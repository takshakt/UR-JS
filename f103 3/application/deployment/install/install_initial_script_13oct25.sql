prompt --application/deployment/install/install_initial_script_13oct25
begin
--   Manifest
--     INSTALL: INSTALL-Initial Script 13OCT25
--   Manifest End
wwv_flow_imp.component_begin (
 p_version_yyyy_mm_dd=>'2024.11.30'
,p_release=>'24.2.10'
,p_default_workspace_id=>7945143549875994
,p_default_application_id=>103
,p_default_id_offset=>0
,p_default_owner=>'WKSP_DEV'
);
wwv_flow_imp_shared.create_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_install_id=>wwv_flow_imp.id(9665506831982728)
,p_name=>'Initial Script 13OCT25'
,p_sequence=>20
,p_script_type=>'INSTALL'
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'',
'  CREATE TABLE "DEBUG_LOG" ',
'   (	"ID" RAW(16) DEFAULT sys_guid(), ',
'	"LOG_TIME" TIMESTAMP (6) DEFAULT systimestamp, ',
'	"MESSAGE" CLOB',
'   ) ;',
'',
'  CREATE TABLE "EXPENSES" ',
'   (	"EMPLOYEE_NAME" VARCHAR2(100), ',
'	"EXPENSE_ID" NUMBER, ',
'	"EXP_TYPE" VARCHAR2(50), ',
'	"PROJECT_NAME" VARCHAR2(100), ',
'	"EXPENSE_PURPOSE" VARCHAR2(50), ',
'	"EXPENSE_DATE_FROM" DATE, ',
'	"EXPENSE_DATE_TO" DATE, ',
'	"STATUS" VARCHAR2(50), ',
'	"CURRENCY" VARCHAR2(50), ',
'	"CLAIM_AMOUNT" NUMBER, ',
'	"EXPENSE_ATTACHMENT" NUMBER, ',
'	"EXPENSE_COMMENT" CLOB, ',
'	"CREATED_BY" VARCHAR2(50), ',
'	"CREATION_DATE" TIMESTAMP (6), ',
'	"LAST_UPDATED_BY" VARCHAR2(50), ',
'	"LAST_UPDATE_DATE" TIMESTAMP (6)',
'   ) ;',
'',
'  CREATE TABLE "TEMP_BLOB" ',
'   (	"ID" NUMBER(22,0) NOT NULL ENABLE, ',
'	"APPLICATION_ID" NUMBER(22,0), ',
'	"NAME" VARCHAR2(400), ',
'	"FILENAME" VARCHAR2(400), ',
'	"MIME_TYPE" VARCHAR2(255), ',
'	"CREATED_ON" DATE, ',
'	"BLOB_CONTENT" BLOB, ',
'	"PROFILE" CLOB, ',
'	"RECORDS" NUMBER, ',
'	"COLUMNS" CLOB, ',
'	 CONSTRAINT "PK_TEMP_BLOB" PRIMARY KEY ("ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "TEMP_UR_REPORTS" ',
'   (	"ID" VARCHAR2(22210) DEFAULT sys_guid() NOT NULL ENABLE, ',
'	"HOTEL_ID" VARCHAR2(106), ',
'	"KEY" VARCHAR2(110) DEFAULT sys_guid(), ',
'	"NAME" VARCHAR2(100), ',
'	"TYPE" VARCHAR2(50), ',
'	"ACTIVE" VARCHAR2(1) DEFAULT ''Y'', ',
'	"DEFINITION" CLOB, ',
'	"DB_OBJECT_NAME" VARCHAR2(150), ',
'	"DB_OBJECT_CREATED_ON" DATE, ',
'	"ROWS_COUNT" NUMBER, ',
'	"TABLE_SPACE_SIZE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"DEFINITION_JSON" CLOB, ',
'	"COLUMN_ALIAS" CLOB, ',
'	"EXPRESSIONS_CLOB" CLOB',
'   ) ;',
'',
'  CREATE TABLE "TEMP_UR_REPORT_DASHBOARDS" ',
'   (	"ID" NUMBER GENERATED ALWAYS AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, ',
'	"HOTEL_ID" RAW(16), ',
'	"KEY" VARCHAR2(110), ',
'	"NAME" VARCHAR2(100), ',
'	"TYPE" VARCHAR2(50), ',
'	"ACTIVE" VARCHAR2(1) DEFAULT ''Y'', ',
'	"DEFINITION" CLOB, ',
'	"SUMMARY" CLOB, ',
'	 PRIMARY KEY ("ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_ALGO_VERSIONS" ',
'   (	"ID" RAW(16) NOT NULL ENABLE, ',
'	"ALGO_ID" RAW(16) NOT NULL ENABLE, ',
'	"VERSION" VARCHAR2(10) NOT NULL ENABLE, ',
'	"CREATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"UPDATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"CREATED_ON" DATE NOT NULL ENABLE, ',
'	"UPDATED_ON" DATE NOT NULL ENABLE, ',
'	"EXPRESSION" CLOB, ',
'	 CONSTRAINT "PK_UR_ALGO_VERSIONS" PRIMARY KEY ("ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UK_UR_ALGO_VERSIONS_ALGO_VERSION" UNIQUE ("ALGO_ID", "VERSION")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_HOTELS" ',
'   (	"ID" RAW(16) NOT NULL ENABLE, ',
'	"GROUP_ID" RAW(16), ',
'	"HOTEL_NAME" VARCHAR2(100) NOT NULL ENABLE, ',
'	"STAR_RATING" NUMBER(1,0), ',
'	"ADDRESS_ID" RAW(16), ',
'	"CONTACT_ID" RAW(16), ',
'	"OPENING_DATE" DATE, ',
'	"CURRENCY_CODE" VARCHAR2(3) DEFAULT ''GBP'', ',
'	"ASSOCIATION_START_DATE" DATE, ',
'	"ASSOCIATION_END_DATE" DATE, ',
'	"ASSOCIATED_USER_ID" RAW(16), ',
'	"ALGORITHM_ID" RAW(16), ',
'	"CREATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"UPDATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"CREATED_ON" DATE NOT NULL ENABLE, ',
'	"UPDATED_ON" DATE NOT NULL ENABLE, ',
'	"IMAGE" BLOB, ',
'	"IMAGE_NAME" VARCHAR2(40 CHAR), ',
'	"IMG_TYPE" VARCHAR2(100 CHAR), ',
'	 CONSTRAINT "PK_UR_HOTELS" PRIMARY KEY ("ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_INTERFACE_LOGS" ',
'   (	"ID" RAW(16) NOT NULL ENABLE, ',
'	"HOTEL_ID" RAW(16), ',
'	"TEMPLATE_ID" RAW(16) NOT NULL ENABLE, ',
'	"INTERFACE_TYPE" VARCHAR2(20) NOT NULL ENABLE, ',
'	"LOAD_START_TIME" TIMESTAMP (6) NOT NULL ENABLE, ',
'	"LOAD_END_TIME" TIMESTAMP (6), ',
'	"LOAD_MAPPING" CLOB, ',
'	"LOAD_STATUS" VARCHAR2(20) NOT NULL ENABLE, ',
'	"RECORDS_PROCESSED" NUMBER, ',
'	"RECORDS_SUCCESSFUL" NUMBER, ',
'	"RECORDS_FAILED" NUMBER, ',
'	"ERROR_DETAILS" VARCHAR2(1000), ',
'	"CREATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"UPDATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"CREATED_ON" DATE NOT NULL ENABLE, ',
'	"UPDATED_ON" DATE NOT NULL ENABLE, ',
'	"FILE_ID" NUMBER, ',
'	"ERROR_JSON" CLOB, ',
'	 CHECK (Records_Processed >= 0) ENABLE, ',
'	 CHECK (Records_Successful >= 0) ENABLE, ',
'	 CHECK (Records_Failed >= 0) ENABLE, ',
'	 CONSTRAINT "PK_UR_INTERFACE_LOGS" PRIMARY KEY ("ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_LOS1_YORK_2_T_ERR$" ',
'   (	"ORA_ERR_NUMBER$" NUMBER, ',
'	"ORA_ERR_MESG$" VARCHAR2(2000), ',
'	"ORA_ERR_ROWID$" UROWID (4000), ',
'	"ORA_ERR_OPTYP$" VARCHAR2(2), ',
'	"ORA_ERR_TAG$" VARCHAR2(2000), ',
'	"REC_ID" RAW(32767), ',
'	"SDATE" VARCHAR2(4000), ',
'	"DAY" VARCHAR2(32767), ',
'	"MY_OTB" VARCHAR2(4000), ',
'	"MARKET_DEMAND" VARCHAR2(4000), ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" VARCHAR2(32767), ',
'	"HILTON_YORK" VARCHAR2(32767), ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" VARCHAR2(32767), ',
'	"RADISSON_HOTEL_YORK" VARCHAR2(32767), ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" VARCHAR2(32767), ',
'	"NOVOTEL_YORK_CENTRE" VARCHAR2(32767), ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(32767), ',
'	"MOXY_YORK" VARCHAR2(32767), ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" VARCHAR2(32767), ',
'	"HAMPTON_BY_HILTON_YORK" VARCHAR2(32767), ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(32767), ',
'	"CREATED_BY" RAW(32767), ',
'	"UPDATED_BY" RAW(32767), ',
'	"CREATED_ON" VARCHAR2(4000), ',
'	"UPDATED_ON" VARCHAR2(4000), ',
'	"HOTEL_ID" RAW(32767), ',
'	"INTERFACE_LOG_ID" RAW(32767)',
'   ) ;',
'',
'  CREATE TABLE "UR_LOS1_YORK_2_T_ERR$1" ',
'   (	"ORA_ERR_NUMBER$" NUMBER, ',
'	"ORA_ERR_MESG$" VARCHAR2(2000), ',
'	"ORA_ERR_ROWID$" UROWID (4000), ',
'	"ORA_ERR_OPTYP$" VARCHAR2(2), ',
'	"ORA_ERR_TAG$" VARCHAR2(2000), ',
'	"REC_ID" RAW(32767), ',
'	"SDATE" VARCHAR2(4000), ',
'	"DAY" VARCHAR2(32767), ',
'	"MY_OTB" VARCHAR2(4000), ',
'	"MARKET_DEMAND" VARCHAR2(4000), ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" VARCHAR2(32767), ',
'	"HILTON_YORK" VARCHAR2(32767), ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" VARCHAR2(32767), ',
'	"RADISSON_HOTEL_YORK" VARCHAR2(32767), ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" VARCHAR2(32767), ',
'	"NOVOTEL_YORK_CENTRE" VARCHAR2(32767), ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(32767), ',
'	"MOXY_YORK" VARCHAR2(32767), ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" VARCHAR2(32767), ',
'	"HAMPTON_BY_HILTON_YORK" VARCHAR2(32767), ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(32767), ',
'	"CREATED_BY" RAW(32767), ',
'	"UPDATED_BY" RAW(32767), ',
'	"CREATED_ON" VARCHAR2(4000), ',
'	"UPDATED_ON" VARCHAR2(4000), ',
'	"HOTEL_ID" RAW(32767), ',
'	"INTERFACE_LOG_ID" RAW(32767)',
'   ) ;',
'',
'  CREATE TABLE "UR_REPORTS" ',
'   (	"ID" RAW(16) DEFAULT sys_guid() NOT NULL ENABLE, ',
'	"HOTEL_ID" RAW(16), ',
'	"KEY" VARCHAR2(110) DEFAULT sys_guid(), ',
'	"NAME" VARCHAR2(100) NOT NULL ENABLE, ',
'	"TYPE" VARCHAR2(50), ',
'	"ACTIVE" VARCHAR2(1) DEFAULT ''Y'' NOT NULL ENABLE, ',
'	"DEFINITION" CLOB NOT NULL ENABLE, ',
'	"DB_OBJECT_NAME" VARCHAR2(150), ',
'	"DB_OBJECT_CREATED_ON" DATE NOT NULL ENABLE, ',
'	"ROWS_COUNT" NUMBER, ',
'	"TABLE_SPACE_SIZE" NUMBER, ',
'	"CREATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"UPDATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"CREATED_ON" DATE NOT NULL ENABLE, ',
'	"UPDATED_ON" DATE NOT NULL ENABLE, ',
'	 CHECK (Active IN (''Y'', ''N'')) ENABLE, ',
'	 CONSTRAINT "PK_UR_REPORTS" PRIMARY KEY ("ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UQ_UR_REPORTS_KEY" UNIQUE ("KEY")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_REPORT_DASHBOARDS" ',
'   (	"ID" RAW(16) NOT NULL ENABLE, ',
'	"HOTEL_ID" RAW(16), ',
'	"KEY" VARCHAR2(110) NOT NULL ENABLE, ',
'	"NAME" VARCHAR2(100) NOT NULL ENABLE, ',
'	"TYPE" VARCHAR2(50), ',
'	"ACTIVE" VARCHAR2(1) DEFAULT ''Y'', ',
'	"DEFINITION" CLOB NOT NULL ENABLE, ',
'	"CREATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"UPDATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"CREATED_ON" DATE NOT NULL ENABLE, ',
'	"UPDATED_ON" DATE NOT NULL ENABLE, ',
'	 CHECK (ACTIVE IN (''Y'', ''N'')) ENABLE, ',
'	 CONSTRAINT "CK_KEY_FORMAT" CHECK (',
'    REGEXP_LIKE("KEY", ''^[A-Z0-9_]+$'')',
'  ) ENABLE, ',
'	 CONSTRAINT "PK_UR_REPORT_DASHBOARDS" PRIMARY KEY ("ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UQ_UR_REPORT_DASHBOARDS_HOTEL_ID" UNIQUE ("HOTEL_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UQ_UR_REPORT_DASHBOARDS_KEY" UNIQUE ("KEY")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UQ_UR_REPORT_DASHBOARDS_NAME" UNIQUE ("NAME")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_TEMPLATES" ',
'   (	"ID" RAW(32) DEFAULT sys_guid() NOT NULL ENABLE, ',
'	"HOTEL_ID" RAW(16), ',
'	"KEY" VARCHAR2(110) NOT NULL ENABLE, ',
'	"NAME" VARCHAR2(100) NOT NULL ENABLE, ',
'	"TYPE" VARCHAR2(50) NOT NULL ENABLE, ',
'	"ACTIVE" VARCHAR2(1) DEFAULT ''Y'' NOT NULL ENABLE, ',
'	"DEFINITION" CLOB NOT NULL ENABLE, ',
'	"DB_OBJECT_NAME" VARCHAR2(150), ',
'	"DB_OBJECT_CREATED_ON" DATE, ',
'	"ROWS_COUNT" NUMBER, ',
'	"TABLE_SPACE_SIZE" NUMBER, ',
'	"CREATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"UPDATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"CREATED_ON" DATE NOT NULL ENABLE, ',
'	"UPDATED_ON" DATE NOT NULL ENABLE, ',
'	"DB_VIEW_OBJECT_NAME" VARCHAR2(150), ',
'	"DB_VIEW_OBJECT_CREATED_ON" DATE, ',
'	 CHECK (Active IN (''Y'', ''N'')) ENABLE, ',
'	 CONSTRAINT "PK_UR_TEMPLATES" PRIMARY KEY ("ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UQ_UR_TEMPLATES_KEY" UNIQUE ("KEY")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "XXPEL_WF_GLOBAL_PROFILES_TBL" ',
'   (	"ID" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, ',
'	"KEY" VARCHAR2(2000 CHAR), ',
'	"NAME" VARCHAR2(2000 CHAR), ',
'	"DESCRIPTION" VARCHAR2(2000 CHAR), ',
'	"VALUE" VARCHAR2(2000 CHAR), ',
'	"START_DATE" DATE, ',
'	"END_DATE" DATE, ',
'	"CREATED_BY" VARCHAR2(2000 CHAR), ',
'	"UPDATED_BY" VARCHAR2(2000 CHAR), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"ATTRIBUTE1" VARCHAR2(2000 CHAR), ',
'	"ATTRIBUTE2" VARCHAR2(2000 CHAR), ',
'	"ATTRIBUTE3" VARCHAR2(2000 CHAR), ',
'	"ATTRIBUTE4" VARCHAR2(2000 CHAR), ',
'	"ATTRIBUTE5" VARCHAR2(2000 CHAR), ',
'	 CONSTRAINT "XXPEL_WF_GLOBAL_PROFILES_TBL_PK" PRIMARY KEY ("ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "KEY_UNIQUE" UNIQUE ("KEY")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "HTMLDB_PLAN_TABLE" ',
'   (	"STATEMENT_ID" VARCHAR2(30), ',
'	"PLAN_ID" NUMBER, ',
'	"TIMESTAMP" DATE, ',
'	"REMARKS" VARCHAR2(4000), ',
'	"OPERATION" VARCHAR2(30), ',
'	"OPTIONS" VARCHAR2(255), ',
'	"OBJECT_NODE" VARCHAR2(128), ',
'	"OBJECT_OWNER" VARCHAR2(128), ',
'	"OBJECT_NAME" VARCHAR2(128), ',
'	"OBJECT_ALIAS" VARCHAR2(261), ',
'	"OBJECT_INSTANCE" NUMBER(*,0), ',
'	"OBJECT_TYPE" VARCHAR2(128), ',
'	"OPTIMIZER" VARCHAR2(255), ',
'	"SEARCH_COLUMNS" NUMBER, ',
'	"ID" NUMBER(*,0), ',
'	"PARENT_ID" NUMBER(*,0), ',
'	"DEPTH" NUMBER(*,0), ',
'	"POSITION" NUMBER(*,0), ',
'	"COST" NUMBER(*,0), ',
'	"CARDINALITY" NUMBER(*,0), ',
'	"BYTES" NUMBER(*,0), ',
'	"OTHER_TAG" VARCHAR2(255), ',
'	"PARTITION_START" VARCHAR2(255), ',
'	"PARTITION_STOP" VARCHAR2(255), ',
'	"PARTITION_ID" NUMBER(*,0), ',
'	"OTHER" LONG, ',
'	"DISTRIBUTION" VARCHAR2(30), ',
'	"CPU_COST" NUMBER(*,0), ',
'	"IO_COST" NUMBER(*,0), ',
'	"TEMP_SPACE" NUMBER(*,0), ',
'	"ACCESS_PREDICATES" VARCHAR2(4000), ',
'	"FILTER_PREDICATES" VARCHAR2(4000), ',
'	"PROJECTION" VARCHAR2(4000), ',
'	"TIME" NUMBER(*,0), ',
'	"QBLOCK_NAME" VARCHAR2(128)',
'   ) ;',
'',
'  CREATE TABLE "UR_1DAY_T" ',
'   (	"REC_ID" RAW(16), ',
'	"STAY_DATE" DATE, ',
'	"YESTERDAY_ROOMS_COMMIT" NUMBER, ',
'	"YESTERDAY_ADR_COMMIT" NUMBER, ',
'	"YESTERDAY_REV" NUMBER, ',
'	"YESTERDAY_GROUPS_RNTS" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_1DAY_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_1DAY_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_3DAY2_T" ',
'   (	"REC_ID" RAW(16), ',
'	"STAY_DATE" DATE, ',
'	"TODAY_ROOMS_COMMIT" NUMBER, ',
'	"TODAY_ADR_COMMIT" NUMBER, ',
'	"REV" NUMBER, ',
'	"PICK_UP_RNTS" NUMBER, ',
'	"PICK_UP_REV" NUMBER, ',
'	"PICK_UP_ADR" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_3DAY2_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_3DAY2_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_3DAY_T" ',
'   (	"REC_ID" RAW(16), ',
'	"STAY_DATE" DATE, ',
'	"C3_DAYS_ROOMS_COMMIT" NUMBER, ',
'	"C3_DAYS_ADR_COMMIT" NUMBER, ',
'	"C3_DAYS_REV" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_3DAY_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_3DAY_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_7DAY1_T" ',
'   (	"REC_ID" RAW(16), ',
'	"STAY_DATE" DATE, ',
'	"C7_DAYS_ROOMS_COMMIT" NUMBER, ',
'	"C7_DAYS_ADR_COMMIT" NUMBER, ',
'	"C7DAYS_REV" NUMBER, ',
'	"C7_DAYS_GROUPS" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_7DAY1_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_7DAY1_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_ADAM_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY__" NUMBER, ',
'	"ADR__USD_" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_ADAM_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_ADDRESSES" ',
'   (	"ID" RAW(16) NOT NULL ENABLE, ',
'	"STREET_ADDRESS" VARCHAR2(200) NOT NULL ENABLE, ',
'	"CITY" VARCHAR2(100) NOT NULL ENABLE, ',
'	"COUNTY" VARCHAR2(100), ',
'	"POST_CODE" VARCHAR2(20) NOT NULL ENABLE, ',
'	"COUNTRY" VARCHAR2(100) NOT NULL ENABLE, ',
'	"CREATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"UPDATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"CREATED_ON" DATE NOT NULL ENABLE, ',
'	"UPDATED_ON" DATE NOT NULL ENABLE, ',
'	"HOTEL_ID" RAW(16) NOT NULL ENABLE, ',
'	"PRIMARY_ADDRESS" VARCHAR2(200) NOT NULL ENABLE, ',
'	 CONSTRAINT "PK_ADDRESSES" PRIMARY KEY ("ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_ALGOS" ',
'   (	"ID" RAW(16) NOT NULL ENABLE, ',
'	"NAME" VARCHAR2(100) NOT NULL ENABLE, ',
'	"DESCRIPTION" VARCHAR2(1000), ',
'	"HOTEL_ID" RAW(16), ',
'	"CURRENT_VERSION_ID" RAW(16), ',
'	"CREATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"UPDATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"CREATED_ON" DATE NOT NULL ENABLE, ',
'	"UPDATED_ON" DATE NOT NULL ENABLE, ',
'	 CONSTRAINT "PK_UR_ALGOS" PRIMARY KEY ("ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_ALGOS_CON" UNIQUE ("NAME")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_ALGO_ATTRIBUTES" ',
'   (	"ID" RAW(16) NOT NULL ENABLE, ',
'	"ALGO_ID" RAW(16), ',
'	"HOTEL_ID" RAW(16), ',
'	"NAME" VARCHAR2(100) NOT NULL ENABLE, ',
'	"KEY" VARCHAR2(120) NOT NULL ENABLE, ',
'	"DATA_TYPE" VARCHAR2(50) DEFAULT ''NUMBER'' NOT NULL ENABLE, ',
'	"DESCRIPTION" VARCHAR2(1000), ',
'	"TYPE" VARCHAR2(1) DEFAULT ''M'' NOT NULL ENABLE, ',
'	"VALUE" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"UPDATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"CREATED_ON" DATE NOT NULL ENABLE, ',
'	"UPDATED_ON" DATE NOT NULL ENABLE, ',
'	"TEMPLATE_ID" RAW(16), ',
'	"ATTRIBUTE_QUALIFIER" VARCHAR2(50), ',
'	 CONSTRAINT "PK_UR_ALGO_ATTRIBUTES" PRIMARY KEY ("ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UK_UR_ALGO_ATTRIBUTES_KEY" UNIQUE ("KEY")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_BHAUMIK_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_BHAUMIK_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_BHAUMIK_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_CHINAR_22SEPT1_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_CHINAR_22SEPT1_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_CHINAR_22SEPT_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_CHINAR_22SEPT_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_CHINAR_22SEPT_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_CHINAR_28_SEP_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_CHINAR_28_SEP_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_CHINAR_28_SEP_T_STAY_UQ" UNIQUE ("STAY")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_CHINAR_STAY_DATE_TEMPLATE_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_CHINAR_STAY_DATE_TEMPLATE_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_CHINAR_STAY_DATE_TEMPLATE_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_CHINAR_TEST_111_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_CHINAR_TEST_111_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_CHINAR_TEST_112_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_CHINAR_TEST_112_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_CHINAR_TEST_112_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_CONTACTS" ',
'   (	"ID" RAW(16) NOT NULL ENABLE, ',
'	"HOTEL_ID" RAW(16), ',
'	"CONTACT_NAME" VARCHAR2(100) NOT NULL ENABLE, ',
'	"POSITION_TITLE" VARCHAR2(100), ',
'	"EMAIL" VARCHAR2(150), ',
'	"PHONE_NUMBER" VARCHAR2(30), ',
'	"CONTACT_TYPE" VARCHAR2(50), ',
'	"PRIMARY" VARCHAR2(1) DEFAULT ''N'', ',
'	"CREATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"UPDATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"CREATED_ON" DATE NOT NULL ENABLE, ',
'	"UPDATED_ON" DATE NOT NULL ENABLE, ',
'	 CHECK (Primary IN (''Y'', ''N'')) ENABLE, ',
'	 CONSTRAINT "CHK_EMAIL_FORMAT" CHECK (',
'        Email IS NULL OR REGEXP_LIKE(Email, ''^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'')',
'    ) ENABLE, ',
'	 CONSTRAINT "CHK_PHONE_FORMAT" CHECK (',
'        Phone_Number IS NULL OR REGEXP_LIKE(Phone_Number, ''^\+?[0-9\-\(\) ]{7,30}$'')',
'    ) ENABLE, ',
'	 CONSTRAINT "PK_UR_CONTACTS" PRIMARY KEY ("ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_DAILY_BREAKDOWN11_T" ',
'   (	"REC_ID" RAW(16), ',
'	"COL001" VARCHAR2(4000), ',
'	"COL002" VARCHAR2(4000), ',
'	"COL003" VARCHAR2(4000), ',
'	"COL004" VARCHAR2(4000), ',
'	"REVENUE_INSIGHT___HOTEL_INDIGO_LONDON___1_LEICESTER_SQUARE_BY_IHG___GBP" VARCHAR2(4000), ',
'	"COL006" VARCHAR2(4000), ',
'	"COL007" VARCHAR2(4000), ',
'	"COL008" VARCHAR2(4000), ',
'	"COL009" VARCHAR2(4000), ',
'	"COL010" VARCHAR2(4000), ',
'	"COL011" VARCHAR2(4000), ',
'	"COL012" VARCHAR2(4000), ',
'	"COL013" VARCHAR2(4000), ',
'	"COL014" VARCHAR2(4000), ',
'	"COL015" VARCHAR2(4000), ',
'	"COL016" VARCHAR2(4000), ',
'	"COL017" VARCHAR2(4000), ',
'	"COL018" VARCHAR2(4000), ',
'	"COL019" VARCHAR2(4000), ',
'	"COL020" VARCHAR2(4000), ',
'	"COL021" VARCHAR2(4000), ',
'	"COL022" VARCHAR2(4000), ',
'	"COL023" VARCHAR2(4000), ',
'	"COL024" VARCHAR2(4000), ',
'	"COL025" VARCHAR2(4000), ',
'	"COL026" VARCHAR2(4000), ',
'	"COL027" VARCHAR2(4000), ',
'	"COL028" NUMBER, ',
'	"COL029" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_DAILY_BREAKDOWN11_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_DAILY_BREAKDOWN_T" ',
'   (	"REC_ID" RAW(16), ',
'	"COLUMN_" VARCHAR2(4000), ',
'	"RNS__OTB_" NUMBER, ',
'	"REVENUE__OTB_" NUMBER, ',
'	"OUT_OF_ORDER__OOO___OTB_" NUMBER, ',
'	"RNS__OTB_STLY_" NUMBER, ',
'	"ROOM_REVENUE__OTB_STLY_" NUMBER, ',
'	"RNS__PICKUP_CY_" NUMBER, ',
'	"ROOM_REVENUE__PICKUP_CY_" NUMBER, ',
'	"RNS__PICKUP_LY_" NUMBER, ',
'	"ROOM_REVENUE__PICKUP_LY_" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_DAILY_BREAKDOWN_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_DAILY_BREAKDOWN_VK_2_T" ',
'   (	"REC_ID" RAW(16), ',
'	"COLUMN_" VARCHAR2(4000), ',
'	"RNS__OTB_" NUMBER, ',
'	"REVENUE__OTB_" NUMBER, ',
'	"OUT_OF_ORDER__OOO___OTB_" NUMBER, ',
'	"RNS__OTB_STLY_" NUMBER, ',
'	"ROOM_REVENUE__OTB_STLY_" NUMBER, ',
'	"RNS__PICKUP_CY_" NUMBER, ',
'	"ROOM_REVENUE__PICKUP_CY_" NUMBER, ',
'	"RNS__PICKUP_LY_" NUMBER, ',
'	"ROOM_REVENUE__PICKUP_LY_" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_DAILY_BREAKDOWN_VK_2_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_DAILY_BREAKDOWN_VK_2_T_RNS__OTB__UQ" UNIQUE ("RNS__OTB_")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_DAILY_BREAKDOWN_VK_3_T" ',
'   (	"REC_ID" RAW(16), ',
'	"COLUMN_" VARCHAR2(4000), ',
'	"RNS__OTB_" NUMBER, ',
'	"REVENUE__OTB_" NUMBER, ',
'	"OUT_OF_ORDER__OOO___OTB_" NUMBER, ',
'	"RNS__OTB_STLY_" NUMBER, ',
'	"ROOM_REVENUE__OTB_STLY_" NUMBER, ',
'	"RNS__PICKUP_CY_" NUMBER, ',
'	"ROOM_REVENUE__PICKUP_CY_" NUMBER, ',
'	"RNS__PICKUP_LY_" NUMBER, ',
'	"ROOM_REVENUE__PICKUP_LY_" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_DAILY_BREAKDOWN_VK_3_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_DAILY_BREAKDOWN_VK_3_T_RNS__OTB__UQ" UNIQUE ("RNS__OTB_")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_DAILY_BREAKDOWN_VK_4_T" ',
'   (	"REC_ID" RAW(16), ',
'	"COLUMN_" VARCHAR2(4000), ',
'	"RNS__OTB_" NUMBER, ',
'	"REVENUE__OTB_" NUMBER, ',
'	"OUT_OF_ORDER__OOO___OTB_" NUMBER, ',
'	"RNS__OTB_STLY_" NUMBER, ',
'	"ROOM_REVENUE__OTB_STLY_" NUMBER, ',
'	"RNS__PICKUP_CY_" NUMBER, ',
'	"ROOM_REVENUE__PICKUP_CY_" NUMBER, ',
'	"RNS__PICKUP_LY_" NUMBER, ',
'	"ROOM_REVENUE__PICKUP_LY_" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_DAILY_BREAKDOWN_VK_4_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_DAILY_BREAKDOWN_VK_T" ',
'   (	"REC_ID" RAW(16), ',
'	"COLUMN_" VARCHAR2(4000), ',
'	"RNS__OTB_" NUMBER, ',
'	"REVENUE__OTB_" NUMBER, ',
'	"OUT_OF_ORDER__OOO___OTB_" NUMBER, ',
'	"RNS__OTB_STLY_" NUMBER, ',
'	"ROOM_REVENUE__OTB_STLY_" NUMBER, ',
'	"RNS__PICKUP_CY_" NUMBER, ',
'	"ROOM_REVENUE__PICKUP_CY_" NUMBER, ',
'	"RNS__PICKUP_LY_" NUMBER, ',
'	"ROOM_REVENUE__PICKUP_LY_" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_DAILY_BREAKDOWN_VK_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_DEMO_30SEP25_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" DATE, ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" NUMBER, ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" NUMBER, ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_DEMO_30SEP25_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_DEMO_30SEP25_T_SDATE_UQ" UNIQUE ("SDATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_EVENTS" ',
'   (	"ID" RAW(16) NOT NULL ENABLE, ',
'	"HOTEL_ID" RAW(16), ',
'	"EVENT_NAME" VARCHAR2(200) NOT NULL ENABLE, ',
'	"EVENT_TYPE" VARCHAR2(100) NOT NULL ENABLE, ',
'	"EVENT_START_DATE" DATE NOT NULL ENABLE, ',
'	"EVENT_END_DATE" DATE NOT NULL ENABLE, ',
'	"ESTIMATED_ATTENDANCE" NUMBER, ',
'	"IMPACT_LEVEL" VARCHAR2(50), ',
'	"DESCRIPTION" VARCHAR2(500), ',
'	"CITY" VARCHAR2(100), ',
'	"POSTCODE" VARCHAR2(10), ',
'	"CREATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"UPDATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"CREATED_ON" DATE NOT NULL ENABLE, ',
'	"UPDATED_ON" DATE NOT NULL ENABLE, ',
'	"COUNTRY" VARCHAR2(100), ',
'	"EVENT_FREQUENCY" VARCHAR2(50), ',
'	"IMPACT_TYPE" VARCHAR2(50), ',
'	 CONSTRAINT "PK_UR_EVENTS" PRIMARY KEY ("ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_EXPENSE_TEMPLATE_02_T" ',
'   (	"ROW_ID" RAW(16), ',
'	"ID" NUMBER, ',
'	"USERNAME" VARCHAR2(4000), ',
'	"PROJECTNAME" VARCHAR2(4000), ',
'	"TASKNAME" VARCHAR2(4000), ',
'	"DESCRIPTION" VARCHAR2(4000), ',
'	"HRS" NUMBER, ',
'	"DATE_WORK" DATE, ',
'	"TO_DATE_WORK" DATE, ',
'	"COMMENTS" VARCHAR2(4000), ',
'	"CREATE_BY" VARCHAR2(4000), ',
'	"LAST_UPDATE_BY" VARCHAR2(4000), ',
'	"CREATE_DATE" DATE, ',
'	"LAST_UPDATE_DATE" DATE, ',
'	"LAST_UPDATE_LOGIN" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	 CONSTRAINT "UR_EXPENSE_TEMPLATE_02_T_PK" PRIMARY KEY ("ROW_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_EXP_REPORT_2122122_T" ',
'   (	"ROW_ID" RAW(16), ',
'	"ID" NUMBER, ',
'	"USERNAME" VARCHAR2(4000), ',
'	"PROJECTNAME" VARCHAR2(4000), ',
'	"TASKNAME" VARCHAR2(4000), ',
'	"DESCRIPTION" VARCHAR2(4000), ',
'	"HRS" NUMBER, ',
'	"DATE_WORK" DATE, ',
'	"TO_DATE_WORK" DATE, ',
'	"COMMENTS" VARCHAR2(4000), ',
'	"CREATE_BY" VARCHAR2(4000), ',
'	"LAST_UPDATE_BY" VARCHAR2(4000), ',
'	"CREATE_DATE" DATE, ',
'	"LAST_UPDATE_DATE" DATE, ',
'	"LAST_UPDATE_LOGIN" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	 CONSTRAINT "UR_EXP_REPORT_2122122_T_PK" PRIMARY KEY ("ROW_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_EXP_REPORT_212212_T" ',
'   (	"ROW_ID" RAW(16), ',
'	"ID" NUMBER, ',
'	"USERNAME" VARCHAR2(4000), ',
'	"PROJECTNAME" VARCHAR2(4000), ',
'	"TASKNAME" VARCHAR2(4000), ',
'	"DESCRIPTION" VARCHAR2(4000), ',
'	"HRS" NUMBER, ',
'	"DATE_WORK" DATE, ',
'	"TO_DATE_WORK" DATE, ',
'	"COMMENTS" VARCHAR2(4000), ',
'	"CREATE_BY" VARCHAR2(4000), ',
'	"LAST_UPDATE_BY" VARCHAR2(4000), ',
'	"CREATE_DATE" DATE, ',
'	"LAST_UPDATE_DATE" DATE, ',
'	"LAST_UPDATE_LOGIN" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	 CONSTRAINT "UR_EXP_REPORT_212212_T_PK" PRIMARY KEY ("ROW_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_EXP_REPORT_21221_T" ',
'   (	"ROW_ID" RAW(16), ',
'	"ID" NUMBER, ',
'	"USERNAME" VARCHAR2(4000), ',
'	"PROJECTNAME" VARCHAR2(4000), ',
'	"TASKNAME" VARCHAR2(4000), ',
'	"DESCRIPTION" VARCHAR2(4000), ',
'	"HRS" NUMBER, ',
'	"DATE_WORK" DATE, ',
'	"TO_DATE_WORK" DATE, ',
'	"COMMENTS" VARCHAR2(4000), ',
'	"CREATE_BY" VARCHAR2(4000), ',
'	"LAST_UPDATE_BY" VARCHAR2(4000), ',
'	"CREATE_DATE" DATE, ',
'	"LAST_UPDATE_DATE" DATE, ',
'	"LAST_UPDATE_LOGIN" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	 CONSTRAINT "UR_EXP_REPORT_21221_T_PK" PRIMARY KEY ("ROW_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_EXP_REPORT_21_T" ',
'   (	"ROW_ID" RAW(16), ',
'	"ID" NUMBER, ',
'	"USERNAME" VARCHAR2(4000), ',
'	"PROJECTNAME" VARCHAR2(4000), ',
'	"TASKNAME" VARCHAR2(4000), ',
'	"DESCRIPTION" VARCHAR2(4000), ',
'	"HRS" NUMBER, ',
'	"DATE_WORK" DATE, ',
'	"TO_DATE_WORK" DATE, ',
'	"COMMENTS" VARCHAR2(4000), ',
'	"CREATE_BY" VARCHAR2(4000), ',
'	"LAST_UPDATE_BY" VARCHAR2(4000), ',
'	"CREATE_DATE" DATE, ',
'	"LAST_UPDATE_DATE" DATE, ',
'	"LAST_UPDATE_LOGIN" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	 CONSTRAINT "UR_EXP_REPORT_21_T_PK" PRIMARY KEY ("ROW_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_EXP_REPORT_3_T" ',
'   (	"ROW_ID" RAW(16), ',
'	"ID" NUMBER, ',
'	"USERNAME" VARCHAR2(4000), ',
'	"PROJECTNAME" VARCHAR2(4000), ',
'	"TASKNAME" VARCHAR2(4000), ',
'	"DESCRIPTION" VARCHAR2(4000), ',
'	"HRS" NUMBER, ',
'	"DATE_WORK" DATE, ',
'	"TO_DATE_WORK" DATE, ',
'	"COMMENTS" VARCHAR2(4000), ',
'	"CREATE_BY" VARCHAR2(4000), ',
'	"LAST_UPDATE_BY" VARCHAR2(4000), ',
'	"CREATE_DATE" DATE, ',
'	"LAST_UPDATE_DATE" DATE, ',
'	"LAST_UPDATE_LOGIN" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	 CONSTRAINT "UR_EXP_REPORT_3_T_PK" PRIMARY KEY ("ROW_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_EXP_REPORT_T" ',
'   (	"ROW_ID" RAW(16), ',
'	"ID" NUMBER, ',
'	"USERNAME" VARCHAR2(4000), ',
'	"PROJEC'))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'TNAME" VARCHAR2(4000), ',
'	"TASKNAME" VARCHAR2(4000), ',
'	"DESCRIPTION" VARCHAR2(4000), ',
'	"HRS" NUMBER, ',
'	"DATE_WORK" DATE, ',
'	"TO_DATE_WORK" DATE, ',
'	"COMMENTS" VARCHAR2(4000), ',
'	"CREATE_BY" VARCHAR2(4000), ',
'	"LAST_UPDATE_BY" VARCHAR2(4000), ',
'	"CREATE_DATE" DATE, ',
'	"LAST_UPDATE_DATE" DATE, ',
'	"LAST_UPDATE_LOGIN" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	 CONSTRAINT "UR_EXP_REPORT_T_PK" PRIMARY KEY ("ROW_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_HOTEL_ACCESSES" ',
'   (	"HOTEL_ID" RAW(16) NOT NULL ENABLE, ',
'	"USER_ID" RAW(16) NOT NULL ENABLE, ',
'	"ACCESS_TYPE" VARCHAR2(100) NOT NULL ENABLE, ',
'	"START_DATE" DATE, ',
'	"END_DATE" DATE, ',
'	"CREATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"UPDATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"CREATED_ON" DATE NOT NULL ENABLE, ',
'	"UPDATED_ON" DATE NOT NULL ENABLE, ',
'	 CONSTRAINT "PK_UR_HOTEL_ACCESSES" PRIMARY KEY ("HOTEL_ID", "USER_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_HOTEL_GROUPS" ',
'   (	"ID" RAW(16), ',
'	"GROUP_NAME" VARCHAR2(100) NOT NULL ENABLE, ',
'	"DESCRIPTION" VARCHAR2(250), ',
'	"ADDRESS_ID" RAW(16), ',
'	"CONTACT_ID" RAW(16), ',
'	"ASSOCIATION_START_DATE" DATE, ',
'	"ASSOCIATION_END_DATE" DATE, ',
'	"ASSOCIATED_EMP_ID" RAW(16), ',
'	"CREATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"UPDATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"CREATED_ON" DATE NOT NULL ENABLE, ',
'	"UPDATED_ON" DATE NOT NULL ENABLE, ',
'	 CONSTRAINT "PK_UR_HOTEL_GROUPS" PRIMARY KEY ("ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UQ_UR_HOTEL_GROUPS_NAME" UNIQUE ("GROUP_NAME")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_HOTEL_PRICE_OVERRIDE" ',
'   (	"ID" RAW(16) NOT NULL ENABLE, ',
'	"STAY_DATE" DATE NOT NULL ENABLE, ',
'	"HOTEL_ID" RAW(16) NOT NULL ENABLE, ',
'	"TYPE" VARCHAR2(10) DEFAULT ''Retail'' NOT NULL ENABLE, ',
'	"PRICE" NUMBER(10,2) NOT NULL ENABLE, ',
'	"REASON" VARCHAR2(120), ',
'	"CREATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"UPDATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"CREATED_ON" DATE NOT NULL ENABLE, ',
'	"UPDATED_ON" DATE NOT NULL ENABLE, ',
'	"STATUS" VARCHAR2(10) DEFAULT ''A'' NOT NULL ENABLE, ',
'	 CONSTRAINT "UR_HPRICOVR_ID_PK" PRIMARY KEY ("ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_HPRICOVR_PRICE_CHK" CHECK (Price > 0) ENABLE, ',
'	 CONSTRAINT "UR_HOTEL_PRICE_OVERRIDE_CON" UNIQUE ("HOTEL_ID", "STAY_DATE", "TYPE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_HOTEL_RESERVATIONS" ',
'   (	"ID" RAW(16), ',
'	"RES_NUMBER" VARCHAR2(20) NOT NULL ENABLE, ',
'	"HOTEL_ID" RAW(16), ',
'	"ARRIVAL_DATE" DATE NOT NULL ENABLE, ',
'	"NUMBER_OF_NIGHTS" NUMBER(3,0) NOT NULL ENABLE, ',
'	"ROOMS_BOOKED" NUMBER(5,0) NOT NULL ENABLE, ',
'	"TOTAL_BOOKING_VALUE" NUMBER(12,2) NOT NULL ENABLE, ',
'	"CHARGED_FLAG" CHAR(1), ',
'	"EXCEPTION_AMOUNT" NUMBER(12,2) NOT NULL ENABLE, ',
'	"APPROVED_BY" VARCHAR2(100), ',
'	"NOTES" VARCHAR2(1000), ',
'	"CREATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"UPDATED_ON" DATE NOT NULL ENABLE, ',
'	"ATTRIBUTE1" VARCHAR2(100), ',
'	"ATTRIBUTE2" VARCHAR2(100), ',
'	"ATTRIBUTE3" VARCHAR2(100), ',
'	"ATTRIBUTE4" VARCHAR2(100), ',
'	"ATTRIBUTE5" VARCHAR2(100), ',
'	"ATTRIBUTE6" NUMBER, ',
'	"ATTRIBUTE7" NUMBER, ',
'	"ATTRIBUTE8" NUMBER, ',
'	"ATTRIBUTE9" DATE, ',
'	"ATTRIBUTE10" DATE, ',
'	"CREATED_ON" DATE NOT NULL ENABLE, ',
'	"UPDATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"RESERVATION_TYPE" VARCHAR2(2), ',
'	"EXCEPTION_DATE" DATE, ',
'	"EXCEPTION_REASON" VARCHAR2(250), ',
'	"RESERVATION_EXCEPTION_TYPE" VARCHAR2(50), ',
'	"APPROVED_BY_MANUAL" VARCHAR2(100), ',
'	"ROOM_TYPE_ID" RAW(16), ',
'	 CHECK (Number_of_Nights > 0) ENABLE, ',
'	 CHECK (Rooms_Booked >= 0) ENABLE, ',
'	 CHECK (Total_Booking_Value >= 0) ENABLE, ',
'	 CHECK (Charged_Flag IN (''Y'', ''N'')) ENABLE, ',
'	 CHECK ("EXCEPTION_AMOUNT">=0) ENABLE, ',
'	 CONSTRAINT "PK_UR_HOTEL_RESERVATIONS" PRIMARY KEY ("ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UQ_UR_HOTEL_RES_NUMBER" UNIQUE ("RES_NUMBER")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_HOTEL_ROOM_TYPES" ',
'   (	"ROOM_TYPE_ID" RAW(16) NOT NULL ENABLE, ',
'	"HOTEL_ID" RAW(16) NOT NULL ENABLE, ',
'	"ROOM_TYPE_NAME" VARCHAR2(100) NOT NULL ENABLE, ',
'	"MAX_OCCUPANCY" NUMBER(2,0) NOT NULL ENABLE, ',
'	"BED_TYPE" VARCHAR2(50), ',
'	"DESCRIPTION" VARCHAR2(250), ',
'	"CREATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"UPDATED_BY" RAW(16) NOT NULL ENABLE, ',
'	"CREATED_ON" DATE NOT NULL ENABLE, ',
'	"UPDATED_ON" DATE NOT NULL ENABLE, ',
'	"PRICE" NUMBER, ',
'	"SUPPLIMENT_TYPE" VARCHAR2(3), ',
'	"SUPPLIEMENT_PRICE_MIN" NUMBER, ',
'	"SUPPLIMENT_PRICE_MAX" NUMBER, ',
'	 CONSTRAINT "PK_UR_HOTEL_ROOM_TYPES" PRIMARY KEY ("ROOM_TYPE_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_INDIGO_L_SQUARE_I_T" ',
'   (	"REC_ID" RAW(16), ',
'	"DATE_" DATE, ',
'	"DOW" VARCHAR2(4000), ',
'	"EVENTS_2025" VARCHAR2(4000), ',
'	"RMS_RATE" NUMBER, ',
'	"LIGHTHOUSE_RATE" VARCHAR2(4000), ',
'	"HURDLES" VARCHAR2(4000), ',
'	"PROPOSED_RATE" NUMBER, ',
'	"MLOS3_PROPOSED_RATE" NUMBER, ',
'	"MANUAL_OVERRIDE" NUMBER, ',
'	"RATE_TO_PUBLISH" NUMBER, ',
'	"ROOMS" NUMBER, ',
'	"GROUPS_ROOMS" NUMBER, ',
'	"OCC" NUMBER, ',
'	"STLY" NUMBER, ',
'	"OOO" NUMBER, ',
'	"OCC_FINAL_LY" NUMBER, ',
'	"COMP_SET_LY_OCC" NUMBER, ',
'	"ADR" NUMBER, ',
'	"ADR_STLY_LY" NUMBER, ',
'	"ADR_FINAL_LY" NUMBER, ',
'	"COMP_SET_LY_ADR" NUMBER, ',
'	"REVPAR_TY" NUMBER, ',
'	"REVPAR_LY" NUMBER, ',
'	"COMP_SET_REVPAR_LY" NUMBER, ',
'	"LIVE_RGI" NUMBER, ',
'	"LY_RGI" NUMBER, ',
'	"C1_DAY_RNTS_PICK_UP" NUMBER, ',
'	"C3_DAY_RNTS_PICK_UP" NUMBER, ',
'	"C7_DAY_RNTS_PICK_UP" NUMBER, ',
'	"C1_DAY__GROUP_PICK_UP" NUMBER, ',
'	"C3_DAY_GROUP_PICK_UP" NUMBER, ',
'	"C7_DAY_GROUP_PICK_UP" NUMBER, ',
'	"C1_DAY_RNTS_PICK_UP_LY" NUMBER, ',
'	"C3_DAY_RNTS_PICK_UP_LY" NUMBER, ',
'	"C7_DAY_RNTS_PICK_UP_LY" NUMBER, ',
'	"C1_DAY_REVENUE_PICK_UP_LY" NUMBER, ',
'	"C3_DAY_REVENUE_PICK_UP_LY" NUMBER, ',
'	"C7_DAY_REVENUE_PICK_UP_LY" NUMBER, ',
'	"C1_DAY_ADR_PICK_UP" VARCHAR2(4000), ',
'	"C3_DAY_ADR_PICK_UP" VARCHAR2(4000), ',
'	"C7_DAY_ADR_PICK_UP" VARCHAR2(4000), ',
'	"C1_DAY_REVENUE_PICK_UP" NUMBER, ',
'	"C3_DAY_REVENUE_PICK_UP" NUMBER, ',
'	"C7_DAY_REVENUE_PICK_UP" NUMBER, ',
'	"REV_OTB" NUMBER, ',
'	"COLUMN_" NUMBER, ',
'	"LOS1_RATE" VARCHAR2(4000), ',
'	"LOS3_RATE" VARCHAR2(4000), ',
'	"LOS1_RNK" VARCHAR2(4000), ',
'	"LOS3_RNK" VARCHAR2(4000), ',
'	"RMS_RATE_PUBLISH_CHECK" NUMBER, ',
'	"OVERBOOKING" NUMBER, ',
'	"COL053" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_INDIGO_L_SQUARE_I_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_INDIGO_L_SQUARE_T" ',
'   (	"REC_ID" RAW(16), ',
'	"DATE_" DATE, ',
'	"DOW" VARCHAR2(4000), ',
'	"EVENTS_2025" VARCHAR2(4000), ',
'	"RMS_RATE" NUMBER, ',
'	"LIGHTHOUSE_RATE" VARCHAR2(4000), ',
'	"HURDLES" VARCHAR2(4000), ',
'	"PROPOSED_RATE" NUMBER, ',
'	"MLOS3_PROPOSED_RATE" NUMBER, ',
'	"MANUAL_OVERRIDE" NUMBER, ',
'	"RATE_TO_PUBLISH" NUMBER, ',
'	"ROOMS" NUMBER, ',
'	"GROUPS_ROOMS" NUMBER, ',
'	"OCC" NUMBER, ',
'	"STLY" NUMBER, ',
'	"OOO" NUMBER, ',
'	"OCC_FINAL_LY" NUMBER, ',
'	"COMP_SET_LY_OCC" NUMBER, ',
'	"ADR" NUMBER, ',
'	"ADR_STLY_LY" NUMBER, ',
'	"ADR_FINAL_LY" NUMBER, ',
'	"COMP_SET_LY_ADR" NUMBER, ',
'	"REVPAR_TY" NUMBER, ',
'	"REVPAR_LY" NUMBER, ',
'	"COMP_SET_REVPAR_LY" NUMBER, ',
'	"LIVE_RGI" NUMBER, ',
'	"LY_RGI" NUMBER, ',
'	"C1_DAY_RNTS_PICK_UP" NUMBER, ',
'	"C3_DAY_RNTS_PICK_UP" NUMBER, ',
'	"C7_DAY_RNTS_PICK_UP" NUMBER, ',
'	"C1_DAY__GROUP_PICK_UP" NUMBER, ',
'	"C3_DAY_GROUP_PICK_UP" NUMBER, ',
'	"C7_DAY_GROUP_PICK_UP" NUMBER, ',
'	"C1_DAY_RNTS_PICK_UP_LY" NUMBER, ',
'	"C3_DAY_RNTS_PICK_UP_LY" NUMBER, ',
'	"C7_DAY_RNTS_PICK_UP_LY" NUMBER, ',
'	"C1_DAY_REVENUE_PICK_UP_LY" NUMBER, ',
'	"C3_DAY_REVENUE_PICK_UP_LY" NUMBER, ',
'	"C7_DAY_REVENUE_PICK_UP_LY" NUMBER, ',
'	"C1_DAY_ADR_PICK_UP" VARCHAR2(4000), ',
'	"C3_DAY_ADR_PICK_UP" VARCHAR2(4000), ',
'	"C7_DAY_ADR_PICK_UP" VARCHAR2(4000), ',
'	"C1_DAY_REVENUE_PICK_UP" NUMBER, ',
'	"C3_DAY_REVENUE_PICK_UP" NUMBER, ',
'	"C7_DAY_REVENUE_PICK_UP" NUMBER, ',
'	"REV_OTB" NUMBER, ',
'	"COLUMN_" NUMBER, ',
'	"LOS1_RATE" VARCHAR2(4000), ',
'	"LOS3_RATE" VARCHAR2(4000), ',
'	"LOS1_RNK" VARCHAR2(4000), ',
'	"LOS3_RNK" VARCHAR2(4000), ',
'	"RMS_RATE_PUBLISH_CHECK" NUMBER, ',
'	"OVERBOOKING" NUMBER, ',
'	"COL053" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_INDIGO_L_SQUARE_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_LOS1_INDIGO_T" ',
'   (	"REC_ID" RAW(16), ',
'	"STAY_DATE" DATE, ',
'	"DOW" VARCHAR2(4000), ',
'	"MY_OTB_PERCENT" NUMBER, ',
'	"MARKET_DEMAND_PERCENT" NUMBER, ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" VARCHAR2(4000), ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" NUMBER, ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_LOS1_INDIGO_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_LOS1_INDIGO_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_LOS1_MCL_T" ',
'   (	"REC_ID" RAW(16), ',
'	"STAY_DATE" DATE, ',
'	"DOW" VARCHAR2(4000), ',
'	"MY_OTB_PERCENT" NUMBER, ',
'	"MARKET_DEMAND_PERCENT" NUMBER, ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" VARCHAR2(4000), ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" NUMBER, ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_LOS1_MCL_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_LOS1_MCL_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_LOS1_T" ',
'   (	"REC_ID" RAW(16), ',
'	"DATE" DATE, ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" NUMBER, ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" VARCHAR2(4000), ',
'	"HILTON_YORK" VARCHAR2(4000), ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" VARCHAR2(4000), ',
'	"RADISSON_HOTEL_YORK" VARCHAR2(4000), ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" VARCHAR2(4000), ',
'	"NOVOTEL_YORK_CENTRE" VARCHAR2(4000), ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" VARCHAR2(4000), ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" VARCHAR2(4000), ',
'	"HAMPTON_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_LOS1_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_LOS1_T_DATE_UQ" UNIQUE ("DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_LOS1_YORK_10_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" VARCHAR2(4000), ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" VARCHAR2(4000), ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_LOS1_YORK_10_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_LOS1_YORK_10_T_SDATE_UQ" UNIQUE ("SDATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_LOS1_YORK_11_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" VARCHAR2(4000), ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" VARCHAR2(4000), ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_LOS1_YORK_11_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_LOS1_YORK_11_T_SDATE_UQ" UNIQUE ("SDATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_LOS1_YORK_12_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" VARCHAR2(4000), ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" NUMBER, ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" NUMBER, ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_LOS1_YORK_12_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_LOS1_YORK_12_T_SDATE_UQ" UNIQUE ("SDATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_LOS1_YORK_13OCT_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" DATE, ',
'	"DAY" DATE, ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" NUMBER, ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" NUMBER, ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_LOS1_YORK_13OCT_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_LOS1_YORK_13OCT_T_SDATE_UQ" UNIQUE ("SDATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_LOS1_YORK_13_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" DATE, ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" NUMBER, ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" NUMBER, ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_LOS1_YORK_13_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_LOS1_YORK_13_T_SDATE_UQ" UNIQUE ("SDATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_LOS1_YORK_14_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" DATE, ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" NUMBER, ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" NUMBER, ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_LOS1_YORK_14_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_LOS1_YORK_14_T_SDATE_UQ" UNIQUE ("SDATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_LOS1_YORK_15_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" DATE, ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" NUMBER, ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" NUMBER, ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_LOS1_YORK_15_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_LOS1_YORK_15_T_SDATE_UQ" UNIQUE ("SDATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_LOS1_YORK_2_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" DATE, ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" NUMBER, ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" VARCHAR2(4000), ',
'	"HILTON_YORK" VARCHAR2(4000), ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" VARCHAR2(4000), ',
'	"RADISSON_HOTEL_YORK" VARCHAR2(4000), ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" VARCHAR2(4000), ',
'	"NOVOTEL_YORK_CENTRE" VARCHAR2(4000), ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" VARCHAR2(4000), ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" VARCHAR2(4000), ',
'	"HAMPTON_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_LOS1_YORK_2_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_LOS1_YORK_2_T_SDATE_UQ" UNIQUE ("SDATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_LOS1_YORK_2_T_INTERFACE" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" DATE, ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" NUMBER, ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" VARCHAR2(4000), ',
'	"HILTON_YORK" VARCHAR2(4000), ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" VARCHAR2(4000), ',
'	"RADISSON_HOTEL_YORK" VARCHAR2(4000), ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" VARCHAR2(4000), ',
'	"NOVOTEL_YORK_CENTRE" VARCHAR2(4000), ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" VARCHAR2(4000), ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" VARCHAR2(4000), ',
'	"HAMPTON_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16)',
'   ) ;',
'',
'  CREATE TABLE "UR_LOS1_YORK_7_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" VARCHAR2(4000), ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" VARCHAR2(4000), ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_LOS1_YORK_7_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_LOS1_YORK_7_T_SDATE_UQ" UNIQUE ("SDATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_LOS1_YORK_8_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" VARCHAR2(4000), ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" VARCHAR2(4000), ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_LOS1_YORK_8_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_LOS1_YORK_8_T_SDATE_UQ" UNIQUE ("SDATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_LOS1_YORK_9_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" VARCHAR2(4000), ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" VARCHAR2(4000), ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_LOS1_YORK_9_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_LOS1_YORK_9_T_SDATE_UQ" UNIQUE ("SDATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_LOS1_YORK_T" ',
'   (	"REC_ID" RAW(16), ',
'	"DATE" DATE, ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" NUMBER, ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" VARCHAR2(4000), ',
'	"HILTON_YORK" VARCHAR2(4000), ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" VARCHAR2(4000), ',
'	"RADISSON_HOTEL_YORK" VARCHAR2(4000), ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" VARCHAR2(4000), ',
'	"NOVOTEL_YORK_CENTRE" VARCHAR2(4000), ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" VARCHAR2(4000), ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" VARCHAR2(4000), ',
'	"HAMPTON_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_LOS1_YORK_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_LOS1_YORK_T_DATE_UQ" UNIQUE ("DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_LOS1_YORK_T_INTERFACE" ',
'   (	"REC_ID" RAW(16), ',
'	"DATE" DATE, ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" NUMBER, ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" VARCHAR2(4000), ',
'	"HILTON_YORK" VARCHAR2(4000), ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" VARCHAR2(4000), ',
'	"RADISSON_HOTEL_YORK" VARCHAR2(4000), ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" VARCHAR2(4000), ',
'	"NOVOTEL_YORK_CENTRE" VARCHAR2(4000), ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" VARCHAR2(4000), ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" VARCHAR2(4000), ',
'	"HAMPTON_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16)',
'   ) ;',
'',
'  CREATE TABLE "UR_LOS3_YORK_T" ',
'   (	"REC_ID" RAW(16), ',
'	"DATE" DATE, ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" NUMBER, ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" VARCHAR2(4000), ',
'	"HILTON_YORK" VARCHAR2(4000), ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" VARCHAR2(4000), ',
'	"RADISSON_HOTEL_YORK" VARCHAR2(4000), ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" VARCHAR2(4000), ',
'	"NOVOTEL_YORK_CENTRE" VARCHAR2(4000), ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" VARCHAR2(4000), ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" VARCHAR2(4000), ',
'	"HAMPTON_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_LOS3_YORK_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_LOS3_YORK_T_DATE_UQ" UNIQUE ("DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_MCL_LOS1_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" DATE, ',
'	"DAY" DATE, ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" NUMBER, ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" NUMBER, ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_MCL_LOS1_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_MCL_LOS1_T_SDATE_UQ" UNIQUE ("SDATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_PICKUP_INDIGO_T" ',
'   (	"REC_ID" RAW(16), ',
'	"STAY_DATE" DATE, ',
'	"DOW" VARCHAR2(4000), ',
'	"EVENTS" VARCHAR2(4000), ',
'	"CURRENT_RATE" NUMBER, ',
'	"LIGHTHOUSE_AP_2PAX" NUMBER, ',
'	"RATE_CHANGES_IN_THE_LAST_7_DAYS" NUMBER, ',
'	"HURDLE" NUMBER, ',
'	"MLOS3_TRAGET_RATE" NUMBER, ',
'	"AP_RATE_TO_PUBLISH" NUMBER, ',
'	"MANUAL_OVERRIDE" NUMBER, ',
'	"LOS3_TARGET_RATE" VARCHAR2(4000), ',
'	"LOS3_RATE_BASED_ON_PROPOSED_RATE" NUMBER, ',
'	"RATE_TO_PUBLISH" NUMBER, ',
'	"ROOMS" NUMBER, ',
'	"GROUPS" NUMBER, ',
'	"OCC" NUMBER, ',
'	"OOO" NUMBER, ',
'	"OCC_OOO" NUMBER, ',
'	"STLY_TRANSIENT_OCC" NUMBER, ',
'	"LY_OCC" NUMBER, ',
'	"LY_COMP_SET_OCC_STR" NUMBER, ',
'	"ADR" NUMBER, ',
'	"LY_ADR" NUMBER, ',
'	"LY_COMP_SET_ADR_STR" NUMBER, ',
'	"REVPAR_TY" NUMBER, ',
'	"COMP_SET_REVPAR_LY" NUMBER, ',
'	"LIVE_PENETRATION" NUMBER, ',
'	"LY_RGI" NUMBER, ',
'	"C1_DAY_RNTS_PICK_UP" NUMBER, ',
'	"C3_DAY_RNTS_PICK_UP" VARCHAR2(4000), ',
'	"C7_DAY_RNTS_PICK_UP" VARCHAR2(4000), ',
'	"C14_DAY_RNTS_PICK_UP" VARCHAR2(4000), ',
'	"C28_DAY_RNTS_PICK_UP" VARCHAR2(4000), ',
'	"C1_DAY_GROUP_PICKUP" NUMBER, ',
'	"C7_DAY_GROUP_PICKUP" VARCHAR2(4000), ',
'	"C1_DAY_REVENUE_PICK_UP" NUMBER, ',
'	"C3_DAY_REVENUE_PICK_UP" VARCHAR2(4000), ',
'	"C7_DAY_REVENUE_PICK_UP" VARCHAR2(4000), ',
'	"C14_DAY_REVENUE_PICK_UP" VARCHAR2(4000), ',
'	"C28_DAY_REVENUE_PICK_UP" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"STLY_REVENUE" NUMBER, ',
'	"STLY_RNTS" NUMBER, ',
'	"MARKET_DEMAND" NUMBER, ',
'	"LOS1_RNK" NUMBER, ',
'	"LOS3_RNK" VARCHAR2(4000), ',
'	"REWARDS" NUMBER, ',
'	"REWARDS_LY" NUMBER, ',
'	"OVERBOOKING" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_PICKUP_INDIGO_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_PICKUP_INDIGO_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_PROFILE_OPTIONS" ',
'   (	"ID" RAW(16) NOT NULL ENABLE, ',
'	"KEY" VARCHAR2(50) NOT NULL ENABLE, ',
'	"NAME" VARCHAR2(100), ',
'	"DESCRIPTION" VARCHAR2(200), ',
'	"VALUE" VARCHAR2(500) NOT NULL ENABLE, ',
'	"START_DATE" DATE, ',
'	"END_DATE" DATE, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	 CONSTRAINT "PK_UR_PROFILE_OPTIONS" PRIMARY KEY ("ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UQ_UR_PROFILE_OPTIONS_KEY" UNIQUE ("KEY")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_STR_3_T" ',
'   (	"REC_ID" RAW(16), ',
'	"STAY_DATE" DATE, ',
'	"THIS_YEAR_MY_PROP" NUMBER, ',
'	"COMP_SET" NUMBER, ',
'	"PERCENTAGE_CHG_MY_PROP" NUMBER, ',
'	"PERCENTAGE_CHG_COMP_SET" NUMBER, ',
'	"INDEX_ARI" NUMBER, ',
'	"RANK" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_STR_3_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_STR_3_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_STR_T" ',
'   (	"REC_ID" RAW(16), ',
'	"STAY_DATE" DATE, ',
'	"COMPARABLE_DOW" VARCHAR2(4000), ',
'	"DATE" DATE, ',
'	"DOW" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_STR_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_TEMP_1_OCT_N1_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" DATE, ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" VARCHAR2(4000), ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_TEMP_1_OCT_N1_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_TEMP_1_OCT_N1_T_SDATE_UQ" UNIQUE ("SDATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_TEMP_1_OCT_N2_T" ',
'   (	"REC_ID" RAW(16), ',
'	"STAY_DATE" DATE, ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" VARCHAR2(4000), ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_TEMP_1_OCT_N2_T_PK" PRIMARY KEY ("REC_ID")',
'  '))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_TEMP_1_OCT_N2_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_TEMP_1_OCT_N_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" VARCHAR2(4000), ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" VARCHAR2(4000), ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_TEMP_1_OCT_N_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_TEMP_1_OCT_T" ',
'   (	"REC_ID" RAW(16), ',
'	"STAY_DATE" DATE, ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" VARCHAR2(4000), ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_TEMP_1_OCT_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_TEMP_3_OCT_T" ',
'   (	"REC_ID" RAW(16), ',
'	"STAY_DATE" DATE, ',
'	"RATE_PUBLISH_CHECK_OY" NUMBER, ',
'	"RATE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_TEMP_3_OCT_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_TEMP_3_OCT_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_TEMP_DEMO_11_T" ',
'   (	"REC_ID" RAW(16), ',
'	"STAY_DATE" DATE, ',
'	"TODAY_ROOMS_COMMIT" NUMBER, ',
'	"TODAY_ADR_COMMIT" NUMBER, ',
'	"REV" NUMBER, ',
'	"TODAY_GROUPS" NUMBER, ',
'	"PICK_UP_RNTS" NUMBER, ',
'	"PICK_UP_REV" NUMBER, ',
'	"PICK_UP_ADR" NUMBER, ',
'	"GROUPS_PICK_UP" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_TEMP_DEMO_11_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_TEMP_DEMO_11_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_TEMP_NN_T" ',
'   (	"REC_ID" RAW(16), ',
'	"STAY_DATE" DATE, ',
'	"TODAY_ROOMS_COMMIT" NUMBER, ',
'	"TODAY_ADR_COMMIT" NUMBER, ',
'	"TODAY_REV" NUMBER, ',
'	"TODAY_GROUPS_RNTS" NUMBER, ',
'	"TODAY_OOO" NUMBER, ',
'	"TODAY_PICK_UP_RNTS" NUMBER, ',
'	"PICK_UP_REV" NUMBER, ',
'	"PICK_UP_ADR" NUMBER, ',
'	"GROUPS_PICK_UP" NUMBER, ',
'	"NO_SHOWS" NUMBER, ',
'	"COLUMN" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_TEMP_NN_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_TEMP_NN_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_TEST1_22_CHINAR_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_TEST1_22_CHINAR_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_TEST_13_10_CP_2_T" ',
'   (	"REC_ID" RAW(16), ',
'	"STAY_DATE" DATE, ',
'	"C3_DAYS_ROOMS_COMMIT" NUMBER, ',
'	"C3_DAYS_ADR_COMMIT" NUMBER, ',
'	"C3_DAYS_REV" NUMBER, ',
'	"BOOKING_DATE" DATE, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_TEST_13_10_CP_2_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_TEST_13_10_CP_2_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_TEST_13_10_CP_T" ',
'   (	"REC_ID" RAW(16), ',
'	"STAY_DATE" DATE, ',
'	"C3_DAYS_ROOMS_COMMIT" NUMBER, ',
'	"C3_DAYS_ADR_COMMIT" NUMBER, ',
'	"C3_DAYS_REV" NUMBER, ',
'	"BOOKING_DATE" DATE, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_TEST_13_10_CP_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_TEST_13_10_CP_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_TEST_CHINAR_1_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_TEST_CHINAR_1_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_TEST_CHINAR_1_T_BOOKING_ID_UQ" UNIQUE ("BOOKING_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_TEST_CHINAR_29_SEP_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_TEST_CHINAR_29_SEP_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_TEST_CHINAR_29_SEP_T_STAY_UQ" UNIQUE ("STAY")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_TEST_CHINAR_29_SEP_T_INTERFACE" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16)',
'   ) ;',
'',
'  CREATE TABLE "UR_TEST_CHINAR_2_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_TEST_CHINAR_2_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_TEST_CHINAR_2_T_BOOKING_ID_UQ" UNIQUE ("BOOKING_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_TEST_CHINAR_NEWEST_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_TEST_CHINAR_NEWEST_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_TEST_CHINAR_NO_USC_NEW_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_TEST_CHINAR_NO_USC_NEW_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_TEST_CHINAR_NO_USC_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_TEST_CHINAR_NO_USC_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_TEST_CHINAR_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY__" NUMBER, ',
'	"ADR__USD_" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_TEST_CHINAR_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_TEST_STACY_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_TEST_STACY_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_TEST_TEMPLATE_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY__" NUMBER, ',
'	"ADR__USD_" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_TEST_TEMPLATE_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_TT_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_TT_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_UR_BHAUMIK_30_SEP1_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" DATE, ',
'	"STAY" DATE, ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_UR_BHAUMIK_30_SEP1_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_UR_BHAUMIK_30_SEP1_T_STAY_UQ" UNIQUE ("STAY")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_UR_BHAUMIK_30_SEP_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" DATE, ',
'	"STAY" DATE, ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_UR_BHAUMIK_30_SEP_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_UR_BHAUMIK_30_SEP_T_STAY_UQ" UNIQUE ("STAY")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_UR_CHINAR_QUAL_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_UR_CHINAR_QUAL_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_UR_CHINAR_QUAL_T_STAY_UQ" UNIQUE ("STAY")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_UR_CHINAR_QUAL_T_INTERFACE" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16)',
'   ) ;',
'',
'  CREATE TABLE "UR_USERS" ',
'   (	"USER_ID" RAW(16) DEFAULT SYS_GUID() NOT NULL ENABLE, ',
'	"FIRST_NAME" VARCHAR2(100) NOT NULL ENABLE, ',
'	"LAST_NAME" VARCHAR2(100) NOT NULL ENABLE, ',
'	"EMAIL" VARCHAR2(150) NOT NULL ENABLE, ',
'	"CONTACT_NUMBER" NUMBER, ',
'	"USER_TYPE" VARCHAR2(50) NOT NULL ENABLE, ',
'	"STATUS" VARCHAR2(20) NOT NULL ENABLE, ',
'	"START_DATE" DATE, ',
'	"END_DATE" DATE, ',
'	"LOGIN_METHOD" VARCHAR2(50) NOT NULL ENABLE, ',
'	"PASSWORD_HASH" VARCHAR2(256), ',
'	"CREATED_BY" RAW(16) DEFAULT SYS_GUID() NOT NULL ENABLE, ',
'	"UPDATED_BY" RAW(16) DEFAULT SYS_GUID() NOT NULL ENABLE, ',
'	"CREATED_ON" DATE DEFAULT SYSDATE NOT NULL ENABLE, ',
'	"UPDATED_ON" DATE DEFAULT SYSDATE NOT NULL ENABLE, ',
'	"USER_NAME" VARCHAR2(255), ',
'	"NOTES" VARCHAR2(50), ',
'	 CONSTRAINT "PK_UR_USERS" PRIMARY KEY ("USER_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UQ_UR_USERS_EMAIL" UNIQUE ("EMAIL")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_250915_1_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_250915_1_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_VK_250915_1_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_250915_2_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_250915_2_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_VK_250915_2_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_250915_3_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_250915_3_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_250915_4_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_250915_4_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_VK_250915_4_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_250915_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" DATE, ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_250915_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_VK_250915_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_ATT_QUAL1_T" ',
'   (	"REC_ID" RAW(16), ',
'	"COLUMN_" VARCHAR2(4000), ',
'	"RNS__OTB_" NUMBER, ',
'	"REVENUE__OTB_" NUMBER, ',
'	"OUT_OF_ORDER__OOO___OTB_" NUMBER, ',
'	"RNS__OTB_STLY_" NUMBER, ',
'	"ROOM_REVENUE__OTB_STLY_" NUMBER, ',
'	"RNS__PICKUP_CY_" NUMBER, ',
'	"ROOM_REVENUE__PICKUP_CY_" NUMBER, ',
'	"RNS__PICKUP_LY_" NUMBER, ',
'	"ROOM_REVENUE__PICKUP_LY_" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_ATT_QUAL1_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_VK_ATT_QUAL1_T_RNS__OTB__UQ" UNIQUE ("RNS__OTB_")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_LEAVE_SETUP_T" ',
'   (	"REC_ID" RAW(16), ',
'	"LID" NUMBER, ',
'	"USER_NAME" VARCHAR2(4000), ',
'	"CURRENT_LEAVE" NUMBER, ',
'	"CARRY_LEAVE" NUMBER, ',
'	"CURRENT_YEAR_FROM" DATE, ',
'	"CURRENT_YEAR_TO" DATE, ',
'	"PAID_SICK_DAYS_ALLOWANCE" NUMBER, ',
'	"LEAVE_PROGRAM_RUN" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_LEAVE_SETUP_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_LOS1_YORK_2_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" DATE, ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" NUMBER, ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" NUMBER, ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_LOS1_YORK_2_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_VK_LOS1_YORK_2_T_SDATE_UQ" UNIQUE ("SDATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_LOS1_YORK_3_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" DATE, ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" NUMBER, ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" NUMBER, ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_LOS1_YORK_3_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_VK_LOS1_YORK_3_T_SDATE_UQ" UNIQUE ("SDATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_LOS1_YORK_4_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" DATE, ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" NUMBER, ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" NUMBER, ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_LOS1_YORK_4_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_VK_LOS1_YORK_4_T_SDATE_UQ" UNIQUE ("SDATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_LOS1_YORK_5_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" VARCHAR2(4000), ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" VARCHAR2(4000), ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_LOS1_YORK_5_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_LOS1_YORK_6_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" VARCHAR2(4000), ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" VARCHAR2(4000), ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_LOS1_YORK_6_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_LOS1_YORK_7_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" VARCHAR2(4000), ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" VARCHAR2(4000), ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_LOS1_YORK_7_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_LOS1_YORK_8_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" VARCHAR2(4000), ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" VARCHAR2(4000), ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_LOS1_YORK_8_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_LOS1_YORK_9_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" VARCHAR2(4000), ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" VARCHAR2(4000), ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_LOS1_YORK_9_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_LOS1_YORK_T" ',
'   (	"REC_ID" RAW(16), ',
'	"SDATE" DATE, ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" NUMBER, ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" NUMBER, ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_LOS1_YORK_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_VK_LOS1_YORK_T_SDATE_UQ" UNIQUE ("SDATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_NEW_CHINAR_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_NEW_CHINAR_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_VK_NEW_CHINAR_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_NEW_CHINAR_T_INTERFACE" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" VARCHAR2(4000), ',
'	"STAY_DATE" VARCHAR2(4000), ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16)',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_SAMPLE_HOTEL_DATA_T" ',
'   (	"REC_ID" RAW(16), ',
'	"BOOKING_ID" NUMBER, ',
'	"BOOKING_DATE" DATE, ',
'	"STAY_DATE" DATE, ',
'	"OCCUPANCY" NUMBER, ',
'	"ADR_USD" NUMBER, ',
'	"NUMBER_OF_ROOMS" NUMBER, ',
'	"BOOKING_CHANNEL" VARCHAR2(4000), ',
'	"GUEST_COUNTRY" VARCHAR2(4000), ',
'	"REVENUE" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_SAMPLE_HOTEL_DATA_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_VK_SAMPLE_HOTEL_DATA_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_SEG1_T" ',
'   (	"REC_ID" RAW(16), ',
'	"EMPLOYEE_ID" VARCHAR2(4000), ',
'	"POSITION" VARCHAR2(4000), ',
'	"DOJ" VARCHAR2(4000), ',
'	"PHONE_NO" VARCHAR2(4000), ',
'	"EMAIL" VARCHAR2(4000), ',
'	"ROLE" VARCHAR2(4000), ',
'	"USER_NAME" VARCHAR2(4000), ',
'	"RIGHT_TO_WORK" VARCHAR2(4000), ',
'	"END_DATE" VARCHAR2(4000), ',
'	"REVIEW_DATE" VARCHAR2(4000), ',
'	"APPROVER_EMAIL" VARCHAR2(4000), ',
'	"PROBATION_PERIOD_DATE" DATE, ',
'	"GENDER" VARCHAR2(4000), ',
'	"ENABLE_SM_LEAVE" VARCHAR2(4000), ',
'	"FIRST_NAME" VARCHAR2(4000), ',
'	"LAST_NAME" VARCHAR2(4000), ',
'	"EMP_DETAIL_ID" NUMBER, ',
'	"LEGACY_EMP_NUMBER" VARCHAR2(4000), ',
'	"MIDDLE_NAME" VARCHAR2(4000), ',
'	"KNOWN_AS" VARCHAR2(4000), ',
'	"START_DATE" DATE, ',
'	"ACTIVE_EMPLOYEE_TYPE" NUMBER, ',
'	"JOB_DESCRIPTION" VARCHAR2(4000), ',
'	"GRADE" VARCHAR2(4000), ',
'	"MANAGER" VARCHAR2(4000), ',
'	"SUPERVISOR" VARCHAR2(4000), ',
'	"VACATION_RULES_MANAGER" VARCHAR2(4000), ',
'	"ADDRESS_LINE1" VARCHAR2(4000), ',
'	"ADDRESS_LINE2" VARCHAR2(4000), ',
'	"ADDRESS_LINE3" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_SEG1_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_SEGMENT_QUALIFIER1_T" ',
'   (	"REC_ID" RAW(16), ',
'	"EMPLOYEE_ID" VARCHAR2(4000), ',
'	"POSITION" VARCHAR2(4000), ',
'	"DOJ" DATE, ',
'	"PHONE_NO" VARCHAR2(4000), ',
'	"EMAIL" VARCHAR2(4000), ',
'	"ROLE" VARCHAR2(4000), ',
'	"USER_NAME" VARCHAR2(4000), ',
'	"RIGHT_TO_WORK" VARCHAR2(4000), ',
'	"END_DATE" VARCHAR2(4000), ',
'	"REVIEW_DATE" VARCHAR2(4000), ',
'	"APPROVER_EMAIL" VARCHAR2(4000), ',
'	"PROBATION_PERIOD_DATE" DATE, ',
'	"GENDER" VARCHAR2(4000), ',
'	"ENABLE_SM_LEAVE" VARCHAR2(4000), ',
'	"FIRST_NAME" VARCHAR2(4000), ',
'	"LAST_NAME" VARCHAR2(4000), ',
'	"EMP_DETAIL_ID" NUMBER, ',
'	"LEGACY_EMP_NUMBER" VARCHAR2(4000), ',
'	"MIDDLE_NAME" VARCHAR2(4000), ',
'	"KNOWN_AS" VARCHAR2(4000), ',
'	"START_DATE" DATE, ',
'	"ACTIVE_EMPLOYEE_TYPE" NUMBER'))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
', ',
'	"JOB_DESCRIPTION" VARCHAR2(4000), ',
'	"GRADE" VARCHAR2(4000), ',
'	"MANAGER" VARCHAR2(4000), ',
'	"SUPERVISOR" VARCHAR2(4000), ',
'	"VACATION_RULES_MANAGER" VARCHAR2(4000), ',
'	"ADDRESS_LINE1" VARCHAR2(4000), ',
'	"ADDRESS_LINE2" VARCHAR2(4000), ',
'	"ADDRESS_LINE3" VARCHAR2(4000), ',
'	"TEST" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_SEGMENT_QUALIFIER1_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_SEGMENT_QUALIFIER2_T" ',
'   (	"REC_ID" RAW(16), ',
'	"EMPLOYEE_ID" VARCHAR2(4000), ',
'	"POSITION" VARCHAR2(4000), ',
'	"DOJ" VARCHAR2(4000), ',
'	"PHONE_NO" VARCHAR2(4000), ',
'	"EMAIL" VARCHAR2(4000), ',
'	"ROLE" VARCHAR2(4000), ',
'	"USER_NAME" VARCHAR2(4000), ',
'	"RIGHT_TO_WORK" VARCHAR2(4000), ',
'	"END_DATE" VARCHAR2(4000), ',
'	"REVIEW_DATE" VARCHAR2(4000), ',
'	"APPROVER_EMAIL" VARCHAR2(4000), ',
'	"PROBATION_PERIOD_DATE" DATE, ',
'	"GENDER" VARCHAR2(4000), ',
'	"ENABLE_SM_LEAVE" VARCHAR2(4000), ',
'	"FIRST_NAME" VARCHAR2(4000), ',
'	"LAST_NAME" VARCHAR2(4000), ',
'	"EMP_DETAIL_ID" NUMBER, ',
'	"LEGACY_EMP_NUMBER" VARCHAR2(4000), ',
'	"MIDDLE_NAME" VARCHAR2(4000), ',
'	"KNOWN_AS" VARCHAR2(4000), ',
'	"START_DATE" DATE, ',
'	"ACTIVE_EMPLOYEE_TYPE" NUMBER, ',
'	"JOB_DESCRIPTION" VARCHAR2(4000), ',
'	"GRADE" VARCHAR2(4000), ',
'	"MANAGER" VARCHAR2(4000), ',
'	"SUPERVISOR" VARCHAR2(4000), ',
'	"VACATION_RULES_MANAGER" VARCHAR2(4000), ',
'	"ADDRESS_LINE1" VARCHAR2(4000), ',
'	"ADDRESS_LINE2" VARCHAR2(4000), ',
'	"ADDRESS_LINE3" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_SEGMENT_QUALIFIER2_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_SEGMENT_QUALIFIER_T" ',
'   (	"REC_ID" RAW(16), ',
'	"EMPLOYEE_ID" VARCHAR2(4000), ',
'	"POSITION" VARCHAR2(4000), ',
'	"DOJ" VARCHAR2(4000), ',
'	"PHONE_NO" VARCHAR2(4000), ',
'	"EMAIL" VARCHAR2(4000), ',
'	"ROLE" VARCHAR2(4000), ',
'	"USER_NAME" VARCHAR2(4000), ',
'	"RIGHT_TO_WORK" VARCHAR2(4000), ',
'	"END_DATE" VARCHAR2(4000), ',
'	"REVIEW_DATE" VARCHAR2(4000), ',
'	"APPROVER_EMAIL" VARCHAR2(4000), ',
'	"PROBATION_PERIOD_DATE" DATE, ',
'	"GENDER" VARCHAR2(4000), ',
'	"ENABLE_SM_LEAVE" VARCHAR2(4000), ',
'	"FIRST_NAME" VARCHAR2(4000), ',
'	"LAST_NAME" VARCHAR2(4000), ',
'	"EMP_DETAIL_ID" NUMBER, ',
'	"LEGACY_EMP_NUMBER" VARCHAR2(4000), ',
'	"MIDDLE_NAME" VARCHAR2(4000), ',
'	"KNOWN_AS" VARCHAR2(4000), ',
'	"START_DATE" DATE, ',
'	"ACTIVE_EMPLOYEE_TYPE" NUMBER, ',
'	"JOB_DESCRIPTION" VARCHAR2(4000), ',
'	"GRADE" VARCHAR2(4000), ',
'	"MANAGER" VARCHAR2(4000), ',
'	"SUPERVISOR" VARCHAR2(4000), ',
'	"VACATION_RULES_MANAGER" VARCHAR2(4000), ',
'	"ADDRESS_LINE1" VARCHAR2(4000), ',
'	"ADDRESS_LINE2" VARCHAR2(4000), ',
'	"ADDRESS_LINE3" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_SEGMENT_QUALIFIER_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_VK_TMS_TASK_T" ',
'   (	"REC_ID" RAW(16), ',
'	"ID" NUMBER, ',
'	"PRJ_ID" NUMBER, ',
'	"NAME" VARCHAR2(4000), ',
'	"DESCRIPTION" VARCHAR2(4000), ',
'	"END_DATE" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_VK_TMS_TASK_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_YORK_LOS1_T" ',
'   (	"REC_ID" RAW(16), ',
'	"DATE" DATE, ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" NUMBER, ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" NUMBER, ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" NUMBER, ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_YORK_LOS1_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_YORK_LOS1_T_DATE_UQ" UNIQUE ("DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_YORK_LOS1_VK_29SEP25_T" ',
'   (	"REC_ID" RAW(16), ',
'	"S_DATE" DATE, ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" NUMBER, ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" VARCHAR2(4000), ',
'	"HILTON_YORK" VARCHAR2(4000), ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" VARCHAR2(4000), ',
'	"RADISSON_HOTEL_YORK" VARCHAR2(4000), ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" VARCHAR2(4000), ',
'	"NOVOTEL_YORK_CENTRE" VARCHAR2(4000), ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" VARCHAR2(4000), ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" VARCHAR2(4000), ',
'	"HAMPTON_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_YORK_LOS1_VK_29SEP25_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_YORK_LOS1_VK_29SEP25_T_S_DATE_UQ" UNIQUE ("S_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_YORK_TEMP12_T" ',
'   (	"REC_ID" RAW(16), ',
'	"STAY_DATE" DATE, ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" VARCHAR2(4000), ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_YORK_TEMP12_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_YORK_TEMP12_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "UR_YORK_TEMP14_T" ',
'   (	"REC_ID" RAW(16), ',
'	"STAY_DATE" DATE, ',
'	"DAY" VARCHAR2(4000), ',
'	"MY_OTB" NUMBER, ',
'	"MARKET_DEMAND" VARCHAR2(4000), ',
'	"DELTA_HOTELS_BY_MARRIOTT_YORK" NUMBER, ',
'	"HILTON_YORK" NUMBER, ',
'	"HOLIDAY_INN_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"RADISSON_HOTEL_YORK" NUMBER, ',
'	"THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK" NUMBER, ',
'	"NOVOTEL_YORK_CENTRE" NUMBER, ',
'	"DOUBLETREE_BY_HILTON_YORK" VARCHAR2(4000), ',
'	"MOXY_YORK" NUMBER, ',
'	"HOTEL_INDIGO_YORK_AN_IHG_HOTEL" NUMBER, ',
'	"HAMPTON_BY_HILTON_YORK" NUMBER, ',
'	"ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON" VARCHAR2(4000), ',
'	"CREATED_BY" RAW(16), ',
'	"UPDATED_BY" RAW(16), ',
'	"CREATED_ON" DATE, ',
'	"UPDATED_ON" DATE, ',
'	"HOTEL_ID" RAW(16), ',
'	"INTERFACE_LOG_ID" RAW(16), ',
'	 CONSTRAINT "UR_YORK_TEMP14_T_PK" PRIMARY KEY ("REC_ID")',
'  USING INDEX  ENABLE, ',
'	 CONSTRAINT "UR_YORK_TEMP14_T_STAY_DATE_UQ" UNIQUE ("STAY_DATE")',
'  USING INDEX  ENABLE',
'   ) ;',
'',
'  CREATE TABLE "XX_FEEDBACK_EMAIL_DETAILS" ',
'   (	"EMAIL_DETAILS" VARCHAR2(2000)',
'   ) ;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_1DAY_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_1DAY_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_1DAY_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_1DAY_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_3DAY2_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_3DAY2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_3DAY2_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_3DAY2_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_3DAY_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_3DAY_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_3DAY_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_3DAY_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_7DAY1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_7DAY1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_7DAY1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_7DAY1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_ADAM_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_ADAM_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_ADAM_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_ADAM_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_ADDRESSES_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_ADDRESSES',
'FOR EACH ROW',
'DECLARE',
'    v_current_user RAW(16);',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO v_current_user FROM UR_USERS WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'        :NEW.CREATED_BY := v_current_user;',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        :NEW.UPDATED_BY := v_current_user;',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO v_current_user FROM UR_USERS WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'        :NEW.UPDATED_BY := v_current_user;',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_ADDRESSES_BI_TRG" ENABLE;',
'',
'  ALTER TABLE "UR_ALGOS" ADD CONSTRAINT "FK_UR_ALGOS_HOTEL" FOREIGN KEY ("HOTEL_ID")',
'	  REFERENCES "UR_HOTELS" ("ID") ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_ALGOS_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_ALGOS"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id RAW(16);',
'BEGIN',
'  IF :NEW.ID IS NULL THEN',
'    :NEW.ID := SYS_GUID();',
'  END IF;',
'',
'  -- Fetch user_id from UR_USERS based on APEX session user',
'  SELECT USER_ID INTO v_user_id ',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_ALGOS_BI_TRG" ENABLE;',
'',
'  ALTER TABLE "UR_ALGO_ATTRIBUTES" ADD CONSTRAINT "FK_UR_ALGO_ATTRIBUTES_ALGO" FOREIGN KEY ("ALGO_ID")',
'	  REFERENCES "UR_ALGOS" ("ID") ENABLE;',
'  ALTER TABLE "UR_ALGO_ATTRIBUTES" ADD CONSTRAINT "FK_UR_ALGO_ATTRIBUTES_HOTEL" FOREIGN KEY ("HOTEL_ID")',
'	  REFERENCES "UR_HOTELS" ("ID") ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_ALGO_ATTRIBUTES_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_ALGO_ATTRIBUTES"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id RAW(16);',
'BEGIN',
'  IF :NEW.ID IS NULL THEN',
'    :NEW.ID := SYS_GUID();',
'  END IF;',
'',
'  -- Fetch USER_ID from UR_USERS based on APEX session user',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'',
'    -- Set default DATA_TYPE if null',
'    IF :NEW.DATA_TYPE IS NULL THEN',
'      :NEW.DATA_TYPE := ''NUMBER'';',
'    END IF;',
'',
'    -- Set default TYPE if null',
'    IF :NEW.TYPE IS NULL THEN',
'      :NEW.TYPE := ''M'';',
'    END IF;',
'',
'    -- Automatically generate KEY from NAME using UR_UTILS.Clean_TEXT if KEY is null or empty',
'    IF :NEW.KEY IS NULL OR TRIM(:NEW.KEY) = '''' THEN',
'      :NEW.KEY := UR_UTILS.Clean_TEXT(:NEW.NAME);',
'    END IF;',
'',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'',
'    -- Do NOT modify KEY during update, leave as is',
'',
'    -- Ensure DATA_TYPE defaults if null',
'    IF :NEW.DATA_TYPE IS NULL THEN',
'      :NEW.DATA_TYPE := ''NUMBER'';',
'    END IF;',
'',
'    -- Ensure TYPE defaults if null',
'    IF :NEW.TYPE IS NULL THEN',
'      :NEW.TYPE := ''M'';',
'    END IF;',
'',
'  END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_ALGO_ATTRIBUTES_BI_TRG" ENABLE;',
'',
'  ALTER TABLE "UR_ALGO_VERSIONS" ADD CONSTRAINT "FK_UR_ALGO_VERSIONS_ALGO" FOREIGN KEY ("ALGO_ID")',
'	  REFERENCES "UR_ALGOS" ("ID") ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_ALGO_VERSIONS_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_ALGO_VERSIONS',
'FOR EACH ROW',
'DECLARE',
'  v_user_id RAW(16);',
'  v_max_version NUMBER;',
'  v_new_version NUMBER;',
'BEGIN',
'  IF :NEW.ID IS NULL THEN',
'    :NEW.ID := SYS_GUID();',
'  END IF;',
'',
'  -- Fetch user_id from UR_USERS based on APEX session user',
'  SELECT USER_ID INTO v_user_id',
'  FROM UR_USERS',
'  WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF INSERTING THEN',
'    -- Set audit columns',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'',
'    -- Auto increment VERSION',
'    BEGIN',
'      SELECT MAX(TO_NUMBER(VERSION)) INTO v_max_version',
'      FROM UR_ALGO_VERSIONS',
'      WHERE ALGO_ID = :NEW.ALGO_ID;',
'',
'      v_new_version := NVL(v_max_version, 0) + 1;',
'    EXCEPTION',
'      WHEN NO_DATA_FOUND THEN',
'        v_new_version := 1;',
'      WHEN VALUE_ERROR THEN',
'        -- version column has non-numeric values - fallback to 1',
'        v_new_version := 1;',
'    END;',
'    :NEW.VERSION := TO_CHAR(v_new_version);',
'',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'',
'  -- Update UR_ALGOS table CURRENT_VERSION_ID to the VERSION record ID that was just inserted/updated',
'  UPDATE UR_ALGOS',
'  SET CURRENT_VERSION_ID = :NEW.ID,',
'      UPDATED_BY = v_user_id,',
'      UPDATED_ON = SYSDATE',
'  WHERE ID = :NEW.ALGO_ID;',
'',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_ALGO_VERSIONS_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_BHAUMIK_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_BHAUMIK_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_BHAUMIK_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_BHAUMIK_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_CHINAR_22SEPT1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_CHINAR_22SEPT1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_CHINAR_22SEPT1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_CHINAR_22SEPT1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_CHINAR_22SEPT_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_CHINAR_22SEPT_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_CHINAR_22SEPT_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_CHINAR_22SEPT_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_CHINAR_28_SEP_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_CHINAR_28_SEP_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_CHINAR_28_SEP_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_CHINAR_28_SEP_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_CHINAR_STAY_DATE_TEMPLATE_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_CHINAR_STAY_DATE_TEMPLATE_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_CHINAR_STAY_DATE_TEMPLATE_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_CHINAR_STAY_DATE_TEMPLATE_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_CHINAR_TEST_111_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_CHINAR_TEST_111_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_CHINAR_TEST_111_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_CHINAR_TEST_111_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_CHINAR_TEST_112_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_CHINAR_TEST_112_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_CHINAR_TEST_112_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_CHINAR_TEST_112_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_CONTACTS_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_CONTACTS',
'FOR EACH ROW',
'DECLARE',
'    v_primary_count NUMBER;',
'    v_user_id RAW(16);',
'BEGIN',
'    -- Assign ID if null',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        BEGIN',
'            SELECT USER_ID INTO v_user_id',
'              FROM UR_USERS',
'             WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'        EXCEPTION',
'            WHEN NO_DATA_FOUND THEN',
'                v_user_id := SYS_GUID();  -- fallback in case no user found',
'        END;',
'',
'        :NEW.CREATED_BY := v_user_id;',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        :NEW.UPDATED_BY := v_user_id;',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        BEGIN',
'            SELECT USER_ID INTO v_user_id',
'              FROM UR_USERS',
'             WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'        EXCEPTION',
'            WHEN NO_DATA_FOUND THEN',
'                v_user_id := SYS_GUID();  -- fallback if user unknown',
'        END;',
'',
'        :NEW.UPDATED_BY := v_user_id;',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'',
'    -- Enforce only one PRIMARY=''Y'' per HOTEL_ID',
'    IF :NEW.PRIMARY = ''Y'' THEN',
'        SELECT COUNT(*)',
'          INTO v_primary_count',
'          FROM UR_CONTACTS',
'         WHERE HOTEL_ID = :NEW.HOTEL_ID',
'           AND PRIMARY = ''Y''',
'           AND ID != :NEW.ID;',
'',
'        IF v_primary_count > 0 THEN',
'            RAISE_APPLICATION_ERROR(-20001, ''Only one PRIMARY contact allowed per HOTEL_ID'');',
'        END IF;',
'    END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_CONTACTS_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_DAILY_BREAKDOWN11_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_DAILY_BREAKDOWN11_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_DAILY_BREAKDOWN11_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_DAILY_BREAKDOWN11_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_DAILY_BREAKDOWN_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_DAILY_BREAKDOWN_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_DAILY_BREAKDOWN_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_DAILY_BREAKDOWN_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_DAILY_BREAKDOWN_VK_2_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_DAILY_BREAKDOWN_VK_2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_DAILY_BREAKDOWN_VK_2_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_DAILY_BREAKDOWN_VK_2_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_DAILY_BREAKDOWN_VK_3_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_DAILY_BREAKDOWN_VK_3_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_DAILY_BREAKDOWN_VK_3_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_DAILY_BREAKDOWN_VK_3_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_DAILY_BREAKDOWN_VK_4_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_DAILY_BREAKDOWN_VK_4_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_DAILY_BREAKDOWN_VK_4_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_DAILY_BREAKDOWN_VK_4_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_DAILY_BREAKDOWN_VK_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_DAILY_BREAKDOWN_VK_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_DAILY_BREAKDOWN_VK_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_DAILY_BREAKDOWN_VK_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_DEMO_30SEP25_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_DEMO_30SEP25_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_DEMO_30SEP25_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_DEMO_30SEP25_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_EVENTS_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_EVENTS',
'FOR EACH ROW',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        -- Assign a new GUID if EVENT_ID is null (typical on insert)',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO :NEW.CREATED_BY ',
'        FROM UR_USERS ',
'        WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        SELECT USER_ID INTO :NEW.UPDATED_BY ',
'        FROM UR_USERS ',
'        WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO :NEW.UPDATED_BY ',
'        FROM UR_USERS ',
'        WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_EVENTS_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_EXPENSE_TEMPLATE_02_T_BI_TRG" ',
'      BEFORE INSERT ON "UR_EXPENSE_TEMPLATE_02_T"',
'      FOR EACH ROW',
'       WHEN (NEW.ID IS NULL) BEGIN',
'        :NEW.ID := SYS_GUID();',
'      END;',
'    ',
'/',
'ALTER TRIGGER "UR_EXPENSE_TEMPLATE_02_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_EXP_REPORT_2122122_T_BI_TRG" ',
'      BEFORE INSERT ON "UR_EXP_REPORT_2122122_T"',
'      FOR EACH ROW',
'       WHEN (NEW.ID IS NULL) BEGIN',
'        :NEW.ID := SYS_GUID();',
'      END;',
'    ',
'/',
'ALTER TRIGGER "UR_EXP_REPORT_2122122_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_EXP_REPORT_212212_T_BI_TRG" ',
'      BEFORE INSERT ON "UR_EXP_REPORT_212212_T"',
'      FOR EACH ROW',
'       WHEN (NEW.ID IS NULL) BEGIN',
'        :NEW.ID := SYS_GUID();',
'      END;',
'    ',
'/',
'ALTER TRIGGER "UR_EXP_REPORT_212212_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_EXP_REPORT_21221_T_BI_TRG" ',
'      BEFORE INSERT ON "UR_EXP_REPORT_21221_T"',
'      FOR EACH ROW',
'       WHEN (NEW.ID IS NULL) BEGIN',
'        :NEW.ID := SYS_GUID();',
'      END;',
'    ',
'/',
'ALTER TRIGGER "UR_EXP_REPORT_21221_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_EXP_REPORT_21_T_BI_TRG" ',
'      BEFORE INSERT ON "UR_EXP_REPORT_21_T"',
'      FOR EACH ROW',
'       WHEN (NEW.ID IS NULL) BEGIN',
'        :NEW.ID := SYS_GUID();',
'      END;',
'    ',
'/',
'ALTER TRIGGER "UR_EXP_REPORT_21_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_EXP_REPORT_3_T_BI_TRG" ',
'      BEFORE INSERT ON "UR_EXP_REPORT_3_T"',
'      FOR EACH ROW',
'       WHEN (NEW.'))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'ID IS NULL) BEGIN',
'        :NEW.ID := SYS_GUID();',
'      END;',
'    ',
'/',
'ALTER TRIGGER "UR_EXP_REPORT_3_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_EXP_REPORT_T_BI_TRG" ',
'      BEFORE INSERT ON "UR_EXP_REPORT_T"',
'      FOR EACH ROW',
'       WHEN (NEW.ID IS NULL) BEGIN',
'        :NEW.ID := SYS_GUID();',
'      END;',
'    ',
'/',
'ALTER TRIGGER "UR_EXP_REPORT_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_HOTELS_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_HOTELS',
'FOR EACH ROW',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO :NEW.CREATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'        IF :NEW.CURRENCY_CODE IS NULL THEN',
'            :NEW.CURRENCY_CODE := ''GBP'';',
'        END IF;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_HOTELS_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_HOTEL_GROUPS_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_HOTEL_GROUPS',
'FOR EACH ROW',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO :NEW.CREATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_HOTEL_GROUPS_BI_TRG" ENABLE;',
'',
'   COMMENT ON COLUMN "UR_HOTEL_PRICE_OVERRIDE"."ID" IS ''UUID - Unique attribute identifier (Primary Key).'';',
'   COMMENT ON COLUMN "UR_HOTEL_PRICE_OVERRIDE"."STAY_DATE" IS ''The specific date for which the price is overridden.'';',
'   COMMENT ON COLUMN "UR_HOTEL_PRICE_OVERRIDE"."HOTEL_ID" IS ''Optional Foreign Key to a Hotel table to limit the override to a specific hotel.'';',
'   COMMENT ON COLUMN "UR_HOTEL_PRICE_OVERRIDE"."TYPE" IS ''Pricing Type (e.g., Retail, Group).'';',
'   COMMENT ON COLUMN "UR_HOTEL_PRICE_OVERRIDE"."PRICE" IS ''The overridden price for the stay date.'';',
'   COMMENT ON COLUMN "UR_HOTEL_PRICE_OVERRIDE"."REASON" IS ''Justification for the price override.'';',
'   COMMENT ON COLUMN "UR_HOTEL_PRICE_OVERRIDE"."CREATED_BY" IS ''UUID of the user who created the record.'';',
'   COMMENT ON COLUMN "UR_HOTEL_PRICE_OVERRIDE"."UPDATED_BY" IS ''UUID of the user who last updated the record.'';',
'   COMMENT ON COLUMN "UR_HOTEL_PRICE_OVERRIDE"."CREATED_ON" IS ''Timestamp of when the record was created.'';',
'   COMMENT ON COLUMN "UR_HOTEL_PRICE_OVERRIDE"."UPDATED_ON" IS ''Timestamp of when the record was last updated.'';',
'   COMMENT ON TABLE "UR_HOTEL_PRICE_OVERRIDE"  IS ''Stores daily price overrides for hotels.'';',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_HOTEL_PRICE_OVERRIDE_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_HOTEL_PRICE_OVERRIDE"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id RAW(16);',
'BEGIN',
'  IF :NEW.ID IS NULL THEN',
'    :NEW.ID := SYS_GUID();',
'  END IF;',
'',
'  -- Fetch user_id from UR_USERS based on APEX session user',
'  SELECT USER_ID INTO v_user_id ',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_HOTEL_PRICE_OVERRIDE_BI_TRG" ENABLE;',
'',
'  ALTER TABLE "UR_HOTEL_RESERVATIONS" ADD CONSTRAINT "FK_UR_HOTEL_RESERVATIONS_HOTEL" FOREIGN KEY ("HOTEL_ID")',
'	  REFERENCES "UR_HOTELS" ("ID") ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_HOTEL_RESERVATIONS_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_HOTEL_RESERVATIONS',
'FOR EACH ROW',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO :NEW.CREATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_HOTEL_RESERVATIONS_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_HOTEL_ROOM_TYPES_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_HOTEL_ROOM_TYPES',
'FOR EACH ROW',
'DECLARE',
'    v_current_user RAW(16);',
'BEGIN',
'  -- The following line is problematic in a row-level trigger and should generally be avoided.',
'  -- Date columns store date and time internally, the format is for display.',
'  -- execute immediate q''[alter session set nls_date_format=''YYYY-MM-DD HH24:MI:SS'']'';',
'',
'  IF :NEW.ROOM_TYPE_ID IS NULL THEN',
'    -- Assign a new GUID if ROOM_TYPE_ID is null (for new records typically)',
'    :NEW.ROOM_TYPE_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    ',
'    SELECT USER_ID INTO :NEW.CREATED_BY FROM UR_USERS WHERE USER_NAME = (SYS_CONTEXT (''APEX$SESSION'', ''APP_USER''));',
'    :NEW.CREATED_ON := SYSDATE;',
'    -- For new records, UPDATED_BY and UPDATED_ON are also set initially.',
'    SELECT USER_ID INTO :NEW.UPDATED_BY FROM UR_USERS WHERE USER_NAME = (SYS_CONTEXT (''APEX$SESSION'', ''APP_USER''));',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'',
'  IF UPDATING THEN',
'    -- When updating an existing record, update UPDATED_BY and UPDATED_ON.',
'    SELECT USER_ID INTO :NEW.UPDATED_BY FROM UR_USERS WHERE USER_NAME = (SYS_CONTEXT (''APEX$SESSION'', ''APP_USER''));',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_HOTEL_ROOM_TYPES_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_INDIGO_L_SQUARE_I_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_INDIGO_L_SQUARE_I_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_INDIGO_L_SQUARE_I_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_INDIGO_L_SQUARE_I_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_INDIGO_L_SQUARE_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_INDIGO_L_SQUARE_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_INDIGO_L_SQUARE_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_INDIGO_L_SQUARE_T_BI_TRG" ENABLE;',
'',
'  ALTER TABLE "UR_INTERFACE_LOGS" ADD CONSTRAINT "FK_UR_INTERFACE_LOGS_HOTEL" FOREIGN KEY ("HOTEL_ID")',
'	  REFERENCES "UR_HOTELS" ("ID") ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_INTERFACE_LOGS_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_INTERFACE_LOGS',
'FOR EACH ROW',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO :NEW.CREATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_INTERFACE_LOGS_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_INDIGO_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_INDIGO_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_INDIGO_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_INDIGO_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_MCL_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_MCL_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_MCL_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_MCL_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_10_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_10_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_10_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_10_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_11_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_11_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_11_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_11_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_12_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_12_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_12_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_12_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_13OCT_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_13OCT_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_13OCT_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_13OCT_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_13_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_13_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_13_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_13_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_14_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_14_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_14_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_14_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_15_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_15_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_15_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_15_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_2_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_2_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_2_T_BI_TRG" ENABLE;',
'',
'   COMMENT ON TABLE "UR_LOS1_YORK_2_T_ERR$"  IS ''DML Error Logging table for "UR_LOS1_YORK_2_T"'';',
'',
'   COMMENT ON TABLE "UR_LOS1_YORK_2_T_ERR$1"  IS ''DML Error Logging table for "UR_LOS1_YORK_2_T"'';',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_7_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_7_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_7_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_7_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_8_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_8_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_8_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_8_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_9_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_9_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_9_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_9_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS3_YORK_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS3_YORK_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS3_YORK_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS3_YORK_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_MCL_LOS1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_MCL_LOS1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_MCL_LOS1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_MCL_LOS1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_PICKUP_INDIGO_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_PICKUP_INDIGO_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_PICKUP_INDIGO_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_PICKUP_INDIGO_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_REPORTS_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_REPORTS',
'FOR EACH ROW',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO :NEW.CREATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_REPORTS_BI_TRG" ENABLE;',
'',
'  ALTER TABLE "UR_REPORT_DASHBOARDS" ADD CONSTRAINT "FK_UR_REPORTS_HOTEL" FOREIGN KEY ("HOTEL_ID")',
'	  REFERENCES "UR_HOTELS" ("ID") ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_REPORT_DASHBOARDS_BI" ',
'BEFORE INSERT OR UPDATE ON UR_REPORT_DASHBOARDS',
'FOR EACH ROW',
'DECLARE',
'  v_hotel_name VARCHAR2(100);',
'  v_key_candidate VARCHAR2(110);',
'  v_user_id RAW(16);',
'  v_json_error EXCEPTION;',
'  PRAGMA EXCEPTION_INIT(v_json_error, -22827); -- ORA-22827 JSON parse error code',
'  ',
'BEGIN',
'  -- Set ID if NULL',
'  IF :NEW.ID IS NULL THEN',
'    :NEW.ID := SYS_GUID();',
'  END IF;',
'',
'  -- Default CREATED_BY, UPDATED_BY, CREATED_ON, UPDATED_ON depending on insert/update',
'  IF INSERTING THEN',
'',
'    -- Fetch CURRENT USER ID from UR_USERS via APEX user',
'    BEGIN',
'      SELECT USER_ID INTO v_user_id',
'      FROM UR_USERS',
'      WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'    EXCEPTION',
'      WHEN NO_DATA_FOUND THEN',
'        v_user_id := NULL;',
'    END;',
'',
'    IF v_user_id IS NOT NULL THEN',
'      :NEW.CREATED_BY := v_user_id;',
'      :NEW.UPDATED_BY := v_user_id;',
'    ELSE',
'      RAISE_APPLICATION_ERROR(-20001, ''Unable to find USER_ID for current APEX user'');',
'    END IF;',
'',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_ON := SYSDATE;',
'',
'    -- ACTIVE default',
'    IF :NEW.ACTIVE IS NULL THEN',
'      :NEW.ACTIVE := ''Y'';',
'    END IF;',
'',
'    -- If HOTEL_ID is provided and Name/Key are NULL or empty, derive from Hotel''s name',
'    IF :NEW.HOTEL_ID IS NOT NULL THEN',
'      SELECT HOTEL_NAME INTO v_hotel_name FROM UR_HOTELS WHERE ID = :NEW.HOTEL_ID;',
'',
'      -- Populate NAME if empty',
'      IF :NEW.NAME IS NULL OR TRIM(:NEW.NAME) = '''' THEN',
'        :NEW.NAME := v_hotel_name;',
'      END IF;',
'',
'      -- Populate KEY if empty',
'      IF :NEW."KEY" IS NULL OR TRIM(:NEW."KEY") = '''' THEN',
'        -- Derive KEY from hotel name (uppercase, replace spaces with underscore, remove special chars except _)',
'        v_key_candidate := REGEXP_REPLACE(UPPER(v_hotel_name), ''[^A-Z0-9_]'', '''');',
'        v_key_candidate := REPLACE(v_key_candidate, '' '', ''_'');  -- Redundant after regex but keep for clarity',
'',
'        -- Append ''_DASHBOARD'' suffix if not already present',
'        IF NOT v_key_candidate LIKE ''%_DASHBOARD'' THEN',
'          v_key_candidate := v_key_candidate || ''_DASHBOARD'';',
'        END IF;',
'',
'        :NEW."KEY" := v_key_candidate;',
'      END IF;',
'    END IF;',
'',
'  ELSIF UPDATING THEN',
'',
'    -- Refresh UPDATED_BY and UPDATED_ON regardless',
'    BEGIN',
'      SELECT USER_ID INTO v_user_id',
'      FROM UR_USERS',
'      WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'    EXCEPTION',
'      WHEN NO_DATA_FOUND THEN',
'        v_user_id := NULL;',
'    END;',
'',
'    IF v_user_id IS NOT NULL THEN',
'      :NEW.UPDATED_BY := v_user_id;',
'    ELSE',
'      RAISE_APPLICATION_ERROR(-20002, ''Unable to find USER_ID for current APEX user'');',
'    END IF;',
'',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'',
'  -- Validate DEFINITION is valid JSON - raise error if not',
'  BEGIN',
'    -- Attempt to parse JSON in DEFINITION by wrapping in JSON_EXISTS which fails if invalid',
'    IF NOT JSON_EXISTS(:NEW.DEFINITION, ''$'') THEN',
'      RAISE_APPLICATION_ERROR(-20003, ''Definition column contains invalid JSON data.'');',
'    END IF;',
'  EXCEPTION',
'    WHEN OTHERS THEN',
'      RAISE_APPLICATION_ERROR(-20004, ''Definition column contains invalid JSON data.'');',
'  END;',
'',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_REPORT_DASHBOARDS_BI" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_STR_3_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_STR_3_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_STR_3_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_STR_3_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_STR_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_STR_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_STR_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_STR_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_TEMPLATES_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_TEMPLATES',
'FOR EACH ROW',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO :NEW.CREATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_TEMPLATES_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEMP_1_OCT_N1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEMP_1_OCT_N1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEMP_1_OCT_N1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEMP_1_OCT_N1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEMP_1_OCT_N2_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEMP_1_OCT_N2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEMP_1_OCT_N2_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEMP_1_OCT_N2_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEMP_1_OCT_N_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEMP_1_OCT_N_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO'))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
' v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEMP_1_OCT_N_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEMP_1_OCT_N_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEMP_1_OCT_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEMP_1_OCT_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEMP_1_OCT_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEMP_1_OCT_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEMP_3_OCT_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEMP_3_OCT_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEMP_3_OCT_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEMP_3_OCT_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEMP_DEMO_11_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEMP_DEMO_11_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEMP_DEMO_11_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEMP_DEMO_11_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEMP_NN_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEMP_NN_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEMP_NN_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEMP_NN_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST1_22_CHINAR_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST1_22_CHINAR_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST1_22_CHINAR_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST1_22_CHINAR_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_13_10_CP_2_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_13_10_CP_2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_13_10_CP_2_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_13_10_CP_2_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_13_10_CP_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_13_10_CP_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_13_10_CP_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_13_10_CP_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_CHINAR_1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_CHINAR_1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_CHINAR_1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_CHINAR_1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_CHINAR_29_SEP_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_CHINAR_29_SEP_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_CHINAR_29_SEP_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_CHINAR_29_SEP_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_CHINAR_2_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_CHINAR_2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_CHINAR_2_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_CHINAR_2_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_CHINAR_NEWEST_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_CHINAR_NEWEST_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_CHINAR_NEWEST_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_CHINAR_NEWEST_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_CHINAR_NO_USC_NEW_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_CHINAR_NO_USC_NEW_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_CHINAR_NO_USC_NEW_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_CHINAR_NO_USC_NEW_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_CHINAR_NO_USC_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_CHINAR_NO_USC_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_CHINAR_NO_USC_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_CHINAR_NO_USC_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_CHINAR_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_CHINAR_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_CHINAR_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_CHINAR_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_STACY_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_STACY_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_STACY_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_STACY_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_TEMPLATE_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_TEMPLATE_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_TEMPLATE_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_TEMPLATE_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TT_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TT_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TT_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TT_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_UR_BHAUMIK_30_SEP1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_UR_BHAUMIK_30_SEP1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_UR_BHAUMIK_30_SEP1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_UR_BHAUMIK_30_SEP1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_UR_BHAUMIK_30_SEP_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_UR_BHAUMIK_30_SEP_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_UR_BHAUMIK_30_SEP_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_UR_BHAUMIK_30_SEP_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_UR_CHINAR_QUAL_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_UR_CHINAR_QUAL_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_UR_CHINAR_QUAL_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_UR_CHINAR_QUAL_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_USERS_BI_TRG" ',
'FOR INSERT OR UPDATE ON ur_users',
'COMPOUND TRIGGER',
'',
'  BEFORE EACH ROW IS',
'    l_current_user_id UR_USERS.USER_ID%TYPE;',
'  BEGIN',
'    IF INSERTING THEN',
'      -- generate PK if not provided',
'      IF :NEW.user_id IS NULL THEN',
'        :NEW.user_id := SYS_GUID();',
'      END IF;',
'',
'      -- set created_by / updated_by from session package (if available)',
'      l_current_user_id := app_user_ctx.get_current_user_id;',
'      IF l_current_user_id IS NOT NULL THEN',
'        :NEW.created_by := l_current_user_id;',
'        :NEW.updated_by := l_current_user_id;',
'      END IF;',
'',
'      -- timestamps (respect any pre-filled created_on)',
'      IF :NEW.created_on IS NULL THEN',
'        :NEW.created_on := SYSDATE;',
'      END IF;',
'      :NEW.updated_on := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'      l_current_user_id := app_user_ctx.get_current_user_id;',
'      IF l_current_user_id IS NOT NULL THEN',
'        :NEW.updated_by := l_current_user_id;',
'      END IF;',
'      :NEW.updated_on := SYSDATE;',
'    END IF;',
'  END BEFORE EACH ROW;',
'',
'END trg_ur_users_bi_trg;',
'/',
'ALTER TRIGGER "TRG_UR_USERS_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_250915_1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_250915_1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_250915_1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_250915_1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_250915_2_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_250915_2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_250915_2_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_250915_2_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_250915_3_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_250915_3_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_250915_3_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_250915_3_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_250915_4_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_250915_4_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_250915_4_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_250915_4_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_250915_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_250915_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_250915_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_250915_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_ATT_QUAL1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_ATT_QUAL1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_ATT_QUAL1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_ATT_QUAL1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_LEAVE_SETUP_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_LEAVE_SETUP_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LEAVE_SETUP_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_LEAVE_SETUP_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_LOS1_YORK_2_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_2_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_LOS1_YORK_2_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_LOS1_YORK_3_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_3_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_3_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_LOS1_YORK_3_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_LOS1_YORK_4_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_4_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_4_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_LOS1_YORK_4_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_LOS1_YORK_5_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_5_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_5_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_LOS1_YORK_5_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_LOS1_YORK_6_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_6_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_6_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_LOS1_YORK_6_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_LOS1_YORK_7_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_7_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_7_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_LOS1_YORK_7_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_LOS1_YORK_8_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_8_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_8_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_LOS1_YORK_8_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_LOS1_YORK_9_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_9_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_9_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_LOS1_YORK_9_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_LOS1_YORK_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_LOS1_YORK_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_NEW_CHINAR_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_NEW_CHINAR_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_NEW_CHINAR_T_BI_TRG;',
'/',
'ALTER TRIGGER "UR_VK_NEW_CHINAR_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_SAMPLE_HOTEL_DATA_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_SAMPLE_HOTEL_DATA_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_SAMPLE_HOTEL_DATA_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_SAMPLE_HOTEL_DATA_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_SEG1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_SEG1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_SEG1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_SEG1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_SEGMENT_QUALIFIER1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_SEGMENT_QUA'))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'LIFIER1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_SEGMENT_QUALIFIER1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_SEGMENT_QUALIFIER1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_SEGMENT_QUALIFIER2_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_SEGMENT_QUALIFIER2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_SEGMENT_QUALIFIER2_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_SEGMENT_QUALIFIER2_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_SEGMENT_QUALIFIER_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_SEGMENT_QUALIFIER_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_SEGMENT_QUALIFIER_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_SEGMENT_QUALIFIER_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_TMS_TASK_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_TMS_TASK_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_TMS_TASK_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_TMS_TASK_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_YORK_LOS1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_YORK_LOS1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_YORK_LOS1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_YORK_LOS1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_YORK_LOS1_VK_29SEP25_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_YORK_LOS1_VK_29SEP25_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_YORK_LOS1_VK_29SEP25_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_YORK_LOS1_VK_29SEP25_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_YORK_TEMP12_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_YORK_TEMP12_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_YORK_TEMP12_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_YORK_TEMP12_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_YORK_TEMP14_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_YORK_TEMP14_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_YORK_TEMP14_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_YORK_TEMP14_T_BI_TRG" ENABLE;',
'create or replace FUNCTION fn_safe_to_date (',
'    p_date_str IN VARCHAR2',
') RETURN DATE',
'IS',
'    v_date DATE;',
'BEGIN',
'    IF p_date_str IS NULL THEN',
'        RETURN NULL;',
'    END IF;',
'',
'    -- Try multiple formats (common global patterns)',
'    IF VALIDATE_CONVERSION(p_date_str AS DATE, ''YYYY-MM-DD'') = 1 THEN',
'        v_date := TO_DATE(p_date_str, ''YYYY-MM-DD'');',
'    ELSIF VALIDATE_CONVERSION(p_date_str AS DATE, ''DD-MM-YYYY'') = 1 THEN',
'        v_date := TO_DATE(p_date_str, ''DD-MM-YYYY'');',
'    ELSIF VALIDATE_CONVERSION(p_date_str AS DATE, ''DD/MM/YYYY'') = 1 THEN',
'        v_date := TO_DATE(p_date_str, ''DD/MM/YYYY'');',
'    ELSIF VALIDATE_CONVERSION(p_date_str AS DATE, ''MM/DD/YYYY'') = 1 THEN',
'        v_date := TO_DATE(p_date_str, ''MM/DD/YYYY'');',
'    ELSIF VALIDATE_CONVERSION(p_date_str AS DATE, ''YYYY/MM/DD'') = 1 THEN',
'        v_date := TO_DATE(p_date_str, ''YYYY/MM/DD'');',
'    ELSIF VALIDATE_CONVERSION(p_date_str AS DATE, ''DD-MON-YYYY'') = 1 THEN',
'        v_date := TO_DATE(p_date_str, ''DD-MON-YYYY'');',
'    ELSIF VALIDATE_CONVERSION(p_date_str AS DATE, ''DD-MON-YY'') = 1 THEN',
'        v_date := TO_DATE(p_date_str, ''DD-MON-YY'');',
'    ELSIF VALIDATE_CONVERSION(p_date_str AS DATE, ''MON-DD-YYYY'') = 1 THEN',
'        v_date := TO_DATE(p_date_str, ''MON-DD-YYYY'');',
'    ELSIF VALIDATE_CONVERSION(p_date_str AS DATE, ''Month DD, YYYY'', ''NLS_DATE_LANGUAGE=ENGLISH'') = 1 THEN',
'        v_date := TO_DATE(p_date_str, ''Month DD, YYYY'', ''NLS_DATE_LANGUAGE=ENGLISH'');',
'    ELSIF VALIDATE_CONVERSION(p_date_str AS DATE, ''DD Month YYYY'', ''NLS_DATE_LANGUAGE=ENGLISH'') = 1 THEN',
'        v_date := TO_DATE(p_date_str, ''DD Month YYYY'', ''NLS_DATE_LANGUAGE=ENGLISH'');',
'    ELSIF VALIDATE_CONVERSION(p_date_str AS DATE, ''YYYYMMDD'') = 1 THEN',
'        v_date := TO_DATE(p_date_str, ''YYYYMMDD'');',
'    ELSE',
'        -- No valid format found',
'        RAISE_APPLICATION_ERROR(-20001, ''Invalid date format: '' || p_date_str);',
'    END IF;',
'',
'    RETURN v_date;',
'END;',
'/',
'create or replace FUNCTION GET_MAP_CALCULATION_FUN(p_formula IN VARCHAR2, p_collection_name IN VARCHAR2)',
'RETURN VARCHAR2 IS',
'    l_formula VARCHAR2(4000) := p_formula;',
'BEGIN',
'    FOR rec IN (',
'        SELECT regexp_substr(c001, ''^[^(]+'') src_col, ',
'               regexp_substr(c002, ''^[^(]+'') tgt_col',
'        FROM apex_collections',
'        WHERE collection_name = p_collection_name',
'    ) LOOP',
'        l_formula := REGEXP_REPLACE(',
'                        l_formula, ',
'                        ''p\.'' || rec.src_col || ''(\b|[^a-zA-Z0-9_])'', ',
'                        ''p.'' || rec.tgt_col || ''\1''',
'                     );',
'    END LOOP;',
'',
'    RETURN l_formula;',
'END;',
'/',
'create or replace FUNCTION get_profile_json (',
'  p_blob     BLOB,',
'  p_filename VARCHAR2',
') RETURN CLOB IS',
'  l_result  apex_data_parser.t_parser_profile;',
'BEGIN',
'  l_result := apex_data_parser.discover(',
'    p_content   => p_blob,',
'    p_file_name => p_filename',
'  );',
'  RETURN l_result.profile;',
'END;',
'/',
'create or replace FUNCTION guess_delimiter (',
'    p_blob IN BLOB',
') RETURN VARCHAR2 IS',
'    l_raw        RAW(32767);',
'    l_varchar2   VARCHAR2(32767);',
'    l_first_line VARCHAR2(4000);',
'    l_comma_count NUMBER := 0;',
'    l_semicolon_count NUMBER := 0;',
'    l_pipe_count NUMBER := 0;',
'    l_tab_count NUMBER := 0;',
'    l_crlf_pos NUMBER;',
'    l_lf_pos NUMBER;',
'BEGIN',
'    -- Read the first part of the BLOB',
'    l_raw := DBMS_LOB.SUBSTR(p_blob, 32767, 1);',
'    ',
'    -- Convert RAW to VARCHAR2',
'    l_varchar2 := UTL_RAW.CAST_TO_VARCHAR2(l_raw);',
'    ',
'    -- Find the end of the first line (CRLF or LF)',
'    l_crlf_pos := INSTR(l_varchar2, CHR(13) || CHR(10));',
'    l_lf_pos := INSTR(l_varchar2, CHR(10));',
'',
'    IF l_crlf_pos > 0 THEN',
'        l_first_line := SUBSTR(l_varchar2, 1, l_crlf_pos - 1);',
'    ELSIF l_lf_pos > 0 THEN',
'        l_first_line := SUBSTR(l_varchar2, 1, l_lf_pos - 1);',
'    ELSE',
'        l_first_line := l_varchar2;',
'    END IF;',
'',
'    -- Count occurrences of common delimiters',
'    l_comma_count := REGEXP_COUNT(l_first_line, '','');',
'    l_semicolon_count := REGEXP_COUNT(l_first_line, '';'');',
'    l_pipe_count := REGEXP_COUNT(l_first_line, ''\|'');',
'    l_tab_count := REGEXP_COUNT(l_first_line, CHR(9));',
'    ',
'    -- Determine the most likely delimiter',
'    IF l_comma_count > l_semicolon_count AND l_comma_count > l_pipe_count AND l_comma_count > l_tab_count THEN',
'        RETURN '','';',
'    ELSIF l_semicolon_count > l_comma_count AND l_semicolon_count > l_pipe_count AND l_semicolon_count > l_tab_count THEN',
'        RETURN '';'';',
'    ELSIF l_pipe_count > l_comma_count AND l_pipe_count > l_semicolon_count AND l_pipe_count > l_tab_count THEN',
'        RETURN ''|'';',
'    ELSIF l_tab_count > 0 THEN -- Tabs are a common delimiter but are hard to distinguish with text',
'        RETURN CHR(9);',
'    ELSE',
'        -- Default to comma or return null if none are found',
'        RETURN '','';',
'    END IF;',
'END;',
'/',
'create or replace FUNCTION sanitize_column_name(p_name IN VARCHAR2) ',
'   RETURN VARCHAR2',
'IS',
'    v_name VARCHAR2(4000);',
'BEGIN',
'    -- Replace non-alphanumeric characters with underscore',
'    v_name := REGEXP_REPLACE(p_name, ''[^A-Za-z0-9]'', ''_'');',
'',
'    -- Replace multiple consecutive underscores with a single underscore',
'    v_name := REGEXP_REPLACE(v_name, ''_+'', ''_'');',
'',
'    -- Trim leading and trailing underscores',
'    v_name := REGEXP_REPLACE(v_name, ''^_+|_+$'', '''');',
'',
'    -- Convert to uppercase',
'    RETURN UPPER(v_name);',
'END sanitize_column_name;',
'/',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'  CREATE UNIQUE INDEX "PK_UR_HOTEL_ROOM_TYPES" ON "UR_HOTEL_ROOM_TYPES" ("ROOM_TYPE_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UQ_UR_HOTEL_RES_NUMBER" ON "UR_HOTEL_RESERVATIONS" ("RES_NUMBER") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UQ_UR_REPORT_DASHBOARDS_KEY" ON "UR_REPORT_DASHBOARDS" ("KEY") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEMP_1_OCT_N2_T_STAY_DATE_UQ" ON "UR_TEMP_1_OCT_N2_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEMP_DEMO_11_T_PK" ON "UR_TEMP_DEMO_11_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEST_CHINAR_29_SEP_T_PK" ON "UR_TEST_CHINAR_29_SEP_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEST_CHINAR_NO_USC_NEW_T_PK" ON "UR_TEST_CHINAR_NO_USC_NEW_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_250915_2_T_PK" ON "UR_VK_250915_2_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_LOS1_YORK_3_T_SDATE_UQ" ON "UR_VK_LOS1_YORK_3_T" ("SDATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_DAILY_BREAKDOWN_VK_4_T_PK" ON "UR_DAILY_BREAKDOWN_VK_4_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_SEGMENT_QUALIFIER2_T_PK" ON "UR_VK_SEGMENT_QUALIFIER2_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_DAILY_BREAKDOWN_VK_T_PK" ON "UR_DAILY_BREAKDOWN_VK_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_MCL_T_PK" ON "UR_LOS1_MCL_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_14_T_SDATE_UQ" ON "UR_LOS1_YORK_14_T" ("SDATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_2_T_SDATE_UQ" ON "UR_LOS1_YORK_2_T" ("SDATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "XXPEL_WF_GLOBAL_PROFILES_TBL_PK" ON "XXPEL_WF_GLOBAL_PROFILES_TBL" ("ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_250915_3_T_PK" ON "UR_VK_250915_3_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_LOS1_YORK_8_T_PK" ON "UR_VK_LOS1_YORK_8_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEST_CHINAR_2_T_PK" ON "UR_TEST_CHINAR_2_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UK_UR_ALGO_VERSIONS_ALGO_VERSION" ON "UR_ALGO_VERSIONS" ("ALGO_ID", "VERSION") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_LOS1_YORK_5_T_PK" ON "UR_VK_LOS1_YORK_5_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UK_UR_ALGO_ATTRIBUTES_KEY" ON "UR_ALGO_ATTRIBUTES" ("KEY") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEST_CHINAR_1_T_BOOKING_ID_UQ" ON "UR_TEST_CHINAR_1_T" ("BOOKING_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_SEGMENT_QUALIFIER_T_PK" ON "UR_VK_SEGMENT_QUALIFIER_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEMP_1_OCT_N1_T_PK" ON "UR_TEMP_1_OCT_N1_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_LOS1_YORK_2_T_PK" ON "UR_VK_LOS1_YORK_2_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_BHAUMIK_T_STAY_DATE_UQ" ON "UR_BHAUMIK_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_12_T_PK" ON "UR_LOS1_YORK_12_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_NEW_CHINAR_T_PK" ON "UR_VK_NEW_CHINAR_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_DEMO_30SEP25_T_PK" ON "UR_DEMO_30SEP25_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEST_CHINAR_2_T_BOOKING_ID_UQ" ON "UR_TEST_CHINAR_2_T" ("BOOKING_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_UR_BHAUMIK_30_SEP_T_PK" ON "UR_UR_BHAUMIK_30_SEP_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_250915_1_T_STAY_DATE_UQ" ON "UR_VK_250915_1_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_LOS1_YORK_4_T_SDATE_UQ" ON "UR_VK_LOS1_YORK_4_T" ("SDATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_SAMPLE_HOTEL_DATA_T_STAY_DATE_UQ" ON "UR_VK_SAMPLE_HOTEL_DATA_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_INDIGO_T_STAY_DATE_UQ" ON "UR_LOS1_INDIGO_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_T_DATE_UQ" ON "UR_LOS1_T" ("DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_11_T_SDATE_UQ" ON "UR_LOS1_YORK_11_T" ("SDATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEST_STACY_T_PK" ON "UR_TEST_STACY_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_LOS1_YORK_4_T_PK" ON "UR_VK_LOS1_YORK_4_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "PK_UR_INTERFACE_LOGS" ON "UR_INTERFACE_LOGS" ("ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UQ_UR_HOTEL_GROUPS_NAME" ON "UR_HOTEL_GROUPS" ("GROUP_NAME") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UQ_UR_REPORTS_KEY" ON "UR_REPORTS" ("KEY") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "PK_UR_HOTEL_GROUPS" ON "UR_HOTEL_GROUPS" ("ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UQ_UR_REPORT_DASHBOARDS_NAME" ON "UR_REPORT_DASHBOARDS" ("NAME") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_EXP_REPORT_T_PK" ON "UR_EXP_REPORT_T" ("ROW_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEMP_1_OCT_T_PK" ON "UR_TEMP_1_OCT_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_7_T_PK" ON "UR_LOS1_YORK_7_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEMP_1_OCT_N_T_PK" ON "UR_TEMP_1_OCT_N_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_250915_2_T_STAY_DATE_UQ" ON "UR_VK_250915_2_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_15_T_SDATE_UQ" ON "UR_LOS1_YORK_15_T" ("SDATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "PK_UR_HOTEL_ACCESSES" ON "UR_HOTEL_ACCESSES" ("HOTEL_ID", "USER_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "PK_UR_REPORTS" ON "UR_REPORTS" ("ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_CHINAR_STAY_DATE_TEMPLATE_T_PK" ON "UR_CHINAR_STAY_DATE_TEMPLATE_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_STR_3_T_STAY_DATE_UQ" ON "UR_STR_3_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_250915_4_T_STAY_DATE_UQ" ON "UR_VK_250915_4_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "PK_UR_ALGO_ATTRIBUTES" ON "UR_ALGO_ATTRIBUTES" ("ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_ALGOS_CON" ON "UR_ALGOS" ("NAME") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEST_13_10_CP_2_T_PK" ON "UR_TEST_13_10_CP_2_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_13OCT_T_SDATE_UQ" ON "UR_LOS1_YORK_13OCT_T" ("SDATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEMP_3_OCT_T_PK" ON "UR_TEMP_3_OCT_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_SAMPLE_HOTEL_DATA_T_PK" ON "UR_VK_SAMPLE_HOTEL_DATA_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "PK_UR_CONTACTS" ON "UR_CONTACTS" ("ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_DAILY_BREAKDOWN_T_PK" ON "UR_DAILY_BREAKDOWN_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_15_T_PK" ON "UR_LOS1_YORK_15_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_3DAY2_T_STAY_DATE_UQ" ON "UR_3DAY2_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_7_T_SDATE_UQ" ON "UR_LOS1_YORK_7_T" ("SDATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEMP_1_OCT_N2_T_PK" ON "UR_TEMP_1_OCT_N2_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEMP_NN_T_PK" ON "UR_TEMP_NN_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "PK_UR_ALGOS" ON "UR_ALGOS" ("ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_DEMO_30SEP25_T_SDATE_UQ" ON "UR_DEMO_30SEP25_T" ("SDATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_EXP_REPORT_2122122_T_PK" ON "UR_EXP_REPORT_2122122_T" ("ROW_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEST_TEMPLATE_T_PK" ON "UR_TEST_TEMPLATE_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_12_T_SDATE_UQ" ON "UR_LOS1_YORK_12_T" ("SDATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEST_13_10_CP_2_T_STAY_DATE_UQ" ON "UR_TEST_13_10_CP_2_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_UR_BHAUMIK_30_SEP1_T_PK" ON "UR_UR_BHAUMIK_30_SEP1_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UQ_UR_PROFILE_OPTIONS_KEY" ON "UR_PROFILE_OPTIONS" ("KEY") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_CHINAR_28_SEP_T_PK" ON "UR_CHINAR_28_SEP_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_13_T_SDATE_UQ" ON "UR_LOS1_YORK_13_T" ("SDATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "PK_UR_TEMPLATES" ON "UR_TEMPLATES" ("ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_250915_1_T_PK" ON "UR_VK_250915_1_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "PK_UR_EVENTS" ON "UR_EVENTS" ("ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEMP_NN_T_STAY_DATE_UQ" ON "UR_TEMP_NN_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "PK_UR_HOTEL_RESERVATIONS" ON "UR_HOTEL_RESERVATIONS" ("ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_CHINAR_STAY_DATE_TEMPLATE_T_STAY_DATE_UQ" ON "UR_CHINAR_STAY_DATE_TEMPLATE_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_INDIGO_L_SQUARE_T_PK" ON "UR_INDIGO_L_SQUARE_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_SEGMENT_QUALIFIER1_T_PK" ON "UR_VK_SEGMENT_QUALIFIER1_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "PK_UR_HOTELS" ON "UR_HOTELS" ("ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_CHINAR_22SEPT1_T_PK" ON "UR_CHINAR_22SEPT1_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS3_YORK_T_DATE_UQ" ON "UR_LOS3_YORK_T" ("DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "PK_UR_USERS" ON "UR_USERS" ("USER_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_T_PK" ON "UR_LOS1_YORK_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_250915_T_STAY_DATE_UQ" ON "UR_VK_250915_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_LOS1_YORK_3_T_PK" ON "UR_VK_LOS1_YORK_3_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_DAILY_BREAKDOWN11_T_PK" ON "UR_DAILY_BREAKDOWN11_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_EXP_REPORT_21_T_PK" ON "UR_EXP_REPORT_21_T" ("ROW_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_SEG1_T_PK" ON "UR_VK_SEG1_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_250915_4_T_PK" ON "UR_VK_250915_4_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_DAILY_BREAKDOWN_VK_2_T_PK" ON "UR_DAILY_BREAKDOWN_VK_2_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_ATT_QUAL1_T_PK" ON "UR_VK_ATT_QUAL1_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "PK_UR_REPORT_DASHBOARDS" ON "UR_REPORT_DASHBOARDS" ("ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_250915_T_PK" ON "UR_VK_250915_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_YORK_LOS1_T_PK" ON "UR_YORK_LOS1_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "KEY_UNIQUE" ON "XXPEL_WF_GLOBAL_PROFILES_TBL" ("KEY") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_13_T_PK" ON "UR_LOS1_YORK_13_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_ADAM_T_PK" ON "UR_ADAM_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_LOS1_YORK_7_T_PK" ON "UR_VK_LOS1_YORK_7_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_CHINAR_22SEPT_T_PK" ON "UR_CHINAR_22SEPT_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_13OCT_T_PK" ON "UR_LOS1_YORK_13OCT_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEMP_DEMO_11_T_STAY_DATE_UQ" ON "UR_TEMP_DEMO_11_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEST_CHINAR_29_SEP_T_STAY_UQ" ON "UR_TEST_CHINAR_29_SEP_T" ("STAY") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEST_CHINAR_NEWEST_T_PK" ON "UR_TEST_CHINAR_NEWEST_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_UR_BHAUMIK_30_SEP_T_STAY_UQ" ON "UR_UR_BHAUMIK_30_SEP_T" ("STAY") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UQ_UR_TEMPLATES_KEY" ON "UR_TEMPLATES" ("KEY") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_CHINAR_TEST_111_T_PK" ON "UR_CHINAR_TEST_111_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_PICKUP_INDIGO_T_PK" ON "UR_PICKUP_INDIGO_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEST1_22_CHINAR_T_PK" ON "UR_TEST1_22_CHINAR_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_1DAY_T_PK" ON "UR_1DAY_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_EXP_REPORT_3_T_PK" ON "UR_EXP_REPORT_3_T" ("ROW_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEST_CHINAR_1_T_PK" ON "UR_TEST_CHINAR_1_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "PK_ADDRESSES" ON "UR_ADDRESSES" ("ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS3_YORK_T_PK" ON "UR_LOS3_YORK_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_MCL_LOS1_T_PK" ON "UR_MCL_LOS1_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_LOS1_YORK_6_T_PK" ON "UR_VK_LOS1_YORK_6_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEST_CHINAR_T_PK" ON "UR_TEST_CHINAR_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_YORK_LOS1_VK_29SEP25_T_PK" ON "UR_YORK_LOS1_VK_29SEP25_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEST_13_10_CP_T_PK" ON "UR_TEST_13_10_CP_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_ATT_QUAL1_T_RNS__OTB__UQ" ON "UR_VK_ATT_QUAL1_T" ("RNS__OTB_") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_MCL_T_STAY_DATE_UQ" ON "UR_LOS1_MCL_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_10_T_PK" ON "UR_LOS1_YORK_10_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_LOS1_YORK_T_PK" ON "UR_VK_LOS1_YORK_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_TMS_TASK_T_PK" ON "UR_VK_TMS_TASK_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_YORK_TEMP12_T_PK" ON "UR_YORK_TEMP12_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_YORK_TEMP12_T_STAY_DATE_UQ" ON "UR_YORK_TEMP12_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_BHAUMIK_T_PK" ON "UR_BHAUMIK_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_CHINAR_28_SEP_T_STAY_UQ" ON "UR_CHINAR_28_SEP_T" ("STAY") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_PICKUP_INDIGO_T_STAY_DATE_UQ" ON "UR_PICKUP_INDIGO_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_STR_T_PK" ON "UR_STR_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_UR_CHINAR_QUAL_T_PK" ON "UR_UR_CHINAR_QUAL_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_YORK_LOS1_VK_29SEP25_T_S_DATE_UQ" ON "UR_YORK_LOS1_VK_29SEP25_T" ("S_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_7DAY1_T_PK" ON "UR_7DAY1_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_T_DATE_UQ" ON "UR_LOS1_YORK_T" ("DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEMP_1_OCT_N1_T_SDATE_UQ" ON "UR_TEMP_1_OCT_N1_T" ("SDATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_LEAVE_SETUP_T_PK" ON "UR_VK_LEAVE_SETUP_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_YORK_TEMP14_T_STAY_DATE_UQ" ON "UR_YORK_TEMP14_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UQ_UR_REPORT_DASHBOARDS_HOTEL_ID" ON "UR_REPORT_DASHBOARDS" ("HOTEL_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_7DAY1_T_STAY_DATE_UQ" ON "UR_7DAY1_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_2_T_PK" ON "UR_LOS1_YORK_2_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_YORK_LOS1_T_DATE_UQ" ON "UR_YORK_LOS1_T" ("DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_3DAY_T_PK" ON "UR_3DAY_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_CHINAR_22SEPT_T_STAY_DATE_UQ" ON "UR_CHINAR_22SEPT_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_EXP_REPORT_212212_T_PK" ON "UR_EXP_REPORT_212212_T" ("ROW_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_LOS1_YORK_9_T_PK" ON "UR_VK_LOS1_YORK_9_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_INDIGO_T_PK" ON "UR_LOS1_INDIGO_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_8_T_SDATE_UQ" ON "UR_LOS1_YORK_8_T" ("SDATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_T_PK" ON "UR_LOS1_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_STR_3_T_PK" ON "UR_STR_3_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_DAILY_BREAKDOWN_VK_3_T_RNS__OTB__UQ" ON "UR_DAILY_BREAKDOWN_VK_3_T" ("RNS__OTB_") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_HPRICOVR_ID_PK" ON "UR_HOTEL_PRICE_OVERRIDE" ("ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TT_T_PK" ON "UR_TT_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_LOS1_YORK_2_T_SDATE_UQ" ON "UR_VK_LOS1_YORK_2_T" ("SDATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_EXP_REPORT_21221_T_PK" ON "UR_EXP_REPORT_21221_T" ("ROW_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_DAILY_BREAKDOWN_VK_3_T_PK" ON "UR_DAILY_BREAKDOWN_VK_3_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_10_T_SDATE_UQ" ON "UR_LOS1_YORK_10_T" ("SDATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_14_T_PK" ON "UR_LOS1_YORK_14_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEST_13_10_CP_T_STAY_DATE_UQ" ON "UR_TEST_13_10_CP_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_LOS1_YORK_T_SDATE_UQ" ON "UR_VK_LOS1_YORK_T" ("SDATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_VK_NEW_CHINAR_T_STAY_DATE_UQ" ON "UR_VK_NEW_CHINAR_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_YORK_TEMP14_T_PK" ON "UR_YORK_TEMP14_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_1DAY_T_STAY_DATE_UQ" ON "UR_1DAY_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_3DAY2_T_PK" ON "UR_3DAY2_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_3DAY_T_STAY_DATE_UQ" ON "UR_3DAY_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEMP_3_OCT_T_STAY_DATE_UQ" ON "UR_TEMP_3_OCT_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_TEST_CHINAR_NO_USC_T_PK" ON "UR_TEST_CHINAR_NO_USC_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_8_T_PK" ON "UR_LOS1_YORK_8_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "PK_UR_PROFILE_OPTIONS" ON "UR_PROFILE_OPTIONS" ("ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UQ_UR_USERS_EMAIL" ON "UR_USERS" ("EMAIL") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_11_T_PK" ON "UR_LOS1_YORK_11_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "PK_TEMP_BLOB" ON "TEMP_BLOB" ("ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_EXPENSE_TEMPLATE_02_T_PK" ON "UR_EXPENSE_TEMPLATE_02_T" ("ROW_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_UR_BHAUMIK_30_SEP1_T_STAY_UQ" ON "UR_UR_BHAUMIK_30_SEP1_T" ("STAY") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "PK_UR_ALGO_VERSIONS" ON "UR_ALGO_VERSIONS" ("ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_INDIGO_L_SQUARE_I_T_PK" ON "UR_INDIGO_L_SQUARE_I_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_9_T_PK" ON "UR_LOS1_YORK_9_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_MCL_LOS1_T_SDATE_UQ" ON "UR_MCL_LOS1_T" ("SDATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_CHINAR_TEST_112_T_PK" ON "UR_CHINAR_TEST_112_T" ("REC_ID") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_UR_CHINAR_QUAL_T_STAY_UQ" ON "UR_UR_CHINAR_QUAL_T" ("STAY") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_CHINAR_TEST_112_T_STAY_DATE_UQ" ON "UR_CHINAR_TEST_112_T" ("STAY_DATE") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_DAILY_BREAKDOWN_VK_2_T_RNS__OTB__UQ" ON "UR_DAILY_BREAKDOWN_VK_2_T" ("RNS__OTB_") ',
'  ;',
'',
'  CREATE UNIQUE INDEX "UR_LOS1_YORK_9_T_SDATE_UQ" ON "UR_LOS1_YORK_9_T" ("SDATE") ',
'  ;',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'create or replace PACKAGE ALGO_EVALUATOR_PKG IS',
'',
'  FUNCTION build_dynamic_query(p_rules_json IN CLOB) RETURN CLOB;',
'',
'  FUNCTION EVALUATE(',
'    p_algo_id    IN ur_algos.id%TYPE,',
'    p_version_id IN ur_algo_versions.id%TYPE DEFAULT NULL,',
'    p_stay_date  IN DATE DEFAULT NULL',
'  ) RETURN t_result_tab_obj PIPELINED;',
'',
'',
'    TYPE t_result_rec IS RECORD (',
'    stay_date       DATE,',
'    evaluated_price NUMBER,',
'    applied_rule    CLOB',
'  );',
'  TYPE t_result_tab IS TABLE OF t_result_rec;',
'',
'    FUNCTION GENERIC_MATH_EVAL(',
'    p_function_name IN VARCHAR2,',
'    p_values IN VARCHAR2',
'  ) RETURN NUMBER;',
'',
'END ALGO_EVALUATOR_PKG;',
'/',
'create or replace PACKAGE app_user_ctx IS',
'  PROCEDURE set_current_user_id(p_user_id IN UR_USERS.USER_ID%TYPE);',
'  PROCEDURE clear_current_user_id;',
'  FUNCTION get_current_user_id RETURN UR_USERS.USER_ID%TYPE;',
'END app_user_ctx;',
'/',
'create or replace PACKAGE Graph_SQL AS',
'  PROCEDURE proc_crud_json(',
'    p_mode      IN VARCHAR2,    -- C=Create, U=Update, D=Delete, F=Fetch metadata',
'    p_table     IN VARCHAR2,    -- Table name (must be in user''s schema)',
'    p_payload   IN CLOB,        -- JSON payload string',
'    p_debug     IN VARCHAR2 DEFAULT ''N'', -- ''Y'' or ''N''',
'    p_status    OUT VARCHAR2,   -- S=Success, E=Error',
'    p_message   OUT CLOB,       -- Message or JSON (for Fetch mode)',
unistr('    p_icon      OUT VARCHAR2,   -- \2705 added: icon type (success, error, info, warning\2026)'),
unistr('    p_title     OUT VARCHAR2    -- \2705 added: alert title (Success!, Update Failed, etc.)'),
'  );',
'',
'END graph_SQL;',
'/',
'create or replace PACKAGE pkg_generic_crud AS',
'  PROCEDURE proc_crud_'))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'json(',
'    p_mode      IN VARCHAR2,    -- C=Create, U=Update, D=Delete, F=Fetch metadata',
'    p_table     IN VARCHAR2,    -- Table name (must be in user''s schema)',
'    p_payload   IN CLOB,        -- JSON payload string',
'    p_debug     IN VARCHAR2 DEFAULT ''N'', -- ''Y'' or ''N''',
'    p_status    OUT VARCHAR2,   -- S=Success, E=Error',
'    p_message   OUT CLOB,       -- Message or JSON (for Fetch mode)',
unistr('    p_icon      OUT VARCHAR2,   -- \2705 added: icon type (success, error, info, warning\2026)'),
unistr('    p_title     OUT VARCHAR2    -- \2705 added: alert title (Success!, Update Failed, etc.)'),
'  );',
'',
'END pkg_generic_crud;',
'/',
'create or replace PACKAGE ur_users_pkg IS',
'',
'  TYPE t_result IS RECORD (',
'    status   VARCHAR2(20),   -- ''OK'' | ''ERROR'' | ''PENDING''',
'    message  VARCHAR2(4000),',
'    username VARCHAR2(255)',
'  );',
'',
'  -- Main helper: create user row, create APEX account (if privileged) or enqueue for admin.',
'  FUNCTION create_user_full(',
'    p_first_name      IN VARCHAR2,',
'    p_last_name       IN VARCHAR2,',
'    p_email           IN VARCHAR2,',
'    p_contact_number  IN NUMBER DEFAULT NULL,',
'    p_user_type       IN VARCHAR2 DEFAULT ''ENDUSER'',',
'    p_status          IN VARCHAR2 DEFAULT ''ACTIVE'',',
'    p_start_date      IN DATE DEFAULT NULL,',
'    p_end_date        IN DATE DEFAULT NULL,',
'    p_login_method    IN VARCHAR2 DEFAULT ''APEX'',',
'    p_app_id          IN NUMBER DEFAULT NULL,          -- application id for role assignment (optional)',
'    p_preferred_roles IN VARCHAR2 DEFAULT NULL         -- comma-separated role static IDs',
'  ) RETURN t_result;',
'',
'  -- Enqueue for admin (explicit enqueue API)',
'  PROCEDURE enqueue_user_for_admin(',
'    p_first_name IN VARCHAR2,',
'    p_last_name  IN VARCHAR2,',
'    p_email      IN VARCHAR2,',
'    p_contact_number IN NUMBER DEFAULT NULL,',
'    p_user_type IN VARCHAR2 DEFAULT ''ENDUSER'',',
'    p_start_date IN DATE DEFAULT NULL,',
'    p_end_date   IN DATE DEFAULT NULL,',
'    p_login_method IN VARCHAR2 DEFAULT ''APEX'',',
'    p_base_username IN VARCHAR2 DEFAULT NULL,',
'    p_suggested_username IN VARCHAR2 DEFAULT NULL,',
'    p_preferred_roles IN VARCHAR2 DEFAULT NULL',
'  );',
'',
'  -- Admin/privileged: process pending rows (to be run by workspace admin schema / scheduled job)',
'  PROCEDURE process_pending_users(',
'    p_processor IN VARCHAR2 DEFAULT NULL  -- who ran it (optional)',
'  );',
'',
'END ur_users_pkg;',
'/',
'create or replace PACKAGE ur_user_mgmt IS',
'-- Create user and send notification',
'PROCEDURE create_user (',
'p_first      IN VARCHAR2,',
'p_last       IN VARCHAR2,',
'p_email      IN VARCHAR2,',
'p_contact    IN NUMBER,',
'p_user_type  IN VARCHAR2,',
'p_status     IN VARCHAR2,',
'p_start_date IN DATE DEFAULT SYSDATE,',
'p_end_date   IN DATE DEFAULT NULL,',
'p_login_method IN VARCHAR2 DEFAULT ''APEX''',
');',
'END ur_user_mgmt;',
'/',
'create or replace PACKAGE ur_utils IS',
'',
'  -- Modified get_collection_json procedure (returns JSON plus status/message)',
'  PROCEDURE get_collection_json(',
'    p_collection_name IN VARCHAR2,',
'    p_json_clob OUT CLOB,',
'    p_status OUT VARCHAR2,',
'    p_message OUT VARCHAR2',
'  );',
'  ',
'  PROCEDURE POPULATE_ERROR_COLLECTION_FROM_LOG (',
'    p_interface_log_id IN  UR_INTERFACE_LOGS.ID%TYPE,',
'    p_collection_name  IN  VARCHAR2,',
'    p_status           OUT VARCHAR2,',
'    p_message          OUT VARCHAR2',
'    );',
'',
'  PROCEDURE VALIDATE_TEMPLATE_DEFINITION (',
'      p_json_clob   IN            CLOB,',
'      p_alert_clob  IN OUT NOCOPY CLOB,',
'      p_status      OUT           VARCHAR2',
'  );',
'  ',
'  FUNCTION GET_ATTRIBUTE_VALUE (',
'    p_attribute_id    IN  RAW       DEFAULT NULL,',
'    p_attribute_key   IN  VARCHAR2  DEFAULT NULL,',
'    p_hotel_id        IN  RAW       DEFAULT NULL,',
'    p_stay_date       IN  DATE      DEFAULT NULL,',
'    p_round_digits    IN  NUMBER    DEFAULT 2',
'  ) RETURN UR_attribute_value_table PIPELINED;',
'',
'  PROCEDURE GET_ATTRIBUTE_VALUE (',
'    p_attribute_id    IN  RAW       DEFAULT NULL,',
'    p_attribute_key   IN  VARCHAR2  DEFAULT NULL,',
'    p_hotel_id        IN  RAW       DEFAULT NULL,',
'    p_stay_date       IN  DATE      DEFAULT NULL,',
'    p_round_digits    IN  NUMBER    DEFAULT 2,',
'    p_debug_flag      IN  BOOLEAN   DEFAULT FALSE,',
'    p_response_clob   OUT CLOB',
'  );',
'',
'  PROCEDURE manage_algo_attributes(',
'    p_template_key   IN  VARCHAR2,',
'    p_mode           IN  CHAR,',
'    p_attribute_key  IN  VARCHAR2 DEFAULT NULL,',
'    p_status         OUT BOOLEAN,',
'    p_message        OUT VARCHAR2',
'  );',
'',
'    procedure add_alert(',
'        p_existing_json   IN  CLOB,',
'        p_message         IN  VARCHAR2,',
'        p_icon            IN  VARCHAR2 DEFAULT NULL,',
'        p_title           IN  VARCHAR2 DEFAULT NULL,',
'        p_timeOut         IN  NUMBER   DEFAULT NULL,',
'        p_updated_json    OUT CLOB',
'    );',
'  PROCEDURE define_db_object(',
'    p_template_key IN VARCHAR2,',
'    p_status OUT BOOLEAN,',
'    p_message OUT VARCHAR2,',
'    p_mode         IN  VARCHAR2 DEFAULT ''N''',
'  );',
'',
'  PROCEDURE create_ranking_view(',
'    p_template_key IN VARCHAR2,',
'    p_status OUT BOOLEAN,',
'    p_message OUT VARCHAR2',
');',
'',
'  PROCEDURE LOAD_DATA_MAPPING_COLLECTION (',
'    p_file_id         IN  VARCHAR2,',
'    p_template_id     IN  VARCHAR2,',
'    p_collection_name IN  VARCHAR2,',
'    p_status          OUT VARCHAR2,',
'    p_message         OUT VARCHAR2',
'  );',
'  ',
'  FUNCTION Clean_TEXT(p_text IN VARCHAR2) RETURN VARCHAR2;',
'',
'  PROCEDURE Load_Data (',
'    p_file_id         IN  NUMBER,',
'    p_template_key    IN  VARCHAR2,',
'    p_hotel_id        IN  RAW,',
'    p_collection_name IN  VARCHAR2,',
'    p_status          OUT boolean,',
'    p_message         OUT VARCHAR2);',
'    ',
'  PROCEDURE fetch_templates(',
'    p_file_id      IN NUMBER,',
'    p_hotel_id     IN VARCHAR2,',
'    p_min_score    IN NUMBER DEFAULT 90,',
'    p_debug_flag   IN VARCHAR2 DEFAULT ''N'',',
'    p_output_json  OUT CLOB,',
'    p_status       OUT VARCHAR2,',
'    p_message      OUT VARCHAR2',
'  );',
'',
'    PROCEDURE DELETE_TEMPLATES (',
'    p_id           IN VARCHAR2 DEFAULT NULL,',
'    p_hotel_id     IN VARCHAR2 DEFAULT NULL,',
'    p_key          IN VARCHAR2 DEFAULT NULL,',
'    p_name         IN VARCHAR2 DEFAULT NULL,',
'    p_type         IN VARCHAR2 DEFAULT NULL,',
'    p_active       IN CHAR DEFAULT NULL,',
'    p_db_obj_empty IN CHAR DEFAULT NULL,',
'    p_delete_all   IN CHAR DEFAULT ''N'',',
'    p_debug        IN CHAR DEFAULT ''N'',',
'    p_json_output  OUT CLOB',
'  );',
'',
'  FUNCTION normalize_json (p_json CLOB) RETURN CLOB; ',
'',
'  PROCEDURE validate_expression (',
'    p_expression IN VARCHAR2,',
'    p_mode       IN CHAR,',
'    p_hotel_id   IN VARCHAR2,',
'    p_status     OUT VARCHAR2,  -- ''S'' for success, ''E'' for error',
'    p_message    OUT VARCHAR2',
'  );',
'',
'END ur_utils;',
'/',
'create or replace PACKAGE ur_utils_test IS',
'',
'  -- Modified get_collection_json procedure (returns JSON plus status/message)',
'  PROCEDURE get_collection_json(',
'    p_collection_name IN VARCHAR2,',
'    p_json_clob OUT CLOB,',
'    p_status OUT BOOLEAN,',
'    p_message OUT VARCHAR2',
'  );',
'',
'  PROCEDURE manage_algo_attributes(',
'    p_template_key   IN  VARCHAR2,',
'    p_mode           IN  CHAR,',
'    p_attribute_key  IN  VARCHAR2 DEFAULT NULL,',
'    p_status         OUT BOOLEAN,',
'    p_message        OUT VARCHAR2',
'  );',
'',
'    procedure add_alert(',
'        p_existing_json   IN  CLOB,',
'        p_message         IN  VARCHAR2,',
'        p_icon            IN  VARCHAR2 DEFAULT NULL,',
'        p_title           IN  VARCHAR2 DEFAULT NULL,',
'        p_timeOut         IN  NUMBER   DEFAULT NULL,',
'        p_updated_json    OUT CLOB',
'    );',
'  PROCEDURE define_db_object(',
'    p_template_key IN VARCHAR2,',
'    p_status OUT BOOLEAN,',
'    p_message OUT VARCHAR2',
'  );',
'',
'  PROCEDURE LOAD_DATA_MAPPING_COLLECTION (',
'    p_file_id         IN  VARCHAR2,',
'    p_template_id     IN  VARCHAR2,',
'    p_collection_name IN  VARCHAR2,',
'    p_status          OUT VARCHAR2,',
'    p_message         OUT VARCHAR2',
'  );',
'  ',
'  FUNCTION Clean_TEXT(p_text IN VARCHAR2) RETURN VARCHAR2;',
'',
'  PROCEDURE Load_Data (',
'    p_file_id         IN  NUMBER,',
'    p_template_key    IN  VARCHAR2,',
'    p_hotel_id        IN  RAW,',
'    p_collection_name IN  VARCHAR2,',
'    p_status          OUT boolean,',
'    p_message         OUT VARCHAR2);',
'    ',
'  PROCEDURE fetch_templates(',
'    p_file_id      IN NUMBER,',
'    p_hotel_id     IN VARCHAR2,',
'    p_min_score    IN NUMBER DEFAULT 90,',
'    p_debug_flag   IN VARCHAR2 DEFAULT ''N'',',
'    p_output_json  OUT CLOB,',
'    p_status       OUT VARCHAR2,',
'    p_message      OUT VARCHAR2',
'  );',
'',
'    PROCEDURE DELETE_TEMPLATES (',
'    p_id           IN VARCHAR2 DEFAULT NULL,',
'    p_hotel_id     IN VARCHAR2 DEFAULT NULL,',
'    p_key          IN VARCHAR2 DEFAULT NULL,',
'    p_name         IN VARCHAR2 DEFAULT NULL,',
'    p_type         IN VARCHAR2 DEFAULT NULL,',
'    p_active       IN CHAR DEFAULT NULL,',
'    p_db_obj_empty IN CHAR DEFAULT NULL,',
'    p_delete_all   IN CHAR DEFAULT ''N'',',
'    p_debug        IN CHAR DEFAULT ''N'',',
'    p_json_output  OUT CLOB',
'  );',
'',
'  FUNCTION normalize_json (p_json CLOB) RETURN CLOB; ',
'',
'  PROCEDURE validate_expression (',
'    p_expression IN VARCHAR2,',
'    p_mode       IN CHAR,',
'    p_hotel_id   IN VARCHAR2,',
'    p_status     OUT VARCHAR2,  -- ''S'' for success, ''E'' for error',
'    p_message    OUT VARCHAR2',
'  );',
'',
'END ur_utils_test;',
'/',
'create or replace PACKAGE ur_utils_test_1 IS',
'',
'  -- Modified get_collection_json procedure (returns JSON plus status/message)',
'  PROCEDURE get_collection_json(',
'    p_collection_name IN VARCHAR2,',
'    p_json_clob OUT CLOB,',
'    p_status OUT BOOLEAN,',
'    p_message OUT VARCHAR2',
'  );',
'',
'  PROCEDURE manage_algo_attributes(',
'    p_template_key   IN  VARCHAR2,',
'    p_mode           IN  CHAR,',
'    p_attribute_key  IN  VARCHAR2 DEFAULT NULL,',
'    p_status         OUT BOOLEAN,',
'    p_message        OUT VARCHAR2',
'  );',
'',
'    procedure add_alert(',
'        p_existing_json   IN  CLOB,',
'        p_message         IN  VARCHAR2,',
'        p_icon            IN  VARCHAR2 DEFAULT NULL,',
'        p_title           IN  VARCHAR2 DEFAULT NULL,',
'        p_timeOut         IN  NUMBER   DEFAULT NULL,',
'        p_updated_json    OUT CLOB',
'    );',
'  PROCEDURE define_db_object(',
'    p_template_key IN VARCHAR2,',
'    p_status OUT BOOLEAN,',
'    p_message OUT VARCHAR2',
'  );',
'',
'  PROCEDURE LOAD_DATA_MAPPING_COLLECTION (',
'    p_file_id         IN  VARCHAR2,',
'    p_template_id     IN  VARCHAR2,',
'    p_collection_name IN  VARCHAR2,',
'    p_status          OUT VARCHAR2,',
'    p_message         OUT VARCHAR2',
'  );',
'  ',
'  FUNCTION Clean_TEXT(p_text IN VARCHAR2) RETURN VARCHAR2;',
'',
'  PROCEDURE Load_Data (',
'    p_file_id         IN  NUMBER,',
'    p_template_key    IN  VARCHAR2,',
'    p_hotel_id        IN  RAW,',
'    p_collection_name IN  VARCHAR2,',
'    p_status          OUT boolean,',
'    p_message         OUT VARCHAR2);',
'    ',
'  PROCEDURE fetch_templates(',
'    p_file_id      IN NUMBER,',
'    p_hotel_id     IN VARCHAR2,',
'    p_min_score    IN NUMBER DEFAULT 90,',
'    p_debug_flag   IN VARCHAR2 DEFAULT ''N'',',
'    p_output_json  OUT CLOB,',
'    p_status       OUT VARCHAR2,',
'    p_message      OUT VARCHAR2',
'  );',
'',
'    PROCEDURE DELETE_TEMPLATES (',
'    p_id           IN VARCHAR2 DEFAULT NULL,',
'    p_hotel_id     IN VARCHAR2 DEFAULT NULL,',
'    p_key          IN VARCHAR2 DEFAULT NULL,',
'    p_name         IN VARCHAR2 DEFAULT NULL,',
'    p_type         IN VARCHAR2 DEFAULT NULL,',
'    p_active       IN CHAR DEFAULT NULL,',
'    p_db_obj_empty IN CHAR DEFAULT NULL,',
'    p_delete_all   IN CHAR DEFAULT ''N'',',
'    p_debug        IN CHAR DEFAULT ''N'',',
'    p_json_output  OUT CLOB',
'  );',
'',
'  FUNCTION normalize_json (p_json CLOB) RETURN CLOB; ',
'',
'  PROCEDURE validate_expression (',
'    p_expression IN VARCHAR2,',
'    p_mode       IN CHAR,',
'    p_hotel_id   IN VARCHAR2,',
'    p_status     OUT VARCHAR2,  -- ''S'' for success, ''E'' for error',
'    p_message    OUT VARCHAR2',
'  );',
'',
'END ur_utils_test_1;',
'/',
'create or replace PACKAGE XXPEL_A001_FEEDBACK AS',
'  -- Procedure: Submit feedback, create JIRA issue, send notifications',
'  PROCEDURE SUBMIT_FEEDBACK(',
'    p_feedback       IN VARCHAR2,',
'    p_rating         IN VARCHAR2,',
'    p_new_type       IN VARCHAR2,',
'    p_summary        IN VARCHAR2,',
'    p_description    IN VARCHAR2,',
'    p_page_id        IN NUMBER,',
'    p_app_id         IN NUMBER,',
'    p_app_user       IN VARCHAR2',
'  );',
'END XXPEL_A001_FEEDBACK;',
'/',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'create or replace PROCEDURE call_ai_chat_completion (',
'    p_system_msg  IN VARCHAR2,',
'    p_user_prompt IN CLOB,           -- JSON format string, e.g. ''{"text": "Hello"}''',
'    p_model_id    IN VARCHAR2,',
'    p_web_cred    IN VARCHAR2,',
'    p_completion  OUT CLOB,',
'    p_token_count OUT NUMBER',
') IS',
'    l_http_request   UTL_HTTP.req;',
'    l_http_response  UTL_HTTP.resp;',
'    l_response_text  CLOB;',
'    ',
'    l_url           VARCHAR2(4000) := ''https://api.openai.com/v1/chat/completions'';',
'    l_api_key       VARCHAR2(4000);',
'    ',
'    l_body_json     CLOB;',
'    l_msg_array     JSON_ARRAY_T;',
'    l_payload       JSON_OBJECT_T;',
'    ',
'    l_json_response JSON_OBJECT_T;',
'    l_choices       JSON_ARRAY_T;',
'    l_usage         JSON_OBJECT_T;',
'    ',
'    -- to read chunks from response',
'    l_buffer        VARCHAR2(32767);',
'BEGIN',
'    -- Retrieve API key from APEX Web Credential (which securely stores API Key as Password)',
'    l_api_key := APEX_WEB_CREDENTIAL.GET_PASSWORD(p_web_cred);',
'',
'    -- Compose the messages array (with system and user message)',
'    l_msg_array := JSON_ARRAY_T();',
'    l_msg_array.APPEND(JSON_OBJECT_T(''role'' VALUE ''system'', ''content'' VALUE p_system_msg));',
'    l_msg_array.APPEND(JSON_OBJECT_T(''role'' VALUE ''user'', ''content'' VALUE l_user_message));',
'    -- user prompt is passed as JSON string (already JSON formatted)',
'    -- Assume p_user_prompt is JSON string representing message object(s),',
'',
'    -- We''ll parse p_user_prompt as JSON to get user message(s)',
'    -- Two options:',
'    -- - if p_user_prompt is a single message string (just text), wrap it',
'    -- - if p_user_prompt is JSON array or JSON object representing messages, append all',
'',
'    -- For flexibility, let''s assume p_user_prompt is JSON string representing user message text, simple.',
'',
'    -- Alternative: If user prompt is a JSON object with {"text": "..."} then:',
'    DECLARE',
'        l_user_msg JSON_OBJECT_T;',
'    BEGIN',
'        l_user_msg := JSON_OBJECT_T.parse(p_user_prompt);',
'        l_msg_array.APPEND(JSON_OBJECT_T(''role'' VALUE ''user'', ''content'' VALUE l_user_msg.get_String(''text'')));',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'          -- fallback: treat p_user_prompt as plain text',
'          l_msg_array.APPEND(JSON_OBJECT_T(''role'' VALUE ''user'' VALUE p_user_prompt));',
'    END;',
'',
'    -- Build payload JSON object',
'    l_payload := JSON_OBJECT_T();',
'    l_payload.put(''model'', p_model_id);',
'    l_payload.put(''messages'', l_msg_array);',
'    ',
'    -- Convert l_payload to clob',
'    l_body_json := l_payload.to_clob;',
'',
'    -- Prepare HTTPS request',
'    l_http_request := UTL_HTTP.begin_request(',
'        url => l_url,',
'        method => ''POST'',',
'        http_version => ''HTTP/1.1''',
'    );',
'',
'    -- Set headers',
'    UTL_HTTP.set_header(l_http_request, ''Content-Type'', ''application/json'');',
'    UTL_HTTP.set_header(l_http_request, ''Authorization'', ''Bearer '' || l_api_key);',
'',
'    -- Write payload',
'    UTL_HTTP.write_text(l_http_request, l_body_json);',
'',
'    -- Get Response',
'    l_http_response := UTL_HTTP.get_response(l_http_request);',
'',
'    l_response_text := EMPTY_CLOB();',
'    DBMS_LOB.createtemporary(l_response_text, TRUE);',
'',
'    BEGIN',
'        LOOP',
'            UTL_HTTP.read_text(l_http_response, l_buffer, 32767);',
'            DBMS_LOB.writeappend(l_response_text, LENGTH(l_buffer), l_buffer);',
'        END LOOP;',
'    EXCEPTION',
'        WHEN UTL_HTTP.END_OF_BODY THEN',
'            NULL;',
'    END;',
'    UTL_HTTP.end_response(l_http_response);',
'',
'    -- Parse JSON response',
'    l_json_response := JSON_OBJECT_T.parse(l_response_text);',
'',
'    -- Get completion text (first choice)',
'    l_choices := l_json_response.get_Array(''choices'');',
'    IF l_choices.COUNT > 0 THEN',
'        p_completion := l_choices.get_Object(1).get_String(''message'').get_String(''content'');',
'    ELSE',
'        p_completion := NULL;',
'    END IF;',
'',
'    -- Get token count from usage',
'    l_usage := l_json_response.get_Object(''usage'');',
'    IF l_usage IS NOT NULL THEN',
'        p_token_count := l_usage.get_Number(''total_tokens'');',
'    ELSE',
'        p_token_count := NULL;',
'    END IF;',
'',
'EXCEPTION',
'    WHEN OTHERS THEN',
'        -- Return error message in output variable',
'        p_completion := ''Error: '' || SQLERRM;',
'        p_token_count := NULL;',
'END call_openai_chat_completion;',
'/',
'create or replace PROCEDURE call_openai_chat_completion (',
'    p_system_msg IN VARCHAR2,',
'    p_user_msg   IN VARCHAR2,',
'    p_result     OUT CLOB',
') AS',
'    l_url      VARCHAR2(32767) := ''https://api.openai.com/v1/chat/completions'';',
'    l_body     CLOB;',
'    l_response CLOB;',
'    l_api_key  VARCHAR2(4000);',
'BEGIN',
'    -- Get API key from application item',
'    l_api_key := ''xsdcsdfsdf'';',
'',
'    -- Build JSON request body',
'    l_body := json_object(',
'                 ''model'' VALUE ''gpt-4o-mini'',',
'                 ''messages'' VALUE json_array(',
'                     json_object(''role'' VALUE ''system'', ''content'' VALUE p_system_msg),',
'                     json_object(''role'' VALUE ''user'',   ''content'' VALUE p_user_msg)',
'                 )',
'              );',
'',
'    -- Call API',
'    l_response := apex_web_service.make_rest_request(',
'        p_url         => l_url,',
'        p_http_method => ''POST'',',
'        p_body        => l_body,',
'        p_http_headers => apex_t_varchar2(',
'                              ''Content-Type'', ''application/json'',',
'                              ''Authorization'', ''Bearer '' || l_api_key',
'                          )',
'    );',
'',
'    -- Parse the response',
'    SELECT json_value(l_response, ''$.choices[0].message.content'')',
'      INTO p_result',
'      FROM dual;',
'',
'EXCEPTION',
'    WHEN OTHERS THEN',
'        p_result := ''Error: '' || SQLERRM;',
'END call_openai_chat_completion;',
'/',
'create or replace PROCEDURE DELETE_TEMPLATES_AND_DB_OBJECTS_JSON (',
'  p_id            IN VARCHAR2 DEFAULT NULL,',
'  p_hotel_id      IN VARCHAR2 DEFAULT NULL,',
'  p_key           IN VARCHAR2 DEFAULT NULL,',
'  p_name          IN VARCHAR2 DEFAULT NULL,',
'  p_type          IN VARCHAR2 DEFAULT NULL,',
'  p_active        IN CHAR DEFAULT NULL,           -- ''Y'' or ''N''',
'  p_db_obj_empty  IN CHAR DEFAULT NULL,           -- ''Y'' = only if table is empty, else skip',
'  p_delete_all    IN CHAR DEFAULT ''N'',            -- ''Y'' to delete EVERYTHING',
'  p_debug         IN CHAR DEFAULT ''N'',            -- ''Y'' to log debug messages to APEX debug',
'  p_json_output   OUT CLOB',
')',
'AS',
'  v_sql            VARCHAR2(1000);',
'  v_rows_count     NUMBER;',
'  v_status         CHAR(1);',
'  v_message        VARCHAR2(4000);',
'  v_json_list      CLOB := ''['';',
'  v_first          BOOLEAN := TRUE;',
'  v_tmp_json       CLOB;',
'',
'  CURSOR c_templates IS',
'    SELECT id, hotel_id, key, name, type, active, db_object_name',
'    FROM ur_templates',
'    WHERE (p_delete_all = ''Y''',
'          OR (p_id IS NULL OR id = p_id))',
'      AND (p_delete_all = ''Y''',
'           OR (p_hotel_id IS NULL OR hotel_id = p_hotel_id))',
'      AND (p_delete_all = ''Y''',
'           OR (p_key IS NULL OR key = p_key))',
'      AND (p_delete_all = ''Y''',
'           OR (p_name IS NULL OR name = p_name))',
'      AND (p_delete_all = ''Y''',
'           OR (p_type IS NULL OR type = p_type))',
'      AND (p_delete_all = ''Y''',
'           OR (p_active IS NULL OR active = p_active));',
'           ',
'  -- Helper to escape JSON strings - simple version; improves safety',
'  FUNCTION json_escape(str IN VARCHAR2) RETURN VARCHAR2 IS',
'  BEGIN',
'    RETURN REPLACE(REPLACE(REPLACE(REPLACE(str, ''\'', ''\\''), ''"'', ''\"''), CHR(10), ''\n''), CHR(13), '''');',
'  EXCEPTION WHEN OTHERS THEN',
'    RETURN '''';',
'  END;',
'',
'  PROCEDURE dbg(p_msg VARCHAR2) IS',
'  BEGIN',
'    IF p_debug = ''Y'' THEN',
'      apex_debug.message(p_msg);',
'    END IF;',
'  END;',
'',
'  PROCEDURE append_result (',
'    p_id            IN VARCHAR2,',
'    p_hotel_id      IN VARCHAR2,',
'    p_key           IN VARCHAR2,',
'    p_name          IN VARCHAR2,',
'    p_type          IN VARCHAR2,',
'    p_active        IN CHAR,',
'    p_db_obj_name   IN VARCHAR2,',
'    p_status        IN CHAR,',
'    p_message       IN VARCHAR2',
'  ) IS',
'  BEGIN',
'    IF v_first THEN',
'      v_first := FALSE;',
'    ELSE',
'      v_json_list := v_json_list || '','';',
'    END IF;',
'',
'    v_json_list := v_json_list || ''{'' ||',
'      ''"id":"''          || json_escape(p_id)          || ''",'' ||',
'      ''"hotel_id":"''    || json_escape(p_hotel_id)    || ''",'' ||',
'      ''"key":"''         || json_escape(p_key)         || ''",'' ||',
'      ''"name":"''        || json_escape(p_name)        || ''",'' ||',
'      ''"type":"''        || json_escape(p_type)        || ''",'' ||',
'      ''"active":"''      || json_escape(p_active)      || ''",'' ||',
'      ''"db_object_name":"'' || json_escape(p_db_obj_name) || ''",'' ||',
'      ''"status":"''      || json_escape(p_status)      || ''",'' ||',
'      ''"message":"''     || json_escape(p_message)     || ''"'' ||',
'    ''}'';',
'  END;',
'BEGIN',
'  dbg(''Started DELETE_TEMPLATES_AND_DB_OBJECTS_JSON procedure.'');',
'',
'  FOR rec IN c_templates LOOP',
'    dbg(''Processing template ID='' || rec.id || '', DB_OBJECT_NAME='' || rec.db_object_name);',
'',
'    IF rec.db_object_name IS NULL THEN',
'      v_status := ''E'';',
'      v_message := ''No DB_OBJECT_NAME specified for template, skipping.'';',
'      dbg(v_message);',
'      append_result(rec.id, rec.hotel_id, rec.key, rec.name, rec.type, rec.active, NULL, v_status, v_message);',
'      CONTINUE;',
'    END IF;',
'',
'    -- -- Check if table exists in user schema',
'    -- SELECT COUNT(*)',
'    --   INTO v_rows_count',
'    --   FROM all_tables',
'    --  WHERE table_name = rec.db_object_name',
'    --    AND owner = USER;',
'',
'    -- IF v_rows_count = 0 THEN',
'    --   v_status := ''E'';',
'    --   v_message := ''DB Object ['' || rec.db_object_name || ''] does not exist or is not a table.'';',
'    --   dbg(v_message);',
'    --   append_result(rec.id, rec.hotel_id, rec.key, rec.name, rec.type, rec.active, rec.db_object_name, v_status, v_message);',
'    --   CONTINUE;',
'    -- END IF;',
'',
'    -- Check if table should be empty before deleting',
'    IF p_db_obj_empty = ''Y'' THEN',
'      v_sql := ''SELECT COUNT(*) FROM '' || rec.db_object_name;',
'      BEGIN',
'        EXECUTE IMMEDIATE v_sql INTO v_rows_count;',
'      EXCEPTION',
'        WHEN OTHERS THEN',
'          v_rows_count := -1; -- can''t count, treat as error or non-empty',
'      END;',
'',
'      IF v_rows_count > 0 THEN',
'        v_status := ''E'';',
'        v_message := ''DB Object table ['' || rec.db_object_name || ''] is not empty (ROWS='' || v_rows_count || ''), skipping deletion.'';',
'        dbg(v_message);',
'        append_result(rec.id, rec.hotel_id, rec.key, rec.name, rec.type, rec.active, rec.db_object_name, v_status, v_message);',
'        CONTINUE;',
'      END IF;',
'      dbg(''DB Object table ['' || rec.db_object_name || ''] is empty, proceeding.'');',
'    END IF;',
'',
'    -- Try to drop the table and delete template',
'    BEGIN',
'      v_sql := ''DROP TABLE '' || rec.db_object_name || '' CASCADE CONSTRAINTS'';',
'      dbg(''Executing: '' || v_sql);',
'      EXECUTE IMMEDIATE v_sql;',
'',
'      dbg(''Dropped table '' || rec.db_object_name);',
'',
'      DELETE FROM ur_templates WHERE id = rec.id;',
'',
'      dbg(''Deleted template id='' || rec.id);',
'',
'      v_status := ''S'';',
'      v_message := ''Successfully dropped table and deleted template.'';',
'      append_result(rec.id, rec.hotel_id, rec.key, rec.name, rec.type, rec.active, rec.db_object_name, v_status, v_message);',
'',
'    EXCEPTION',
'      WHEN OTHERS THEN',
'        v_status := ''E'';',
'        v_message := ''Error dropping table or deleting template: '' || SQLERRM;',
'        dbg(v_message);',
'        append_result(rec.id, rec.hotel_id, rec.key, rec.name, rec.type, rec.active, rec.db_object_name, v_status, v_message);',
'    END;',
'  END LOOP;',
'',
'  v_json_list := v_json_list || '']'';',
'',
'  p_json_output := v_json_list;',
'',
'  dbg(''Completed DELETE_TEMPLATES_AND_DB_OBJECTS_JSON procedure.'');',
'END DELETE_TEMPLATES_AND_DB_OBJECTS_JSON;',
'/',
'create or replace PROCEDURE generic_crud_proc (',
'  p_mode      IN VARCHAR2,',
'  p_table     IN VARCHAR2,',
'  p_payload   IN CLOB,',
'  p_debug     IN VARCHAR2 DEFAULT ''N'',',
'  p_status    OUT VARCHAR2,',
'  p_message   OUT CLOB',
') IS',
'  -- Types for column metadata',
'  TYPE t_col_rec IS RECORD (',
'    column_name  VARCHAR2(100),',
'    data_type    VARCHAR2(30),',
'    nullable     CHAR(1)',
'  );',
'  TYPE t_col_tab IS TABLE OF t_col_rec INDEX BY PLS_INTEGER;',
'',
'  v_columns     t_col_tab;',
'  v_pk_cols     SYS.ODCIVARCHAR2LIST;',
'',
'  v_col_cnt     PLS_INTEGER := 0;',
'  v_pk_cnt      PLS_INTEGER := 0;',
'',
'  v_json_obj    JSON_OBJECT_T;',
'  v_sql         CLOB;',
'  v_cursor      INTEGER DEFAULT DBMS_SQL.OPEN_CURSOR;',
'  v_col_value_varchar   VARCHAR2(4000);',
'  v_col_value_number    NUMBER;',
'  v_col_value_date      DATE;',
'  v_col_value_raw       RAW(16);',
'',
'  v_bind_idx    INTEGER;',
'  v_col_meta    t_col_rec;',
'',
'  v_missing     SYS.ODCIVARCHAR2LIST := SYS.ODCIVARCHAR2LIST();',
'  v_err_msg     VARCHAR2(4000);',
'',
'  PROCEDURE log_debug(p_msg VARCHAR2) IS',
'  BEGIN',
'    IF UPPER(p_debug) = ''Y'' THEN',
'      BEGIN',
'        APEX_DEBUG.MESSAGE(''DEBUG: '' || p_msg);',
'      EXCEPTION WHEN OTHERS THEN',
'        DBMS_OUTPUT.PUT_LINE(''DEBUG: '' || p_msg);',
'      END;',
'    END IF;',
'  END;',
'',
'  FUNCTION hex_to_raw16(hexstr VARCHAR2) RETURN RAW IS',
'  BEGIN',
'    IF LENGTH(hexstr) = 32 THEN',
'      RETURN HEXTORAW(hexstr);',
'    ELSE',
'      RETURN NULL;',
'    END IF;',
'  END;',
'',
'  -- Utility to validate mandatory columns present in JSON',
'PROCEDURE validate_mandatory_cols IS',
'BEGIN',
'  FOR i IN 1 .. v_col_cnt LOOP',
'    IF v_columns(i).nullable = ''N'' THEN',
'      IF NOT v_json_obj.has(v_columns(i).column_name) THEN',
'        v_missing.EXTEND;',
'        v_missing(v_missing.COUNT) := v_columns(i).column_name;',
'      END IF;',
'    END IF;',
'  END LOOP;',
'',
'  IF v_missing.COUNT > 0 THEN',
'    DECLARE',
'      v_list_str VARCHAR2(4000);',
'    BEGIN',
'      SELECT LISTAGG(column_value, '', '') WITHIN GROUP (ORDER BY column_value)',
'        INTO v_list_str',
'        FROM TABLE(v_missing);',
'      v_err_msg := ''Mandatory columns missing: '' || v_list_str;',
'    END;',
'    RAISE_APPLICATION_ERROR(-20001, v_err_msg);',
'  END IF;',
'END;',
'',
'  -- Utility to fetch column metadata dynamically',
'  PROCEDURE load_metadata IS',
'  BEGIN',
'    SELECT column_name, data_type, nullable',
'      BULK COLLECT INTO v_columns',
'      FROM all_tab_columns',
'     WHERE table_name = UPPER(p_table)',
'       AND owner = USER',
'     ORDER BY column_id;',
'',
'    IF v_columns.COUNT = 0 THEN',
'      v_err_msg := ''Table "'' || p_table || ''" does not exist or no columns found.'';',
'      RAISE_APPLICATION_ERROR(-20002, v_err_msg);',
'    END IF;',
'',
'    SELECT acc.column_name',
'      BULK COLLECT INTO v_pk_cols',
'      FROM all_constraints ac',
'      JOIN all_cons_columns acc ON ac.constraint_name = acc.constraint_name AND ac.owner = acc.owner',
'     WHERE ac.constraint_type = ''P''',
'       AND ac.table_name = UPPER(p_table)',
'       AND ac.owner = USER',
'     ORDER BY acc.position;',
'',
'    v_col_cnt := v_columns.COUNT;',
'    v_pk_cnt := v_pk_cols.COUNT;',
'  END;',
'',
'  -- Procedure to generate sample payloads JSON (for F mode)',
'  FUNCTION sample_payload_json RETURN CLOB IS',
'    v_json JSON_OBJECT_T := JSON_OBJECT_T();',
'    v_sample_create JSON_OBJECT_T := JSON_OBJECT_T();',
'    v_sample_update JSON_OBJECT_T := JSON_OBJECT_T();',
'    v_sample_delete JSON_OBJECT_T := JSON_OBJECT_T();',
'  BEGIN',
'    FOR i IN 1 .. v_col_cnt LOOP',
'      IF v_columns(i).data_type LIKE ''VARCHAR2%'' THEN',
'        v_sample_create.put(v_columns(i).column_name, v_columns(i).column_name || ''_sample'');',
'        v_sample_update.put(v_columns(i).column_name, v_columns(i).column_name || ''_updated'');',
'      ELSIF v_columns(i).data_type LIKE ''NUMBER%'' THEN',
'        v_sample_create.put(v_columns(i).column_name, 123);',
'        v_sample_update.put(v_columns(i).column_name, 456);',
'      ELSIF v_columns(i).data_type LIKE ''DATE%'' THEN',
'        v_sample_create.put(v_columns(i).column_name, TO_CHAR(SYSDATE, ''YYYY-MM-DD"T"HH24:MI:SS''));',
'        v_sample_update.put(v_columns(i).column_name, TO_CHAR(SYSDATE+1, ''YYYY-MM-DD"T"HH24:MI:SS''));',
'      ELSIF v_columns(i).data_type = ''RAW'' THEN',
'        -- UUID as 32 char hex string',
'        v_sample_create.put(v_columns(i).column_name, ''A1B2C3D4E5F60718293A4B5C6D7E8F90'');',
'        v_sample_update.put(v_columns(i).column_name, ''F0E8D7C6B5A4938271607F5E4D3C2B1A'');',
'      END IF;',
'    END LOOP;',
'    -- For delete and update PK columns required:',
'    FOR i IN 1 .. v_pk_cnt LOOP',
'      v_sample_delete.put(v_pk_cols(i), ''A1B2C3D4E5F60718293A4B5C6D7E8F90'');',
'      v_sample_update.put(v_pk_cols(i), ''A1B2C3D4E5F60718293A4B5C6D7E8F90'');',
'    END LOOP;',
'',
'    v_json.put(''table_name'', p_table);',
'    v_json.put(''columns'', JSON_ARRAY_T());',
'    FOR i IN 1 .. v_col_cnt LOOP',
'      DECLARE',
'        v_col_obj JSON_OBJECT_T := JSON_OBJECT_T();',
'      BEGIN',
'        v_col_obj.put(''column_name'', v_columns(i).column_name);',
'        v_col_obj.put(''data_type'', v_columns(i).data_type);',
'        v_col_obj.put(''nullable'', v_columns(i).nullable);',
'        v_col_obj.put(''sample_value'', v_sample_create.get(v_columns(i).column_name));',
'        v_json.get_Array(''columns'').append(v_col_obj);',
'      END;',
'    END LOOP;',
'',
'    v_json.put(''sample_create_payload'', v_sample_create);',
'    v_json.put(''sample_update_payload'', v_sample_update);',
'    v_json.put(''sample_delete_payload'', v_sample_delete);',
'',
'    RETURN v_json.to_clob;',
'  END;',
'',
'BEGIN',
'  p_status := ''E'';',
'  p_message := NULL;',
'',
'  log_debug(''Starting procedure for mode='' || p_mode || '', table='' || p_table);',
'',
'  -- Validate mode input',
'  IF p_mode NOT IN (''C'',''U'',''D'',''F'') THEN',
'    p_message := ''Invalid mode. Allowed values: C (Create), U (Update), D (Delete), F (Fetch metadata).'';',
'    RETURN;',
'  END IF;',
'',
'  -- Load table metadata',
'  load_metadata;',
'  log_debug(''Metadata loaded: '' || v_col_cnt || '' columns, '' || v_pk_cnt || '' primary key columns.'');',
'',
'  IF p_mode = ''F'' THEN',
'    -- Return metadata JSON and sample payloads',
'    p_message := sample_payload_json;',
'    p_status := ''S'';',
'    RETURN;',
'  END IF;',
'',
'  -- Parse JSON payload',
'  v_json_obj := JSON_OBJECT_T.parse(p_payload);',
'  log_debug(''Payload parsed.'');',
'',
'  -- Validate mandatory columns if C or U',
'  IF p_mode IN (''C'', ''U'') THEN',
'    validate_mandatory_cols;',
'    log_debug(''Mandatory columns validation passed.'');',
'  END IF;',
'',
'  -- Build dynamic DML and execute with DBMS_SQL',
'  IF p_mode = ''C'' '))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'THEN',
'    -- INSERT',
'    v_sql := ''INSERT INTO '' || p_table || '' ('';',
'    FOR i IN 1 .. v_col_cnt LOOP',
'      IF v_json_obj.has(v_columns(i).column_name) THEN',
'        IF i > 1 AND v_sql NOT LIKE ''%($'' THEN',
'          v_sql := v_sql || '', '';',
'        END IF;',
'        v_sql := v_sql || v_columns(i).column_name;',
'      END IF;',
'    END LOOP;',
'    v_sql := v_sql || '') VALUES ('';',
'    FOR i IN 1 .. v_col_cnt LOOP',
'      IF v_json_obj.has(v_columns(i).column_name) THEN',
'        IF i > 1 AND v_sql NOT LIKE ''%($'' THEN',
'          v_sql := v_sql || '', '';',
'        END IF;',
'        v_sql := v_sql || '':'' || v_columns(i).column_name;',
'      END IF;',
'    END LOOP;',
'    v_sql := v_sql || '')'';',
'',
'    log_debug(''Insert SQL: '' || v_sql);',
'',
'    DBMS_SQL.PARSE(v_cursor, v_sql, DBMS_SQL.NATIVE);',
'',
'    -- Bind variables',
'    v_bind_idx := 0;',
'    FOR i IN 1 .. v_col_cnt LOOP',
'      IF v_json_obj.has(v_columns(i).column_name) THEN',
'        v_bind_idx := v_bind_idx + 1;',
'        v_col_meta := v_columns(i);',
'',
'        IF v_col_meta.data_type LIKE ''VARCHAR2%'' THEN',
'          v_col_value_varchar := v_json_obj.get_String(v_col_meta.column_name);',
'          DBMS_SQL.BIND_VARIABLE(v_cursor, '':'' || v_col_meta.column_name, v_col_value_varchar);',
'',
'        ELSIF v_col_meta.data_type LIKE ''NUMBER%'' THEN',
'          v_col_value_number := v_json_obj.get_Number(v_col_meta.column_name);',
'          DBMS_SQL.BIND_VARIABLE(v_cursor, '':'' || v_col_meta.column_name, v_col_value_number);',
'',
'        ELSIF v_col_meta.data_type LIKE ''DATE%'' THEN',
'          -- Parse ISO8601 to DATE',
'          v_col_value_varchar := v_json_obj.get_String(v_col_meta.column_name);',
'          v_col_value_date := TO_TIMESTAMP_TZ(v_col_value_varchar, ''YYYY-MM-DD"T"HH24:MI:SS.FF TZH:TZM'');',
'          DBMS_SQL.BIND_VARIABLE(v_cursor, '':'' || v_col_meta.column_name, v_col_value_date);',
'',
'        ELSIF v_col_meta.data_type = ''RAW'' THEN',
'          -- Expect 32 char hex string for UUID',
'          v_col_value_varchar := v_json_obj.get_String(v_col_meta.column_name);',
'          v_col_value_raw := hex_to_raw16(v_col_value_varchar);',
'          IF v_col_value_raw IS NULL THEN',
'            RAISE_APPLICATION_ERROR(-20003, ''Invalid UUID format for column '' || v_col_meta.column_name);',
'          END IF;',
'          DBMS_SQL.BIND_VARIABLE(v_cursor, '':'' || v_col_meta.column_name, v_col_value_raw);',
'',
'        ELSE',
'          -- Default varchar2',
'          v_col_value_varchar := v_json_obj.get_String(v_col_meta.column_name);',
'          DBMS_SQL.BIND_VARIABLE(v_cursor, '':'' || v_col_meta.column_name, v_col_value_varchar);',
'        END IF;',
'      END IF;',
'    END LOOP;',
'',
'    -- Execute statement',
'    IF DBMS_SQL.EXECUTE(v_cursor) = 1 THEN',
'      p_status := ''S'';',
'      p_message := ''Insert successful'';',
'    ELSE',
'      p_status := ''E'';',
'      p_message := ''Insert affected '' || SQL%ROWCOUNT || '' rows (expected 1).'';',
'    END IF;',
'    DBMS_SQL.CLOSE_CURSOR(v_cursor);',
'',
'  ELSIF p_mode = ''U'' THEN',
'    -- UPDATE: SET columns present in payload except PK; WHERE pk cols from payload',
'',
'    v_sql := ''UPDATE '' || p_table || '' SET '';',
'    DECLARE ',
'      v_sep BOOLEAN := FALSE;',
'    BEGIN',
'      FOR i IN 1 .. v_col_cnt LOOP',
'        IF v_json_obj.has(v_columns(i).column_name) AND NOT v_pk_cols.exists(v_pk_cols.FIRST) THEN',
'          IF v_pk_cols.exists(i) AND v_pk_cols(i) = v_columns(i).column_name THEN',
'            NULL; -- skip PK columns for SET clause',
'          ELSE',
'            IF v_sep THEN',
'              v_sql := v_sql || '', '';',
'            END IF;',
'            v_sql := v_sql || v_columns(i).column_name || '' = :'' || v_columns(i).column_name;',
'            v_sep := TRUE;',
'          END IF;',
'        END IF;',
'      END LOOP;',
'    END;',
'    -- WHERE clause with PK columns',
'    v_sql := v_sql || '' WHERE '';',
'    FOR i IN 1 .. v_pk_cnt LOOP',
'      IF i > 1 THEN',
'        v_sql := v_sql || '' AND '';',
'      END IF;',
'      v_sql := v_sql || v_pk_cols(i) || '' = :'' || v_pk_cols(i);',
'    END LOOP;',
'',
'    log_debug(''Update SQL: '' || v_sql);',
'',
'    DBMS_SQL.PARSE(v_cursor, v_sql, DBMS_SQL.NATIVE);',
'',
'    -- Bind SET columns values',
'    FOR i IN 1 .. v_col_cnt LOOP',
'      IF v_json_obj.has(v_columns(i).column_name) THEN',
'        IF v_pk_cols.EXISTS(1) AND v_pk_cols.exists(i) AND v_pk_cols(i) = v_columns(i).column_name THEN',
'          NULL; -- skip here, will bind below as PK',
'        ELSE',
'          v_col_meta := v_columns(i);',
'          IF v_col_meta.data_type LIKE ''VARCHAR2%'' THEN',
'            v_col_value_varchar := v_json_obj.get_String(v_col_meta.column_name);',
'            DBMS_SQL.BIND_VARIABLE(v_cursor, '':'' || v_col_meta.column_name, v_col_value_varchar);',
'          ELSIF v_col_meta.data_type LIKE ''NUMBER%'' THEN',
'            v_col_value_number := v_json_obj.get_Number(v_col_meta.column_name);',
'            DBMS_SQL.BIND_VARIABLE(v_cursor, '':'' || v_col_meta.column_name, v_col_value_number);',
'          ELSIF v_col_meta.data_type LIKE ''DATE%'' THEN',
'            v_col_value_varchar := v_json_obj.get_String(v_col_meta.column_name);',
'            v_col_value_date := TO_TIMESTAMP_TZ(v_col_value_varchar, ''YYYY-MM-DD"T"HH24:MI:SS.FF TZH:TZM'');',
'            DBMS_SQL.BIND_VARIABLE(v_cursor, '':'' || v_col_meta.column_name, v_col_value_date);',
'          ELSIF v_col_meta.data_type = ''RAW'' THEN',
'            v_col_value_varchar := v_json_obj.get_String(v_col_meta.column_name);',
'            v_col_value_raw := hex_to_raw16(v_col_value_varchar);',
'            IF v_col_value_raw IS NULL THEN',
'              RAISE_APPLICATION_ERROR(-20003, ''Invalid UUID format for column '' || v_col_meta.column_name);',
'            END IF;',
'            DBMS_SQL.BIND_VARIABLE(v_cursor, '':'' || v_col_meta.column_name, v_col_value_raw);',
'          ELSE',
'            v_col_value_varchar := v_json_obj.get_String(v_col_meta.column_name);',
'            DBMS_SQL.BIND_VARIABLE(v_cursor, '':'' || v_col_meta.column_name, v_col_value_varchar);',
'          END IF;',
'        END IF;',
'      END IF;',
'    END LOOP;',
'',
'    -- Bind PK columns for WHERE clause',
'    FOR i IN 1 .. v_pk_cnt LOOP',
'      v_col_meta.column_name := v_pk_cols(i);',
'      -- Push PK metadata to find data_type',
'      FOR j IN 1 .. v_col_cnt LOOP',
'        IF v_columns(j).column_name = v_col_meta.column_name THEN',
'          v_col_meta := v_columns(j);',
'          EXIT;',
'        END IF;',
'      END LOOP;',
'',
'      IF NOT v_json_obj.has(v_col_meta.column_name) THEN',
'        RAISE_APPLICATION_ERROR(-20004, ''Primary key column missing in payload for UPDATE: '' || v_col_meta.column_name);',
'      END IF;',
'',
'      IF v_col_meta.data_type LIKE ''VARCHAR2%'' THEN',
'        v_col_value_varchar := v_json_obj.get_String(v_col_meta.column_name);',
'        DBMS_SQL.BIND_VARIABLE(v_cursor, '':'' || v_col_meta.column_name, v_col_value_varchar);',
'      ELSIF v_col_meta.data_type LIKE ''NUMBER%'' THEN',
'        v_col_value_number := v_json_obj.get_Number(v_col_meta.column_name);',
'        DBMS_SQL.BIND_VARIABLE(v_cursor, '':'' || v_col_meta.column_name, v_col_value_number);',
'      ELSIF v_col_meta.data_type LIKE ''DATE%'' THEN',
'        v_col_value_varchar := v_json_obj.get_String(v_col_meta.column_name);',
'        v_col_value_date := TO_TIMESTAMP_TZ(v_col_value_varchar, ''YYYY-MM-DD"T"HH24:MI:SS.FF TZH:TZM'');',
'        DBMS_SQL.BIND_VARIABLE(v_cursor, '':'' || v_col_meta.column_name, v_col_value_date);',
'      ELSIF v_col_meta.data_type = ''RAW'' THEN',
'        v_col_value_varchar := v_json_obj.get_String(v_col_meta.column_name);',
'        v_col_value_raw := hex_to_raw16(v_col_value_varchar);',
'        IF v_col_value_raw IS NULL THEN',
'          RAISE_APPLICATION_ERROR(-20003, ''Invalid UUID format for column '' || v_col_meta.column_name);',
'        END IF;',
'        DBMS_SQL.BIND_VARIABLE(v_cursor, '':'' || v_col_meta.column_name, v_col_value_raw);',
'      ELSE',
'        v_col_value_varchar := v_json_obj.get_String(v_col_meta.column_name);',
'        DBMS_SQL.BIND_VARIABLE(v_cursor, '':'' || v_col_meta.column_name, v_col_value_varchar);',
'      END IF;',
'    END LOOP;',
'',
'    IF DBMS_SQL.EXECUTE(v_cursor) >= 0 THEN',
'      p_status := ''S'';',
'      p_message := ''Update successful.'';',
'    ELSE',
'      p_status := ''E'';',
'      p_message := ''Update affected zero rows.'';',
'    END IF;',
'    DBMS_SQL.CLOSE_CURSOR(v_cursor);',
'',
'  ELSIF p_mode = ''D'' THEN',
'    -- DELETE: WHERE clause on PK columns',
'',
'    IF v_pk_cnt = 0 THEN',
'      RAISE_APPLICATION_ERROR(-20005, ''Table '' || p_table || '' does not have a primary key; cannot delete generically.'');',
'    END IF;',
'',
'    v_sql := ''DELETE FROM '' || p_table || '' WHERE '';',
'    FOR i IN 1 .. v_pk_cnt LOOP',
'      IF i > 1 THEN',
'        v_sql := v_sql || '' AND '';',
'      END IF;',
'      v_sql := v_sql || v_pk_cols(i) || '' = :'' || v_pk_cols(i);',
'    END LOOP;',
'',
'    log_debug(''Delete SQL: '' || v_sql);',
'',
'    DBMS_SQL.PARSE(v_cursor, v_sql, DBMS_SQL.NATIVE);',
'',
'    -- Bind PK values',
'    FOR i IN 1 .. v_pk_cnt LOOP',
'      DECLARE',
'        v_col_name VARCHAR2(100) := v_pk_cols(i);',
'        v_col_type VARCHAR2(30);',
'        v_val_varchar VARCHAR2(4000);',
'        v_val_number NUMBER;',
'        v_val_date DATE;',
'        v_val_raw RAW(16);',
'      BEGIN',
'        FOR j IN 1 .. v_col_cnt LOOP',
'          IF v_columns(j).column_name = v_col_name THEN',
'            v_col_type := v_columns(j).data_type;',
'            EXIT;',
'          END IF;',
'        END LOOP;',
'',
'        IF NOT v_json_obj.has(v_col_name) THEN',
'          RAISE_APPLICATION_ERROR(-20006, ''Primary key '' || v_col_name || '' missing from payload for DELETE'');',
'        END IF;',
'',
'        IF v_col_type LIKE ''VARCHAR2%'' THEN',
'          v_val_varchar := v_json_obj.get_String(v_col_name);',
'          DBMS_SQL.BIND_VARIABLE(v_cursor, '':'' || v_col_name, v_val_varchar);',
'        ELSIF v_col_type LIKE ''NUMBER%'' THEN',
'          v_val_number := v_json_obj.get_Number(v_col_name);',
'          DBMS_SQL.BIND_VARIABLE(v_cursor, '':'' || v_col_name, v_val_number);',
'        ELSIF v_col_type LIKE ''DATE%'' THEN',
'          v_val_varchar := v_json_obj.get_String(v_col_name);',
'          v_val_date := TO_TIMESTAMP_TZ(v_val_varchar, ''YYYY-MM-DD"T"HH24:MI:SS.FF TZH:TZM'');',
'          DBMS_SQL.BIND_VARIABLE(v_cursor, '':'' || v_col_name, v_val_date);',
'        ELSIF v_col_type = ''RAW'' THEN',
'          v_val_varchar := v_json_obj.get_String(v_col_name);',
'          v_val_raw := hex_to_raw16(v_val_varchar);',
'          IF v_val_raw IS NULL THEN',
'            RAISE_APPLICATION_ERROR(-20003, ''Invalid UUID format for column '' || v_col_name);',
'          END IF;',
'          DBMS_SQL.BIND_VARIABLE(v_cursor, '':'' || v_col_name, v_val_raw);',
'        ELSE',
'          v_val_varchar := v_json_obj.get_String(v_col_name);',
'          DBMS_SQL.BIND_VARIABLE(v_cursor, '':'' || v_col_name, v_val_varchar);',
'        END IF;',
'      END;',
'    END LOOP;',
'',
'    IF DBMS_SQL.EXECUTE(v_cursor) >= 0 THEN',
'      p_status := ''S'';',
'      p_message := ''Delete successful.'';',
'    ELSE',
'      p_status := ''E'';',
'      p_message := ''Delete affected zero rows.'';',
'    END IF;',
'    DBMS_SQL.CLOSE_CURSOR(v_cursor);',
'',
'  END IF;',
'',
'EXCEPTION',
'  WHEN JSON_VALUE_ERROR THEN',
'    p_status := ''E'';',
'    p_message := ''Invalid JSON input.'';',
'  WHEN OTHERS THEN',
'    IF DBMS_SQL.IS_OPEN(v_cursor) THEN',
'      DBMS_SQL.CLOSE_CURSOR(v_cursor);',
'    END IF;',
'    p_status := ''E'';',
'    p_message := ''Error: '' || SQLERRM;',
'END generic_crud_proc;',
'/',
'create or replace PROCEDURE load_data_standalone (',
'    p_file_id         IN  NUMBER,',
'    p_template_key    IN  VARCHAR2,',
'    p_hotel_id        IN  RAW,',
'    p_collection_name IN  VARCHAR2,',
'    p_status          OUT BOOLEAN,',
'    p_message         OUT VARCHAR2',
') IS',
'    l_blob        BLOB;',
'    l_file_name   VARCHAR2(255);',
'    l_table_name  VARCHAR2(255);',
'    l_template_id RAW(16);',
'    l_log_id      RAW(16);',
'    l_apex_user   VARCHAR2(255) := NVL(v(''APP_USER''),''APEX_USER'');',
'',
'    TYPE t_map_rec IS RECORD (',
'        src_col     VARCHAR2(128),',
'        tgt_col     VARCHAR2(128),',
'        parser_col  VARCHAR2(20),',
'        data_type   VARCHAR2(50)',
'    );',
'',
'    TYPE t_map IS TABLE OF t_map_rec INDEX BY VARCHAR2(128);',
'    l_mapping t_map;',
'',
'    l_cols        VARCHAR2(32767);',
'    l_vals        VARCHAR2(32767);',
'    l_insert_vals VARCHAR2(32767);',
'    l_update_list VARCHAR2(32767);',
'    l_sql         CLOB;',
'    k             VARCHAR2(128);',
'    l_key_col     VARCHAR2(128);  -- dynamic key column (STAY_DATE)',
'BEGIN',
'    -- 0. Get file blob and name',
'    SELECT blob_content, filename',
'      INTO l_blob, l_file_name',
'      FROM temp_blob',
'     WHERE id = p_file_id;',
'',
'    -- 1. Get target table + template',
'    SELECT db_object_name, id',
'      INTO l_table_name, l_template_id',
'      FROM ur_templates',
'     WHERE upper(id) = upper(p_template_key);',
'',
'    -- 2. Insert interface log',
'    l_log_id := sys_guid();',
'    INSERT INTO ur_interface_logs(',
'        id, hotel_id, template_id, interface_type, load_start_time,',
'        load_status, created_by, updated_by, created_on, updated_on, file_id',
'    ) VALUES (',
'        l_log_id, p_hotel_id, l_template_id, ''UPLOAD'', SYSTIMESTAMP,',
'        ''IN_PROGRESS'',',
'        hextoraw(rawtohex(utl_raw.cast_to_raw(l_apex_user))),',
'        hextoraw(rawtohex(utl_raw.cast_to_raw(l_apex_user))),',
'        SYSDATE, SYSDATE, p_file_id',
'    );',
'',
'    -- 3. Load mapping from collection',
'    FOR rec IN (',
'        SELECT regexp_substr(c001, ''^[^(]+'') src_col,',
'               regexp_substr(c002, ''^[^(]+'') tgt_col,',
'               TRIM(c004) parser_col,',
'               UPPER(regexp_replace(c001, ''^[^(]+\(([^)]+)\).*'', ''\1'')) datatype',
'          FROM apex_collections',
'         WHERE collection_name = p_collection_name',
'           AND c003 = ''Maps To''',
'           AND c004 IS NOT NULL',
'    ) LOOP',
'        l_mapping(UPPER(TRIM(rec.src_col))).src_col    := TRIM(rec.src_col);',
'        l_mapping(UPPER(TRIM(rec.src_col))).tgt_col    := TRIM(rec.tgt_col);',
'        l_mapping(UPPER(TRIM(rec.src_col))).parser_col := TRIM(rec.parser_col);',
'        l_mapping(UPPER(TRIM(rec.src_col))).data_type  := TRIM(rec.datatype);',
'',
'        -- Identify key column dynamically',
'        IF UPPER(TRIM(rec.tgt_col)) = ''STAY_DATE'' THEN',
'            l_key_col := TRIM(rec.parser_col);  -- e.g., COL003',
'        END IF;',
'    END LOOP;',
'',
'    IF l_mapping.COUNT = 0 OR l_key_col IS NULL THEN',
'        RAISE_APPLICATION_ERROR(-20001,''No mapped columns or key column (STAY_DATE) found!'');',
'    END IF;',
'',
'    -- 4. Build dynamic SELECT, UPDATE, INSERT parts',
'    k := l_mapping.FIRST;',
'    WHILE k IS NOT NULL LOOP',
'        IF l_mapping.EXISTS(k) THEN',
'            -- SELECT part',
'            IF l_vals IS NOT NULL THEN l_vals := l_vals || '', ''; END IF;',
'            l_vals := l_vals || ''p.''||l_mapping(k).parser_col||'' AS "''||l_mapping(k).tgt_col||''"'';',
'',
'            -- UPDATE list (skip key columns)',
'            IF l_mapping(k).tgt_col NOT IN (''HOTEL_ID'',''STAY_DATE'') THEN',
'                IF l_update_list IS NOT NULL THEN l_update_list := l_update_list || '', ''; END IF;',
'                IF l_mapping(k).data_type = ''NUMBER'' THEN',
'                    l_update_list := l_update_list || ''"''||l_mapping(k).tgt_col||''" = CASE WHEN REGEXP_LIKE(src.''||l_mapping(k).parser_col||'',''''^-?\d+(\.\d+)?$'''') THEN TO_NUMBER(src.''||l_mapping(k).parser_col||'') ELSE NULL END'';',
'                ELSIF l_mapping(k).data_type = ''DATE'' THEN',
'                    l_update_list := l_update_list || ''"''||l_mapping(k).tgt_col||''" = TO_DATE(src.''||l_mapping(k).parser_col||'', ''''YYYY-MM-DD'''')'';',
'                ELSE',
'                    l_update_list := l_update_list || ''"''||l_mapping(k).tgt_col||''" = src.''||l_mapping(k).parser_col;',
'                END IF;',
'            END IF;',
'',
'            -- INSERT values',
'            IF l_insert_vals IS NOT NULL THEN l_insert_vals := l_insert_vals || '', ''; END IF;',
'            l_insert_vals := l_insert_vals || ''src.''||l_mapping(k).parser_col;',
'        END IF;',
'        k := l_mapping.NEXT(k);',
'    END LOOP;',
'',
'    -- Build column list for INSERT',
'    l_cols := '''';',
'    k := l_mapping.FIRST;',
'    WHILE k IS NOT NULL LOOP',
'        IF l_mapping.EXISTS(k) THEN',
'            IF l_cols IS NOT NULL AND l_cols <> '''' THEN l_cols := l_cols || '', ''; END IF;',
'            l_cols := l_cols || ''"''||l_mapping(k).tgt_col||''"'';',
'        END IF;',
'        k := l_mapping.NEXT(k);',
'    END LOOP;',
'',
'    -- 5. Build dynamic MERGE SQL',
'    l_sql := ''',
'MERGE INTO ''||l_table_name||'' tgt',
'USING (',
'    SELECT :hotel_id AS HOTEL_ID, ''||l_vals||''',
'    FROM TABLE(apex_data_parser.parse(p_content => :b1, p_file_name => :b2)) p',
'    WHERE p.line_number > 1',
') src',
'ON (tgt.HOTEL_ID = src.HOTEL_ID AND tgt."''||UPPER(l_key_col)||''" = src."''||UPPER(l_key_col)||''")',
'WHEN MATCHED THEN',
'    UPDATE SET ''||l_update_list||''',
'WHEN NOT MATCHED THEN',
'    INSERT (HOTEL_ID, ''||l_cols||'')',
'    SELECT :hotel_id, ''||l_insert_vals||'' FROM src'';',
'',
'    -- Debug log',
'    INSERT INTO debug_log(message) VALUES(''MERGE SQL: ''||l_sql);',
'    COMMIT;',
'',
'    -- 6. Execute dynamic MERGE',
'    EXECUTE IMMEDIATE l_sql',
'      USING p_hotel_id, l_blob, l_file_name;',
'',
'    -- 7. Update interface log',
'    UPDATE ur_interface_logs',
'       SET load_end_time = SYSTIMESTAMP,',
'           load_status = ''SUCCESS'',',
'           updated_by = hextoraw(rawtohex(utl_raw.cast_to_raw(l_apex_user))),',
'           updated_on = SYSDATE',
'     WHERE id = l_log_id;',
'',
'    COMMIT;',
'',
'    p_status := TRUE;',
'    p_message := ''Success: Upload completed. Rows=''||SQL%ROWCOUNT;',
'',
'EXCEPTION',
'    WHEN OTHERS THEN',
'        p_status := FALSE;',
'        p_message := ''Failure: ''||SQLERRM;',
'        INSERT INTO debug_log(message) VALUES(''ERROR: ''||SQLERRM);',
'        COMMIT;',
'',
'        UPDATE ur_interface_logs',
'           SET load_end_time = SYSTIMESTAMP,',
'               load_status = ''FAILED'',',
'               updated_by = hextoraw(rawtohex(utl_raw.cast_to_raw(l_apex_user))),',
'               updated_on = SYSDATE',
'         WHERE id = l_log_id;',
'',
'        ROLLBACK;',
'END load_data_standalone;',
'/',
'create or replace PROCEDURE load_data_t (',
'    p_file_id         IN  NUMBER,',
'    p_template_key    IN  VARCHAR2,',
'    p_hotel_id        IN  RAW,',
'    p_collection_name IN  VARCHAR2,',
'    p_status          OUT BOOLEAN,',
'    p_message         OUT VARCHAR2',
') IS',
'    l_blob        BLOB;',
'    l_file_name   VARCHAR2(255);',
'    l_table_name  VARCHAR2(255);',
'    l_template_id RAW(16);',
'    l_log_id      RAW(16);',
'    l_apex_user   VARCHAR2(255) := NVL(v(''APP_USER''),''APEX_USER'');',
'',
'    TYPE t_map_rec IS RECORD (',
'        src_col     VARCHAR2(128),',
'        tgt_col     VARCHAR2(128),',
'        parser_col  VARCHAR2(20),',
'        data_type   VARCHAR2(50)',
'    );',
'',
'    TYPE t_map IS TABLE OF t_map_rec INDEX BY VARCHAR2(128);',
'    l_mapping t_map;',
'',
'    l_cols VARCHAR2(32767);',
'    l_vals VARCHAR2(32767);',
'    l_update_list VARCHAR2(32767);',
'    l_sql CLOB;',
'    k VARCHAR2(128);',
'    l_key_col VARCHAR2(128);  -- dynamic key column (e.g., STAY_DATE)',
'BEGIN',
'    -- 0. Get file blob and name',
'    SELECT blob_content, filename',
'      INTO l_blob, l_file_name',
'      FROM temp_blob',
'     WHERE id = p_file_id;',
'',
'    -- 1. Get target table + template',
'    SELECT db_object_name, id',
'      INTO l_table_name, l_template_id',
'      FROM ur_templates',
'     WHERE upper(id) = upper(p_template_key);',
'',
'    -- 2. Insert interface log',
'    l_log_id := sys_guid();',
'    INSERT INTO ur_interface_logs(',
'        id, hotel_id, template_id, interface_type, load_start_time,',
'        load_status, created_by, updated_by, created_on, updated_on, file_id',
'    ) VALUES (',
'        l_log_id, p_hotel_id, l_template_id, ''UPLOAD'', SYSTIMESTAMP,',
'        ''IN_PROGRESS'',',
'        hextoraw(rawtohex(utl_raw.cast_to_raw(l_apex_user))),',
'        hextoraw(rawtohex(utl_raw.cast_to_raw(l_apex_user))),',
'        SYSDATE, SYSDATE, p_file_id',
'    );',
'',
'    -- 3. Load mapping from collection',
'    FOR rec IN (',
'        SELECT regexp_substr(c001, ''^[^(]+'') src_col,',
'               regexp_substr(c002, ''^[^(]+'') tgt_col,',
'               TRIM(c004) parser_col,',
'               UPPER(regexp_replace(c001, ''^[^(]+\(([^)]+)\).*'', ''\1'')) datatype',
'          FROM apex_collections',
'         WHERE collection_name = p_collection_name',
'           AND c003 = ''Maps To''',
'           AND c004 IS NOT NULL',
'    ) LOOP',
'        l_mapping(UPPER(TRIM(rec.src_col))).src_col    := TRIM(rec.src_col);',
'        l_mapping(UPPER(TRIM(rec.src_col))).tgt_col    := TRIM(rec.tgt_col);',
'        l_mapping(UPPER(TRIM(rec.src_col))).parser_col := TRIM(rec.parser_col);',
'        l_mapping(UPPER(TRIM(rec.src_col))).data_type  := TRIM(rec.datatype);',
'',
'        -- Identify key column dynamically',
'        IF UPPER(TRIM(rec.tgt_col)) = ''STAY_DATE'' THEN',
'            l_key_col := TRIM(rec.parser_col);  -- e.g., COL003',
'        END IF;',
'    END LOOP;',
'',
'    IF l_mapping.COUNT = 0 OR l_key_col IS NULL THEN',
'        RAISE_APPLICATION_ERROR(-20001,''No mapped columns or key column (STAY_DATE) found!'');',
'    END IF;',
'',
'    -- 4. Build dynamic SELECT, UPDATE, INSERT parts',
'    k := l_mapping.FIRST;',
'    WHILE k IS NOT NULL LOOP',
'        IF l_mapping.EXISTS(k) THEN',
'            -- SELECT part',
'            IF l_vals IS NOT NULL THEN l_vals := l_vals || '', ''; END IF;',
'            l_vals := l_vals || ''p.''||l_mapping(k).parser_col||'' AS "''||l_mapping(k).tgt_col||''"'';',
'',
'            -- UPDATE list (skip key columns)',
'            IF l_mapping(k).tgt_col NOT IN (''HOTEL_ID'',''STAY_DATE'') THEN',
'                IF l_update_list IS NOT NULL THEN l_update_list := l_update_list || '', ''; END IF;',
'                IF l_mapping(k).data_type = ''NUMBER'' THEN',
'                    l_update_list := l_update_list || ''"''||l_mapping(k).tgt_col||''" = CASE WHEN REGEXP_LIKE(src.''||l_mapping(k).parser_col||'',''''^-?\d+(\.\d+)?$'''') THEN TO_NUMBER(src.''||l_mapping(k).parser_col||'') ELSE NULL END'';',
'                ELSIF l_mapping(k).data_type = ''DATE'' THEN',
'                    l_update_list := l_update_list || ''"''||l_mapping(k).tgt_col||''" = TO_DATE(src.''||l_mapping(k).parser_col||'', ''''YYYY-MM-DD'''')'';',
'                ELSE',
'                    l_update_list := l_update_list || ''"''||l_mapping(k).tgt_col||''" = src.''||l_mapping(k).parser_col;',
'                END IF;',
'            END IF;',
'        END IF;',
'        k := l_mapping.NEXT(k);',
'    END LOOP;',
'',
'    -- Build column list for INSERT',
'    l_cols := '''';',
'    k := l_mapping.FIRST;',
'    WHILE k IS NOT NULL LOOP',
'        IF l_mapping.EXISTS(k) THEN',
'            IF l_cols IS NOT NULL AND l_cols <> '''' THEN l_cols := l_cols || '', ''; END IF;',
'            l_cols := l_cols || ''"''||l_mapping(k).tgt_col||''"'';',
'        END IF;',
'        k := l_mapping.NEXT(k);',
'    END LOOP;',
'',
'    -- 5. Build dynamic MERGE SQL',
'    l_sql := ''',
'MERGE INTO ''||l_table_name||'' tgt',
'USING (',
'    SELECT :hotel_id AS HOTEL_ID, ''||l_vals||''',
'    FROM TABLE(apex_data_parser.parse(p_content => :b1, p_file_name => :b2)) p',
'    WHERE p.line_number > 1',
') src',
'ON (tgt.HOTEL_ID = src.HOTEL_ID AND tgt."''||UPPER(l_key_col)||''" = src."''||UPPER(l_key_col)||''")',
'WHEN MATCHED THEN',
'    UPDATE SET ''||l_update_list||''',
'WHEN NOT MATCHED THEN',
'    INSERT (HOTEL_ID, ''||l_cols||'')',
'    VALUES (:hotel_id, ''||l_cols||'')'';',
'',
'    INSERT INTO debug_log(message) VALUES(''MERGE SQL: ''||l_sql);',
'    COMMIT;',
'',
'    -- 6. Execute dynamic MERGE',
'    EXECUTE IMMEDIATE l_sql',
'      USING p_hotel_id, l_blob, l_file_name, p_hotel_id;',
'',
'    -- 7. Update interface log',
'    UPDATE ur_interface_logs',
'       SET load_end_time = SYSTIMESTAMP,',
'           load_status = ''SUCCESS'',',
'           updated_by = hextoraw(rawtohex(utl_raw.cast_to_raw(l_apex_user))),',
'           updated_on = SYSDATE',
'     WHERE id = l_log_id;',
'',
'    COMMIT;',
'',
'    p_status := TRUE;',
'    p_message := ''Success: Upload completed. Rows=''||SQL%ROWCOUNT;',
'',
'EXCEPTION',
'    WHEN OTHERS THEN',
'        p_status := FALSE;',
'        p_message := ''Failure: ''||SQLERRM;',
'        INSERT INTO debug_log(message) VALUES(''ERROR: ''||SQLERRM);',
'        COMMIT;',
'        UPDATE ur_interface_logs',
'           SET load_end_time = SYSTIMESTAMP,',
'               load_status = ''FAILED'',',
'               updated_by = hextoraw(rawtohex(utl_raw.cast_to_raw(l_apex_user))),',
'               updated_on = SYSDATE',
'         WHERE id = l_log_id;',
'        ROLLBACK;',
'END load_data_t;',
'/',
'create or replace PROCEDURE match_templates(',
'    p_file_id      IN NUMBER,',
'    p_hotel_id     IN VARCHAR2,',
'    p_min_score    IN NUMBER DEFAULT 90,',
'    p_debug_flag   IN VARCHAR2 DEFAULT ''N'',',
'    p_output_json  OUT CLOB,',
'    p_status       OUT VARCHAR2,',
'    p_message      OUT VARCHAR2',
') IS',
'    -- Local types',
'    TYPE t_name_type_rec IS RECORD(',
'        name       VARCHAR2(100),',
'        data_type  VARCHAR2(30)',
'    );',
'    TYPE t_name_type_tab IS TABLE OF t_name_type_rec;',
'',
'    TYPE t_template_rec IS RECORD(',
'        id         VARCHAR2(50),',
'        name       VARCHAR2(200),',
'        definition t_name_type_tab',
'    );',
'    TYPE t_template_tab IS TABLE OF t_template_rec INDEX BY PLS_INTEGER;',
'',
'    -- Variables',
'    v_source_clob       CLOB;',
'    v_source_normalized CLOB;',
'    ',
'    v_target_id         VARCHAR2(50);',
'    v_target_name       VARCHAR2(200);',
'    v_target_def_clob   CLOB;',
'    v_target_normalized CLOB;',
'',
'    v_source_defs       t_name_type_tab := t_name_type_tab();',
'    v_target_defs       t_name_type_tab := t_name_type_tab();',
'',
'    v_templates         t_template_tab;',
'    v_count_templates   PLS_INTEGER := 0;',
'',
'    v_json_output       CLOB := ''['';',
'    v_min_score_use     NUMBER;',
'    v_separator         VARCHAR2(1) := '''';',
'',
'    v_match_count       NUMBER;',
'    v_score             NUMBER;',
'',
'    CURSOR c_targets IS',
'      SELECT ID, NAME, DEFINITION FROM UR_TEMPLATES WHERE hotel_id = p_hotel_id;',
'',
'    -- Debug procedure',
'    PROCEDURE debug(p_msg VARCHAR2) IS',
'    BEGIN',
'        IF UPPER(p_debug_flag) = ''Y'' THEN',
'            DBMS_OUTPUT.PUT_LINE(''[DEBUG] '' || p_msg);',
'        END IF;',
'    END;',
'',
'    -- Normalize data-type keys in JSON string (case sensitive replacement)',
'    FUNCTION normalize_json(p_json CLOB) RETURN CLOB IS',
'    BEGIN',
'        RETURN REPLACE(REPLACE(p_json, ''"data-type"'', ''"data_type"''), ''"DATA-TYPE"'', ''"data_type"'');',
'    END;',
'',
'    -- Parse definition JSON into PL/SQL collection',
'    FUNCTION parse_definition(p_clob CLOB) RETURN t_name_type_tab IS',
'        l_defs t_name_type_tab := t_name_type_tab();',
'        idx     PLS_INTEGER := 0;',
'    BEGIN',
'        FOR rec IN (',
'            SELECT lower(trim(name)) AS name, lower(trim(data_type)) AS data_type FROM JSON_TABLE(',
'                p_clob,',
'                ''$[*]'' COLUMNS (',
'                    name VARCHAR2(100) PATH ''$.name'',',
'                    data_type VARCHAR2(30) PATH ''$.data_type''',
'                )',
'            )',
'        ) LOOP',
'            idx := idx + 1;',
'            l_defs.EXTEND;',
'            l_defs(idx).name := rec.name;',
'            l_defs(idx).data_type := rec.data_type;',
'        END LOOP;',
'        RETURN l_defs;',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            RETURN NULL;',
'    END;',
'',
'    -- Count matches (name + data_type case-insensitive)',
'    FUNCTION count_matches(p_source t_name_type_tab, p_target t_name_type_tab) RETURN NUMBER IS',
'        v_count NUMBER := 0;',
'    BEGIN',
'        FOR i IN 1 .. p_source.COUNT LOOP',
'            FOR j IN 1 .. p_target.COUNT LOOP',
'                IF p_source(i).name = p_target(j).name AND p_source(i).data_type = p_target(j).data_type THEN',
'                    v_count := v_count + 1;',
'                    EXIT;',
'                END IF;',
'            END LOOP;',
'        END LOOP;',
'        RETURN v_count;',
'    END;',
'',
'BEGIN',
'    -- Validate inputs and assign to local variable',
'    v_min_score_use := NVL(p_min_score, 90);',
'    IF v_min_score_use < 0 OR v_min_score_use > 100 THEN',
'        v_min_score_use := 90;',
'    END IF;',
'',
'    IF p_file_id IS NULL THEN',
'        p_status := ''E'';',
'        p_message := ''File ID must be provided'';',
'        p_output_json := NULL;',
'        RETURN;',
'    END IF;',
'',
'    IF p_hotel_id IS NULL THEN',
'        p_status := ''E'';',
'        p_message := ''Hotel ID must be provided'';',
'        p_output_json := NULL;',
'        RETURN;',
'    END IF;',
'',
'    debug(''Starting processing...'');',
'    debug(''File ID: '' || p_file_id);',
'    debug(''Hotel ID: '' || p_hotel_id);',
'    debug(''Minimum Score: '' || v_min_score_use);',
'',
'    -- Fetch and normalize source CLOB',
'    BEGIN',
'        SELECT columns INTO v_source_clob FROM temp_blob WHERE id = p_file_id;',
'        IF v_source_clob IS NULL THEN',
'            p_status := ''E'';',
'            p_message := ''Source definition not found for file_id '' || p_file_id;',
'            p_output_json := NULL;',
'            RETURN;',
'        END IF;',
'    EXCEPTION',
'        WHEN NO_DATA_FOUND THEN',
'            p_status := ''E'';',
'            p_message := ''Source file not found for id '' || p_file_id;',
'            p_output_json := NULL;',
'            RETURN;',
'        WHEN OTHERS THEN',
'            p_status := ''E'';',
'            p_message := ''Error fetching source definition: '' || SQLERRM;',
'            p_output_json := NULL;',
'            RETURN;',
'    END;',
'',
'    v_source_normalized := normalize_json(v_source_clob);',
'',
'    -- Parse source defs',
'    v_source_defs := parse_definition(v_source_normalized);',
'    IF v_source_defs IS NULL OR v_source_defs.COUNT = 0 THEN',
'        p_status := ''E'';',
'        p_message := ''Cannot parse source definition JSON or empty definition'';',
'        p_output_json := NULL;',
'        RETURN;',
'    END IF;',
'    debug(''Parsed Source definitions: '' || v_source_defs.COUNT || '' fields'');',
'',
'    -- Initialize JSON output',
'    v_json_output := ''['';',
'    v_count_templates := 0;',
'',
'    -- Loop over target templates from cursor',
'    FOR r_target IN c_targets LOOP',
'        v_target_id := r_target.ID;',
'        v_target_name := r_target.NAME;',
'        v_target_def_clob := r_target.DEFINITION;',
'',
'        IF v_target_def_clob IS NULL THEN',
'            debug(''Skipping template '' || v_target_id || '' due to NULL definition'');',
'            CONTINUE;',
'        END IF;',
'',
'        v_target_normalized := normalize_json(v_target_def_clob);',
'',
'        v_target_defs := parse_definition(v_target_normalized);',
'        IF v_target_defs IS NULL OR v_target_defs.COUNT = 0 THEN',
'            debug(''Skipping template '' || v_target_id || '' due to parsing error or empty definition'');',
'            CONTINUE;',
'        END IF;',
'',
'        v_match_count := count_matches(v_source_defs, v_target_defs);',
'',
'        v_score := ROUND((2 * v_match_count) / (v_source_defs.COUNT + v_target_defs.COUNT) * 100);',
'',
'        debug(''Template '' || v_target_id || '' ('' || v_target_name || ''): Matches='' || ',
'              v_match_count || '', Score='' || v_score);',
'',
'        IF v_score >= v_min_score_use THEN',
'            IF v_count_templates > 0 THEN',
'                v_json_output := v_json_output || '','';',
'            END IF;',
'            v_json_output := v_json_output || ''{"Template_id":"'' || v_target_id || ',
'                            ''","Template_Na'))
);
end;
/
begin
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'me":"'' || REPLACE(v_target_name,''"'',''\"'') || ',
'                            ''","Score":'' || v_score || ''}'';',
'            v_count_templates := v_count_templates + 1;',
'        END IF;',
'    END LOOP;',
'',
'    v_json_output := v_json_output || '']'';',
'',
'    IF v_count_templates = 0 THEN',
'        p_output_json := ''[{}]'';',
'        p_message := ''No templates matched the minimum score threshold'';',
'        debug(''No matching templates found.'');',
'    ELSE',
'        p_output_json := v_json_output;',
'        p_message := ''Templates matched: '' || v_count_templates;',
'        debug(''Matching templates count: '' || v_count_templates);',
'    END IF;',
'',
'    p_status := ''S'';',
'',
'EXCEPTION',
'    WHEN OTHERS THEN',
'        p_status := ''E'';',
'        p_message := ''Unexpected error: '' || SQLERRM;',
'        p_output_json := NULL;',
'END match_templates;',
'/',
'create or replace PROCEDURE prc_insert_hotel_group IS',
'  l_payload  CLOB;',
'  l_status   VARCHAR2(10);',
'  l_message  CLOB;',
'BEGIN',
'  -- Example JSON payload',
'  l_payload := ''{',
'    "ID": "3d6da1647275228de063dd59000a9241",',
'    "GROUP_NAME": "Luxury Hotels",',
'    "CREATED_BY": "3d6da164727f228de063dd59000a9241",',
'    "UPDATED_BY": "3d6da1647281228de063dd59000a9241",',
'    "CREATED_ON": "2025-08-28",',
'    "UPDATED_ON": "2025-08-28"',
'  }'';',
'',
'  pkg_generic_crud.proc_crud_json(',
'    p_mode    => ''C'',',
'    p_table   => ''UR_HOTEL_GROUPS'',',
'    p_payload => l_payload,',
'    p_debug   => ''Y'',',
'    p_status  => l_status,',
'    p_message => l_message',
'  );',
'',
'  DBMS_OUTPUT.put_line(''Insert Status  : '' || l_status);',
'  DBMS_OUTPUT.put_line(''Insert Message : '' || l_message);',
'',
'EXCEPTION',
'  WHEN OTHERS THEN',
'    DBMS_OUTPUT.put_line(''Error in prc_insert_hotel_group: '' || SQLERRM);',
'END;',
'/',
'create or replace PROCEDURE p_generic_crud(',
'    p_mode         IN VARCHAR2,    -- ''C'', ''U'', ''D'', ''F''',
'    p_table_name   IN VARCHAR2,    -- Table name (case-insensitive)',
'    p_payload      IN CLOB,        -- JSON payload (for C/U/D)',
'    p_debug        IN VARCHAR2 DEFAULT ''N'', -- ''Y'' for debug output',
'    p_status       OUT VARCHAR2,   -- ''S'' for success, ''E'' for error',
'    p_message      OUT CLOB        -- Success/Error/Info messages or result',
') AS',
'    -- Local Variables',
'    l_sql         VARCHAR2(32767);',
'    l_cols        SYS_REFCURSOR;',
'    l_column_list VARCHAR2(4000);',
'    l_col_val_bind VARCHAR2(4000);',
'    l_primary_key_col VARCHAR2(255);',
'    l_pk_value   VARCHAR2(4000);',
'    l_bind_vars  DBMS_SQL.VARCHAR2_TABLE;',
'    l_datatype   VARCHAR2(50);',
'    l_mandatory  VARCHAR2(1);',
'    l_unique     VARCHAR2(1);',
'    l_cnt        INTEGER;',
'    -- For Fetch Mode',
'    l_json       CLOB;',
'    l_payload_json apex_json.t_values;',
'    l_idx        NUMBER;',
'    l_col_name   varchar2(255);',
'    -- Misc',
'    l_id_value   VARCHAR2(4000);',
'    l_found_pk   NUMBER;',
'    l_dynamic_sql VARCHAR2(32767);',
'',
'    -- Helper subroutines',
'    PROCEDURE debug(msg VARCHAR2) IS',
'    BEGIN',
'        IF UPPER(p_debug) = ''Y'' THEN',
'            APEX_DEBUG.MESSAGE(''[GEN_CRUD] '' || msg);',
'        END IF;',
'    END;',
'',
'    -- Fetch a single value from JSON (by key)',
'    FUNCTION json_get(payload CLOB, key VARCHAR2) RETURN VARCHAR2 IS',
'    BEGIN',
'        RETURN apex_json.get_varchar2(p_path => ''$."''||key||''"'', p_source => payload);',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            RETURN NULL;',
'    END;',
'',
'    -- Get comma-separated columns and binds for the payload, filtering only valid columns',
'    PROCEDURE build_column_lists(table_name IN VARCHAR2, payload IN CLOB, ',
'                               out_cols OUT VARCHAR2, out_vals OUT VARCHAR2, ',
'                               out_updates OUT VARCHAR2) IS',
'        l_cols_arr  apex_t_varchar2;',
'        l_vals_arr  apex_t_varchar2;',
'        l_upd_arr   apex_t_varchar2;',
'        l_sql2      VARCHAR2(2000);',
'        l_val       VARCHAR2(4000);',
'        l_col       VARCHAR2(255);',
'        l_coltype   VARCHAR2(64);',
'        l_idx       INTEGER := 1;',
'    BEGIN',
'        FOR c IN (SELECT column_name, data_type FROM user_tab_columns ',
'                    WHERE table_name = UPPER(table_name)) LOOP',
'            l_val := json_get(payload, c.column_name);',
'            IF l_val IS NOT NULL THEN',
'                l_cols_arr(l_idx) := c.column_name;',
'                l_vals_arr(l_idx) := '':''||l_idx;',
'                l_upd_arr(l_idx) := c.column_name||'' = :''||l_idx;',
'                l_idx := l_idx + 1;',
'            END IF;',
'        END LOOP;',
'        out_cols := LISTAGG(l_cols_arr, '', '');',
'        out_vals := LISTAGG(l_vals_arr, '', '');',
'        out_updates := LISTAGG(l_upd_arr, '', '');',
'    END;',
'',
'    -- Returns the primary key column for a table',
'    FUNCTION get_pk_column (table_name IN VARCHAR2) RETURN VARCHAR2 IS',
'        l_pk_col VARCHAR2(255);',
'    BEGIN',
'        SELECT column_name INTO l_pk_col',
'        FROM user_cons_columns',
'        WHERE constraint_name = (',
'            SELECT constraint_name FROM user_constraints',
'             WHERE table_name = UPPER(table_name)',
'               AND constraint_type = ''P''',
'               AND ROWNUM = 1',
'        ) AND rownum = 1;',
'        RETURN l_pk_col;',
'    EXCEPTION',
'        WHEN NO_DATA_FOUND THEN RETURN NULL;',
'    END;',
'',
'    -- Checks for required (NOT NULL and no default) columns',
'    PROCEDURE get_mandatory_columns(table_name IN VARCHAR2, out_msg OUT CLOB) IS',
'        l_json CLOB := ''{"mandatoryColumns":['';',
'        l_cnt  INTEGER := 0;',
'    BEGIN',
'        FOR c IN (SELECT column_name, data_type, data_length, nullable, data_default ',
'                    FROM user_tab_columns ',
'                    WHERE table_name = UPPER(table_name)) LOOP',
'            IF c.nullable = ''N'' AND (c.data_default IS NULL OR TRIM(c.data_default) IS NULL) THEN',
'                IF l_cnt > 0 THEN l_json := l_json || '',''; END IF;',
'                l_json := l_json || ''{"column":"'' || c.column_name || ''","data_type":"'' || c.data_type || ''"}'';',
'                l_cnt := l_cnt + 1;',
'            END IF;',
'        END LOOP;',
'        l_json := l_json || '']}'';',
'        out_msg := l_json;',
'    END;',
'',
'BEGIN',
'    -- Set debug context',
'    IF UPPER(p_debug) = ''Y'' THEN',
'        APEX_DEBUG.ENABLE;',
'        debug(''Procedure invoked in mode: ''||p_mode||'', Table=''||p_table_name);',
'    END IF;',
'',
'    IF UPPER(p_mode) = ''F'' THEN',
'        -- FETCH mode: Retrieve metadata and provide sample C/U/D example payloads',
'        l_json := ''{"fields":['';',
'        l_cnt := 0;',
'        FOR c IN (SELECT column_name, data_type, data_length, nullable, data_default ',
'                    FROM user_tab_columns WHERE table_name = UPPER(p_table_name)) LOOP',
'            IF l_cnt > 0 THEN l_json := l_json || '',''; END IF;',
'            l_json := l_json||''{"column":"''||c.column_name',
'                     ||''","data_type":"''||c.data_type',
'                     ||''","length":''||NVL(c.data_length,0)',
'                     ||'',"nullable":"''||c.nullable',
'                     ||''","default":"''||REPLACE(NVL(c.data_default,''null''),''"'',''\"'')||''"}'';',
'            l_cnt := l_cnt + 1;',
'        END LOOP;',
'        l_json := l_json || '']'';',
'',
'        -- Find PK',
'        l_primary_key_col := get_pk_column(p_table_name);',
'',
'        -- Sample Example',
'        l_json := l_json ||',
'          '',"sampleExamples":{'' ||',
'          ''"Create":"p_mode=''''C'''', p_table_name=''''''||p_table_name||'''''', p_payload={...MandatoryCols...}",'' ||',
'          ''"Update":"p_mode=''''U'''', p_table_name=''''''||p_table_name||'''''', p_payload={''||l_primary_key_col||'':<value>, ...fields...}",'' ||',
'          ''"Delete":"p_mode=''''D'''', p_table_name=''''''||p_table_name||'''''', p_payload={''||l_primary_key_col||'':<value>}"'' ||',
'          ''} }'';',
'        p_status := ''S'';',
'        p_message := l_json;',
'        RETURN;',
'    END IF;',
'',
'    -- All other modes (C/U/D) require table to exist, payload to be valid',
'    -- Find primary key column',
'    l_primary_key_col := get_pk_column(p_table_name);',
'',
'    IF l_primary_key_col IS NULL THEN',
'        p_status := ''E'';',
'        p_message := ''{"error":"Primary key not found for table ''||p_table_name||''"}'';',
'        RETURN;',
'    END IF;',
'',
'    -- Parse payload as JSON',
'    apex_json.parse(l_payload_json, p_payload);',
'    l_id_value := apex_json.get_varchar2(p_path => ''$."''||l_primary_key_col||''"'', p_values => l_payload_json);',
'',
'    IF UPPER(p_mode) = ''C'' THEN',
'        -- Gather mandatory fields',
'        debug(''Checking mandatory fields'');',
'        FOR c IN (SELECT column_name, data_type, nullable FROM user_tab_columns ',
'                   WHERE table_name = UPPER(p_table_name)) LOOP',
'            IF c.nullable=''N'' THEN',
'                l_col_name := c.column_name;',
'                IF apex_json.get_varchar2(p_path => ''$."''||l_col_name||''"'', p_values => l_payload_json) IS NULL THEN',
'                    p_status := ''E'';',
'                    p_message := ''{"error":"Mandatory field ''||l_col_name||'' is missing"}'';',
'                    RETURN;',
'                END IF;',
'            END IF;',
'        END LOOP;',
'',
'        -- Insert statement',
'        l_column_list := '''';',
'        l_col_val_bind := '''';',
'        l_idx := 1;',
'        FOR c IN (SELECT column_name FROM user_tab_columns WHERE table_name = UPPER(p_table_name)) LOOP',
'            l_col_name := c.column_name;',
'            IF apex_json.get_varchar2(p_path => ''$."''||l_col_name||''"'', p_values => l_payload_json) IS NOT NULL THEN',
'                IF l_column_list IS NOT NULL AND l_column_list <> '''' THEN',
'                    l_column_list := l_column_list || '', '';',
'                    l_col_val_bind := l_col_val_bind || '', '';',
'                END IF;',
'                l_column_list := l_column_list || l_col_name;',
'                l_col_val_bind := l_col_val_bind || '':''||l_idx;',
'                l_bind_vars(l_idx) := apex_json.get_varchar2(p_path => ''$."''||l_col_name||''"'', p_values => l_payload_json);',
'                l_idx := l_idx + 1;',
'            END IF;',
'        END LOOP;',
'',
'        l_sql := ''INSERT INTO ''||p_table_name||'' (''||l_column_list||'') VALUES (''||l_col_val_bind||'')'';',
'        debug(''Insert SQL: ''||l_sql);',
'        EXECUTE IMMEDIATE l_sql USING l_bind_vars;',
'        p_status := ''S'';',
'        p_message := ''{"msg":"Row inserted successfully","'' || l_primary_key_col || ''":"'' || l_bind_vars(1) || ''"}'';',
'        RETURN;',
'    ELSIF UPPER(p_mode) = ''U'' THEN',
'        -- Require primary key value',
'        IF l_id_value IS NULL THEN',
'            p_status := ''E'';',
'            p_message := ''{"error":"Primary key value required for Update"}'';',
'            RETURN;',
'        END IF;',
'        -- Build set clause',
'        l_column_list := '''';',
'        l_col_val_bind := '''';',
'        l_idx := 1;',
'        FOR c IN (SELECT column_name FROM user_tab_columns WHERE table_name = UPPER(p_table_name) AND column_name <> l_primary_key_col) LOOP',
'            l_col_name := c.column_name;',
'            IF apex_json.get_varchar2(p_path => ''$."''||l_col_name||''"'', p_values => l_payload_json) IS NOT NULL THEN',
'                IF l_column_list IS NOT NULL AND l_column_list <> '''' THEN',
'                    l_column_list := l_column_list || '', '';',
'                END IF;',
'                l_column_list := l_column_list || l_col_name || '' = :''||l_idx;',
'                l_bind_vars(l_idx) := apex_json.get_varchar2(p_path => ''$."''||l_col_name||''"'', p_values => l_payload_json);',
'                l_idx := l_idx + 1;',
'            END IF;',
'        END LOOP;',
'        IF l_column_list IS NULL OR l_column_list = '''' THEN',
'            p_status := ''E'';',
'            p_message := ''{"error":"No updatable fields provided"}'';',
'            RETURN;',
'        END IF;',
'',
'        l_sql := ''UPDATE ''||p_table_name||'' SET ''||l_column_list',
'                 ||'' WHERE ''||l_primary_key_col||'' = :''||l_idx;',
'        l_bind_vars(l_idx) := l_id_value;',
'        debug(''Update SQL: ''||l_sql);',
'',
'        EXECUTE IMMEDIATE l_sql USING l_bind_vars;',
'        p_status := ''S'';',
'        p_message := ''{"msg":"Row updated successfully","''||l_primary_key_col||''":"'' || l_id_value || ''"}'';',
'        RETURN;',
'    ELSIF UPPER(p_mode) = ''D'' THEN',
'        -- Require primary key value',
'        IF l_id_value IS NULL THEN',
'            p_status := ''E'';',
'            p_message := ''{"error":"Primary key value required for Delete"}'';',
'            RETURN;',
'        END IF;',
'',
'        l_sql := ''DELETE FROM ''||p_table_name||'' WHERE ''||l_primary_key_col||'' = :1'';',
'        debug(''Delete SQL: ''||l_sql);',
'',
'        EXECUTE IMMEDIATE l_sql USING l_id_value;',
'        p_status := ''S'';',
'        p_message := ''{"msg":"Row deleted successfully","''||l_primary_key_col||''":"'' || l_id_value || ''"}'';',
'        RETURN;',
'    ELSE',
'        p_status := ''E'';',
'        p_message := ''{"error":"Unsupported mode - use C,U,D,F"}'';',
'    END IF;',
'EXCEPTION',
'    WHEN OTHERS THEN',
'        p_status := ''E'';',
'        p_message := ''{"error":"''||SQLERRM||''"}'';',
'        debug(''ERROR encountered: ''||SQLERRM);',
'END p_generic_crud;',
'/',
'create or replace PROCEDURE update_template_definition (',
'    p_template_id        IN  VARCHAR2,',
'    p_collection_name    IN  VARCHAR2,',
'    p_template_type      IN  VARCHAR2 DEFAULT NULL,',
'    p_is_update          IN  VARCHAR2 DEFAULT ''N'', -- ''Y'' = update mode',
'    p_status             OUT VARCHAR2,',
'    p_message            OUT CLOB',
')',
'IS',
'    v_json         CLOB;',
'    v_ok           VARCHAR2(1);',
'    v_msg          VARCHAR2(4000);',
'    v_alerts       CLOB := NULL;',
'    v_val_status   VARCHAR2(1);',
'    v_old_json     CLOB;',
'    v_bd_object    VARCHAR2(255);',
'    v_sql          VARCHAR2(4000);',
'    v_data_count   NUMBER := 0;',
'    v_def_ok       BOOLEAN;',
'    v_def_msg      VARCHAR2(4000);',
'    v_view_ok      BOOLEAN;',
'    v_view_msg     VARCHAR2(4000);',
'    v_template_key varchar2(4000);',
'BEGIN',
unistr('    -- 1\FE0F\20E3 Get new JSON from collection'),
'    ur_utils.get_collection_json(p_collection_name, v_json, v_ok, v_msg);',
'    ur_utils.add_alert(v_alerts, ''Generated JSON: '' || v_msg, v_ok, NULL, NULL, v_alerts);',
'',
unistr('    -- 2\FE0F\20E3 Validate template JSON'),
'    ur_utils.validate_template_definition(',
'        p_json_clob  => v_json,',
'        p_alert_clob => v_alerts,',
'        p_status     => v_val_status',
'    );',
'',
unistr('    -- 3\FE0F\20E3 Fetch current template details'),
'    BEGIN',
'        SELECT definition, db_object_name, key',
'          INTO v_old_json, v_bd_object,v_template_key',
'          FROM ur_templates',
'         WHERE id = p_template_id;',
'    EXCEPTION',
'        WHEN NO_DATA_FOUND THEN',
'            ur_utils.add_alert(v_alerts, ''Template not found for ID: '' || p_template_id, ''error'', NULL, NULL, v_alerts);',
'            p_status  := ''E'';',
'            p_message := v_alerts;',
'            RETURN;',
'    END;',
'',
unistr('    -- 4\FE0F\20E3 Check if BD object has existing data'),
'    IF v_bd_object IS NOT NULL THEN',
'        v_sql := ''SELECT COUNT(*) FROM '' || v_bd_object;',
'        BEGIN',
'            EXECUTE IMMEDIATE v_sql INTO v_data_count;',
'        EXCEPTION',
'            WHEN OTHERS THEN',
'                v_data_count := 0;',
'        END;',
'    END IF;',
'',
unistr('    -- 5\FE0F\20E3 Compare JSON definitions'),
'    IF v_json = v_old_json THEN',
'        IF v_data_count > 0 THEN',
'            ur_utils.add_alert(',
'                v_alerts,',
'                ''Data exists in '' || v_bd_object || ''. Please truncate before updating. Definition is same.'',',
'                ''warning'',',
'                NULL,',
'                NULL,',
'                v_alerts',
'            );',
'        ELSE',
'            ur_utils.add_alert(',
'                v_alerts,',
'                ''Definition is same. No update required.'',',
'                ''info'',',
'                NULL,',
'                NULL,',
'                v_alerts',
'            );',
'        END IF;',
'',
'    ELSE',
'        -- Different definition',
'        IF v_data_count > 0 THEN',
'            ur_utils.add_alert(',
'                v_alerts,',
'                ''Definition is different and data exists in '' || v_bd_object || ',
'                ''. Please truncate data first before updating.'',',
'                ''warning'',',
'                NULL,',
'                NULL,',
'                v_alerts',
'            );',
'        ELSE',
unistr('            -- Definition different and no data \2192 proceed with update'),
'            UPDATE ur_templates',
'               SET definition   = v_json,',
'                   updated_on    = SYSTIMESTAMP',
'             WHERE id = p_template_id;',
'',
'            COMMIT;',
'',
'            ur_utils.add_alert(',
'                v_alerts,',
'                ''Definition updated successfully.'',',
'                ''success'',',
'                NULL,',
'                NULL,',
'                v_alerts',
'            );',
'',
unistr('            -- 6\FE0F\20E3 If update mode is ON, recreate the DB object'),
'            IF UPPER(p_is_update) = ''Y'' THEN',
'                ur_utils.define_db_object(v_template_key, v_def_ok, v_def_msg,''U'');',
'',
'                IF v_def_ok THEN',
'                    ur_utils.add_alert(v_alerts, v_def_msg, ''success'', NULL, NULL, v_alerts);',
'                ELSE',
'                    ur_utils.add_alert(v_alerts, ''DB object recreation failed: '' || v_def_msg, ''error'', NULL, NULL, v_alerts);',
'                END IF;',
'',
'                 ur_utils.manage_algo_attributes(v_template_key, ''U'', NULL, v_def_ok, v_def_msg);',
'                IF v_def_ok THEN',
'                     ur_utils.add_alert(v_alerts, v_def_msg, ''success'', null, null, v_alerts);',
'                ELSE',
'                    ur_utils.add_alert(v_alerts, v_def_msg, ''error'', null, null, v_alerts);',
'                END IF;',
'            END IF;',
'',
unistr('            -- 7\FE0F\20E3 Optional: create ranking view if RST type'),
'            IF UPPER(p_template_type) = ''RST'' THEN',
'                ur_utils.create_ranking_view(p_template_id, v_view_ok, v_view_msg);',
'                IF v_view_ok THEN',
'                    ur_utils.add_alert(v_alerts, v_view_msg, ''success'', NULL, NULL, v_alerts);',
'                ELSE',
'                    ur_utils.add_alert(v_alerts, ''Ranking view failed: '' || v_view_msg, ''warning'', NULL, NULL, v_alerts);',
'                END IF;',
'            END IF;',
'        END IF;',
'    END IF;',
'',
'    p_status  := ''S'';',
'    p_message := v_alerts;',
'',
'EXCEPTION',
'    WHEN OTHERS THEN',
'        ur_utils.add_alert(v_alerts, ''Error: '' || SQLERRM, ''error'', NULL, NULL, v_alerts);',
'        p_status  := ''E'';',
'        p_message := v_alerts;',
'END update_template_definition;',
'/',
'create or replace PROCEDURE ur_upload_file_proc (',
'    p_file_id         IN  NUMBER,',
'    p_template_key    IN  VARCHAR2,',
'    p_hotel_id        IN  RAW,',
'    p_collection_name IN  VARCHAR2,',
'    p_status          OUT BOOLEAN,',
'    p_message         OUT VARCHAR2',
') IS',
'    l_blob        BLOB;',
'    l_file_name   VARCHAR2(255);',
'    l_table_name  VARCHAR2(255);',
'    l_template_id RAW(16);',
'    l_total_rows  NUMBER := 0;',
'    l_success_cnt NUMBER := 0;',
'    l_fail_cnt    NUMBER := 0;',
'    l_log_id      RAW(16);',
'    l_error_json  CLOB := ''['';',
'    l_first_err   BOOLEAN := TRUE;',
'',
'    -- mapping record type',
'    TYPE t_map_rec IS RECORD (',
'        src_col     VARCHAR2(128),  ',
'        tgt_col     VARCHAR2(128),  ',
'        parser_col  VARCHAR2(20),   ',
'        data_type   VARCHAR2(50)',
'    );',
'    TYPE t_map IS TABLE OF t_map_rec INDEX BY VARCHAR2(128);',
'',
'    l_mapping   t_map;',
'    l_apex_user VARCHAR2(255) := NVL(v(''APP_USER''),''APEX_USER'');',
'',
'    l_cols   VARCHAR2(32767);',
'    l_vals   VARCHAR2(32767);',
'    l_sql    CLOB;',
'    k        VARCHAR2(128);',
'    v_expr   VARCHAR2(4000);',
'    l_map_count NUMBER;',
'',
'    l_existing_cnt NUMBER;',
'BEGIN',
'    -------------------------------------------------------------------',
'    -- 0. DUPLICATE CHECK',
'    -------------------------------------------------------------------',
'    SELECT COUNT(*)',
'      INTO l_existing_cnt',
'      FROM ur_interface_logs',
'     WHERE file_id     = p_file_id',
'       AND load_status = ''SUCCESS'';',
'',
'    IF l_existing_cnt > 0 THEN',
'        p_status  := FALSE;',
'        p_message := ''Failure: File ID ''||p_file_id||'' is already uploaded successfully.'';',
'        RETURN;',
'    END IF;',
'',
'    -- 1. Get blob and file name',
'    SELECT blob_content, filename',
'      INTO l_blob, l_file_name',
'      FROM temp_blob',
'     WHERE id = p_file_id;',
'',
'    -- 2. Get target table name + template id',
'    SELECT db_object_name, id',
'      INTO l_table_name, l_template_id',
'      FROM ur_templates',
'     WHERE upper(id) = upper(p_template_key);',
'',
'    -- 3. Insert log entry',
'    l_log_id := sys_guid();',
'    INSERT INTO ur_interface_logs (',
'        id, hotel_id, template_id, interface_type,',
'        load_start_time, load_status, created_by, updated_by,',
'        created_on, updated_on, file_id',
'    )',
'    VALUES (',
'        l_log_id,',
'        p_hotel_id,',
'        l_template_id,',
'        ''UPLOAD'',',
'        systimestamp,',
'        ''IN_PROGRESS'',',
'        hextoraw(rawtohex(utl_raw.cast_to_raw(l_apex_user))),',
'        hextoraw(rawtohex(utl_raw.cast_to_raw(l_apex_user))),',
'        sysdate, sysdate,',
'        p_file_id',
'    );',
'',
'    -- 4. Load mapping',
'    FOR rec IN (',
'        SELECT regexp_substr(c001, ''^[^(]+'')                    src_col,',
'               regexp_substr(c002, ''^[^(]+'')                    tgt_col,',
'               TRIM(c004)                                       parser_col,',
'               UPPER(regexp_replace(c001, ''^[^(]+\(([^)]+)\).*'', ''\1'')) datatype',
'          FROM apex_collections',
'         WHERE collection_name = p_collection_name',
'           AND c003 = ''Maps To''',
'           AND c004 IS NOT NULL',
'    ) LOOP',
'        l_mapping(UPPER(TRIM(rec.src_col))).src_col    := TRIM(rec.src_col);',
'        l_mapping(UPPER(TRIM(rec.src_col))).tgt_col    := TRIM(rec.tgt_col);',
'        l_mapping(UPPER(TRIM(rec.src_col))).parser_col := TRIM(rec.parser_col);',
'        l_mapping(UPPER(TRIM(rec.src_col))).data_type  := TRIM(rec.datatype);',
'    END LOOP;',
'',
'    l_map_count := l_mapping.count;',
'    IF l_map_count = 0 THEN',
'        RAISE_APPLICATION_ERROR(-20001, ''No mapped columns found in collection!'');',
'    END IF;',
'',
'    -- 5. Build dynamic column list and values',
'    k := l_mapping.first;',
'    WHILE k IS NOT NULL LOOP',
'        IF l_mapping.exists(k)',
'           AND l_mapping(k).tgt_col IS NOT NULL',
'           AND l_mapping(k).parser_col IS NOT NULL',
'        THEN',
'            IF l_cols IS NOT NULL THEN',
'                l_cols := l_cols || '','';',
'                l_vals := l_vals || '','';',
'            END IF;',
'',
'            l_cols := l_cols || l_mapping(k).tgt_col;',
'',
'            -- safe conversions',
'            IF l_mapping(k).data_type = ''NUMBER'' THEN',
'                v_expr := ''CASE WHEN REGEXP_LIKE(p.''|| l_mapping(k).parser_col ||'', ''''^-?\d+(\.\d+)?$'''') ''||',
'                          ''THEN TO_NUMBER(p.''|| l_mapping(k).parser_col ||'') ELSE NULL END'';',
'            ELSIF l_mapping(k).data_type = ''DATE'' THEN',
'                v_expr := ''CASE ''||',
'                          '' WHEN REGEXP_LIKE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''^\d{2}-\d{2}-\d{4}\s+\d{2}:\d{2}:\d{2}$'''') ''||',
'                          ''      THEN TO_DATE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''DD-MM-YYYY HH24:MI:SS'''') ''||',
'                          '' WHEN REGEXP_LIKE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''^\d{2}-[A-Z]{3}-\d{4}\s+\d{2}:\d{2}:\d{2}$'''', ''''i'''') ''||',
'                          ''      THEN TO_DATE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''DD-MON-YYYY HH24:MI:SS'''') ''||',
'                          '' ELSE NULL END'';',
'            ELSE',
'                v_expr := ''p.''|| l_mapping(k).parser_col;',
'            END IF;',
'',
'            l_vals := l_vals || v_expr;',
'        END IF;',
'        k := l_mapping.next(k);',
'    END LOOP;',
'',
'    ----------------------------------------------------------------',
'    -- 6. Try BULK insert, fallback to row-by-row on failure',
'    ----------------------------------------------------------------',
'    l_sql :=',
'        ''INSERT INTO ''|| l_table_name ||'' (HOTEL_ID,''|| l_cols ||'',INTERFACE_LOG_ID) ''||',
'        ''SELECT :hotel_id,''|| l_vals ||'',:log_id ''||',
'        ''  FROM TABLE(apex_data_parser.parse(p_content => :b1, p_file_name => :b2)) p ''||',
'        '' WHERE p.line_number > 1'';',
'',
'    BEGIN',
'        EXECUTE IMMEDIATE l_sql USING p_hotel_id, l_log_id, l_blob, l_file_name;',
'        l_success_cnt := SQL%ROWCOUNT;',
'        l_total_rows  := l_success_cnt;',
'exception',
'    when others then',
'        l_fail_cnt := l_fail_cnt + 1;',
'        -- build comma-separated row data dynamically',
'        declare',
'            l_rowdata   clob := '''';',
'            l_val       varchar2(4000);',
'            i           integer := 1;',
'            key         varchar2(128);',
'            l_col_count integer := 0;',
'            col_array   dbms_sql.varchar2_table;',
'            l_errmsg    varchar2(4000); -- store SQLERRM',
'        begin',
'            l_errmsg := sqlerrm; -- capture the error message',
'',
'            -- Prepare array of headers (columns) for the error row',
'            key := l_header.first;',
'            while key is not null loop',
'                l_col_count := l_col_count + 1;',
'                col_array(l_col_count) := key;',
'                key := l_header.next(key);',
'            end loop;',
'',
'            for j in 1 .. l_col_count loop',
'                execute immediate',
'                   ''begin :x := rec.'' || l_header(col_array(j)).tgt_col || ''; end;''',
'                using out l_val;',
'                if j > 1 then',
'                    l_rowdata := l_rowdata || '','';',
'                end if;',
'                l_rowdata := l_rowdata || nvl(l_val,'''');',
'            end loop;',
'',
'            if not l_first_err then',
'                l_error_json := l_error_json || '','';',
'            end if;',
'',
'            -- build JSON with PL/SQL variable l_errmsg',
'            l_error_json := l_error_json ||',
'                json_object(',
'                  ''File_ID'' value 10114138698744212,',
'                  ''Template_ID'' value l_template_id,',
'                  ''error'' value json_object(',
'                      ''Line_Number'' value rec.line_number,',
'                      ''data'' value l_rowdata,',
'                      ''message'' value l_errmsg',
'                  )',
'                );',
'',
'            l_first_err := false;',
'        end;',
'end;',
'',
'',
'    ----------------------------------------------------------------',
'    -- 7. Update log entry',
'    ----------------------------------------------------------------',
'    l_error_json := l_error_json || '']'';',
'',
'    UPDATE ur_interface_logs',
'       SET load_end_time      = systimestamp,',
'           load_status        = CASE WHEN l_fail_cnt = 0 THEN ''SUCCESS'' ELSE ''FAILED'' END,',
'           records_processed  = l_total_rows,',
'           records_successful = l_success_cnt,',
'           records_failed     = l_fail_cnt,',
'           error_json         = CASE WHEN l_fail_cnt > 0 THEN l_error_json ELSE NULL END,',
'           updated_by         = hextoraw(rawtohex(utl_raw.cast_to_raw(l_apex_user))),',
'           updated_on         = sysdate',
'     WHERE id = l_log_id;',
'',
'    COMMIT;',
'',
'    p_status  := (l_fail_cnt = 0);',
'    p_message := CASE WHEN l_fail_cnt = 0',
'                 THEN ''Success: Upload completed for File ID ''||p_file_id||',
unistr('                      '' \2192 Total=''||l_total_rows||'', Success=''||l_success_cnt'),
'                 ELSE ''Completed with errors: Total=''||l_total_rows||',
'                      '', Success=''||l_success_cnt||'', Failed=''||l_fail_cnt END;',
'',
'EXCEPTION',
'    WHEN OTHERS THEN',
'        p_status  := FALSE;',
'        p_message := ''Failure: ''||SQLERRM;',
'',
'        UPDATE ur_interface_logs',
'           SET load_end_time = systimestamp,',
'               load_status   = ''FAILED'',',
'               error_json    = l_error_json || ''{"error":"'' || REPLACE(SQLERRM,''"'','''''''') || ''"}]'',',
'               updated_on    = sysdate',
'         WHERE id = l_log_id;',
'',
'        ROLLBACK;',
'END ur_upload_file_proc;',
'/',
'create or replace PROCEDURE validate_or_clean_expression (',
'    p_expression IN VARCHAR2,',
'    p_mode IN CHAR,',
'    p_hotel_id IN VARCHAR2,',
'    p_status OUT VARCHAR2, -- ''S'' or ''E''',
'    p_message OUT VARCHAR2',
') IS',
'  TYPE t_str_list IS TABLE OF VARCHAR2(100) INDEX BY PLS_INTEGER;',
'  v_attributes t_str_list;',
'  v_functions t_str_list;',
'  v_operators t_str_list;',
'  v_attr_count NUMBER := 0;',
'  v_func_count NUMBER := 0;',
'  v_oper_count NUMBER := 0;',
'',
'  TYPE t_token_rec IS RECORD (',
'    token VARCHAR2(4000),',
'    start_pos PLS_INTEGER,',
'    end_pos PLS_INTEGER',
'  );',
'  TYPE t_token_tab IS TABLE OF t_token_rec INDEX BY PLS_INTEGER;',
'  v_tokens t_token_tab;',
'  v_token_count PLS_INTEGER := 0;',
'',
'  TYPE t_token_tab_nt IS TABLE OF VARCHAR2(100) INDEX BY PLS_INTEGER;',
'  v_unmatched_tokens t_token_tab;',
'  v_unmatched_count PLS_INTEGER := 0;',
'',
'  -- To mark tokens consumed by multi-word operators',
'  TYPE t_bool_tab IS TABLE OF BOOLEAN INDEX BY PLS_INTEGER;',
'  v_token_consumed t_bool_tab;',
'',
'  v_mode CHAR := UPPER(p_mode);',
'',
'  -- Trim and uppercase token helper',
'  FUNCTION normalize_token(p_token VARCHAR2) RETURN VARCHAR2 IS',
'  BEGIN',
'    RETURN UPPER(TRIM(p_token));',
'  END;',
'',
'  -- Strip function parameters, e.g. "ROUND (n,d)" -> "ROUND"',
'  FUNCTION normalize_func_name(p_func VARCHAR2) RETURN VARCHAR2 IS',
'  BEGIN',
'    RETURN REGEXP_REPLACE(UPPER(TRIM(p_func)), ''\s*\(.*\)$'');',
'  END;',
'',
'  -- Checks if token is numeric',
'  FUNCTION is_number(p_token VARCHAR2) RETURN BOOLEAN IS',
'  BEGIN',
'    RETURN REGEXP_LIKE(p_token, ''^[+-]?(\d+(\.\d*)?|\.\d+)([Ee][+-]?\d+)?$'');',
'  END;',
'',
'  -- Check presence in list',
'  FUNCTION is_in_list(p_token VARCHAR2, p_list t_str_list, cnt NUMBER) RETURN BOOLEAN IS',
'  BEGIN',
'    FOR i IN 1..cnt LOOP',
'      IF p_list(i) = p_token THEN',
'        RETURN TRUE;',
'      END IF;',
'    END LOOP;',
'    RETURN FALSE;',
'  END;',
'',
'  -- Check if token valid: attribute, operator, function, number, parentheses',
'  FUNCTION is_token_valid(p_token VARCHAR2) RETURN BOOLEAN IS',
'    l_token VARCHAR2(100) := p_token;',
'  BEGIN',
'    -- Parentheses always valid tokens',
'    IF l_token IN (''('', '')'') THEN',
'      RETURN TRUE;',
'    END IF;',
'',
'    -- Strip trailing ''('' from function calls',
'    IF SUBSTR(l_token, -1) = ''('' THEN',
'      l_token := SUBSTR(l_token, 1, LENGTH(l_token) - 1);',
'    END IF;',
'',
'    -- Check if number',
'    IF is_number(l_token) THEN',
'      RETURN TRUE;',
'    END IF;',
'',
'    l_token := normalize_token(l_token);',
'',
'    IF is_in_list(l_token, v_attributes, v_attr_count) THEN',
'      RETURN TRUE;',
'    ELSIF is_in_list(l_token, v_functions, v_func_count) THEN',
'      RETURN TRUE;',
'    ELSIF is_in_list(l_token, v_operators, v_oper_count) THEN',
'      RETURN TRUE;',
'    END IF;',
'',
'    RETURN FALSE;',
'  END;',
'',
'  PROCEDURE load_functions(p_list OUT t_str_list, p_count OUT NUMBER) IS',
'  BEGIN',
'    p_list.DELETE;',
'    p_count := 0;',
'    FOR r IN (',
'      SELECT return_value FROM apex_application_lov_entries',
'      WHERE list_of_values_name = ''UR EXPRESSION FUNCTIONS''',
'      ORDER BY return_value',
'    ) LOOP',
'      p_count := p_count + 1;',
'      p_list(p_count) := normalize_func_name(r.return_value);',
'    END LOOP;',
'    IF p_count = 0 THEN',
'      RAISE_APPLICATION_ERROR(-20010, ''Functions LOV missing or empty'');',
'    END IF;',
'  END;',
'',
'  PROCEDURE load_'))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'operators(p_list OUT t_str_list, p_count OUT NUMBER) IS',
'  BEGIN',
'    p_list.DELETE;',
'    p_count := 0;',
'    FOR r IN (',
'      SELECT return_value FROM apex_application_lov_entries',
'      WHERE list_of_values_name = ''UR EXPRESSION OPERATORS''',
'      ORDER BY return_value',
'    ) LOOP',
'      p_count := p_count + 1;',
'      p_list(p_count) := UPPER(TRIM(r.return_value));',
'    END LOOP;',
'    IF p_count = 0 THEN',
'      RAISE_APPLICATION_ERROR(-20011, ''Operators LOV missing or empty'');',
'    END IF;',
'  END;',
'',
'  PROCEDURE load_attributes(p_hotel_id IN VARCHAR2, p_list OUT t_str_list, p_count OUT NUMBER) IS',
'  BEGIN',
'    p_list.DELETE;',
'    p_count := 0;',
'    FOR r IN (',
'      SELECT key FROM ur_algo_attributes WHERE hotel_id = p_hotel_id',
'    ) LOOP',
'      p_count := p_count + 1;',
'      p_list(p_count) := UPPER(TRIM(r.key));',
'    END LOOP;',
'    IF p_count = 0 THEN',
'      RAISE_APPLICATION_ERROR(-20012, ''Attributes missing for hotel_id '' || p_hotel_id);',
'    END IF;',
'  END;',
'',
'  -- Tokenizer splitting expression into tokens, tracking start/end pos',
'  PROCEDURE tokenize_expression(p_expr IN VARCHAR2, p_tokens OUT t_token_tab, p_count OUT NUMBER) IS',
'    l_pos PLS_INTEGER := 1;',
'    l_len PLS_INTEGER := LENGTH(p_expr);',
'    l_token VARCHAR2(4000);',
'    l_token_start PLS_INTEGER;',
'    l_token_end PLS_INTEGER;',
'  BEGIN',
'    p_tokens.DELETE;',
'    p_count := 0;',
'    WHILE l_pos <= l_len LOOP',
'      l_token := REGEXP_SUBSTR(p_expr,',
'        ''([A-Za-z0-9_\.]+|\d+(\.\d+)?|\(|\)|\S)'',',
'        l_pos,',
'        1,',
'        ''i'');',
'      EXIT WHEN l_token IS NULL;',
'      l_token_start := INSTR(p_expr, l_token, l_pos);',
'      l_token_end := l_token_start + LENGTH(l_token) - 1;',
'      p_count := p_count + 1;',
'      p_tokens(p_count) := t_token_rec(token => l_token, start_pos => l_token_start, end_pos => l_token_end);',
'      l_pos := l_token_end + 1;',
'      WHILE l_pos <= l_len AND SUBSTR(p_expr, l_pos, 1) = '' '' LOOP',
'        l_pos := l_pos + 1;',
'      END LOOP;',
'    END LOOP;',
'  END;',
'',
'  FUNCTION build_json_errors(p_unmatched t_token_tab, p_count PLS_INTEGER) RETURN VARCHAR2 IS',
'    v_json VARCHAR2(4000) := ''['';',
'  BEGIN',
'    IF p_count = 0 THEN',
'      RETURN ''[]'';',
'    END IF;',
'    FOR i IN 1..p_count LOOP',
'      v_json := v_json || ''{"token":"'' || p_unmatched(i).token ||',
'                ''","start":'' || p_unmatched(i).start_pos ||',
'                '',"end":'' || p_unmatched(i).end_pos || ''}'';',
'      IF i < p_count THEN',
'        v_json := v_json || '','';',
'      END IF;',
'    END LOOP;',
'    v_json := v_json || '']'';',
'    RETURN v_json;',
'  END;',
'',
'  -- Return number of consecutive tokens matched as an operator starting at start_idx',
'  FUNCTION get_longest_operator_match(start_idx IN PLS_INTEGER) RETURN PLS_INTEGER IS',
'    combined VARCHAR2(4000);',
'    max_words CONSTANT PLS_INTEGER := 4; -- max operator words count',
'    words_count PLS_INTEGER;',
'    l_len PLS_INTEGER := LEAST(max_words, v_token_count - start_idx + 1);',
'    i PLS_INTEGER;',
'  BEGIN',
'    FOR words_count IN REVERSE 1 .. l_len LOOP',
'      combined := '''';',
'      FOR i IN start_idx .. start_idx + words_count - 1 LOOP',
'        IF combined IS NULL OR combined = '''' THEN',
'          combined := UPPER(TRIM(v_tokens(i).token));',
'        ELSE',
'          combined := combined || '' '' || UPPER(TRIM(v_tokens(i).token));',
'        END IF;',
'      END LOOP;',
'      IF is_in_list(combined, v_operators, v_oper_count) THEN',
'        RETURN words_count;',
'      END IF;',
'    END LOOP;',
'    RETURN 0;',
'  END;',
'',
'BEGIN',
'  p_status := ''E'';',
'  p_message := NULL;',
'',
'  IF v_mode NOT IN (''V'', ''C'') THEN',
'    p_status := ''E'';',
'    p_message := ''Invalid mode "'' || p_mode || ''". Valid are V or C.'';',
'    RETURN;',
'  END IF;',
'',
'  IF p_hotel_id IS NULL THEN',
'    p_status := ''E'';',
'    p_message := ''hotel_id is mandatory'';',
'    RETURN;',
'  END IF;',
'',
'  IF p_expression IS NULL OR LENGTH(TRIM(p_expression)) = 0 THEN',
'    p_status := ''E'';',
'    p_message := ''Expression is empty'';',
'    RETURN;',
'  END IF;',
'',
'  load_functions(v_functions, v_func_count);',
'  load_operators(v_operators, v_oper_count);',
'  load_attributes(p_hotel_id, v_attributes, v_attr_count);',
'',
'  tokenize_expression(p_expression, v_tokens, v_token_count);',
'',
'  -- Initialize consumed array',
'  v_token_consumed.DELETE;',
'',
'  DECLARE',
'    i PLS_INTEGER := 1;',
'    words_matched PLS_INTEGER := 0;',
'  BEGIN',
'    WHILE i <= v_token_count LOOP',
'      words_matched := get_longest_operator_match(i);',
'      IF words_matched > 0 THEN',
'        FOR j IN i .. i + words_matched - 1 LOOP',
'          v_token_consumed(j) := TRUE;',
'        END LOOP;',
'        i := i + words_matched;',
'      ELSE',
'        -- Single token valid check',
'        v_token_consumed(i) := is_token_valid(normalize_token(v_tokens(i).token));',
'        i := i + 1;',
'      END IF;',
'    END LOOP;',
'  END;',
'',
'  IF v_mode = ''V'' THEN',
'    v_unmatched_tokens.DELETE;',
'    v_unmatched_count := 0;',
'    FOR i IN 1 .. v_token_count LOOP',
'      IF v_token_consumed.EXISTS(i) AND v_token_consumed(i) = FALSE THEN',
'        v_unmatched_count := v_unmatched_count + 1;',
'        v_unmatched_tokens(v_unmatched_count) := v_tokens(i);',
'      END IF;',
'    END LOOP;',
'',
'    IF v_unmatched_count > 0 THEN',
'      p_status := ''E'';',
'      p_message := ''Invalid tokens: '' || build_json_errors(v_unmatched_tokens, v_unmatched_count);',
'    ELSE',
'      p_status := ''S'';',
'      p_message := ''Expression validated successfully.'';',
'    END IF;',
'',
'  ELSIF v_mode = ''C'' THEN',
'    p_status := ''S'';',
'    p_message := '''';',
'    FOR i IN 1..v_token_count LOOP',
'      IF v_token_consumed.EXISTS(i) AND v_token_consumed(i) = TRUE THEN',
'        p_message := p_message || v_tokens(i).token || '' '';',
'      END IF;',
'    END LOOP;',
'    p_message := RTRIM(p_message);',
'  END IF;',
'',
'EXCEPTION',
'  WHEN OTHERS THEN',
'    p_status := ''E'';',
'    p_message := ''Failure: '' || SQLERRM;',
'END validate_or_clean_expression;',
'/',
'create or replace PROCEDURE xxpel_parse_error_json (',
'    p_json_clob      IN  CLOB,',
'    p_collection_name IN VARCHAR2 DEFAULT ''ERROR_COLLECTION'',',
'    p_ai_message     OUT CLOB,',
'    p_status         OUT VARCHAR2',
') AS',
'    l_json_data   JSON_ARRAY_T;',
'    l_obj         JSON_OBJECT_T;',
'    l_error_obj   JSON_OBJECT_T;',
'    l_file_id     VARCHAR2(50);',
'    l_template_id VARCHAR2(100);',
'    l_line_no     NUMBER;',
'    l_message     VARCHAR2(4000);',
'    l_count       PLS_INTEGER := 0;',
'BEGIN',
'    -- Drop and recreate collection',
'    IF apex_collection.collection_exists(p_collection_name) THEN',
'        apex_collection.delete_collection(p_collection_name);',
'    END IF;',
'',
'    apex_collection.create_collection(p_collection_name);',
'',
'    -- Parse the JSON array',
'    l_json_data := JSON_ARRAY_T.parse(p_json_clob);',
'',
'    FOR i IN 0 .. l_json_data.get_size - 1 LOOP',
'        l_obj := TREAT(l_json_data.get(i) AS JSON_OBJECT_T);',
'',
'        l_file_id     := l_obj.get_string(''File_ID'');',
'        l_template_id := l_obj.get_string(''Template_ID'');',
'        l_error_obj   := l_obj.get_object(''error'');',
'        l_line_no     := l_error_obj.get_number(''Line_Number'');',
'        l_message     := l_error_obj.get_string(''message'');',
'',
'        apex_collection.add_member(',
'            p_collection_name => p_collection_name,',
'            p_c001 => l_file_id,',
'            p_c002 => l_template_id,',
'            p_c003 => TO_CHAR(l_line_no),',
'            p_c004 => l_message',
'        );',
'',
'        l_count := l_count + 1;',
'    END LOOP;',
'',
'    -- Status and AI message logic',
'    IF l_count > 0 THEN',
'        p_status := ''S'';',
'        p_ai_message := ''Parsed '' || l_count || '' errors successfully.'';',
'    ELSE',
'        p_status := ''W'';',
'        p_ai_message := ''No errors found in the JSON input.'';',
'    END IF;',
'',
'EXCEPTION',
'    WHEN OTHERS THEN',
'        p_status := ''E'';',
'        p_ai_message := ''Error while parsing JSON: '' || SQLERRM;',
'END;',
'/',
'create or replace PROCEDURE XX_LOCAL_Load_Data (',
'    p_file_id         IN  NUMBER,',
'    p_template_key    IN  VARCHAR2,',
'    p_hotel_id        IN  RAW,',
'    p_collection_name IN  VARCHAR2,',
'    p_status          OUT varchar2,',
'    p_message         OUT VARCHAR2',
') IS',
'    l_blob        BLOB;',
'    l_file_name   VARCHAR2(2550);',
'    l_table_name  VARCHAR2(2550);',
'    l_template_id RAW(16);',
'    l_total_rows  NUMBER := 0;',
'    l_success_cnt NUMBER := 0;',
'    l_fail_cnt    NUMBER := 0;',
'    l_log_id      RAW(16);',
'    l_error_json  CLOB := ''['';',
'    l_first_err   BOOLEAN := TRUE;',
'    l_collection_name VARCHAR2(2550);',
'    l_debug boolean := FALSE;',
'        -- Dynamic headers',
'    TYPE t_headers IS TABLE OF VARCHAR2(4000) INDEX BY PLS_INTEGER;',
'    v_headers      t_headers;',
'    v_col_count    PLS_INTEGER := 0;',
'',
'    -- JSON / dynamic variables',
'    v_profile_clob CLOB;',
'    v_sql_json     CLOB;',
'    c              SYS_REFCURSOR;',
'    v_row_json     CLOB;',
'    v_line_number  NUMBER;',
'',
'    -- Row processing',
'  ',
'    l_vals         VARCHAR2(32767);',
'    l_set          VARCHAR2(32767);',
'    l_stay_col_name VARCHAR2(200);',
'    l_stay_val     VARCHAR2(4000);',
'',
'    -- mapping record type',
'    TYPE t_map_rec IS RECORD (',
'        src_col     VARCHAR2(32000),  ',
'        tgt_col     VARCHAR2(32000),  ',
'        parser_col  VARCHAR2(32000),   ',
'        data_type   VARCHAR2(1000),',
'        map_type    VARCHAR2(1000)',
'    );',
'    TYPE t_map IS TABLE OF t_map_rec INDEX BY VARCHAR2(32000);',
'',
'    l_mapping   t_map;',
'    l_apex_user VARCHAR2(255) := NVL(v(''APP_USER''),''APEX_USER'');',
'',
'    l_cols   VARCHAR2(32767);',
'     l_cols_JSON   VARCHAR2(32767);',
'    l_vals_CALCULATION   VARCHAR2(32767);',
'    l_sql    CLOB;',
'    k        VARCHAR2(32000);',
'    v_expr   VARCHAR2(32000);',
'    l_map_count NUMBER;',
'',
'    -- ADDED: variable for duplicate check',
'    l_existing_cnt NUMBER;',
'    l_error varchar2(32000);',
'BEGIN',
'    -------------------------------------------------------------------',
'    -- 0. DUPLICATE CHECK: stop if file already uploaded successfully',
'    -------------------------------------------------------------------',
'    SELECT COUNT(*)',
'      INTO l_existing_cnt',
'      FROM ur_interface_logs',
'     WHERE file_id   = p_file_id',
'       AND load_status = ''SUCCESS'';',
'',
'    IF l_existing_cnt > 0 THEN',
'        p_status  := ''E'';',
'        p_message := ''Failure: File is already uploaded successfully.'';',
'        RETURN;',
'    END IF;',
'',
'    -- 1. Get blob and file name',
'    SELECT blob_content, filename',
'      INTO l_blob, l_file_name',
'      FROM temp_blob',
'     WHERE id = p_file_id;',
'     ',
'     /*',
'    IF l_file_name < 0 THEN',
'        p_status  := FALSE;',
'        p_message := ''Failure: File ID ''||p_file_id||'' is already uploaded successfully.'';',
'        RETURN;',
'    END IF;*/',
'',
'    -- 2. Get target table name + template id',
'    SELECT db_object_name, id',
'      INTO l_table_name, l_template_id',
'      FROM ur_templates',
'     WHERE upper(id) = upper(p_template_key);',
'',
'    -- 3. Insert log entry',
'    l_log_id := sys_guid();',
'    INSERT INTO ur_interface_logs (',
'        id, hotel_id, template_id, interface_type,',
'        load_start_time, load_status, created_by, updated_by,',
'        created_on, updated_on, file_id',
'    )',
'    VALUES (',
'        l_log_id,',
'        p_hotel_id,',
'        l_template_id,',
'        ''UPLOAD'',',
'        systimestamp,',
'        ''IN_PROGRESS'',',
'        hextoraw(rawtohex(utl_raw.cast_to_raw(l_apex_user))),',
'        hextoraw(rawtohex(utl_raw.cast_to_raw(l_apex_user))),',
'        sysdate, sysdate,',
'        p_file_id',
'    );',
'',
'       BEGIN',
'        SELECT jt.name',
'          INTO l_stay_col_name',
'          FROM ur_templates t,',
'               JSON_TABLE(',
'                 t.definition,',
'                 ''$[*]''',
'                 COLUMNS (',
'                   name       VARCHAR2(200) PATH ''$.name'',',
'                   qualifier  VARCHAR2(200) PATH ''$.qualifier''',
'                 )',
'               ) jt',
'         WHERE t.id = l_template_id',
'           AND UPPER(jt.qualifier) = ''STAY_DATE''',
'         FETCH FIRST 1 ROWS ONLY;',
'        INSERT INTO debug_log(message) VALUES(''Found STAY_DATE column in template: '' || l_stay_col_name);',
'    EXCEPTION',
'        WHEN NO_DATA_FOUND THEN',
'            l_stay_col_name := NULL;',
'            INSERT INTO debug_log(message) VALUES(''No STAY_DATE configured in template'');',
'    END;',
'--l_stay_col_name := TO_CHAR(TO_DATE(l_stay_col_name,''DD/MM/YYYY''),''DD/MM/YYYY'');',
'',
'        -- 4. Load mapping directly from collection',
'    FOR rec IN (',
'        SELECT regexp_substr(c001, ''^[^(]+'')                    src_col,',
'               regexp_substr(c002, ''^[^(]+'')                    tgt_col,',
'               CASE WHEN c003 = ''Maps To'' THEN regexp_substr(c002, ''^[^(]+'') ',
'               WHEN  c003 in (''Default'',''Calculation'')  THEN TRIM(c004)  END                                    parser_col,',
'               c003                                             map_type,',
'             --  UPPER(regexp_replace(c001, ''^[^(]+\(([^)]+)\).*'', ''\1'')) datatype',
'               (select DATA_TYPE from all_tab_cols where ',
'               TABLE_NAME like (select db_object_name from ur_templates where id = l_template_id)',
'               and upper(COLUMN_NAME) like upper(TRIM(regexp_substr(c002, ''^[^(]+'')))   ) datatype1',
'          FROM apex_collections',
'         WHERE collection_name = p_collection_name',
'       --   AND c003 in (''Maps To'',''Default'')',
'          -- AND c004 IS NOT NULL',
'    ) LOOP ',
' ',
'        l_mapping(UPPER(TRIM(rec.src_col))).src_col    := TRIM(rec.src_col);',
'        l_mapping(UPPER(TRIM(rec.src_col))).tgt_col    := TRIM(rec.tgt_col);',
'        l_mapping(UPPER(TRIM(rec.src_col))).parser_col := TRIM(rec.parser_col);',
'        l_mapping(UPPER(TRIM(rec.src_col))).data_type  := rec.datatype1;',
'        l_mapping(UPPER(TRIM(rec.src_col))).map_type  := TRIM(rec.map_type);',
'        INSERT INTO debug_log(message) VALUES(''rec.src_col: '' || rec.src_col);',
'        INSERT INTO debug_log(message) VALUES(''rec.tgt_col : '' || rec.tgt_col);',
'        INSERT INTO debug_log(message) VALUES(''rec.parser_col : '' || rec.parser_col);',
'        INSERT INTO debug_log(message) VALUES(''rec.map_type : '' || rec.map_type);',
'        INSERT INTO debug_log(message) VALUES(''rec.data_type-----> : '' ||rec.datatype1);',
'    commit;',
'    END LOOP;',
'INSERT INTO debug_log(message) VALUES(''l_template_id: '' || l_template_id);',
'    l_map_count := l_mapping.count;',
'    IF l_map_count = 0 THEN',
'        RAISE_APPLICATION_ERROR(-20001, ''No mapped columns found in collection!'');',
'    END IF;',
'',
'    -- 5. Build dynamic column list and values',
'    k := l_mapping.first;',
'    WHILE k IS NOT NULL LOOP',
'        IF l_mapping.exists(k)',
'           AND l_mapping(k).tgt_col IS NOT NULL',
'           --AND l_mapping(k).parser_col IS NOT NULL',
'        THEN',
'                    IF l_cols IS NOT NULL THEN',
'                        l_cols := l_cols || '','';',
'                        l_vals_calculation := l_vals_calculation || '','';',
'                    END IF;',
'',
'                    l_cols := l_cols || l_mapping(k).tgt_col;',
'',
'                    IF l_mapping(k).map_type = ''Default'' THEN',
'                        v_expr :=   l_mapping(k).parser_col ||'' AS '' || l_mapping(k).tgt_col;',
'                        ',
'                    ELSIF l_mapping(k).map_type = ''Calculation'' THEN',
'                        v_expr := REGEXP_REPLACE(',
'                                                 l_mapping(k).parser_col,',
'                                                 ''#[^.]+\.(\w+)#'',',
'                                                 ''p.\1''',
'                                               ) ;',
'                        v_expr := GET_MAP_CALCULATION_FUN(v_expr,p_collection_name)||'' AS '' || l_mapping(k).tgt_col;                                             ',
'',
'                    ELSE    ',
'                            -- safe conversions',
'                            IF l_mapping(k).data_type = ''NUMBER'' THEN  ',
'                               -- v_expr := ''CASE WHEN REGEXP_LIKE(p.''|| l_mapping(k).parser_col ||'', ''''^-?\d+(\.\d+)?$'''') ''||',
'                               --           ''THEN TO_NUMBER(p.''|| l_mapping(k).parser_col ||'') ELSE NULL END''; ',
'                                v_expr := ''CASE WHEN REGEXP_LIKE(p.''|| l_mapping(k).parser_col ||'', ''''^-?\d+(\.\d+)?$'''') ''||',
'                                         ''THEN TO_NUMBER(p.''|| l_mapping(k).parser_col ||'' DEFAULT NULL ON CONVERSION ERROR) ELSE NULL END  as '' || l_mapping(k).parser_col ||'' '';           ',
'',
'                                /*v_expr := ',
'    ''CASE ',
'        WHEN REGEXP_LIKE(p.'' || l_mapping(k).parser_col || ',
'        '', ''''^-?(\d+(\.\d+)?|\.\d+)$'''') ',
'        THEN TO_NUMBER(p.'' || l_mapping(k).parser_col || ',
'        '' DEFAULT NULL ON CONVERSION ERROR) ',
'        ELSE NULL ',
'     END AS '' || l_mapping(k).parser_col;*/',
'',
'',
'',
'                            ELSIF l_mapping(k).data_type = ''DATE'' THEN',
'                                v_expr := ''CASE ''||',
'                              -- Full datetime with DD-MM-YYYY',
'                              '' WHEN REGEXP_LIKE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''^\d{2}-\d{2}-\d{4}\s+\d{2}:\d{2}:\d{2}$'''') ''||',
'                              ''      THEN TO_DATE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''DD-MM-YYYY HH24:MI:SS'''') ''||',
'',
'                              -- Full datetime with DD/MM/YYYY',
'                              '' WHEN REGEXP_LIKE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''^\d{2}/\d{2}/\d{4}\s+\d{2}:\d{2}:\d{2}$'''') ''||',
'                              ''      THEN TO_DATE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''DD/MM/YYYY HH24:MI:SS'''') ''||',
'',
'                              -- Full datetime with DD-MON-YYYY (your case)',
'                              '' WHEN REGEXP_LIKE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''^\d{2}-[A-Z]{3}-\d{4}\s+\d{2}:\d{2}:\d{2}$'''', ''''i'''') ''||',
'                              ''      THEN TO_DATE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''DD-MON-YYYY HH24:MI:SS'''') ''||',
'',
'                              -- Just date YYYY-MM-DD',
'                              '' WHEN REGEXP_LIKE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''^\d{4}-\d{2}-\d{2}$'''') ''||',
'                              ''      THEN TO_DATE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''YYYY-MM-DD'''') ''||',
'',
'                              -- Just date DD/MM/YYYY',
'                              '' WHEN REGEXP_LIKE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''^\d{2}/\d{2}/\d{4}$'''') ''||',
'                              ''      THEN TO_DATE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''DD/MM/YYYY'''') ''||',
'',
'                              -- Just date DD-MM-YYYY',
'                              '' WHEN REGEXP_LIKE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''^\d{2}-\d{2}-\d{4}$'''') ''||',
'                              ''      THEN TO_DATE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''DD-MM-YYYY'''') ''||',
'',
'                              -- Just date DD-MON-YYYY',
'                              '' WHEN REGEXP_LIKE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''^\d{2}-[A-Z]{3}-\d{4}$'''', ''''i'''') ''||',
'                              ''      THEN TO_DATE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''DD-MON-YYYY'''') ''||',
'',
'                              -- Fallback',
'                              '' ELSE NULL END as '' || l_mapping(k).parser_col ||'' '';',
'',
'                                INSERT INTO debug_log(message) VALUES(''v_expr: '' || v_expr);',
'',
'                            ELSE',
'                                v_expr := ''p.''|| l_mapping(k).parser_col;',
'                                INSERT INTO debug_log(message) VALUES(''v_expr: '' || v_expr);',
'                   ',
'                            END IF;',
'                        END IF;',
'',
'                    l_vals_calculation := l_vals_calculation || v_expr;',
'         END IF;',
'        k := l_mapping.next(k);',
'    END LOOP;',
'INSERT INTO debug_log(message) VALUES(''l_cols: '' || l_cols);',
'INSERT INTO debug_log(message) VALUES(''l_vals_calculation: '' || l_vals_calculation);',
'commit;',
'',
'     -------------------------------------------------------------------',
'    -- 4. Discover file profile',
'    -------------------------------------------------------------------',
'    v_profile_clob := apex_data_parser.discover(',
'                         p_content   => l_blob,',
'                         p_file_name => l_file_name',
'                      );',
'',
'    INSERT INTO debug_log(message) VALUES(''apex_data_parser.discover done'');',
'',
'    -------------------------------------------------------------------',
'    -- 5. Insert initial log row',
'    -------------------------------------------------------------------',
'    l_log_id := sys_guid();',
'    INSERT INTO ur_interface_logs (',
'        id, hotel_id, template_id, interface_type,',
'        load_start_time, load_status, created_by, updated_by,',
'        created_on, updated_on, file_id',
'    )',
'    VALUES (',
'        l_log_id,',
'        p_hotel_id,',
'        l_template_id,',
'        ''UPLOAD'',',
'        systimestamp,',
'        ''IN_PROGRESS'',',
'        hextoraw(rawtohex(utl_raw.cast_to_raw(l_apex_user))),',
'        hextoraw(rawtohex(utl_raw.cast_to_raw(l_apex_user))),',
'        sysdate, sysdate,',
'        p_file_id',
'    );',
'',
'    INSERT INTO debug_log(message) VALUES(''Inserted ur_interface_logs id='' || RAWTOHEX(l_log_id));',
'',
'    -------------------------------------------------------------------',
'    -- 6. Get dynamic headers from file',
'    -------------------------------------------------------------------',
'    FOR r IN (',
'        SELECT column_position, column_name',
'          FROM TABLE(apex_data_parser.get_columns(v_profile_clob))',
'         ORDER BY column_position',
'    ) LOOP',
'        v_headers(r.column_position) := r.column_name;',
'        v_col_count := r.column_position;',
'    END LOOP;',
'',
'    INSERT INTO debug_log(message) VALUES(''Detected '' || v_col_count || '' columns from file.'');',
'    IF v_col_count = 0 THEN',
'        RAISE_APPLICATION_ERROR(-20001, ''No columns detected in uploaded file.'');',
'    END IF;',
'',
'    -------------------------------------------------------------------',
'    -- 7. Build JSON SQL',
'    -------------------------------------------------------------------',
'    v_sql_json := ''SELECT p.line_number, JSON_OBJECT('';',
'    FOR i IN 1..v_col_count LOOP',
'        IF i > 1 THEN v_sql_json := v_sql_json || '', ''; END IF;',
'        v_sql_json := v_sql_json || '''''''' || REPLACE(v_headers(i), '''''''', '''''''''''') || '''''' VALUE NVL(p.col'' || LPAD(i,3,''0'') || '', '''''''')'';',
'    END LOOP;',
'    v_sql_json := v_sql_json || '') AS row_json FROM TABLE(apex_data_parser.parse(p_content => :1, p_file_name => :2, p_skip_rows => 1)) p'';',
'',
'    INSERT INTO debug_log(message) VALUES(''Built SQL for JSON parse (len='' || LENGTH(v_sql_json) || '')'');',
'',
'    -------------------------------------------------------------------',
'    -- 8. Process each row',
'    -------------------------------------------------------------------',
'    OPEN c FOR v_sql_json USING l_blob, l_file_name;',
'    LOOP',
'        FETCH c INTO v_line_number, v_row_json;',
'        EXIT WHEN c%NOTFOUND;',
'',
'        l_total_rows := l_total_rows + 1;',
'        INSERT INTO debug_log(message) VALUES(''--- Processing row #'' || l_total_rows || '' line='' || NVL(TO_CHAR(v_line_number),''N/A''));',
'        INSERT INTO debug_log(message) VALUES(''--- v_row_json row #'' || v_row_json || '' line='' || NVL(TO_CHAR(v_line_number),''N/A''));',
'',
'        -- Reset dynamic variables',
'        l_cols := NULL;',
'        l_vals := NULL;',
'        l_set  := NULL;',
'        l_stay_val := NULL;',
'       ',
'',
'        BEGIN',
'            DECLARE',
'                l_elem JSON_ELEMENT_T := JSON_ELEMENT_T.parse(v_row_json);',
'                l_obj  JSON_OBJECT_T;',
'                l_keys JSON_KEY_LIST;',
'                l_col  VARCHAR2(4000);',
'                l_val  VARCHAR2(4000);',
'                l_val_formatted VARCHAR2(4000);',
'                l_sql_select CLOB;',
'                l_sql_main clob;',
'                l_col_u clob;',
'                l_col_s clob;',
'                v_data_type VARCHAR2(1000);',
'                l_key       VARCHAR2(32000);',
'            BEGIN',
'                IF NOT l_elem.is_object THEN',
'                    RAISE_APPLICATION_ERROR(-20002,''Row not a JSON object'');',
'                END IF;',
'',
'                l_obj := TREAT(l_elem AS JSON_OBJECT_T);',
'                l_keys := l_obj.get_keys;',
'',
'                FOR j IN 1..l_keys.count LOOP',
'                    --l_col := UPPER(REPLACE(REPLACE(l_keys(j), ''__'', ''_''), '' '', ''_''));',
'                    l_col := sanitize_column_name(l_keys(j));',
'',
'                    l_val := l_obj.get_string(l_keys(j));',
'                    INSERT INTO debug_log(message) VALUES(''--- l_col:>'' || l_col );',
'                    INSERT INTO debug_log(message) VALUES(''--- l_val:>'' || l_val );',
'                    l_sql_select := l_sql_select|| ''''''''||l_val || '''''' as ''|| l_col||'' , '';',
'',
'                    -- Capture STAY_DATE value',
'                    IF l_stay_col_name IS NOT NULL AND l_col = UPPER(l_stay_col_name) THEN',
'                        l_stay_val := l_val;',
'                    else',
'                        l_col_u := l_col_u ||''t.'' || l_col ||'' = ''||''s.''||l_col ||'' ,'';    ',
'                    END IF;',
'',
'                      ',
'',
'',
'',
'                    -- Format value',
'                    l_val_formatted := NULL;',
'                    IF l_val IS NOT NULL AND REGEXP_LIKE(l_val,''^-?\d+(\.\d+)?$'') THEN',
'                        l_val_formatted := TO_CHAR(TO_NUMBER(l_val));',
'                    END IF;',
'',
'                    IF l_val_formatted IS NULL THEN',
'                        l_val_formatted := '''''''' || REPLACE(NVL(l_val,''''), '''''''', '''''''''''') || '''''''';',
'                    END IF;',
'',
'                    -- Append to dynamic SQL parts',
'                    IF l_set IS NOT NULL THEN',
'                        l_set  := l_set || '', '';',
'                        l_cols := l_cols || '', '';',
'                        l_vals := l_vals || '', '';',
'                    END IF;',
'',
'                    l_set  := NVL(l_set,'''')  || l_col || '' = '' || l_val_formatted;',
'                    l_cols := NVL(l_cols,'''') || l_col;',
'                    --l_col_u := l_col_u ||''t.'' || l_col ||'' = ''||''s.''||l_col ||'' ,'';',
'                    l_col_s := l_col_s ||''s.''||l_col||'','';',
'                    l_vals := NVL(l_vals,'''') || l_val_formatted;',
'                END LOOP;',
'                INSERT INTO debug_log(message) VALUES(''--- l_sql_select:> SELECT  ''||l_vals_calculation||'' FROM ( SELECT '' || rtrim(l_sql_select, '', '')  ||'' FROM DUAL)p'');',
'              ',
'         l_sql_main:=    ''INSERT INTO ''|| l_table_name ||'' (HOTEL_ID,''|| l_cols ||'',INTERFACE_LOG_ID) ''||',
'        ''SELECT ''''''||p_hotel_id||'''''' AS HOTEL_ID,''|| l_cols ||'',''''''||l_log_id||'''''' AS INTERFACE_LOG_ID''||',
'        ''  FROM ( SELECT  ''||l_vals_calculation||'' FROM ( SELECT '' || rtrim(l_sql_select, '', '')  ||'' FROM DUAL)p''||',
'        '' WHERE 1=1 );'';',
'',
'--ON (t.HOTEL_ID = ''''''||p_hotel_id||'''''' and TO_CHAR(t.''||l_stay_col_name||'',''''DD/MM/YYYY'''') = ''''''|| l_stay_val||'''''')   For Date',
'--ON (t.HOTEL_ID = ''''''||p_hotel_id||'''''' and t.''||l_stay_col_name||'' = ''''''|| l_stay_val||'''''')                           For char',
'l_stay_val := TO_CHAR(fn_safe_to_date(l_stay_val), ''DD/MM/YYYY'');',
'          ',
'            ',
'l_sql_main :=',
'''MERGE INTO ''|| l_table_name ||'' t',
'USING (SELECT ''''''||p_hotel_id||'''''' AS HOTEL_ID,''|| l_cols ||'',''''''||l_log_id||'''''' AS INTERFACE_LOG_ID''||',
'        ''  FROM ( SELECT  ''||l_vals_calculation||'' FROM ( SELECT '' || rtrim(l_sql_select, '', '')  ||'' FROM DUAL)p''||',
'        '' WHERE 1=1 )) s',
'ON (t.HOTEL_ID = ''''''||p_hotel_id||'''''' and TO_CHAR(t.''||l_stay_col_name||'',''''DD/MM/YYYY'''') = ''''''|| l_stay_val||'''''') ',
'WHEN MATCHED THEN',
'    UPDATE SET ''|| rtrim(l_col_u, '', '')  ||''',
'WHEN NOT MATCHED THEN',
'   INSERT  (HOTEL_ID,''|| l_cols ||'',INTERFACE_LOG_ID) ''||',
'        ''values (s.HOTEL_ID, ''||rtrim(l_col_s, '', '')||'',s.INTERFACE_LOG_ID)'';',
'',
'',
'        INSERT INTO debug_log(message) VALUES(''--- l_sql_main:>   ''||l_sql_main);',
'        ',
'            ',
'                EXECUTE IMMEDIATE l_sql_main;',
'           ',
'',
'',
'',
'                l_success_cnt := l_success_cnt + 1;',
'',
'            END;',
'        EXCEPTION',
'            WHEN OTHERS THEN',
'                l_fail_cnt := l_fail_cnt + 1;',
'                l_error_json := l_error_json || ''{"row":'' || l_total_rows || '',"error":"'' || REPLACE(SQLERRM,''"'','''''''') || ''"},'';',
'        END;',
'    END LOOP;',
'    CLOSE c;',
'',
'    -- finalize error JSON',
'    IF l_error_json IS NOT NULL AND l_error_json <> ''['' THEN',
'        IF SUBSTR(l_error_json,-1) = '','' THEN',
'            l_error_json := SUBSTR(l_error_json,1,LENGTH(l_error_json)-1);',
'        END IF;',
'        l_error_json := l_error_json || '']'';',
'    ELSE',
'        l_error_json := NULL;',
'    END IF;',
'',
'    COMMIT;',
'',
'    -- Update log',
'    UPDATE ur_interface_logs',
'       SET load_end_time = systimestamp,',
'           load_status   = case when l_fail_cnt > 0 then ''FAILED'' else ''SUCCESS'' end,',
'           updated_on    = sysdate,',
'           error_json    = l_error_json,',
'           RECORDS_PROCESSED = l_total_rows,',
'           RECORDS_SUCCESSFUL = l_success_cnt,',
'           RECORDS_FAILED = l_fail_cnt',
'     WHERE id = l_log_id;',
'',
'',
'    p_status  := case when l_total_rows = l_fail_cnt then ''E'' ELSE ''S'' END;',
unistr('    p_message := case when l_total_rows = l_fail_cnt then ''Failure'' ELSE ''Success'' END||'': Upload completed \2192 Total='' || l_total_rows || '', Success='' || l_success_cnt || '', Failed='' || l_fail_cnt;'),
'',
'    INSERT INTO debug_log(message) VALUES(''Completed Load_Data - '' || p_message);',
'',
'EXCEPTION',
'    WHEN OTHERS THEN',
'        DECLARE',
'            l_err_msg VARCHAR2(4000);',
'        BEGIN',
'            l_err_msg := SQLERRM;',
'',
'            p_status  := ''E'';',
'            p_message := ''Failure: ''|| l_err_msg;',
'',
'            UPDATE ur_interface_logs',
'               SET load_end_time = systimestamp,',
'                   load_status   = ''FAILED'',',
'                   error_json    = l_error_json || ''{"error":"'' || REPLACE(l_err_msg,''"'','''''''') || ''"}]'',',
'                   updated_on    = sysdate,',
'                   RECORDS_PROCESSED = l_total_rows,',
'                   RECORDS_SUCCESSFUL = l_success_cnt,',
'                   RECORDS_FAILED = l_fail_cnt',
'             WHERE id = l_log_id;',
'',
'            ROLLBACK;',
'        END;',
'END XX_LOCAL_Load_Data;',
'/',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'   CREATE SEQUENCE  "XXPEL_WF_FEEDBACK_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 61 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  GLOBAL ;',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
''))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'create or replace TRIGGER "TRG_UR_ADDRESSES_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_ADDRESSES',
'FOR EACH ROW',
'DECLARE',
'    v_current_user RAW(16);',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO v_current_user FROM UR_USERS WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'        :NEW.CREATED_BY := v_current_user;',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        :NEW.UPDATED_BY := v_current_user;',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO v_current_user FROM UR_USERS WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'        :NEW.UPDATED_BY := v_current_user;',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'create or replace TRIGGER "TRG_UR_ALGOS_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_ALGOS"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id RAW(16);',
'BEGIN',
'  IF :NEW.ID IS NULL THEN',
'    :NEW.ID := SYS_GUID();',
'  END IF;',
'',
'  -- Fetch user_id from UR_USERS based on APEX session user',
'  SELECT USER_ID INTO v_user_id ',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END;',
'/',
'create or replace TRIGGER "TRG_UR_ALGO_ATTRIBUTES_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_ALGO_ATTRIBUTES"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id RAW(16);',
'BEGIN',
'  IF :NEW.ID IS NULL THEN',
'    :NEW.ID := SYS_GUID();',
'  END IF;',
'',
'  -- Fetch USER_ID from UR_USERS based on APEX session user',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'',
'    -- Set default DATA_TYPE if null',
'    IF :NEW.DATA_TYPE IS NULL THEN',
'      :NEW.DATA_TYPE := ''NUMBER'';',
'    END IF;',
'',
'    -- Set default TYPE if null',
'    IF :NEW.TYPE IS NULL THEN',
'      :NEW.TYPE := ''M'';',
'    END IF;',
'',
'    -- Automatically generate KEY from NAME using UR_UTILS.Clean_TEXT if KEY is null or empty',
'    IF :NEW.KEY IS NULL OR TRIM(:NEW.KEY) = '''' THEN',
'      :NEW.KEY := UR_UTILS.Clean_TEXT(:NEW.NAME);',
'    END IF;',
'',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'',
'    -- Do NOT modify KEY during update, leave as is',
'',
'    -- Ensure DATA_TYPE defaults if null',
'    IF :NEW.DATA_TYPE IS NULL THEN',
'      :NEW.DATA_TYPE := ''NUMBER'';',
'    END IF;',
'',
'    -- Ensure TYPE defaults if null',
'    IF :NEW.TYPE IS NULL THEN',
'      :NEW.TYPE := ''M'';',
'    END IF;',
'',
'  END IF;',
'END;',
'/',
'create or replace TRIGGER TRG_UR_ALGO_VERSIONS_BI_TRG',
'BEFORE INSERT OR UPDATE ON UR_ALGO_VERSIONS',
'FOR EACH ROW',
'DECLARE',
'  v_user_id RAW(16);',
'  v_max_version NUMBER;',
'  v_new_version NUMBER;',
'BEGIN',
'  IF :NEW.ID IS NULL THEN',
'    :NEW.ID := SYS_GUID();',
'  END IF;',
'',
'  -- Fetch user_id from UR_USERS based on APEX session user',
'  SELECT USER_ID INTO v_user_id',
'  FROM UR_USERS',
'  WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF INSERTING THEN',
'    -- Set audit columns',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'',
'    -- Auto increment VERSION',
'    BEGIN',
'      SELECT MAX(TO_NUMBER(VERSION)) INTO v_max_version',
'      FROM UR_ALGO_VERSIONS',
'      WHERE ALGO_ID = :NEW.ALGO_ID;',
'',
'      v_new_version := NVL(v_max_version, 0) + 1;',
'    EXCEPTION',
'      WHEN NO_DATA_FOUND THEN',
'        v_new_version := 1;',
'      WHEN VALUE_ERROR THEN',
'        -- version column has non-numeric values - fallback to 1',
'        v_new_version := 1;',
'    END;',
'    :NEW.VERSION := TO_CHAR(v_new_version);',
'',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'',
'  -- Update UR_ALGOS table CURRENT_VERSION_ID to the VERSION record ID that was just inserted/updated',
'  UPDATE UR_ALGOS',
'  SET CURRENT_VERSION_ID = :NEW.ID,',
'      UPDATED_BY = v_user_id,',
'      UPDATED_ON = SYSDATE',
'  WHERE ID = :NEW.ALGO_ID;',
'',
'END;',
'/',
'create or replace TRIGGER TRG_UR_CONTACTS_BI_TRG',
'BEFORE INSERT OR UPDATE ON UR_CONTACTS',
'FOR EACH ROW',
'DECLARE',
'    v_primary_count NUMBER;',
'    v_user_id RAW(16);',
'BEGIN',
'    -- Assign ID if null',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        BEGIN',
'            SELECT USER_ID INTO v_user_id',
'              FROM UR_USERS',
'             WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'        EXCEPTION',
'            WHEN NO_DATA_FOUND THEN',
'                v_user_id := SYS_GUID();  -- fallback in case no user found',
'        END;',
'',
'        :NEW.CREATED_BY := v_user_id;',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        :NEW.UPDATED_BY := v_user_id;',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        BEGIN',
'            SELECT USER_ID INTO v_user_id',
'              FROM UR_USERS',
'             WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'        EXCEPTION',
'            WHEN NO_DATA_FOUND THEN',
'                v_user_id := SYS_GUID();  -- fallback if user unknown',
'        END;',
'',
'        :NEW.UPDATED_BY := v_user_id;',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'',
'    -- Enforce only one PRIMARY=''Y'' per HOTEL_ID',
'    IF :NEW.PRIMARY = ''Y'' THEN',
'        SELECT COUNT(*)',
'          INTO v_primary_count',
'          FROM UR_CONTACTS',
'         WHERE HOTEL_ID = :NEW.HOTEL_ID',
'           AND PRIMARY = ''Y''',
'           AND ID != :NEW.ID;',
'',
'        IF v_primary_count > 0 THEN',
'            RAISE_APPLICATION_ERROR(-20001, ''Only one PRIMARY contact allowed per HOTEL_ID'');',
'        END IF;',
'    END IF;',
'END;',
'/',
'create or replace TRIGGER "TRG_UR_EVENTS_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_EVENTS',
'FOR EACH ROW',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        -- Assign a new GUID if EVENT_ID is null (typical on insert)',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO :NEW.CREATED_BY ',
'        FROM UR_USERS ',
'        WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        SELECT USER_ID INTO :NEW.UPDATED_BY ',
'        FROM UR_USERS ',
'        WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO :NEW.UPDATED_BY ',
'        FROM UR_USERS ',
'        WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'create or replace TRIGGER "TRG_UR_HOTELS_BI_TRG"',
'BEFORE INSERT OR UPDATE ON UR_HOTELS',
'FOR EACH ROW',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO :NEW.CREATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'        IF :NEW.CURRENCY_CODE IS NULL THEN',
'            :NEW.CURRENCY_CODE := ''GBP'';',
'        END IF;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'create or replace TRIGGER "TRG_UR_HOTEL_GROUPS_BI_TRG"',
'BEFORE INSERT OR UPDATE ON UR_HOTEL_GROUPS',
'FOR EACH ROW',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO :NEW.CREATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'create or replace TRIGGER "TRG_UR_HOTEL_PRICE_OVERRIDE_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_HOTEL_PRICE_OVERRIDE"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id RAW(16);',
'BEGIN',
'  IF :NEW.ID IS NULL THEN',
'    :NEW.ID := SYS_GUID();',
'  END IF;',
'',
'  -- Fetch user_id from UR_USERS based on APEX session user',
'  SELECT USER_ID INTO v_user_id ',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END;',
'/',
'create or replace TRIGGER "TRG_UR_HOTEL_RESERVATIONS_BI_TRG"',
'BEFORE INSERT OR UPDATE ON UR_HOTEL_RESERVATIONS',
'FOR EACH ROW',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO :NEW.CREATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'create or replace TRIGGER "TRG_UR_HOTEL_ROOM_TYPES_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_HOTEL_ROOM_TYPES',
'FOR EACH ROW',
'DECLARE',
'    v_current_user RAW(16);',
'BEGIN',
'  -- The following line is problematic in a row-level trigger and should generally be avoided.',
'  -- Date columns store date and time internally, the format is for display.',
'  -- execute immediate q''[alter session set nls_date_format=''YYYY-MM-DD HH24:MI:SS'']'';',
'',
'  IF :NEW.ROOM_TYPE_ID IS NULL THEN',
'    -- Assign a new GUID if ROOM_TYPE_ID is null (for new records typically)',
'    :NEW.ROOM_TYPE_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    ',
'    SELECT USER_ID INTO :NEW.CREATED_BY FROM UR_USERS WHERE USER_NAME = (SYS_CONTEXT (''APEX$SESSION'', ''APP_USER''));',
'    :NEW.CREATED_ON := SYSDATE;',
'    -- For new records, UPDATED_BY and UPDATED_ON are also set initially.',
'    SELECT USER_ID INTO :NEW.UPDATED_BY FROM UR_USERS WHERE USER_NAME = (SYS_CONTEXT (''APEX$SESSION'', ''APP_USER''));',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'',
'  IF UPDATING THEN',
'    -- When updating an existing record, update UPDATED_BY and UPDATED_ON.',
'    SELECT USER_ID INTO :NEW.UPDATED_BY FROM UR_USERS WHERE USER_NAME = (SYS_CONTEXT (''APEX$SESSION'', ''APP_USER''));',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END;',
'/',
'create or replace TRIGGER "TRG_UR_INTERFACE_LOGS_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_INTERFACE_LOGS',
'FOR EACH ROW',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO :NEW.CREATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'create or replace TRIGGER "TRG_UR_REPORTS_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_REPORTS',
'FOR EACH ROW',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO :NEW.CREATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'create or replace TRIGGER trg_ur_report_dashboards_bi',
'BEFORE INSERT OR UPDATE ON UR_REPORT_DASHBOARDS',
'FOR EACH ROW',
'DECLARE',
'  v_hotel_name VARCHAR2(100);',
'  v_key_candidate VARCHAR2(110);',
'  v_user_id RAW(16);',
'  v_json_error EXCEPTION;',
'  PRAGMA EXCEPTION_INIT(v_json_error, -22827); -- ORA-22827 JSON parse error code',
'  ',
'BEGIN',
'  -- Set ID if NULL',
'  IF :NEW.ID IS NULL THEN',
'    :NEW.ID := SYS_GUID();',
'  END IF;',
'',
'  -- Default CREATED_BY, UPDATED_BY, CREATED_ON, UPDATED_ON depending on insert/update',
'  IF INSERTING THEN',
'',
'    -- Fetch CURRENT USER ID from UR_USERS via APEX user',
'    BEGIN',
'      SELECT USER_ID INTO v_user_id',
'      FROM UR_USERS',
'      WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'    EXCEPTION',
'      WHEN NO_DATA_FOUND THEN',
'        v_user_id := NULL;',
'    END;',
'',
'    IF v_user_id IS NOT NULL THEN',
'      :NEW.CREATED_BY := v_user_id;',
'      :NEW.UPDATED_BY := v_user_id;',
'    ELSE',
'      RAISE_APPLICATION_ERROR(-20001, ''Unable to find USER_ID for current APEX user'');',
'    END IF;',
'',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_ON := SYSDATE;',
'',
'    -- ACTIVE default',
'    IF :NEW.ACTIVE IS NULL THEN',
'      :NEW.ACTIVE := ''Y'';',
'    END IF;',
'',
'    -- If HOTEL_ID is provided and Name/Key are NULL or empty, derive from Hotel''s name',
'    IF :NEW.HOTEL_ID IS NOT NULL THEN',
'      SELECT HOTEL_NAME INTO v_hotel_name FROM UR_HOTELS WHERE ID = :NEW.HOTEL_ID;',
'',
'      -- Populate NAME if empty',
'      IF :NEW.NAME IS NULL OR TRIM(:NEW.NAME) = '''' THEN',
'        :NEW.NAME := v_hotel_name;',
'      END IF;',
'',
'      -- Populate KEY if empty',
'      IF :NEW."KEY" IS NULL OR TRIM(:NEW."KEY") = '''' THEN',
'        -- Derive KEY from hotel name (uppercase, replace spaces with underscore, remove special chars except _)',
'        v_key_candidate := REGEXP_REPLACE(UPPER(v_hotel_name), ''[^A-Z0-9_]'', '''');',
'        v_key_candidate := REPLACE(v_key_candidate, '' '', ''_'');  -- Redundant after regex but keep for clarity',
'',
'        -- Append ''_DASHBOARD'' suffix if not already present',
'        IF NOT v_key_candidate LIKE ''%_DASHBOARD'' THEN',
'          v_key_candidate := v_key_candidate || ''_DASHBOARD'';',
'        END IF;',
'',
'        :NEW."KEY" := v_key_candidate;',
'      END IF;',
'    END IF;',
'',
'  ELSIF UPDATING THEN',
'',
'    -- Refresh UPDATED_BY and UPDATED_ON regardless',
'    BEGIN',
'      SELECT USER_ID INTO v_user_id',
'      FROM UR_USERS',
'      WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'    EXCEPTION',
'      WHEN NO_DATA_FOUND THEN',
'        v_user_id := NULL;',
'    END;',
'',
'    IF v_user_id IS NOT NULL THEN',
'      :NEW.UPDATED_BY := v_user_id;',
'    ELSE',
'      RAISE_APPLICATION_ERROR(-20002, ''Unable to find USER_ID for current APEX user'');',
'    END IF;',
'',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'',
'  -- Validate DEFINITION is valid JSON - raise error if not',
'  BEGIN',
'    -- Attempt to parse JSON in DEFINITION by wrapping in JSON_EXISTS which fails if invalid',
'    IF NOT JSON_EXISTS(:NEW.DEFINITION, ''$'') THEN',
'      RAISE_APPLICATION_ERROR(-20003, ''Definition column contains invalid JSON data.'');',
'    END IF;',
'  EXCEPTION',
'    WHEN OTHERS THEN',
'      RAISE_APPLICATION_ERROR(-20004, ''Definition column contains invalid JSON data.'');',
'  END;',
'',
'END;',
'/',
'create or replace TRIGGER "TRG_UR_TEMPLATES_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_TEMPLATES',
'FOR EACH ROW',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO :NEW.CREATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'create or replace TRIGGER trg_ur_users_bi_trg',
'FOR INSERT OR UPDATE ON ur_users',
'COMPOUND TRIGGER',
'',
'  BEFORE EACH ROW IS',
'    l_current_user_id UR_USERS.USER_ID%TYPE;',
'  BEGIN',
'    IF INSERTING THEN',
'      -- generate PK if not provided',
'      IF :NEW.user_id IS NULL THEN',
'        :NEW.user_id := SYS_GUID();',
'      END IF;',
'',
'      -- set created_by / updated_by from session package (if available)',
'      l_current_user_id := app_user_ctx.get_current_user_id;',
'      IF l_current_user_id IS NOT NULL THEN',
'        :NEW.created_by := l_current_user_id;',
'        :NEW.updated_by := l_current_user_id;',
'      END IF;',
'',
'      -- timestamps (respect any pre-filled created_on)',
'      IF :NEW.created_on IS NULL THEN',
'        :NEW.created_on := SYSDATE;',
'      END IF;',
'      :NEW.updated_on := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'      l_current_user_id := app_user_ctx.get_current_user_id;',
'      IF l_current_user_id IS NOT NULL THEN',
'        :NEW.updated_by := l_current_user_id;',
'      END IF;',
'      :NEW.updated_on := SYSDATE;',
'    END IF;',
'  END BEFORE EACH ROW;',
'',
'END trg_ur_users_bi_trg;',
'/',
'create or replace TRIGGER "UR_1DAY_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_1DAY_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_1DAY_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_3DAY2_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_3DAY2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_3DAY2_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_3DAY_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_3DAY_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_3DAY_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_7DAY1_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_7DAY1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_7DAY1_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_ADAM_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_ADAM_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_ADAM_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_BHAUMIK_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_BHAUMIK_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_BHAUMIK_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_CHINAR_22SEPT1_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_CHINAR_22SEPT1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_CHINAR_22SEPT1_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_CHINAR_22SEPT_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_CHINAR_22SEPT_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_CHINAR_22SEPT_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_CHINAR_28_SEP_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_CHINAR_28_SEP_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_CHINAR_28_SEP_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_CHINAR_STAY_DATE_TEMPLATE_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_CHINAR_STAY_DATE_TEMPLATE_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_CHINAR_STAY_DATE_TEMPLATE_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_CHINAR_TEST_111_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_CHINAR_TEST_111_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_CHINAR_TEST_111_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_CHINAR_TEST_112_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_CHINAR_TEST_112_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_CHINAR_TEST_112_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_DAILY_BREAKDOWN11_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_DAILY_BREAKDOWN11_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_DAILY_BREAKDOWN11_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_DAILY_BREAKDOWN_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_DAILY_BREAKDOWN_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_DAILY_BREAKDOWN_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_DAILY_BREAKDOWN_VK_2_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_DAILY_BREAKDOWN_VK_2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_DAILY_BREAKDOWN_VK_2_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_DAILY_BREAKDOWN_VK_3_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_DAILY_BREAKDOWN_VK_3_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_DAILY_BREAKDOWN_VK_3_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_DAILY_BREAKDOWN_VK_4_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_DAILY_BREAKDOWN_VK_4_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_DAILY_BREAKDOWN_VK_4_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_DAILY_BREAKDOWN_VK_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_DAILY_BREAKDOWN_VK_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_DAILY_BREAKDOWN_VK_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_DEMO_30SEP25_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_DEMO_30SEP25_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_DEMO_30SE'))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'P25_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_EXPENSE_TEMPLATE_02_T_BI_TRG"',
'      BEFORE INSERT ON "UR_EXPENSE_TEMPLATE_02_T"',
'      FOR EACH ROW',
'      WHEN (NEW.ID IS NULL)',
'      BEGIN',
'        :NEW.ID := SYS_GUID();',
'      END;',
'    ',
'/',
'create or replace TRIGGER "UR_EXP_REPORT_2122122_T_BI_TRG"',
'      BEFORE INSERT ON "UR_EXP_REPORT_2122122_T"',
'      FOR EACH ROW',
'      WHEN (NEW.ID IS NULL)',
'      BEGIN',
'        :NEW.ID := SYS_GUID();',
'      END;',
'    ',
'/',
'create or replace TRIGGER "UR_EXP_REPORT_212212_T_BI_TRG"',
'      BEFORE INSERT ON "UR_EXP_REPORT_212212_T"',
'      FOR EACH ROW',
'      WHEN (NEW.ID IS NULL)',
'      BEGIN',
'        :NEW.ID := SYS_GUID();',
'      END;',
'    ',
'/',
'create or replace TRIGGER "UR_EXP_REPORT_21221_T_BI_TRG"',
'      BEFORE INSERT ON "UR_EXP_REPORT_21221_T"',
'      FOR EACH ROW',
'      WHEN (NEW.ID IS NULL)',
'      BEGIN',
'        :NEW.ID := SYS_GUID();',
'      END;',
'    ',
'/',
'create or replace TRIGGER "UR_EXP_REPORT_21_T_BI_TRG"',
'      BEFORE INSERT ON "UR_EXP_REPORT_21_T"',
'      FOR EACH ROW',
'      WHEN (NEW.ID IS NULL)',
'      BEGIN',
'        :NEW.ID := SYS_GUID();',
'      END;',
'    ',
'/',
'create or replace TRIGGER "UR_EXP_REPORT_3_T_BI_TRG"',
'      BEFORE INSERT ON "UR_EXP_REPORT_3_T"',
'      FOR EACH ROW',
'      WHEN (NEW.ID IS NULL)',
'      BEGIN',
'        :NEW.ID := SYS_GUID();',
'      END;',
'    ',
'/',
'create or replace TRIGGER "UR_EXP_REPORT_T_BI_TRG"',
'      BEFORE INSERT ON "UR_EXP_REPORT_T"',
'      FOR EACH ROW',
'      WHEN (NEW.ID IS NULL)',
'      BEGIN',
'        :NEW.ID := SYS_GUID();',
'      END;',
'    ',
'/',
'create or replace TRIGGER "UR_INDIGO_L_SQUARE_I_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_INDIGO_L_SQUARE_I_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_INDIGO_L_SQUARE_I_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_INDIGO_L_SQUARE_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_INDIGO_L_SQUARE_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_INDIGO_L_SQUARE_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_LOS1_INDIGO_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_INDIGO_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_INDIGO_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_LOS1_MCL_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_MCL_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_MCL_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_LOS1_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_LOS1_YORK_10_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_10_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_10_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_LOS1_YORK_11_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_11_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_11_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_LOS1_YORK_12_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_12_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_12_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_LOS1_YORK_13OCT_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_13OCT_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_13OCT_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_LOS1_YORK_13_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_13_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_13_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_LOS1_YORK_14_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_14_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_14_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_LOS1_YORK_15_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_15_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_15_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_LOS1_YORK_2_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_2_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_LOS1_YORK_7_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_7_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_7_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_LOS1_YORK_8_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_8_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_8_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_LOS1_YORK_9_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_9_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_9_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_LOS1_YORK_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_LOS3_YORK_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_LOS3_YORK_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS3_YORK_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_MCL_LOS1_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_MCL_LOS1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_MCL_LOS1_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_PICKUP_INDIGO_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_PICKUP_INDIGO_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_PICKUP_INDIGO_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_STR_3_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_STR_3_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_STR_3_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_STR_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_STR_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_STR_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_TEMP_1_OCT_N1_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_TEMP_1_OCT_N1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEMP_1_OCT_N1_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_TEMP_1_OCT_N2_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_TEMP_1_OCT_N2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEMP_1_OCT_N2_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_TEMP_1_OCT_N_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_TEMP_1_OCT_N_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEMP_1_OCT_N_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_TEMP_1_OCT_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_TEMP_1_OCT_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEMP_1_OCT_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_TEMP_3_OCT_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_TEMP_3_OCT_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEMP_3_OCT_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_TEMP_DEMO_11_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_TEMP_DEMO_11_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEMP_DEMO_11_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_TEMP_NN_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_TEMP_NN_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEMP_NN_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_TEST1_22_CHINAR_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_TEST1_22_CHINAR_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST1_22_CHINAR_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_TEST_13_10_CP_2_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_TEST_13_10_CP_2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_13_10_CP_2_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_TEST_13_10_CP_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_TEST_13_10_CP_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_13_10_CP_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_TEST_CHINAR_1_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_TEST_CHINAR_1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_CHINAR_1_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_TEST_CHINAR_29_SEP_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_TEST_CHINAR_29_SEP_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_CHINAR_29_SEP_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_TEST_CHINAR_2_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_TEST_CHINAR_2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_CHINAR_2_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_TEST_CHINAR_NEWEST_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_TEST_CHINAR_NEWEST_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_CHINAR_NEWEST_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_TEST_CHINAR_NO_USC_NEW_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_TEST_CHINAR_NO_USC_NEW_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_CHINAR_NO_USC_NEW_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_TEST_CHINAR_NO_USC_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_TEST_CHINAR_NO_USC_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_CHINAR_NO_USC_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_TEST_CHINAR_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_TEST_CHINAR_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_CHINAR_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_TEST_STACY_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_TEST_STACY_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_STACY_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_TEST_TEMPLATE_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_TEST_TEMPLATE_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_TEMPLATE_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_TT_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_TT_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TT_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_UR_BHAUMIK_30_SEP1_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_UR_BHAUMIK_30_SEP1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_UR_BHAUMIK_30_SEP1_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_UR_BHAUMIK_30_SEP_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_UR_BHAUMIK_30_SEP_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    '))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
':NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_UR_BHAUMIK_30_SEP_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_UR_CHINAR_QUAL_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_UR_CHINAR_QUAL_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_UR_CHINAR_QUAL_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_250915_1_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_250915_1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_250915_1_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_250915_2_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_250915_2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_250915_2_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_250915_3_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_250915_3_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_250915_3_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_250915_4_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_250915_4_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_250915_4_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_250915_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_250915_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_250915_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_ATT_QUAL1_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_ATT_QUAL1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_ATT_QUAL1_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_LEAVE_SETUP_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_LEAVE_SETUP_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LEAVE_SETUP_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_LOS1_YORK_2_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_2_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_LOS1_YORK_3_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_3_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_3_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_LOS1_YORK_4_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_4_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_4_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_LOS1_YORK_5_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_5_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_5_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_LOS1_YORK_6_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_6_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_6_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_LOS1_YORK_7_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_7_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_7_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_LOS1_YORK_8_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_8_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_8_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_LOS1_YORK_9_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_9_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_9_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_LOS1_YORK_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_NEW_CHINAR_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_NEW_CHINAR_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_NEW_CHINAR_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_SAMPLE_HOTEL_DATA_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_SAMPLE_HOTEL_DATA_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_SAMPLE_HOTEL_DATA_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_SEG1_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_SEG1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_SEG1_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_SEGMENT_QUALIFIER1_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_SEGMENT_QUALIFIER1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_SEGMENT_QUALIFIER1_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_SEGMENT_QUALIFIER2_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_SEGMENT_QUALIFIER2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_SEGMENT_QUALIFIER2_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_SEGMENT_QUALIFIER_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_SEGMENT_QUALIFIER_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_SEGMENT_QUALIFIER_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_VK_TMS_TASK_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_VK_TMS_TASK_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_TMS_TASK_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_YORK_LOS1_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_YORK_LOS1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_YORK_LOS1_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_YORK_LOS1_VK_29SEP25_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_YORK_LOS1_VK_29SEP25_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_YORK_LOS1_VK_29SEP25_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_YORK_TEMP12_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_YORK_TEMP12_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_YORK_TEMP12_T_BI_TRG;',
'/',
'create or replace TRIGGER "UR_YORK_TEMP14_T_BI_TRG"',
'BEFORE INSERT OR UPDATE ON "UR_YORK_TEMP14_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_YORK_TEMP14_T_BI_TRG;',
'/',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'create or replace TYPE attribute_value_row AS OBJECT (',
'    stay_date       DATE,',
'    attribute_value NUMBER',
')',
'/',
'create or replace TYPE attribute_value_table AS TABLE OF attribute_value_row',
'/',
'create or replace TYPE log_rec_obj AS OBJECT (',
'    log_id        NUMBER,',
'    log_message   VARCHAR2(255)',
')',
'/',
'create or replace TYPE log_tab_type AS TABLE OF log_rec_obj;',
'CREATE OR REPLACE PACKAGE pkg_log_data_trg AS',
'    -- Global variable now uses the SQL type',
'    g_log_data_tab log_tab_type;',
'',
'    PROCEDURE init;',
'    PROCEDURE process;',
'END pkg_log_data_trg',
'/',
'create or replace TYPE my_date_list IS TABLE OF DATE',
'/',
'create or replace TYPE t_result_rec_obj AS OBJECT (',
'  algo_name         VARCHAR2(255),',
'  stay_date         DATE,',
'  stay_day          VARCHAR2(3), -- e.g., ''Mon'', ''Tue''',
'  evaluated_price   NUMBER,',
'  applied_rule      CLOB',
')',
'/',
'create or replace TYPE t_result_tab_obj AS TABLE OF t_result_rec_obj',
'/',
'create or replace TYPE UR_attribute_value_row AS OBJECT (',
'    stay_date        DATE,',
'    attribute_value  VARCHAR2(4000)',
')',
'/',
'create or replace TYPE UR_attribute_value_table IS TABLE OF UR_attribute_value_row',
'/',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "TEMP_INDIGOHOTELS_INDIGOREPORT_V" ("HOTELID", "BOOKING_ID - VK Sample Hotel Data", "BOOKING_DATE - VK Sample Hotel Data", "STAY_DATE - VK Sample Hotel Data", "OCCUPANCY__ - VK Sample Hotel Data", "ADR__USD_'
||' - VK Sample Hotel Data", "NUMBER_OF_ROOMS - VK Sample Hotel Data", "BOOKING_CHANNEL - VK Sample Hotel Data", "GUEST_COUNTRY - VK Sample Hotel Data", "REVENUE - VK Sample Hotel Data", "BOOKING_ID - test template", "BOOKING_DATE - test template", "STA'
||'Y_DATE - test template", "OCCUPANCY__ - test template", "ADR__USD_ - test template", "NUMBER_OF_ROOMS - test template", "BOOKING_CHANNEL - test template", "GUEST_COUNTRY - test template", "REVENUE - test template") AS ',
'  WITH t1_rn AS (',
'  SELECT hotel_id, BOOKING_ID, BOOKING_DATE, STAY_DATE, OCCUPANCY__, ADR__USD_, NUMBER_OF_ROOMS, BOOKING_CHANNEL, GUEST_COUNTRY, REVENUE,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY BOOKING_ID) rn',
'  FROM UR_VK_SAMPLE_HOTEL_DATA_T',
'  WHERE hotel_id = ''3B9B828094379CA8E063DD59000AC846''',
'),',
't2_rn AS (',
'  SELECT hotel_id, BOOKING_ID, BOOKING_DATE, STAY_DATE, OCCUPANCY__, ADR__USD_, NUMBER_OF_ROOMS, BOOKING_CHANNEL, GUEST_COUNTRY, REVENUE,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY BOOKING_ID) rn',
'  FROM UR_TEST_TEMPLATE_T',
'  WHERE hotel_id = ''3B9B828094379CA8E063DD59000AC846''',
')',
'SELECT COALESCE(t1_rn.hotel_id, t2_rn.hotel_id, null) AS hotelid,',
'       t1_rn.BOOKING_ID AS "BOOKING_ID - VK Sample Hotel Data",',
'       t1_rn.BOOKING_DATE AS "BOOKING_DATE - VK Sample Hotel Data",',
'       t1_rn.STAY_DATE AS "STAY_DATE - VK Sample Hotel Data",',
'       t1_rn.OCCUPANCY__ AS "OCCUPANCY__ - VK Sample Hotel Data",',
'       t1_rn.ADR__USD_ AS "ADR__USD_ - VK Sample Hotel Data",',
'       t1_rn.NUMBER_OF_ROOMS AS "NUMBER_OF_ROOMS - VK Sample Hotel Data",',
'       t1_rn.BOOKING_CHANNEL AS "BOOKING_CHANNEL - VK Sample Hotel Data",',
'       t1_rn.GUEST_COUNTRY AS "GUEST_COUNTRY - VK Sample Hotel Data",',
'       t1_rn.REVENUE AS "REVENUE - VK Sample Hotel Data",',
'       t2_rn.BOOKING_ID AS "BOOKING_ID - test template",',
'       t2_rn.BOOKING_DATE AS "BOOKING_DATE - test template",',
'       t2_rn.STAY_DATE AS "STAY_DATE - test template",',
'       t2_rn.OCCUPANCY__ AS "OCCUPANCY__ - test template",',
'       t2_rn.ADR__USD_ AS "ADR__USD_ - test template",',
'       t2_rn.NUMBER_OF_ROOMS AS "NUMBER_OF_ROOMS - test template",',
'       t2_rn.BOOKING_CHANNEL AS "BOOKING_CHANNEL - test template",',
'       t2_rn.GUEST_COUNTRY AS "GUEST_COUNTRY - test template",',
'       t2_rn.REVENUE AS "REVENUE - test template"',
'FROM t1_rn',
'JOIN t2_rn',
'    ON t1_rn.hotel_id = t2_rn.hotel_id',
'   AND t1_rn.STAY_DATE = t2_rn.STAY_DATE',
'ORDER BY COALESCE(t1_rn.rn, t2_rn.rn,0)  ;',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "TEMP_INDIGOHOTELS_R2_V" ("HOTELID", "BOOKING_ID - VK Sample Hotel Data", "BOOKING_DATE - VK Sample Hotel Data", "NUMBER_OF_ROOMS - VK Sample Hotel Data", "BOOKING_ID - test template", "BOOKING_DATE - test t'
||'emplate", "NUMBER_OF_ROOMS - test template") AS ',
'  WITH t1_rn AS (',
'  SELECT hotel_id, BOOKING_ID, BOOKING_DATE, NUMBER_OF_ROOMS, STAY_DATE,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY BOOKING_ID) rn',
'  FROM UR_VK_SAMPLE_HOTEL_DATA_T',
'  WHERE hotel_id = ''3B9B828094379CA8E063DD59000AC846''',
'),',
't2_rn AS (',
'  SELECT hotel_id, BOOKING_ID, BOOKING_DATE, NUMBER_OF_ROOMS, STAY_DATE,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY BOOKING_ID) rn',
'  FROM UR_TEST_TEMPLATE_T',
'  WHERE hotel_id = ''3B9B828094379CA8E063DD59000AC846''',
')',
'SELECT COALESCE(t1_rn.hotel_id, t2_rn.hotel_id, null) AS hotelid,',
'       t1_rn.BOOKING_ID AS "BOOKING_ID - VK Sample Hotel Data",',
'       t1_rn.BOOKING_DATE AS "BOOKING_DATE - VK Sample Hotel Data",',
'       t1_rn.NUMBER_OF_ROOMS AS "NUMBER_OF_ROOMS - VK Sample Hotel Data",',
'       t2_rn.BOOKING_ID AS "BOOKING_ID - test template",',
'       t2_rn.BOOKING_DATE AS "BOOKING_DATE - test template",',
'       t2_rn.NUMBER_OF_ROOMS AS "NUMBER_OF_ROOMS - test template"',
'FROM t1_rn',
'JOIN t2_rn',
'    ON t1_rn.hotel_id = t2_rn.hotel_id',
'   AND t1_rn.STAY_DATE = t2_rn.STAY_DATE',
'ORDER BY COALESCE(t1_rn.rn, t2_rn.rn,0)  ;',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "TEMP_INDIGOHOTELS_R6_V" ("HOTELID", "BOOKING_ID - VK Sample Hotel Data", "BOOKING_DATE - VK Sample Hotel Data", "BOOKING_ID - test template", "OCCUPANCY__ - test template", "REVENUE - test template") AS ',
'  WITH t1_rn AS (',
'  SELECT hotel_id, BOOKING_ID, BOOKING_DATE, STAY_DATE,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY BOOKING_ID) rn',
'  FROM UR_VK_SAMPLE_HOTEL_DATA_T',
'  WHERE hotel_id = ''3B9B828094379CA8E063DD59000AC846''',
'),',
't2_rn AS (',
'  SELECT hotel_id, BOOKING_ID, OCCUPANCY__, REVENUE, STAY_DATE,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY BOOKING_ID) rn',
'  FROM UR_TEST_TEMPLATE_T',
'  WHERE hotel_id = ''3B9B828094379CA8E063DD59000AC846''',
')',
'SELECT COALESCE(t1_rn.hotel_id, t2_rn.hotel_id, null) AS hotelid,',
'       t1_rn.BOOKING_ID AS "BOOKING_ID - VK Sample Hotel Data",',
'       t1_rn.BOOKING_DATE AS "BOOKING_DATE - VK Sample Hotel Data",',
'       t2_rn.BOOKING_ID AS "BOOKING_ID - test template",',
'       t2_rn.OCCUPANCY__ AS "OCCUPANCY__ - test template",',
'       t2_rn.REVENUE AS "REVENUE - test template"',
'FROM t1_rn',
'JOIN t2_rn',
'    ON t1_rn.hotel_id = t2_rn.hotel_id',
'   AND t1_rn.STAY_DATE = t2_rn.STAY_DATE',
'ORDER BY COALESCE(t1_rn.rn, t2_rn.rn,0)  ;',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "TEMP_INDIGOHOTELS_REPORT1_V" ("HOTELID", "BOOKING_ID - VK Sample Hotel Data", "NUMBER_OF_ROOMS - VK Sample Hotel Data", "REVENUE - test template", "STAY_DATE - test template") AS ',
'  WITH t1_rn AS (',
'  SELECT hotel_id, BOOKING_ID, NUMBER_OF_ROOMS, STAY_DATE,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY BOOKING_ID) rn',
'  FROM UR_VK_SAMPLE_HOTEL_DATA_T',
'  WHERE hotel_id = ''3B9B828094379CA8E063DD59000AC846''',
'),',
't2_rn AS (',
'  SELECT hotel_id, REVENUE, STAY_DATE,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY REVENUE) rn',
'  FROM UR_TEST_TEMPLATE_T',
'  WHERE hotel_id = ''3B9B828094379CA8E063DD59000AC846''',
')',
'SELECT COALESCE(t1_rn.hotel_id, t2_rn.hotel_id, null) AS hotelid,',
'       t1_rn.BOOKING_ID AS "BOOKING_ID - VK Sample Hotel Data",',
'       t1_rn.NUMBER_OF_ROOMS AS "NUMBER_OF_ROOMS - VK Sample Hotel Data",',
'       t2_rn.REVENUE AS "REVENUE - test template",',
'       t2_rn.STAY_DATE AS "STAY_DATE - test template"',
'FROM t1_rn',
'JOIN t2_rn',
'    ON t1_rn.hotel_id = t2_rn.hotel_id',
'   AND t1_rn.STAY_DATE = t2_rn.STAY_DATE',
'ORDER BY COALESCE(t1_rn.rn, t2_rn.rn,0)  ;',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "TEMP_INDIGOHOTELS_REPORT24_V" ("HOTELID", "NUMBER_OF_ROOMS - VK Sample Hotel Data", "BOOKING_ID - VK Sample Hotel Data", "GUEST_COUNTRY - VK Sample Hotel Data", "BOOKING_DATE - VK Sample Hotel Data", "BOOKI'
||'NG_ID - test template", "OCCUPANCY__ - test template", "ADR__USD_ - test template", "NUMBER_OF_ROOMS - test template") AS ',
'  WITH t1_rn AS (',
'  SELECT hotel_id, NUMBER_OF_ROOMS, BOOKING_ID, GUEST_COUNTRY, BOOKING_DATE, STAY_DATE,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY NUMBER_OF_ROOMS) rn',
'  FROM UR_VK_SAMPLE_HOTEL_DATA_T',
'  WHERE hotel_id = ''3B9B828094379CA8E063DD59000AC846''',
'),',
't2_rn AS (',
'  SELECT hotel_id, BOOKING_ID, OCCUPANCY__, ADR__USD_, NUMBER_OF_ROOMS, STAY_DATE,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY BOOKING_ID) rn',
'  FROM UR_TEST_TEMPLATE_T',
'  WHERE hotel_id = ''3B9B828094379CA8E063DD59000AC846''',
')',
'SELECT COALESCE(t1_rn.hotel_id, t2_rn.hotel_id, null) AS hotelid,',
'       t1_rn.NUMBER_OF_ROOMS AS "NUMBER_OF_ROOMS - VK Sample Hotel Data",',
'       t1_rn.BOOKING_ID AS "BOOKING_ID - VK Sample Hotel Data",',
'       t1_rn.GUEST_COUNTRY AS "GUEST_COUNTRY - VK Sample Hotel Data",',
'       t1_rn.BOOKING_DATE AS "BOOKING_DATE - VK Sample Hotel Data",',
'       t2_rn.BOOKING_ID AS "BOOKING_ID - test template",',
'       t2_rn.OCCUPANCY__ AS "OCCUPANCY__ - test template",',
'       t2_rn.ADR__USD_ AS "ADR__USD_ - test template",',
'       t2_rn.NUMBER_OF_ROOMS AS "NUMBER_OF_ROOMS - test template"',
'FROM t1_rn',
'JOIN t2_rn',
'    ON t1_rn.hotel_id = t2_rn.hotel_id',
'   AND t1_rn.STAY_DATE = t2_rn.STAY_DATE',
'ORDER BY COALESCE(t1_rn.rn, t2_rn.rn,0)  ;',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "TEMP_INDIGOHOTELS_REPORTTEMP_V" ("HOTELID", "BOOKING_ID - VK Sample Hotel Data", "BOOKING_DATE - VK Sample Hotel Data", "OCCUPANCY__ - test template", "NUMBER_OF_ROOMS - test template") AS ',
'  WITH t1_rn AS (',
'  SELECT hotel_id, BOOKING_ID, BOOKING_DATE, STAY_DATE,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY BOOKING_ID) rn',
'  FROM UR_VK_SAMPLE_HOTEL_DATA_T',
'  WHERE hotel_id = ''3B9B828094379CA8E063DD59000AC846''',
'),',
't2_rn AS (',
'  SELECT hotel_id, OCCUPANCY__, NUMBER_OF_ROOMS, STAY_DATE,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY OCCUPANCY__) rn',
'  FROM UR_TEST_TEMPLATE_T',
'  WHERE hotel_id = ''3B9B828094379CA8E063DD59000AC846''',
')',
'SELECT COALESCE(t1_rn.hotel_id, t2_rn.hotel_id, null) AS hotelid,',
'       t1_rn.BOOKING_ID AS "BOOKING_ID - VK Sample Hotel Data",',
'       t1_rn.BOOKING_DATE AS "BOOKING_DATE - VK Sample Hotel Data",',
'       t2_rn.OCCUPANCY__ AS "OCCUPANCY__ - test template",',
'       t2_rn.NUMBER_OF_ROOMS AS "NUMBER_OF_ROOMS - test template"',
'FROM t1_rn',
'JOIN t2_rn',
'    ON t1_rn.hotel_id = t2_rn.hotel_id',
'   AND t1_rn.STAY_DATE = t2_rn.STAY_DATE',
'ORDER BY COALESCE(t1_rn.rn, t2_rn.rn,0)  ;',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "TEMP_INDIGOHOTELS_TEST_V" ("HOTELID", "STAY_DATE - Los1 Indigo", "DOW - Los1 Indigo", "MY_OTB_PERCENT - Los1 Indigo") AS ',
'  WITH t1_rn AS (',
'  SELECT hotel_id, STAY_DATE, DOW, MY_OTB_PERCENT,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY STAY_DATE) rn',
'  FROM UR_LOS1_INDIGO_T',
'  WHERE hotel_id = ''3B9B828094379CA8E063DD59000AC846''',
')',
'SELECT COALESCE(t1'))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'_rn.hotel_id, null) AS hotelid,',
'       t1_rn.STAY_DATE AS "STAY_DATE - Los1 Indigo",',
'       t1_rn.DOW AS "DOW - Los1 Indigo",',
'       t1_rn.MY_OTB_PERCENT AS "MY_OTB_PERCENT - Los1 Indigo"',
'FROM t1_rn',
'',
'ORDER BY COALESCE(t1_rn.rn,0)  ;',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "TEMP_INDIGO_HOTELS_R2_V" ("HOTELID", "T1_RN_BOOKING_ID", "T1_RN_BOOKING_DATE", "T1_RN_NUMBER_OF_ROOMS", "T1_RN_GUEST_COUNTRY", "T1_RN_REVENUE", "T2_RN_BOOKING_ID", "T2_RN_BOOKING_DATE", "T2_RN_NUMBER_OF_ROO'
||'MS") AS ',
'  WITH t1_rn AS (',
'  SELECT hotel_id, BOOKING_ID, BOOKING_DATE, NUMBER_OF_ROOMS, GUEST_COUNTRY, REVENUE, STAY_DATE,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY BOOKING_ID) rn',
'  FROM UR_VK_SAMPLE_HOTEL_DATA_T',
'  WHERE hotel_id = ''3B9B828094379CA8E063DD59000AC846''',
'),',
't2_rn AS (',
'  SELECT hotel_id, BOOKING_ID, BOOKING_DATE, NUMBER_OF_ROOMS, STAY_DATE,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY BOOKING_ID) rn',
'  FROM UR_TEST_TEMPLATE_T',
'  WHERE hotel_id = ''3B9B828094379CA8E063DD59000AC846''',
')',
'SELECT COALESCE(t1_rn.hotel_id, t2_rn.hotel_id, null) AS hotelid,',
'       t1_rn.BOOKING_ID AS t1_rn_BOOKING_ID,',
'       t1_rn.BOOKING_DATE AS t1_rn_BOOKING_DATE,',
'       t1_rn.NUMBER_OF_ROOMS AS t1_rn_NUMBER_OF_ROOMS,',
'       t1_rn.GUEST_COUNTRY AS t1_rn_GUEST_COUNTRY,',
'       t1_rn.REVENUE AS t1_rn_REVENUE,',
'       t2_rn.BOOKING_ID AS t2_rn_BOOKING_ID,',
'       t2_rn.BOOKING_DATE AS t2_rn_BOOKING_DATE,',
'       t2_rn.NUMBER_OF_ROOMS AS t2_rn_NUMBER_OF_ROOMS',
'FROM t1_rn',
'JOIN t2_rn',
'    ON t1_rn.hotel_id = t2_rn.hotel_id',
'   AND t1_rn.STAY_DATE = t2_rn.STAY_DATE',
'ORDER BY COALESCE(t1_rn.rn, t2_rn.rn,0)  ;',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "TEMP_MARRIOTCENTRALLONDON_DEMO_V" ("HOTELID", "BOOKING_ID - Test_Chinar", "STAY_DATE - Test_Chinar") AS ',
'  WITH t1_rn AS (',
'  SELECT hotel_id, BOOKING_ID, STAY_DATE,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY BOOKING_ID) rn',
'  FROM UR_TEST_CHINAR_T',
'  WHERE hotel_id = ''3B9B847282589D45E063DD59000A6D5F''',
')',
'SELECT COALESCE(t1_rn.hotel_id, null) AS hotelid,',
'       t1_rn.BOOKING_ID AS "BOOKING_ID - Test_Chinar",',
'       t1_rn.STAY_DATE AS "STAY_DATE - Test_Chinar"',
'FROM t1_rn',
'',
'ORDER BY COALESCE(t1_rn.rn,0)  ;',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "TEMP_MARRIOTCENTRALLONDON_R1_V" ("HOTELID", "T1_RN_BOOKING_ID", "T1_RN_BOOKING_DATE") AS ',
'  WITH t1_rn AS (',
'  SELECT hotel_id, BOOKING_ID, BOOKING_DATE, STAY_DATE,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY BOOKING_ID) rn',
'  FROM UR_TEST_CHINAR_T',
'  WHERE hotel_id = ''3B9B847282589D45E063DD59000A6D5F''',
')',
'SELECT COALESCE(t1_rn.hotel_id, null) AS hotelid,',
'       t1_rn.BOOKING_ID AS t1_rn_BOOKING_ID,',
'       t1_rn.BOOKING_DATE AS t1_rn_BOOKING_DATE',
'FROM t1_rn',
'',
'ORDER BY COALESCE(t1_rn.rn,0)  ;',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "TEMP_MARRIOTCL_FIRSTR_V" ("HOTELID", "STAY_DATE - LoS1 MCL", "MY_OTB_PERCENT - LoS1 MCL", "MARKET_DEMAND_PERCENT - LoS1 MCL") AS ',
'  WITH t1_rn AS (',
'  SELECT hotel_id, STAY_DATE, MY_OTB_PERCENT, MARKET_DEMAND_PERCENT,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY STAY_DATE) rn',
'  FROM UR_LOS1_MCL_T',
'  WHERE hotel_id = ''401A7C75B1C88E74E063265A000A28D7''',
')',
'SELECT COALESCE(t1_rn.hotel_id, null) AS hotelid,',
'       t1_rn.STAY_DATE AS "STAY_DATE - LoS1 MCL",',
'       t1_rn.MY_OTB_PERCENT AS "MY_OTB_PERCENT - LoS1 MCL",',
'       t1_rn.MARKET_DEMAND_PERCENT AS "MARKET_DEMAND_PERCENT - LoS1 MCL"',
'FROM t1_rn',
'',
'ORDER BY COALESCE(t1_rn.rn,0)  ;',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "TEMP_MARRIOTCL_TEST_V" ("HOTELID", "SDATE - MCL LoS1", "DAY - MCL LoS1", "MY_OTB - MCL LoS1", "MARKET_DEMAND - MCL LoS1", "DELTA_HOTELS_BY_MARRIOTT_YORK - MCL LoS1", "HILTON_YORK - MCL LoS1", "HOLIDAY_INN_Y'
||'ORK_AN_IHG_HOTEL - MCL LoS1", "RADISSON_HOTEL_YORK - MCL LoS1", "VK_Price_1 - Strategy_Column") AS ',
'  WITH t1_rn AS (',
'  SELECT hotel_id, SDATE, DAY, MY_OTB, MARKET_DEMAND, DELTA_HOTELS_BY_MARRIOTT_YORK, HILTON_YORK, HOLIDAY_INN_YORK_AN_IHG_HOTEL, RADISSON_HOTEL_YORK, SDATE as pk_col,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY SDATE) rn',
'  FROM UR_MCL_LOS1_T',
'  WHERE hotel_id = ''401A7C75B1C88E74E063265A000A28D7''',
'),',
's1_rn AS (',
'  SELECT ',
'      t.STAY_DATE as pk_col,',
'      t.EVALUATED_PRICE,',
'      a.name,',
'      a.hotel_id AS hotel_id,',
'      ROW_NUMBER() OVER (PARTITION BY a.id ORDER BY STAY_DATE) rn',
'  FROM (',
'      SELECT id, name,hotel_id',
'      FROM ur_algos',
'      WHERE hotel_id = ''401A7C75B1C88E74E063265A000A28D7''',
'      ORDER BY id DESC',
'  ) a,',
'  TABLE(',
'      ALGO_EVALUATOR_PKG.EVALUATE(a.id, NULL)',
'  ) t',
'  WHERE a.name LIKE ''VK_Price_1''',
')',
'SELECT COALESCE(t1_rn.hotel_id, s1_rn.hotel_id, null) AS hotelid,',
'       t1_rn.SDATE AS "SDATE - MCL LoS1",',
'       t1_rn.DAY AS "DAY - MCL LoS1",',
'       t1_rn.MY_OTB AS "MY_OTB - MCL LoS1",',
'       t1_rn.MARKET_DEMAND AS "MARKET_DEMAND - MCL LoS1",',
'       t1_rn.DELTA_HOTELS_BY_MARRIOTT_YORK AS "DELTA_HOTELS_BY_MARRIOTT_YORK - MCL LoS1",',
'       t1_rn.HILTON_YORK AS "HILTON_YORK - MCL LoS1",',
'       t1_rn.HOLIDAY_INN_YORK_AN_IHG_HOTEL AS "HOLIDAY_INN_YORK_AN_IHG_HOTEL - MCL LoS1",',
'       t1_rn.RADISSON_HOTEL_YORK AS "RADISSON_HOTEL_YORK - MCL LoS1",',
'       s1_rn.EVALUATED_PRICE AS "VK_Price_1 - Strategy_Column"',
'FROM t1_rn',
' LEFT  JOIN s1_rn',
'      ON t1_rn.hotel_id = s1_rn.hotel_id',
'     AND t1_rn.pk_col = s1_rn.pk_col',
'ORDER BY COALESCE(t1_rn.rn, s1_rn.rn, 0)  ;',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "TEMP_MARRIOTCL__V" ("HOTELID", "STAY_DATE - LoS1 MCL3", "DOW - LoS1 MCL3") AS ',
'  WITH t1_rn AS (',
'  SELECT hotel_id, STAY_DATE, DOW,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY STAY_DATE) rn',
'  FROM UR_LOS1_MCL_T',
'  WHERE hotel_id = ''401A7C75B1C88E74E063265A000A28D7''',
')',
'SELECT COALESCE(t1_rn.hotel_id, null) AS hotelid,',
'       t1_rn.STAY_DATE AS "STAY_DATE - LoS1 MCL3",',
'       t1_rn.DOW AS "DOW - LoS1 MCL3"',
'FROM t1_rn',
'',
'ORDER BY COALESCE(t1_rn.rn,0)  ;',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "TEMP_YORKHOTEL_YORK06_V" ("HOTELID", "STAY_DATE - York_temp14", "DAY - York_temp14", "MY_OTB - York_temp14", "MARKET_DEMAND - York_temp14", "HILTON_YORK - York_temp14", "RADISSON_HOTEL_YORK - York_temp14", '
||'"NOVOTEL_YORK_CENTRE - York_temp14", "MOXY_YORK - York_temp14", "HOTEL_INDIGO_YORK_AN_IHG_HOTEL - York_temp14", "HAMPTON_BY_HILTON_YORK - York_temp14") AS ',
'  WITH t1_rn AS (',
'  SELECT hotel_id, STAY_DATE, DAY, MY_OTB, MARKET_DEMAND, HILTON_YORK, RADISSON_HOTEL_YORK, NOVOTEL_YORK_CENTRE, MOXY_YORK, HOTEL_INDIGO_YORK_AN_IHG_HOTEL, HAMPTON_BY_HILTON_YORK,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY STAY_DATE) rn',
'  FROM UR_YORK_TEMP14_T',
'  WHERE hotel_id = ''3F89FD08835C25B3E063265A000A5EED''',
')',
'SELECT COALESCE(t1_rn.hotel_id, null) AS hotelid,',
'       t1_rn.STAY_DATE AS "STAY_DATE - York_temp14",',
'       t1_rn.DAY AS "DAY - York_temp14",',
'       t1_rn.MY_OTB AS "MY_OTB - York_temp14",',
'       t1_rn.MARKET_DEMAND AS "MARKET_DEMAND - York_temp14",',
'       t1_rn.HILTON_YORK AS "HILTON_YORK - York_temp14",',
'       t1_rn.RADISSON_HOTEL_YORK AS "RADISSON_HOTEL_YORK - York_temp14",',
'       t1_rn.NOVOTEL_YORK_CENTRE AS "NOVOTEL_YORK_CENTRE - York_temp14",',
'       t1_rn.MOXY_YORK AS "MOXY_YORK - York_temp14",',
'       t1_rn.HOTEL_INDIGO_YORK_AN_IHG_HOTEL AS "HOTEL_INDIGO_YORK_AN_IHG_HOTEL - York_temp14",',
'       t1_rn.HAMPTON_BY_HILTON_YORK AS "HAMPTON_BY_HILTON_YORK - York_temp14"',
'FROM t1_rn',
'',
'ORDER BY COALESCE(t1_rn.rn,0)  ;',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "TEMP_YORKHOTEL_YORK7_V" ("HOTELID", "STAY_DATE - York_temp14", "MY_OTB - York_temp14", "MARKET_DEMAND - York_temp14", "HILTON_YORK - York_temp14", "York_P2 - Strategy_Column") AS ',
'  WITH t1_rn AS (',
'  SELECT hotel_id, STAY_DATE, MY_OTB, MARKET_DEMAND, HILTON_YORK, STAY_DATE as pk_col,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY STAY_DATE) rn',
'  FROM UR_YORK_TEMP14_T',
'  WHERE hotel_id = ''3F89FD08835C25B3E063265A000A5EED''',
'),',
's1_rn AS (',
'  SELECT ',
'      t.STAY_DATE as pk_col,',
'      t.EVALUATED_PRICE,',
'      a.name,',
'      a.id AS hotel_id,',
'      ROW_NUMBER() OVER (PARTITION BY a.id ORDER BY STAY_DATE) rn',
'  FROM (',
'      SELECT id, name',
'      FROM ur_algos',
'      WHERE hotel_id = ''3F89FD08835C25B3E063265A000A5EED''',
'      ORDER BY id DESC',
'  ) a,',
'  TABLE(',
'      ALGO_EVALUATOR_PKG.EVALUATE(a.id, NULL)',
'  ) t',
'  WHERE a.name LIKE ''York_P2''',
')',
'SELECT COALESCE(t1_rn.hotel_id, s1_rn.hotel_id, null) AS hotelid,',
'       t1_rn.STAY_DATE AS "STAY_DATE - York_temp14",',
'       t1_rn.MY_OTB AS "MY_OTB - York_temp14",',
'       t1_rn.MARKET_DEMAND AS "MARKET_DEMAND - York_temp14",',
'       t1_rn.HILTON_YORK AS "HILTON_YORK - York_temp14",',
'       s1_rn.EVALUATED_PRICE AS "York_P2 - Strategy_Column"',
'FROM t1_rn',
' LEFT  JOIN s1_rn',
'      ON t1_rn.hotel_id = s1_rn.hotel_id',
'     AND t1_rn.pk_col = s1_rn.pk_col',
'ORDER BY COALESCE(t1_rn.rn, s1_rn.rn, 0)  ;',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "TEMP_YORKHOTEL_YORKR1_V" ("HOTELID", "STAY_DATE - York_temp14", "MOXY_YORK - York_temp14", "NOVOTEL_YORK_CENTRE - York_temp14", "HILTON_YORK - York_temp14", "York_P2 - Strategy_Column") AS ',
'  WITH t1_rn AS (',
'  SELECT hotel_id, STAY_DATE, MOXY_YORK, NOVOTEL_YORK_CENTRE, HILTON_YORK, STAY_DATE as pk_col,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY STAY_DATE) rn',
'  FROM UR_YORK_TEMP14_T',
'  WHERE hotel_id = ''3F89FD08835C25B3E063265A000A5EED''',
'),',
's1_rn AS (',
'  SELECT ',
'      t.STAY_DATE as pk_col,',
'      t.EVALUATED_PRICE,',
'      a.name,',
'      a.hotel_id AS hotel_id,',
'      ROW_NUMBER() OVER (PARTITION BY a.id ORDER BY STAY_DATE) rn',
'  FROM (',
'      SELECT id, name,hotel_id',
'      FROM ur_algos',
'      WHERE hotel_id = ''3F89FD08835C25B3E063265A000A5EED''',
'      ORDER BY id DESC',
'  ) a,',
'  TABLE(',
'      ALGO_EVALUATOR_PKG.EVALUATE(a.id, NULL)',
'  ) t',
'  WHERE a.name LIKE ''York_P2''',
')',
'SELECT COALESCE(t1_rn.hotel_id, s1_rn.hotel_id, null) AS hotelid,',
'       t1_rn.STAY_DATE AS "STAY_DATE - York_temp14",',
'       t1_rn.MOXY_YORK AS "MOXY_YORK - York_temp14",',
'       t1_rn.NOVOTEL_YORK_CENTRE AS "NOVOTEL_YORK_CENTRE - York_temp14",',
'       t1_rn.HILTON_YORK AS "HILTON_YORK - York_temp14",',
'       s1_rn.EVALUATED_PRICE AS "York_P2 - Strategy_Column"',
'FROM t1_rn',
' LEFT  JOIN s1_rn',
'      ON t1_rn.hotel_id = s1_rn.hotel_id',
'     AND t1_rn.pk_col = s1_rn.pk_col',
'ORDER BY COALESCE(t1_rn.rn, s1_rn.rn, 0)  ;',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "TEMP_YORKHOTEL_YORKR7_V" ("HOTELID", "STAY_DATE - York_temp14", "DAY - York_temp14", "MY_OTB - York_temp14") AS ',
'  WITH t1_rn AS (',
'  SELECT hotel_id, STAY_DATE, DAY, MY_OTB,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY STAY_DATE) rn',
'  FROM UR_YORK_TEMP14_T',
'  WHERE hotel_id = ''3F89FD08835C25B3E063265A000A5EED''',
')',
'SELECT COALESCE(t1_rn.hotel_id, null) AS hotelid,',
'       t1_rn.STAY_DATE AS "STAY_DATE - York_temp14",',
'       t1_rn.DAY AS "DAY - York_temp14",',
'       t1_rn.MY_OTB AS "MY_OTB - York_temp14"',
'FROM t1_rn',
'',
'ORDER BY COALESCE(t1_rn.rn,0)  ;',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "TEMP_YORKHOTEL_YORK_REPORT_V" ("HOTELID", "RADISSON_HOTEL_YORK - York_temp14", "NOVOTEL_YORK_CENTRE - York_temp14", "MOXY_YORK - York_temp14", "STAY_DATE - York_temp14", "HAMPTON_BY_HILTON_YORK - York_temp1'
||'4", "ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON - York_temp14", "MARKET_DEMAND - York_temp14", "HILTON_YORK - York_temp14", "DOUBLETREE_BY_HILTON_YORK - York_temp14") AS ',
'  WITH t1_rn AS (',
'  SELECT hotel_id, RADISSON_HOTEL_YORK, NOVOTEL_YORK_CENTRE, MOXY_YORK, STAY_DATE, HAMPTON_BY_HILTON_YORK, ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON, MARKET_DEMAND, HILTON_YORK, DOUBLETREE_BY_HILTON_YORK, STAY_DATE as pk_col,',
'         ROW_NUMBER() OVER (PARTITION BY hotel_id ORDER BY RADISSON_HOTEL_YORK) rn',
'  FROM UR_YORK_TEMP14_T',
'  WHERE hotel_id = ''3F89FD08835C25B3E063265A000A5EED''',
')',
'SELECT COALESCE(t1_rn.hotel_id, null) AS hotelid,',
'       t1_rn.RADISSON_HOTEL_YORK AS "RADISSON_HOTEL_YORK - York_temp14",',
'       t1_rn.NOVOTEL_YORK_CENTRE AS "NOVOTEL_YORK_CENTRE - York_temp14",',
'       t1_rn.MOXY_YORK AS "MOXY_YORK - York_temp14",',
'       t1_rn.STAY_DATE AS "STAY_DATE - York_temp14",',
'       t1_rn.HAMPTON_BY_HILTON_YORK AS "HAMPTON_BY_HILTON_YORK - York_temp14",',
'       t1_rn.ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON AS "ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON - York_temp14",',
'       t1_rn.MARKET_DEMAND AS "MARKET_DEMAND - York_temp14",',
'       t1_rn.HILTON_YORK AS "HILTON_YORK - York_temp14",',
'       t1_rn.DOUBLETREE_BY_HILTON_YORK AS "DOUBLETREE_BY_HILTON_YORK - York_temp14"',
'FROM t1_rn',
'',
'ORDER BY COALESCE(t1_rn.rn, 0)  ;',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "UR_DEMO_30SEP25_RANKING_V" ("STAY_DATE", "OWN_PROPERTY_RATE", "OWN_PROPERTY_RANK", "RANK_1_NAME", "RANK_1_RATE", "RANK_2_NAME", "RANK_2_RATE", "RANK_3_NAME", "RANK_3_RATE", "RANK_4_NAME", "RANK_4_RATE", "RA'
||'NK_5_NAME", "RANK_5_RATE", "RANK_6_NAME", "RANK_6_RATE", "RANK_7_NAME", "RANK_7_RATE", "RANK_8_NAME", "RANK_8_RATE", "RANK_9_NAME", "RANK_9_RATE", "RANK_10_NAME", "RANK_10_RATE", "RANK_11_NAME", "RANK_11_RATE") AS ',
'  WITH all_properties_ranked AS (',
'    SELECT ',
'        "SDATE",',
'        hotel_name,',
'        CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END AS price,',
'        ROW_NUMBER() OVER(PARTITION BY "SDATE" ORDER BY CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END ASC NULLS LAST) as overall_rank',
'    FROM "UR_DEMO_30SEP25_T"',
'    UNPIVOT (price FOR hotel_name IN ("DELTA_HOTELS_BY_MARRIOTT_YORK", "DOUBLETREE_BY_HILTON_YORK", "ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON", "HAMPTON_BY_HILTON_YORK", "HILTON_YORK", "HOLIDAY_INN_YORK_AN_IHG_HOTEL", "HOTEL_INDIGO_YORK_AN_IHG_HOTE'
||'L", "MOXY_YORK", "NOVOTEL_YORK_CENTRE", "RADISSON_HOTEL_YORK", "THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK"))',
')',
'SELECT ',
'    p."SDATE" AS "STAY_DATE",',
'    own.price AS "OWN_PROPERTY_RATE",',
'    own.overall_rank AS "OWN_PROPERTY_RANK",',
'    p."RANK_1_NAME",',
'p."RANK_1_RATE",',
'p."RANK_2_NAME",',
'p."RANK_2_RATE",',
'p."RANK_3_NAME",',
'p."RANK_3_RATE",',
'p."RANK_4_NAME",',
'p."RANK_4_RATE",',
'p."RANK_5_NAME",',
'p."RANK_5_RATE",',
'p."RANK_6_NAME",',
'p."RANK_6_RATE",',
'p."RANK_7_NAME",',
'p."RANK_7_RATE",',
'p."RANK_8_NAME",',
'p."RANK_8_RATE",',
'p."RANK_9_NAME",',
'p."RANK_9_RATE",',
'p."RANK_10_NAME",',
'p."RANK_10_RATE",',
'p."RANK_11_NAME",',
'p."RANK_11_RATE"',
'FROM (',
'    SELECT "SDATE", MAX(CASE WHEN overall_rank = 1 THEN hotel_name END) AS "RANK_1_NAME",',
'MAX(CASE WHEN overall_rank = 1 THEN price END) AS "RANK_1_RATE",',
'MAX(CASE WHEN overall_rank = 2 THEN hotel_name END) AS "RANK_2_NAME",',
'MAX(CASE WHEN overall_rank = 2 THEN price END) AS "RANK_2_RATE",',
'MAX(CASE WHEN overall_rank = 3 THEN hotel_name END) AS "RANK_3_NAME",',
'MAX(CASE WHEN overall_rank = 3 THEN price END) AS "RANK_3_RATE",',
'MAX(CASE WHEN overall_rank = 4 THEN hotel_name END) AS "RANK_4_NAME",',
'MAX(CASE WHEN overall_rank = 4 THEN price END) AS "RANK_4_RATE",',
'MAX(CASE WHEN overall_rank = 5 THEN hotel_name END) AS "RANK_5_NAME",',
'MAX(CASE WHEN overall_rank = 5 THEN price END) AS "RANK_5_RATE",',
'MAX(CASE WHEN overall_rank = 6 THEN hotel_name END) AS "RANK_6_NAME",',
'MAX(CASE WHEN overall_rank = 6 THEN price END) AS "RANK_6_RATE",',
'MAX(CASE WHEN overall_rank = 7 THEN hotel_name END) AS "RANK_7_NAME",',
'MAX(CASE WHEN overall_rank = 7 THEN price END) AS "RANK_7_RATE",',
'MAX(CASE WHEN overall_rank = 8 THEN hotel_name END) AS "RANK_8_NAME",',
'MAX(CASE WHEN overall_rank = 8 THEN price END) AS "RANK_8_RATE",',
'MAX(CASE WHEN overall_rank = 9 THEN hotel_name END) AS "RANK_9_NAME",',
'MAX(CASE WHEN overall_rank = 9 THEN price END) AS "RANK_9_RATE",',
'MAX(CASE WHEN overall_rank = 10 THEN hotel_name END) AS "RANK_10_NAME",',
'MAX(CASE WHEN overall_rank = 10 THEN price END) AS "RANK_10_RATE",',
'MAX(CASE WHEN overall_rank = 11 THEN hotel_name END) AS "RANK_11_NAME",',
'MAX(CASE WHEN overall_rank = 11 THEN price END) AS "RANK_11_RATE" FROM all_properties_ranked GROUP BY "SDATE"',
') p',
'JOIN (',
'    SELECT "SDATE", price, overall_rank FROM all_properties_ranked WHERE hotel_name = ''DELTA_HOTELS_BY_MARRIOTT_YORK''',
') own ON p."SDATE" = own."SDATE";',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "UR_LOS1_INDIGO_RANKING_V" ("STAY_DATE", "OWN_PROPERTY_RATE", "OWN_PROPERTY_RANK", "RANK_1_NAME", "RANK_1_RATE", "RANK_2_NAME", "RANK_2_RATE", "RANK_3_NAME", "RANK_3_RATE", "RANK_4_NAME", "RANK_4_RATE", "RAN'
||'K_5_NAME", "RANK_5_RATE", "RANK_6_NAME", "RANK_6_RATE", "RANK_7_NAME", "RANK_7_RATE", "RANK_8_NAME", "RANK_8_RATE", "RANK_9_NAME", "RANK_9_RATE", "RANK_10_NAME", "RANK_10_RATE") AS ',
'  WITH all_properties_ranked AS (',
'    SELECT ',
'        "STAY_DATE",',
'        hotel_name,',
'        CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END AS price,',
'        ROW_NUMBER() OVER(PARTITION BY "STAY_DATE" ORDER BY CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END ASC NULLS LAST) as overall_rank',
'    FROM "UR_LOS1_INDIGO_T"',
'    UNPIVOT (price FOR hotel_name IN ("DELTA_HOTELS_BY_MARRIOTT_YORK", "DOUBLETREE_BY_HILTON_YORK", "ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON", "HAMPTON_BY_HILTON_YORK", "HILTON_YORK", "HOLIDAY_INN_YORK_AN_IHG_HOTEL", "HOTEL_INDIGO_YORK_AN_IHG_HOTE'
||'L", "MOXY_YORK", "NOVOTEL_YORK_CENTRE", "RADISSON_HOTEL_YORK"))',
')',
'SELECT ',
'    p."STAY_DATE" AS "STAY_DATE",',
'    own.price AS "OWN_PROPERTY_RATE",',
'    own.overall_rank AS "OWN_PROPERTY_RANK",',
'    p."RANK_1_NAME",',
'p."RANK_1_RATE",',
'p."RANK_2_NAME",',
'p."RANK_2_RATE",',
'p."RANK_3_NAME",',
'p."RANK_3_RATE",',
'p."RANK_4_NAME",',
'p."RANK_4_RATE",',
'p."RANK_5_NAME",',
'p."RANK_5_RATE",',
'p."RANK_6_NAME",',
'p."RANK_6_RATE",',
'p."RANK_7_NAME",',
'p."RANK_7_RATE",',
'p."RANK_8_NAME",',
'p."RANK_8_RATE",',
'p."RANK_9_NAME",',
'p."RANK_9_RATE",',
'p."RANK_10_NAME",',
'p."RANK_10_RATE"',
'FROM (',
'    SELECT "STAY_DATE", MAX(CASE WHEN overall_rank = 1 THEN hotel_name END) AS "RANK_1_NAME",',
'MAX(CASE WHEN overall_rank = 1 THEN price END) AS "RANK_1_RATE",',
'MAX(CASE WHEN overall_rank = 2 THEN hotel_name END) AS "RANK_2_NAME",',
'MAX(CASE WHEN overall_rank = 2 THEN price END) AS "RANK_2_RATE",',
'MAX(CASE WHEN overall_rank = 3 THEN hotel_name END) AS "RANK_3_NAME",',
'MAX(CASE WHEN overall_rank = 3 THEN price END) AS "RANK_3_RATE",',
'MAX(CASE WHEN overall_rank = 4 THEN hotel_name END) AS "RANK_4_NAME",',
'MAX(CASE WHEN overall_rank = 4 THEN price END) AS "RANK_4_RATE",',
'MAX(CASE WHEN overall_rank = 5 THEN hotel_name END) AS "RANK_5_NAME",',
'MAX(CASE WHEN overall_rank = 5 THEN price END) AS "RANK_5_RATE",',
'MAX(CASE WHEN overall_rank = 6 THEN hotel_name END) AS "RANK_6_NAME",',
'MAX(CASE WHEN overall_rank = 6 THEN price END) AS "RANK_6_RATE",',
'MAX(CASE WHEN overall_rank = 7 THEN hotel_name END) AS "RANK_7_NAME",',
'MAX(CASE WHEN overall_rank = 7 THEN price END) AS "RANK_7_RATE",',
'MAX(CASE WHEN overall_rank = 8 THEN hotel_name END) AS "RANK_8_NAME",',
'MAX(CASE WHEN overall_rank = 8 THEN price END) AS "RANK_8_RATE",',
'MAX(CASE WHEN overall_rank = 9 THEN hotel_name END) AS "RANK_9_NAME",',
'MAX(CASE WHEN overall_rank = 9 THEN price END) AS "RANK_9_RATE",',
'MAX(CASE WHEN overall_rank = 10 THEN hotel_name END) AS "RANK_10_NAME",',
'MAX(CASE WHEN overall_rank = 10 THEN price END) AS "RANK_10_RATE" FROM all_properties_ranked GROUP BY "STAY_DATE"',
') p',
'JOIN (',
'    SELECT "STAY_DATE", price, overall_rank FROM all_properties_ranked WHERE hotel_name = ''DELTA_HOTELS_BY_MARRIOTT_YORK''',
') own ON p."STAY_DATE" = own."STAY_DATE";',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "UR_LOS1_MCL_RANKING_V" ("STAY_DATE", "OWN_PROPERTY_RATE", "OWN_PROPERTY_RANK", "RANK_1_NAME", "RANK_1_RATE", "RANK_2_NAME", "RANK_2_RATE", "RANK_3_NAME", "RANK_3_RATE", "RANK_4_NAME", "RANK_4_RATE", "RANK_5'
||'_NAME", "RANK_5_RATE", "RANK_6_NAME", "RANK_6_RATE", "RANK_7_NAME", "RANK_7_RATE", "RANK_8_NAME", "RANK_8_RATE", "RANK_9_NAME", "RANK_9_RATE", "RANK_10_NAME", "RANK_10_RATE") AS ',
'  WITH all_properties_ranked AS (',
'    SELECT ',
'        "STAY_DATE",',
'        hotel_name,',
'        CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END AS price,',
'        ROW_NUMBER() OVER(PARTITION BY "STAY_DATE" ORDER BY CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END ASC NULLS LAST) as overall_rank',
'    FROM "UR_LOS1_MCL_T"',
'    UNPIVOT (price FOR hotel_name IN ("DELTA_HOTELS_BY_MARRIOTT_YORK", "DOUBLETREE_BY_HILTON_YORK", "ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON", "HAMPTON_BY_HILTON_YORK", "HILTON_YORK", "HOLIDAY_INN_YORK_AN_IHG_HOTEL", "HOTEL_INDIGO_YORK_AN_IHG_HOTE'
||'L", "MOXY_YORK", "NOVOTEL_YORK_CENTRE", "RADISSON_HOTEL_YORK"))',
')',
'SELECT ',
'    p."STAY_DATE" AS "STAY_DATE",',
'    own.price AS "OWN_PROPERTY_RATE",',
'    own.overall_rank AS "OWN_PROPERTY_RANK",',
'    p."RANK_1_NAME",',
'p."RANK_1_RATE",',
'p."RANK_2_NAME",',
'p."RANK_2_RATE",',
'p."RANK_3_NAME",',
'p."RANK_3_RATE",',
'p."RANK_4_NAME",',
'p."RANK_4_RATE",',
'p."RANK_5_NAME",',
'p."RANK_5_RATE",',
'p."RANK_6_NAME",',
'p."RANK_6_RATE",',
'p."RANK_7_NAME",',
'p."RANK_7_RATE",',
'p."RANK_8_NAME",',
'p."RANK_8_RATE",',
'p."RANK_9_NAME",',
'p."RANK_9_RATE",',
'p."RANK_10_NAME",',
'p."RANK_10_RATE"',
'FROM (',
'    SELECT "STAY_DATE", MAX(CASE WHEN overall_rank = 1 THEN hotel_name END) AS "RANK_1_NAME",',
'MAX(CASE WHEN overall_rank = 1 THEN price END) AS "RANK_1_RATE",',
'MAX(CASE WHEN overall_rank = 2 THEN hotel_name END) AS "RANK_2_NAME",',
'MAX(CASE WHEN overall_rank = 2 THEN price END) AS "RANK_2_RATE",',
'MAX(CASE WHEN overall_rank = 3 THEN hotel_name END) AS "RANK_3_NAME",',
'MAX(CASE WHEN overall_rank = 3 THEN price END) AS "RANK_3_RATE",',
'MAX(CASE WHEN overall_rank = 4 THEN hotel_name END) AS "RANK_4_NAME",',
'MAX(CASE WHEN overall_rank = 4 THEN price END) AS "RANK_4_RATE",',
'MAX(CASE WHEN overall_rank = 5 THEN hotel_name END) AS "RANK_5_NAME",',
'MAX(CASE WHEN overall_rank = 5 THEN price END) AS "RANK_5_RATE",',
'MAX(CASE WHEN overall_rank = 6 THEN hotel_name END) AS "RANK_6_NAME",',
'MAX(CASE WHEN overall_rank = 6 THEN price END) AS "RANK_6_RATE",',
'MAX(CASE WHEN overall_rank = 7 THEN hotel_name END) AS "RANK_7_NAME",',
'MAX(CASE WHEN overall_rank = 7 THEN price END) AS "RANK_7_RATE",',
'MAX(CASE WHEN overall_rank = 8 THEN hotel_name END) AS "RANK_8_NAME",',
'MAX(CASE WHEN overall_rank = 8 THEN price END) AS "RANK_8_RATE",',
'MAX(CASE WHEN overall_rank = 9 THEN hotel_name END) AS "RANK_9_NAME",',
'MAX(CASE WHEN overall_rank = 9 THEN price END) AS "RANK_9_RATE",',
'MAX(CASE WHEN overall_rank = 10 THEN hotel_name END) AS "RANK_10_NAME",',
'MAX(CASE WHEN overall_rank = 10 THEN price END) AS "RANK_10_RATE" FROM all_properties_ranked GROUP BY "STAY_DATE"',
') p',
'JOIN (',
'    SELECT "STAY_DATE", price, overall_rank FROM all_properties_ranked WHERE hotel_name = ''DELTA_HOTELS_BY_MARRIOTT_YORK''',
') own ON p."STAY_DATE" = own."STAY_DATE";',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "UR_LOS1_YORK_12_RANKING_V" ("STAY_DATE", "OWN_PROPERTY_RATE", "OWN_PROPERTY_RANK", "RANK_1_NAME", "RANK_1_RATE", "RANK_2_NAME", "RANK_2_RATE", "RANK_3_NAME", "RANK_3_RATE", "RANK_4_NAME", "RANK_4_RATE", "RA'
||'NK_5_NAME", "RANK_5_RATE", "RANK_6_NAME", "RANK_6_RATE", "RANK_7_NAME", "RANK_7_RATE", "RANK_8_NAME", "RANK_8_RATE", "RANK_9_NAME", "RANK_9_RATE", "RANK_10_NAME", "RANK_10_RATE", "RANK_11_NAME", "RANK_11_RATE") AS ',
'  WITH all_properties_ranked AS (',
'    SELECT ',
'        "SDATE",',
'        hotel_name,',
'        CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END AS price,',
'        ROW_NUMBER() OVER(PARTITION BY "SDATE" ORDER BY CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END ASC NULLS LAST) as overall_rank',
'    FROM "UR_LOS1_YORK_12_T"',
'    UNPIVOT (price FOR hotel_name IN ("DELTA_HOTELS_BY_MARRIOTT_YORK", "DOUBLETREE_BY_HILTON_YORK", "ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON", "HAMPTON_BY_HILTON_YORK", "HILTON_YORK", "HOLIDAY_INN_YORK_AN_IHG_HOTEL", "HOTEL_INDIGO_YORK_AN_IHG_HOTE'
||'L", "MOXY_YORK", "NOVOTEL_YORK_CENTRE", "RADISSON_HOTEL_YORK", "THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK"))',
')',
'SELECT ',
'    p."SDATE" AS "STAY_DATE",',
'    own.price AS "OWN_PROPERTY_RATE",',
'    own.overall_rank AS "OWN_PROPERTY_RANK",',
'    p."RANK_1_NAME",',
'p."RANK_1_RATE",',
'p."RANK_2_NAME",',
'p."RANK_2_RATE",',
'p."RANK_3_NAME",',
'p."RANK_3_RATE",',
'p."RANK_4_NAME",',
'p."RANK_4_RATE",',
'p."RANK_5_NAME",',
'p."RANK_5_RATE",',
'p."RANK_6_NAME",',
'p."RANK_6_RATE",',
'p."RANK_7_NAME",',
'p."RANK_7_RATE",',
'p."RANK_8_NAME",',
'p."RANK_8_RATE",',
'p."RANK_9_NAME",',
'p."RANK_9_RATE",',
'p."RANK_10_NAME",',
'p."RANK_10_RATE",',
'p."RANK_11_NAME",',
'p."RANK_11_RATE"',
'FROM (',
'    SELECT "SDATE", MAX(CASE WHEN overall_rank = 1 THEN hotel_name END) AS "RANK_1_NAME",',
'MAX(CASE WHEN overall_rank = 1 THEN price END) AS "RANK_1_RATE",',
'MAX(CASE WHEN overall_rank = 2 THEN hotel_name END) AS "RANK_2_NAME",',
'MAX(CASE WHEN overall_rank = 2 THEN price END) AS "RANK_2_RATE",',
'MAX(CASE WHEN overall_rank = 3 THEN hotel_name END) AS "RANK_3_NAME",',
'MAX(CASE WHEN overall_rank = 3 THEN price END) AS "RANK_3_RATE",',
'MAX(CASE WHEN overall_rank = 4 THEN hotel_name END) AS "RANK_4_NAME",',
'MAX(CASE WHEN overall_rank = 4 THEN price END) AS "RANK_4_RATE",',
'MAX(CASE WHEN overall_rank = 5 THEN hotel_name END) AS "RANK_5_NAME",',
'MAX(CASE WHEN overall_rank = 5 THEN price END) AS "RANK_5_RATE",',
'MAX(CASE WHEN overall_rank = 6 THEN hotel_name END) AS "RANK_6_NAME",',
'MAX(CASE WHEN overall_rank = 6 THEN price END) AS "RANK_6_RATE",',
'MAX(CASE WHEN overall_rank = 7 THEN hotel_name END) AS "RANK_7_NAME",',
'MAX(CASE WHEN overall_rank = 7 THEN price END) AS "RANK_7_RATE",',
'MAX(CASE WHEN overall_rank = 8 THEN hotel_name END) AS "RANK_8_NAME",',
'MAX(CASE WHEN overall_rank = 8 THEN price END) AS "RANK_8_RATE",',
'MAX(CASE WHEN overall_rank = 9 THEN hotel_name END) AS "RANK_9_NAME",',
'MAX(CASE WHEN overall_rank = 9 THEN price END) AS "RANK_9_RATE",',
'MAX(CASE WHEN overall_rank = 10 THEN hotel_name END) AS "RANK_10_NAME",',
'MAX(CASE WHEN overall_rank = 10 THEN price END) AS "RANK_10_RATE",',
'MAX(CASE WHEN overall_rank = 11 THEN hotel_name END) AS "RANK_11_NAME",',
'MAX(CASE WHEN overall_rank = 11 THEN price END) AS "RANK_11_RATE" FROM all_properties_ranked GROUP BY "SDATE"',
') p',
'JOIN (',
'    SELECT "SDATE", price, overall_rank FROM all_properties_ranked WHERE hotel_name = ''DELTA_HOTELS_BY_MARRIOTT_YORK''',
') own ON p."SDATE" = own."SDATE";',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "UR_LOS1_YORK_13OCT_RANKING_V" ("STAY_DATE", "OWN_PROPERTY_RATE", "OWN_PROPERTY_RANK", "RANK_1_NAME", "RANK_1_RATE", "RANK_2_NAME", "RANK_2_RATE", "RANK_3_NAME", "RANK_3_RATE", "RANK_4_NAME", "RANK_4_RATE", '
||'"RANK_5_NAME", "RANK_5_RATE", "RANK_6_NAME", "RANK_6_RATE", "RANK_7_NAME", "RANK_7_RATE", "RANK_8_NAME", "RANK_8_RATE", "RANK_9_NAME", "RANK_9_RATE", "RANK_10_NAME", "RANK_10_RATE", "RANK_11_NAME", "RANK_11_RATE") AS ',
'  WITH all_properties_ranked AS (',
'    SELECT ',
'        "SDATE",',
'        hotel_name,',
'        CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END AS price,',
'        ROW_NUMBER() OVER(PARTITION BY "SDATE" ORDER BY CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END ASC NULLS LAST) as overall_rank',
'    FROM "UR_LOS1_YORK_13OCT_T"',
'    UNPIVOT (price FOR hotel_name IN ("DELTA_HOTELS_BY_MARRIOTT_YORK", "DOUBLETREE_BY_HILTON_YORK", "ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON", "HAMPTON_BY_HILTON_YORK", "HILTON_YORK", "HOLIDAY_INN_YORK_AN_IHG_HOTEL", "HOTEL_INDIGO_YORK_AN_IHG_HOTE'
||'L", "MOXY_YORK", "NOVOTEL_YORK_CENTRE", "RADISSON_HOTEL_YORK", "THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK"))',
')',
'SELECT ',
'    p."SDATE" AS "STAY_DATE",',
'    own.price AS "OWN_PROPERTY_RATE",',
'    own.overall_rank AS "OWN_PROPERTY_RANK",',
'    p."RANK_1_NAME",',
'p."RANK_1_RATE",',
'p."RANK_2_NAME",',
'p."RANK_2_RATE",',
'p."RANK_3_NAME",',
'p."RANK_3_RATE",',
'p."RANK_4_NAME",',
'p."RANK_4_RATE",',
'p."RANK_5_NAME",',
'p."RANK_5_RATE",',
'p."RANK_6_NAME",',
'p."RANK_6_RATE",',
'p."RANK_7_NAME",',
'p."RANK_7_RATE",',
'p."RANK_8_NAME",',
'p."RANK_8_RATE",',
'p."RANK_9_NAME",',
'p."RANK_9_RATE",',
'p."RANK_10_NAME",',
'p."RANK_10_RATE",',
'p."RANK_11_NAME",',
'p."RANK_11_RATE"',
'FROM (',
'    SELECT "SDATE", MAX(CASE WHEN overall_rank = 1 THEN hotel_name END) AS "RANK_1_NAME",',
'MAX(CASE WHEN overall_rank = 1 THEN price END) AS "RANK_1_RATE",',
'MAX(CASE WHEN overall_rank = 2 THEN hotel_name END) AS "RANK_2_NAME",',
'MAX(CASE WHEN overall_rank = 2 THEN price END) AS "RANK_2_RATE",',
'MAX(CASE WHEN overall_rank = 3 THEN hotel_name END) AS "RANK_3_NAME",',
'MAX(CASE WHEN overall_rank = 3 THEN price END) AS "RANK_3_RATE",',
'MAX(CASE WHEN overall_rank = 4 THEN hotel_name END) AS "RANK_4_NAME",',
'MAX(CASE WHEN overall_rank = 4 THEN price END) AS "RANK_4_RATE",',
'MAX(CASE WHEN overall_rank = 5 THEN hotel_name END) AS "RANK_5_NAME",',
'MAX(CASE WHEN overall_rank = 5 THEN price END) AS "RANK_5_RATE",',
'MAX(CASE WHEN overall_rank = 6 THEN hotel_name END) AS "RANK_6_NAME",',
'MAX(CASE WHEN overall_rank = 6 THEN price END) AS "RANK_6_RATE",',
'MAX(CASE WHEN overall_rank = 7 THEN hotel_name END) AS "RANK_7_NAME",',
'MAX(CASE WHEN overall_rank = 7 THEN price END) AS "RANK_7_RATE",',
'MAX(CASE WHEN overall_rank = 8 THEN hotel_name END) AS "RANK_8_NAME",',
'MAX(CASE WHEN overall_rank = 8 THEN price END) AS "RANK_8_RATE",',
'MAX(CASE WHEN overall_rank = 9 THEN hotel_name END) AS "RANK_9_NAME",',
'MAX(CASE WHEN overall_rank = 9 THEN price END) AS "RANK_9_RATE",',
'MAX(CASE WHEN overall_rank = 10 THEN hotel_name END) AS "RANK_10_NAME",',
'MAX(CASE WHEN overall_rank = 10 THEN price END) AS "RANK_10_RATE",',
'MAX(CASE WHEN overall_rank = 11 THEN hotel_name END) AS "RANK_11_NAME",',
'MAX(CASE WHEN overall_rank = 11 THEN price END) AS "RANK_11_RATE" FROM all_properties_ranked GROUP BY "SDATE"',
') p',
'JOIN (',
'    SELECT "SDATE", price, overall_rank FROM all_properties_ranked WHERE hotel_name = ''DELTA_HOTELS_BY_MARRIOTT_YORK''',
') own ON p."SDATE" = own."SDATE";',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "UR_LOS1_YORK_13_RANKING_V" ("STAY_DATE", "OWN_PROPERTY_RATE", "OWN_PROPERTY_RANK", "RANK_1_NAME", "RANK_1_RATE", "RANK_2_NAME", "RANK_2_RATE", "RANK_3_NAME", "RANK_3_RATE", "RANK_4_NAME", "RANK_4_RATE", "RA'
||'NK_5_NAME", "RANK_5_RATE", "RANK_6_NAME", "RANK_6_RATE", "RANK_7_NAME", "RANK_7_RATE", "RANK_8_NAME", "RANK_8_RATE", "RANK_9_NAME", "RANK_9_RATE", "RANK_10_NAME", "RANK_10_RATE", "RANK_11_NAME", "RANK_11_RATE") AS ',
'  WITH all_properties_ranked AS (',
'    SELECT ',
'        "SDATE",',
'        hotel_name,',
'        CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END AS price,',
'        ROW_NUMBER() OVER(PARTITION BY "SDATE" ORDER BY CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','''))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
', '''')) ELSE NULL END ASC NULLS LAST) as overall_rank',
'    FROM "UR_LOS1_YORK_13_T"',
'    UNPIVOT (price FOR hotel_name IN ("DELTA_HOTELS_BY_MARRIOTT_YORK", "DOUBLETREE_BY_HILTON_YORK", "ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON", "HAMPTON_BY_HILTON_YORK", "HILTON_YORK", "HOLIDAY_INN_YORK_AN_IHG_HOTEL", "HOTEL_INDIGO_YORK_AN_IHG_HOTE'
||'L", "MOXY_YORK", "NOVOTEL_YORK_CENTRE", "RADISSON_HOTEL_YORK", "THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK"))',
')',
'SELECT ',
'    p."SDATE" AS "STAY_DATE",',
'    own.price AS "OWN_PROPERTY_RATE",',
'    own.overall_rank AS "OWN_PROPERTY_RANK",',
'    p."RANK_1_NAME",',
'p."RANK_1_RATE",',
'p."RANK_2_NAME",',
'p."RANK_2_RATE",',
'p."RANK_3_NAME",',
'p."RANK_3_RATE",',
'p."RANK_4_NAME",',
'p."RANK_4_RATE",',
'p."RANK_5_NAME",',
'p."RANK_5_RATE",',
'p."RANK_6_NAME",',
'p."RANK_6_RATE",',
'p."RANK_7_NAME",',
'p."RANK_7_RATE",',
'p."RANK_8_NAME",',
'p."RANK_8_RATE",',
'p."RANK_9_NAME",',
'p."RANK_9_RATE",',
'p."RANK_10_NAME",',
'p."RANK_10_RATE",',
'p."RANK_11_NAME",',
'p."RANK_11_RATE"',
'FROM (',
'    SELECT "SDATE", MAX(CASE WHEN overall_rank = 1 THEN hotel_name END) AS "RANK_1_NAME",',
'MAX(CASE WHEN overall_rank = 1 THEN price END) AS "RANK_1_RATE",',
'MAX(CASE WHEN overall_rank = 2 THEN hotel_name END) AS "RANK_2_NAME",',
'MAX(CASE WHEN overall_rank = 2 THEN price END) AS "RANK_2_RATE",',
'MAX(CASE WHEN overall_rank = 3 THEN hotel_name END) AS "RANK_3_NAME",',
'MAX(CASE WHEN overall_rank = 3 THEN price END) AS "RANK_3_RATE",',
'MAX(CASE WHEN overall_rank = 4 THEN hotel_name END) AS "RANK_4_NAME",',
'MAX(CASE WHEN overall_rank = 4 THEN price END) AS "RANK_4_RATE",',
'MAX(CASE WHEN overall_rank = 5 THEN hotel_name END) AS "RANK_5_NAME",',
'MAX(CASE WHEN overall_rank = 5 THEN price END) AS "RANK_5_RATE",',
'MAX(CASE WHEN overall_rank = 6 THEN hotel_name END) AS "RANK_6_NAME",',
'MAX(CASE WHEN overall_rank = 6 THEN price END) AS "RANK_6_RATE",',
'MAX(CASE WHEN overall_rank = 7 THEN hotel_name END) AS "RANK_7_NAME",',
'MAX(CASE WHEN overall_rank = 7 THEN price END) AS "RANK_7_RATE",',
'MAX(CASE WHEN overall_rank = 8 THEN hotel_name END) AS "RANK_8_NAME",',
'MAX(CASE WHEN overall_rank = 8 THEN price END) AS "RANK_8_RATE",',
'MAX(CASE WHEN overall_rank = 9 THEN hotel_name END) AS "RANK_9_NAME",',
'MAX(CASE WHEN overall_rank = 9 THEN price END) AS "RANK_9_RATE",',
'MAX(CASE WHEN overall_rank = 10 THEN hotel_name END) AS "RANK_10_NAME",',
'MAX(CASE WHEN overall_rank = 10 THEN price END) AS "RANK_10_RATE",',
'MAX(CASE WHEN overall_rank = 11 THEN hotel_name END) AS "RANK_11_NAME",',
'MAX(CASE WHEN overall_rank = 11 THEN price END) AS "RANK_11_RATE" FROM all_properties_ranked GROUP BY "SDATE"',
') p',
'JOIN (',
'    SELECT "SDATE", price, overall_rank FROM all_properties_ranked WHERE hotel_name = ''DELTA_HOTELS_BY_MARRIOTT_YORK''',
') own ON p."SDATE" = own."SDATE";',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "UR_LOS1_YORK_15_RANKING_V" ("STAY_DATE", "OWN_PROPERTY_RATE", "OWN_PROPERTY_RANK", "RANK_1_NAME", "RANK_1_RATE", "RANK_2_NAME", "RANK_2_RATE", "RANK_3_NAME", "RANK_3_RATE", "RANK_4_NAME", "RANK_4_RATE") AS ',
'  WITH all_properties_ranked AS (',
'    SELECT ',
'        "SDATE",',
'        hotel_name,',
'        CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END AS price,',
'        ROW_NUMBER() OVER(PARTITION BY "SDATE" ORDER BY CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END ASC NULLS LAST) as overall_rank',
'    FROM "UR_LOS1_YORK_15_T"',
'    UNPIVOT (price FOR hotel_name IN ("DELTA_HOTELS_BY_MARRIOTT_YORK", "DOUBLETREE_BY_HILTON_YORK", "ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON", "HAMPTON_BY_HILTON_YORK"))',
')',
'SELECT ',
'    p."SDATE" AS "STAY_DATE",',
'    own.price AS "OWN_PROPERTY_RATE",',
'    own.overall_rank AS "OWN_PROPERTY_RANK",',
'    p."RANK_1_NAME",',
'p."RANK_1_RATE",',
'p."RANK_2_NAME",',
'p."RANK_2_RATE",',
'p."RANK_3_NAME",',
'p."RANK_3_RATE",',
'p."RANK_4_NAME",',
'p."RANK_4_RATE"',
'FROM (',
'    SELECT "SDATE", MAX(CASE WHEN overall_rank = 1 THEN hotel_name END) AS "RANK_1_NAME",',
'MAX(CASE WHEN overall_rank = 1 THEN price END) AS "RANK_1_RATE",',
'MAX(CASE WHEN overall_rank = 2 THEN hotel_name END) AS "RANK_2_NAME",',
'MAX(CASE WHEN overall_rank = 2 THEN price END) AS "RANK_2_RATE",',
'MAX(CASE WHEN overall_rank = 3 THEN hotel_name END) AS "RANK_3_NAME",',
'MAX(CASE WHEN overall_rank = 3 THEN price END) AS "RANK_3_RATE",',
'MAX(CASE WHEN overall_rank = 4 THEN hotel_name END) AS "RANK_4_NAME",',
'MAX(CASE WHEN overall_rank = 4 THEN price END) AS "RANK_4_RATE" FROM all_properties_ranked GROUP BY "SDATE"',
') p',
'JOIN (',
'    SELECT "SDATE", price, overall_rank FROM all_properties_ranked WHERE hotel_name = ''DELTA_HOTELS_BY_MARRIOTT_YORK''',
') own ON p."SDATE" = own."SDATE";',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "UR_LOS1_YORK_2_RANKING_V" ("STAY_DATE", "OWN_PROPERTY_RATE", "OWN_PROPERTY_RANK", "RANK_1_NAME", "RANK_1_RATE", "RANK_2_NAME", "RANK_2_RATE", "RANK_3_NAME", "RANK_3_RATE", "RANK_4_NAME", "RANK_4_RATE", "RAN'
||'K_5_NAME", "RANK_5_RATE", "RANK_6_NAME", "RANK_6_RATE", "RANK_7_NAME", "RANK_7_RATE", "RANK_8_NAME", "RANK_8_RATE", "RANK_9_NAME", "RANK_9_RATE", "RANK_10_NAME", "RANK_10_RATE", "RANK_11_NAME", "RANK_11_RATE") AS ',
'  WITH all_properties_ranked AS (',
'    SELECT ',
'        "SDATE",',
'        hotel_name,',
'        CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END AS price,',
'        ROW_NUMBER() OVER(PARTITION BY "SDATE" ORDER BY CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END ASC NULLS LAST) as overall_rank',
'    FROM "UR_LOS1_YORK_2_T"',
'    UNPIVOT (price FOR hotel_name IN ("DELTA_HOTELS_BY_MARRIOTT_YORK", "DOUBLETREE_BY_HILTON_YORK", "ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON", "HAMPTON_BY_HILTON_YORK", "HILTON_YORK", "HOLIDAY_INN_YORK_AN_IHG_HOTEL", "HOTEL_INDIGO_YORK_AN_IHG_HOTE'
||'L", "MOXY_YORK", "NOVOTEL_YORK_CENTRE", "RADISSON_HOTEL_YORK", "THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK"))',
')',
'SELECT ',
'    p."SDATE" AS "STAY_DATE",',
'    own.price AS "OWN_PROPERTY_RATE",',
'    own.overall_rank AS "OWN_PROPERTY_RANK",',
'    p."RANK_1_NAME",',
'p."RANK_1_RATE",',
'p."RANK_2_NAME",',
'p."RANK_2_RATE",',
'p."RANK_3_NAME",',
'p."RANK_3_RATE",',
'p."RANK_4_NAME",',
'p."RANK_4_RATE",',
'p."RANK_5_NAME",',
'p."RANK_5_RATE",',
'p."RANK_6_NAME",',
'p."RANK_6_RATE",',
'p."RANK_7_NAME",',
'p."RANK_7_RATE",',
'p."RANK_8_NAME",',
'p."RANK_8_RATE",',
'p."RANK_9_NAME",',
'p."RANK_9_RATE",',
'p."RANK_10_NAME",',
'p."RANK_10_RATE",',
'p."RANK_11_NAME",',
'p."RANK_11_RATE"',
'FROM (',
'    SELECT "SDATE", MAX(CASE WHEN overall_rank = 1 THEN hotel_name END) AS "RANK_1_NAME",',
'MAX(CASE WHEN overall_rank = 1 THEN price END) AS "RANK_1_RATE",',
'MAX(CASE WHEN overall_rank = 2 THEN hotel_name END) AS "RANK_2_NAME",',
'MAX(CASE WHEN overall_rank = 2 THEN price END) AS "RANK_2_RATE",',
'MAX(CASE WHEN overall_rank = 3 THEN hotel_name END) AS "RANK_3_NAME",',
'MAX(CASE WHEN overall_rank = 3 THEN price END) AS "RANK_3_RATE",',
'MAX(CASE WHEN overall_rank = 4 THEN hotel_name END) AS "RANK_4_NAME",',
'MAX(CASE WHEN overall_rank = 4 THEN price END) AS "RANK_4_RATE",',
'MAX(CASE WHEN overall_rank = 5 THEN hotel_name END) AS "RANK_5_NAME",',
'MAX(CASE WHEN overall_rank = 5 THEN price END) AS "RANK_5_RATE",',
'MAX(CASE WHEN overall_rank = 6 THEN hotel_name END) AS "RANK_6_NAME",',
'MAX(CASE WHEN overall_rank = 6 THEN price END) AS "RANK_6_RATE",',
'MAX(CASE WHEN overall_rank = 7 THEN hotel_name END) AS "RANK_7_NAME",',
'MAX(CASE WHEN overall_rank = 7 THEN price END) AS "RANK_7_RATE",',
'MAX(CASE WHEN overall_rank = 8 THEN hotel_name END) AS "RANK_8_NAME",',
'MAX(CASE WHEN overall_rank = 8 THEN price END) AS "RANK_8_RATE",',
'MAX(CASE WHEN overall_rank = 9 THEN hotel_name END) AS "RANK_9_NAME",',
'MAX(CASE WHEN overall_rank = 9 THEN price END) AS "RANK_9_RATE",',
'MAX(CASE WHEN overall_rank = 10 THEN hotel_name END) AS "RANK_10_NAME",',
'MAX(CASE WHEN overall_rank = 10 THEN price END) AS "RANK_10_RATE",',
'MAX(CASE WHEN overall_rank = 11 THEN hotel_name END) AS "RANK_11_NAME",',
'MAX(CASE WHEN overall_rank = 11 THEN price END) AS "RANK_11_RATE" FROM all_properties_ranked GROUP BY "SDATE"',
') p',
'JOIN (',
'    SELECT "SDATE", price, overall_rank FROM all_properties_ranked WHERE hotel_name = ''DELTA_HOTELS_BY_MARRIOTT_YORK''',
') own ON p."SDATE" = own."SDATE";',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "UR_MCL_LOS1_RANKING_V" ("STAY_DATE", "HOTEL_ID", "OWN_PROPERTY_RATE", "OWN_PROPERTY_RANK", "RANK_1_NAME", "RANK_1_RATE", "RANK_2_NAME", "RANK_2_RATE", "RANK_3_NAME", "RANK_3_RATE", "RANK_4_NAME", "RANK_4_RA'
||'TE", "RANK_5_NAME", "RANK_5_RATE", "RANK_6_NAME", "RANK_6_RATE", "RANK_7_NAME", "RANK_7_RATE", "RANK_8_NAME", "RANK_8_RATE", "RANK_9_NAME", "RANK_9_RATE", "RANK_10_NAME", "RANK_10_RATE", "RANK_11_NAME", "RANK_11_RATE") AS ',
'  WITH all_properties_ranked AS (',
'  SELECT',
'    "SDATE",',
'    hotel_id, -- <<< ADDED',
'    hotel_name,',
'    CASE',
'      WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', ''''))',
'      ELSE NULL',
'    END AS price,',
'    ROW_NUMBER() OVER(',
'      PARTITION BY',
'        "SDATE"',
'      ORDER BY',
'        CASE',
'          WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', ''''))',
'          ELSE NULL',
'        END ASC NULLS LAST',
'    ) as overall_rank',
'  FROM',
'    "UR_MCL_LOS1_T" UNPIVOT (',
'      price FOR hotel_name IN (',
'        "DELTA_HOTELS_BY_MARRIOTT_YORK",',
'        "DOUBLETREE_BY_HILTON_YORK",',
'        "ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON",',
'        "HAMPTON_BY_HILTON_YORK",',
'        "HILTON_YORK",',
'        "HOLIDAY_INN_YORK_AN_IHG_HOTEL",',
'        "HOTEL_INDIGO_YORK_AN_IHG_HOTEL",',
'        "MOXY_YORK",',
'        "NOVOTEL_YORK_CENTRE",',
'        "RADISSON_HOTEL_YORK",',
'        "THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK"',
'      )',
'    )',
')',
'SELECT',
'  p."SDATE" AS "STAY_DATE",',
'  own.hotel_id AS "HOTEL_ID", -- <<< ADDED',
'  own.price AS "OWN_PROPERTY_RATE",',
'  own.overall_rank AS "OWN_PROPERTY_RANK",',
'  p."RANK_1_NAME",',
'  p."RANK_1_RATE",',
'  p."RANK_2_NAME",',
'  p."RANK_2_RATE",',
'  p."RANK_3_NAME",',
'  p."RANK_3_RATE",',
'  p."RANK_4_NAME",',
'  p."RANK_4_RATE",',
'  p."RANK_5_NAME",',
'  p."RANK_5_RATE",',
'  p."RANK_6_NAME",',
'  p."RANK_6_RATE",',
'  p."RANK_7_NAME",',
'  p."RANK_7_RATE",',
'  p."RANK_8_NAME",',
'  p."RANK_8_RATE",',
'  p."RANK_9_NAME",',
'  p."RANK_9_RATE",',
'  p."RANK_10_NAME",',
'  p."RANK_10_RATE",',
'  p."RANK_11_NAME",',
'  p."RANK_11_RATE"',
'FROM',
'  (',
'    SELECT',
'      "SDATE",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 1 THEN hotel_name',
'        END',
'      ) AS "RANK_1_NAME",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 1 THEN price',
'        END',
'      ) AS "RANK_1_RATE",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 2 THEN hotel_name',
'        END',
'      ) AS "RANK_2_NAME",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 2 THEN price',
'        END',
'      ) AS "RANK_2_RATE",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 3 THEN hotel_name',
'        END',
'      ) AS "RANK_3_NAME",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 3 THEN price',
'        END',
'      ) AS "RANK_3_RATE",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 4 THEN hotel_name',
'        END',
'      ) AS "RANK_4_NAME",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 4 THEN price',
'        END',
'      ) AS "RANK_4_RATE",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 5 THEN hotel_name',
'        END',
'      ) AS "RANK_5_NAME",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 5 THEN price',
'        END',
'      ) AS "RANK_5_RATE",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 6 THEN hotel_name',
'        END',
'      ) AS "RANK_6_NAME",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 6 THEN price',
'        END',
'      ) AS "RANK_6_RATE",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 7 THEN hotel_name',
'        END',
'      ) AS "RANK_7_NAME",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 7 THEN price',
'        END',
'      ) AS "RANK_7_RATE",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 8 THEN hotel_name',
'        END',
'      ) AS "RANK_8_NAME",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 8 THEN price',
'        END',
'      ) AS "RANK_8_RATE",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 9 THEN hotel_name',
'        END',
'      ) AS "RANK_9_NAME",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 9 THEN price',
'        END',
'      ) AS "RANK_9_RATE",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 10 THEN hotel_name',
'        END',
'      ) AS "RANK_10_NAME",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 10 THEN price',
'        END',
'      ) AS "RANK_10_RATE",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 11 THEN hotel_name',
'        END',
'      ) AS "RANK_11_NAME",',
'      MAX(',
'        CASE',
'          WHEN overall_rank = 11 THEN price',
'        END',
'      ) AS "RANK_11_RATE"',
'    FROM',
'      all_properties_ranked',
'    GROUP BY',
'      "SDATE"',
'  ) p',
'  JOIN (',
'    SELECT',
'      "SDATE",',
'      hotel_id, -- <<< ADDED',
'      price,',
'      overall_rank',
'    FROM',
'      all_properties_ranked',
'    WHERE',
'      hotel_name = ''DELTA_HOTELS_BY_MARRIOTT_YORK''',
'  ) own ON p."SDATE" = own."SDATE";',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "UR_VK_LOS1_YORK_2_RANKING_V" ("STAY_DATE", "OWN_PROPERTY_RATE", "OWN_PROPERTY_RANK", "RANK_1_NAME", "RANK_1_RATE", "RANK_2_NAME", "RANK_2_RATE", "RANK_3_NAME", "RANK_3_RATE", "RANK_4_NAME", "RANK_4_RATE", "'
||'RANK_5_NAME", "RANK_5_RATE", "RANK_6_NAME", "RANK_6_RATE", "RANK_7_NAME", "RANK_7_RATE", "RANK_8_NAME", "RANK_8_RATE", "RANK_9_NAME", "RANK_9_RATE", "RANK_10_NAME", "RANK_10_RATE", "RANK_11_NAME", "RANK_11_RATE") AS ',
'  WITH all_properties_ranked AS (',
'    SELECT ',
'        "SDATE",',
'        hotel_name,',
'        CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END AS price,',
'        ROW_NUMBER() OVER(PARTITION BY "SDATE" ORDER BY CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END ASC NULLS LAST) as overall_rank',
'    FROM "UR_VK_LOS1_YORK_2_T"',
'    UNPIVOT (price FOR hotel_name IN ("DELTA_HOTELS_BY_MARRIOTT_YORK", "DOUBLETREE_BY_HILTON_YORK", "ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON", "HAMPTON_BY_HILTON_YORK", "HILTON_YORK", "HOLIDAY_INN_YORK_AN_IHG_HOTEL", "HOTEL_INDIGO_YORK_AN_IHG_HOTE'
||'L", "MOXY_YORK", "NOVOTEL_YORK_CENTRE", "RADISSON_HOTEL_YORK", "THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK"))',
')',
'SELECT ',
'    p."SDATE" AS "STAY_DATE",',
'    own.price AS "OWN_PROPERTY_RATE",',
'    own.overall_rank AS "OWN_PROPERTY_RANK",',
'    p."RANK_1_NAME",',
'p."RANK_1_RATE",',
'p."RANK_2_NAME",',
'p."RANK_2_RATE",',
'p."RANK_3_NAME",',
'p."RANK_3_RATE",',
'p."RANK_4_NAME",',
'p."RANK_4_RATE",',
'p."RANK_5_NAME",',
'p."RANK_5_RATE",',
'p."RANK_6_NAME",',
'p."RANK_6_RATE",',
'p."RANK_7_NAME",',
'p."RANK_7_RATE",',
'p."RANK_8_NAME",',
'p."RANK_8_RATE",',
'p."RANK_9_NAME",',
'p."RANK_9_RATE",',
'p."RANK_10_NAME",',
'p."RANK_10_RATE",',
'p."RANK_11_NAME",',
'p."RANK_11_RATE"',
'FROM (',
'    SELECT "SDATE", MAX(CASE WHEN overall_rank = 1 THEN hotel_name END) AS "RANK_1_NAME",',
'MAX(CASE WHEN overall_rank = 1 THEN price END) AS "RANK_1_RATE",',
'MAX(CASE WHEN overall_rank = 2 THEN hotel_name END) AS "RANK_2_NAME",',
'MAX(CASE WHEN overall_rank = 2 THEN price END) AS "RANK_2_RATE",',
'MAX(CASE WHEN overall_rank = 3 THEN hotel_name END) AS "RANK_3_NAME",',
'MAX(CASE WHEN overall_rank = 3 THEN price END) AS "RANK_3_RATE",',
'MAX(CASE WHEN overall_rank = 4 THEN hotel_name END) AS "RANK_4_NAME",',
'MAX(CASE WHEN overall_rank = 4 THEN price END) AS "RANK_4_RATE",',
'MAX(CASE WHEN overall_rank = 5 THEN hotel_name END) AS "RANK_5_NAME",',
'MAX(CASE WHEN overall_rank = 5 THEN price END) AS "RANK_5_RATE",',
'MAX(CASE WHEN overall_rank = 6 THEN hotel_name END) AS "RANK_6_NAME",',
'MAX(CASE WHEN overall_rank = 6 THEN price END) AS "RANK_6_RATE",',
'MAX(CASE WHEN overall_rank = 7 THEN hotel_name END) AS "RANK_7_NAME",',
'MAX(CASE WHEN overall_rank = 7 THEN price END) AS "RANK_7_RATE",',
'MAX(CASE WHEN overall_rank = 8 THEN hotel_name END) AS "RANK_8_NAME",',
'MAX(CASE WHEN overall_rank = 8 THEN price END) AS "RANK_8_RATE",',
'MAX(CASE WHEN overall_rank = 9 THEN hotel_name END) AS "RANK_9_NAME",',
'MAX(CASE WHEN overall_rank = 9 THEN price END) AS "RANK_9_RATE",',
'MAX(CASE WHEN overall_rank = 10 THEN hotel_name END) AS "RANK_10_NAME",',
'MAX(CASE WHEN overall_rank = 10 THEN price END) AS "RANK_10_RATE",',
'MAX(CASE WHEN overall_rank = 11 THEN hotel_name END) AS "RANK_11_NAME",',
'MAX(CASE WHEN overall_rank = 11 THEN price END) AS "RANK_11_RATE" FROM all_properties_ranked GROUP BY "SDATE"',
') p',
'JOIN (',
'    SELECT "SDATE", price, overall_rank FROM all_properties_ranked WHERE hotel_name = ''DELTA_HOTELS_BY_MARRIOTT_YORK''',
') own ON p."SDATE" = own."SDATE";',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "UR_VK_LOS1_YORK_3_RANKING_V" ("STAY_DATE", "OWN_PROPERTY_RATE", "OWN_PROPERTY_RANK", "RANK_1_NAME", "RANK_1_RATE", "RANK_2_NAME", "RANK_2_RATE", "RANK_3_NAME", "RANK_3_RATE", "RANK_4_NAME", "RANK_4_RATE", "'
||'RANK_5_NAME", "RANK_5_RATE", "RANK_6_NAME", "RANK_6_RATE", "RANK_7_NAME", "RANK_7_RATE", "RANK_8_NAME", "RANK_8_RATE", "RANK_9_NAME", "RANK_9_RATE", "RANK_10_NAME", "RANK_10_RATE", "RANK_11_NAME", "RANK_11_RATE") AS ',
'  WITH all_properties_ranked AS (',
'    SELECT ',
'        "SDATE",',
'        hotel_name,',
'        CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END AS price,',
'        ROW_NUMBER() OVER(PARTITION BY "SDATE" ORDER BY CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END ASC NULLS LAST) as overall_rank',
'    FROM "UR_VK_LOS1_YORK_3_T"',
'    UNPIVOT (price FOR hotel_name IN ("DELTA_HOTELS_BY_MARRIOTT_YORK", "DOUBLETREE_BY_HILTON_YORK", "ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON", "HAMPTON_BY_HILTON_YORK", "HILTON_YORK", "HOLIDAY_INN_YORK_AN_IHG_HOTEL", "HOTEL_INDIGO_YORK_AN_IHG_HOTE'
||'L", "MOXY_YORK", "NOVOTEL_YORK_CENTRE", "RADISSON_HOTEL_YORK", "THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK"))',
')',
'SELECT ',
'    p."SDATE" AS "STAY_DATE",',
'    own.price AS "OWN_PROPERTY_RATE",',
'    own.overall_rank AS "OWN_PROPERTY_RANK",',
'    p."RANK_1_NAME",',
'p."RANK_1_RATE",',
'p."RANK_2_NAME",',
'p."RANK_2_RATE",',
'p."RANK_3_NAME",',
'p."RANK_3_RATE",',
'p."RANK_4_NAME",',
'p."RANK_4_RATE",',
'p."RANK_5_NAME",',
'p."RANK_5_RATE",',
'p."RANK_6_NAME",',
'p."RANK_6_RATE",',
'p."RANK_7_NAME",',
'p."RANK_7_RATE",',
'p."RANK_8_NAME",',
'p."RANK_8_RATE",',
'p."RANK_9_NAME",',
'p."RANK_9_RATE",',
'p."RANK_10_NAME",',
'p."RANK_10_RATE",',
'p."RANK_11_NAME",',
'p."RANK_11_RATE"',
'FROM (',
'    SELECT "SDATE", MAX(CASE WHEN overall_rank = 1 THEN hotel_name END) AS "RANK_1_NAME",',
'MAX(CASE WHEN overall_rank = 1 THEN price END) AS "RANK_1_RATE",',
'MAX(CASE WHEN overall_rank = 2 THEN hotel_name END) AS "RANK_2_NAME",',
'MAX(CASE WHEN overall_rank = 2 THEN price END) AS "RANK_2_RATE",',
'MAX(CASE WHEN overall_rank = 3 THEN hotel_name END) AS "RANK_3_NAME",',
'MAX(CASE WHEN overall_rank = 3 THEN price END) AS "RANK_3_RATE",',
'MAX(CASE WHEN overall_rank = 4 THEN hotel_name END) AS "RANK_4_NAME",',
'MAX(CASE WHEN overall_rank = 4 THEN price END) AS "RANK_4_RATE",',
'MAX(CASE WHEN overall_rank = 5 THEN hotel_name END) AS "RANK_5_NAME",',
'MAX(CASE WHEN overall_rank = 5 THEN price END) AS "RANK_5_RATE",',
'MAX(CASE WHEN overall_rank = 6 THEN hotel_name END) AS "RANK_6_NAME",',
'MAX(CASE WHEN overall_rank = 6 THEN price END) AS "RANK_6_RATE",',
'MAX(CASE WHEN overall_rank = 7 THEN hotel_name END) AS "RANK_7_NAME",',
'MAX(CASE WHEN overall_rank = 7 THEN price END) AS "RANK_7_RATE",',
'MAX(CASE WHEN overall_rank = 8 THEN hotel_name END) AS "RANK_8_NAME",',
'MAX(CASE WHEN overall_rank = 8 THEN price END) AS "RANK_8_RATE",',
'MAX(CASE WHEN overall_rank = 9 THEN hotel_name END) AS "RANK_9_NAME",',
'MAX(CASE WHEN overall_rank = 9 THEN price END) AS "RANK_9_RATE",',
'MAX(CASE WHEN overall_rank = 10 THEN hotel_name END) AS "RANK_10_NAME",',
'MAX(CASE WHEN overall_rank = 10 THEN price END) AS "RANK_10_RATE",',
'MAX(CASE WHEN overall_rank = 11 THEN hotel_name END) AS "RANK_11_NAME",',
'MAX(CASE WHEN overall_rank = 11 THEN price END) AS "RANK_11_RATE" FROM all_properties_ranked GROUP BY "SDATE"',
') p',
'JOIN (',
'    SELECT "SDATE", price, overall_rank FROM all_properties_ranked WHERE hotel_name = ''DELTA_HOTELS_BY_MARRIOTT_YORK''',
') own ON p."SDATE" = own."SDATE";',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "UR_VK_LOS1_YORK_4_RANKING_V" ("STAY_DATE", "OWN_PROPERTY_RATE", "OWN_PROPERTY_RANK", "RANK_1_NAME", "RANK_1_RATE", "RANK_2_NAME", "RANK_2_RATE", "RANK_3_NAME", "RANK_3_RATE", "RANK_4_NAME", "RANK_4_RATE", "'
||'RANK_5_NAME", "RANK_5_RATE", "RANK_6_NAME", "RANK_6_RATE", "RANK_7_NAME", "RANK_7_RATE", "RANK_8_NAME", "RANK_8_RATE") AS ',
'  WITH all_properties_ranked AS (',
'    SELECT ',
'        "SDATE",',
'        hotel_name,',
'        CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END AS price,',
'        ROW_NUMBER() OVER(PARTITION BY "SDATE" ORDER BY CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END ASC NULLS LAST) as overall_rank',
'    FROM "UR_VK_LOS1_YORK_4_T"',
'    UNPIVOT (price FOR hotel_name IN ("DELTA_HOTELS_BY_MARRIOTT_YORK", "DOUBLETREE_BY_HILTON_YORK", "HILTON_YORK", "HOLIDAY_INN_YORK_AN_IHG_HOTEL", "MOXY_YORK", "NOVOTEL_YORK_CENTRE", "RADISSON_HOTEL_YORK", "THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YOR'
||'K"))',
')',
'SELECT ',
'    p."SDATE" AS "STAY_DATE",',
'    own.price AS "OWN_PROPERTY_RATE",',
'    own.overall_rank AS "OWN_PROPERTY_RANK",',
'    p."RANK_1_NAME",',
'p."RANK_1_RATE",',
'p."RANK_2_NAME",',
'p."RANK_2_RATE",',
'p."RANK_3_NAME",',
'p."RANK_3_RATE",',
'p."RANK_4_NAME",',
'p."RANK_4_RATE",',
'p."RANK_5_NAME",',
'p."RANK_5_RATE",',
'p."RANK_6_NAME",',
'p."RANK_6_RATE",',
'p."RANK_7_NAME",',
'p."RANK_7_RATE",',
'p."RANK_8_NAME",',
'p."RANK_8_RATE"',
'FROM (',
'    SELECT "SDATE", MAX(CASE WHEN overall_rank = 1 THEN hotel_name END) AS "RANK_1_NAME",',
'MAX(CASE WHEN overall_rank = 1 THEN price END) AS "RANK_1_RATE",',
'MAX(CASE WHEN overall_rank = 2 THEN hotel_name END) AS "RANK_2_NAME",',
'MAX(CASE WHEN overall_rank = 2 THEN price END) AS "RANK_2_RATE",',
'MAX(CASE WHEN overall_rank = 3 THEN hotel_name END) AS "RANK_3_NAME",',
'MAX(CASE WHEN overall_rank = 3 THEN price END) AS "RANK_3_RATE",',
'MAX(CASE WHEN overall_rank = 4 THEN hotel_name END) AS "RANK_4_NAME",',
'MAX(CASE WHEN overall_rank = 4 THEN price END) AS "RANK_4_RATE",',
'MAX(CASE WHEN overall_rank = 5 THEN hotel_name END) AS "RANK_5_NAME",',
'MAX(CASE WHEN overall_rank = 5 THEN price END) AS "RANK_5_RATE",',
'MAX(CASE WHEN overall_rank = 6 THEN hotel_name END) AS "RANK_6_NAME",',
'MAX(CASE WHEN overall_rank = 6 THEN price END) AS "RANK_6_RATE",',
'MAX(CASE WHEN overall_rank = 7 THEN hotel_name END) AS "RANK_7_NAME",',
'MAX(CASE WHEN overall_rank = 7 THEN price END) AS "RANK_7_RATE",',
'MAX(CASE WHEN overall_rank = 8 THEN hotel_name END) AS "RANK_8_NAME",',
'MAX(CASE WHEN overall_rank = 8 THEN price END) AS "RANK_8_RATE" FROM all_properties_ranked GROUP BY "SDATE"',
') p',
'JOIN (',
'    SELECT "SDATE", price, overall_rank FROM all_properties_ranked WHERE hotel_name = ''DELTA_HOTELS_BY_MARRIOTT_YORK''',
') own ON p."SDATE" = own."SDATE";',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "UR_VK_LOS1_YORK_RANKING_V" ("STAY_DATE", "OWN_PROPERTY_RATE", "OWN_PROPERTY_RANK", "RANK_1_NAME", "RANK_1_RATE", "RANK_2_NAME", "RANK_2_RATE", "RANK_3_NAME", "RANK_3_RATE", "RANK_4_NAME", "RANK_4_RATE", "RA'
||'NK_5_NAME", "RANK_5_RATE", "RANK_6_NAME", "RANK_6_RATE", "RANK_7_NAME", "RANK_7_RATE", "RANK_8_NAME", "RANK_8_RATE", "RANK_9_NAME", "RANK_9_RATE", "RANK_10_NAME", "RANK_10_RATE", "RANK_11_NAME", "RANK_11_RATE") AS ',
'  WITH all_properties_ranked AS (',
'    SELECT ',
'        "SDATE",',
'        hotel_name,',
'        CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END AS price,',
'        ROW_NUMBER() OVER(PARTITION BY "SDATE" ORDER BY CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END ASC NULLS LAST) as overall_rank',
'    FROM "UR_VK_LOS1_YORK_T"',
'    UNPIVOT (price FOR hotel_name IN ("DELTA_HOTELS_BY_MARRIOTT_YORK", "DOUBLETREE_BY_HILTON_YORK", "ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON", "HAMPTON_BY_HILTON_YORK", "HILTON_YORK", "HOLIDAY_INN_YORK_AN_IHG_HOTEL", "HOTEL_INDIGO_YORK_AN_IHG_HOTE'
||'L", "MOXY_YORK", "NOVOTEL_YORK_CENTRE", "RADISSON_HOTEL_YORK", "THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK"))',
')',
'SELECT ',
'    p."SDATE" AS "STAY_DATE",',
'    own.price AS "OWN_PROPERTY_RATE",',
'    own.overall_rank AS "OWN_PROPERTY_RANK",',
'    p."RANK_1_NAME",',
'p."RANK_1_RATE",',
'p."RANK_2_NAME",',
'p."RANK_2_RATE",',
'p."RANK_3_NAME",',
'p."RANK_3_RATE",',
'p."RANK_4_NAME",',
'p."RANK_4_RATE",',
'p."RANK_5_NAME",',
'p."RANK_5_RATE",',
'p."RANK_6_NAME",',
'p."RANK_6_RATE",',
'p."RANK_7_NAME",',
'p."RANK_7_RATE",',
'p."RANK_8_NAME",',
'p."RANK_8_RATE",',
'p."RANK_9_NAME",',
'p."RANK_9_RATE",',
'p."RANK_10_NAME",',
'p."RANK_10_RATE",',
'p."RANK_11_NAME",',
'p."RANK_11_RATE"',
'FROM (',
'    SELECT "SDATE", MAX(CASE WHEN overall_rank = 1 THEN hotel_name END) AS "RANK_1_NAME",',
'MAX(CASE WHEN overall_rank = 1 THEN price END) AS "RANK_1_RATE",',
'MAX(CASE WHEN overall_rank = 2 THEN hotel_name END) AS "RANK_2_NAME",',
'MAX(CASE WHEN overall_rank = 2 THEN price END) AS "RANK_2_RATE",',
'MAX(CASE WHEN overall_rank = 3 THEN hotel_name END) AS "RANK_3_NAME",',
'MAX(CASE WHEN overall_rank = 3 THEN price END) AS "RANK_3_RATE",',
'MAX(CASE WHEN overall_rank = 4 THEN hotel_name END) AS "RANK_4_NAME",',
'MAX(CASE WHEN overall_rank = 4 THEN price END) AS "RANK_4_RATE",',
'MAX(CASE WHEN overall_rank = 5 THEN hotel_name END) AS "RANK_5_NAME",',
'MAX(CASE WHEN overall_rank = 5 THEN price END) AS "RANK_5_RATE",',
'MAX(CASE WHEN overall_rank = 6 THEN hotel_name END) AS "RANK_6_NAME",',
'MAX(CASE WHEN overall_rank = 6 THEN price END) AS "RANK_6_RATE",',
'MAX(CASE WHEN overall_rank = 7 THEN hotel_name END) AS "RANK_7_NAME",',
'MAX(CASE WHEN overall_rank = 7 THEN price END) AS "RANK_7_RATE",',
'MAX(CASE WHEN overall_rank = 8 THEN hotel_name END) AS "RANK_8_NAME",',
'MAX(CASE WHEN overall_rank = 8 THEN price END) AS "RANK_8_RATE",',
'MAX(CASE WHEN overall_rank = 9 THEN hotel_name END) AS "RANK_9_NAME",',
'MAX(CASE WHEN overall_rank = 9 THEN price END) AS "RANK_9_RATE",',
'MAX(CASE WHEN overall_rank = 10 THEN hotel_name END) AS "RANK_10_NAME",',
'MAX(CASE WHEN overall_rank = 10 THEN price END) AS "RANK_10_RATE",',
'MAX(CASE WHEN overall_rank = 11 THEN hotel_name END) AS "RANK_11_NAME",',
'MAX(CASE WHEN overall_rank = 11 THEN price END) AS "RANK_11_RATE" FROM all_properties_ranked GROUP BY "SDATE"',
') p',
'JOIN (',
'    SELECT "SDATE", price, overall_rank FROM all_properties_ranked WHERE hotel_name = ''DELTA_HOTELS_BY_MARRIOTT_YORK''',
') own ON p."SDATE" = own."SDATE";',
'',
'  CREATE OR REPLACE FORCE EDITIONABLE VIEW "V_RANKING_UR_LOS1_YORK_2_T" ("SDATE", "OWN_PROPERTY_RATE", "OWN_PROPERTY_RANK", "COMP_RANK_1_RATE", "COMP_RANK_2_RATE", "COMP_RANK_3_RATE", "COMP_RANK_4_RATE", "COMP_RANK_5_RATE", "COMP_RANK_6_RATE", "COMP_'
||'RANK_7_RATE", "COMP_RANK_8_RATE", "COMP_RANK_9_RATE", "COMP_RANK_10_RATE") AS ',
'  WITH all_properties_ranked AS (',
'    SELECT ',
'        "SDATE",',
'        hotel_name,',
'        CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END AS price,',
'        ROW_NUMBER() OVER(PARTITION BY "SDATE" ORDER BY CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END ASC NULLS LAST) as overall_rank,',
'        CASE WHEN hotel_name != ''DELTA_HOTELS_BY_MARRIOTT_YORK'' THEN ',
'           ROW_NUMBER() OVER(PARTITION BY "SDATE", CASE WHEN hotel_name = ''DELTA_HOTELS_BY_MARRIOTT_YORK'' THEN 0 ELSE 1 END ORDER BY CASE WHEN REGEXP_LIKE(price, ''^[0-9,.]+$'') THEN TO_NUMBER(REPLACE(price, '','', '''')) ELSE NULL END ASC NULLS LAST) ',
'        END as comp_rank',
'    FROM "UR_LOS1_YORK_2_T"',
'    UNPIVOT (price FOR hotel_name IN ("DELTA_HOTELS_BY_MARRIOTT_YORK", "DOUBLETREE_BY_HILTON_YORK", "ELMBANK_YORK_TAPESTRY_COLLECTION_BY_HILTON", "HAMPTON_BY_HILTON_YORK", "HILTON_YORK", "HOLIDAY_INN_YORK_AN_IHG_HOTEL", "HOTEL_INDIGO_YORK_AN_IHG_HOTE'
||'L", "MOXY_YORK", "NOVOTEL_YORK_CENTRE", "RADISSON_HOTEL_YORK", "THE_MILNER_YORK_FORMERLY_THE_PRINCIPAL_YORK"))',
')',
'SELECT ',
'    "SDATE",',
'    MAX(CASE WHEN hotel_name = ''DELTA_HOTELS_BY_MARRIOTT_YORK'' THEN price END) AS "OWN_PROPERTY_RATE",',
'    MAX(CASE WHEN hotel_name = ''DELTA_HOTELS_BY_MARRIOTT_YORK'' THEN overall_rank END) AS "OWN_PROPERTY_RANK",',
'    MAX(CASE WHEN comp_rank = 1 THEN price END) AS "COMP_RANK_1_RATE",',
'MAX(CASE WHEN comp_rank = 2 THEN price END) AS "COMP_RANK_2_RATE",',
'MAX(CASE WHEN comp_rank = 3 THEN price END) AS "COMP_RANK_3_RATE",',
'MAX(CASE WHEN comp_rank = 4 THEN price END) AS "COMP_RANK_4_RATE",',
'MAX(CASE WHEN comp_rank = 5 THEN price END) AS "COMP_RANK_5_RATE",',
'MAX(CASE WHEN comp_rank = 6 THEN price END) AS "COMP_RANK_6_RATE",',
'MAX(CASE WHEN comp_rank = 7 THEN price END) AS "COMP_RANK_7_RATE",',
'MAX(CASE WHEN comp_rank = 8 THEN price END) AS "COMP_RANK_8_RATE",',
'MAX(CASE WHEN comp_rank = 9 THEN price END) AS "COMP_RANK_9_RATE",',
'MAX(CASE WHEN comp_rank = 10 THEN price END) AS "COMP_RANK_10_RATE"',
'FROM all_properties_ranked ',
'GROUP BY "SDATE";',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_1DAY_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_1DAY_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_1DAY_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_1DAY_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_3DAY2_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_3DAY2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_3DAY2_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_3DAY2_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_3DAY_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_3DAY_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW'))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_3DAY_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_3DAY_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_7DAY1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_7DAY1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_7DAY1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_7DAY1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_ADAM_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_ADAM_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_ADAM_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_ADAM_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_ADDRESSES_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_ADDRESSES',
'FOR EACH ROW',
'DECLARE',
'    v_current_user RAW(16);',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO v_current_user FROM UR_USERS WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'        :NEW.CREATED_BY := v_current_user;',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        :NEW.UPDATED_BY := v_current_user;',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO v_current_user FROM UR_USERS WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'        :NEW.UPDATED_BY := v_current_user;',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_ADDRESSES_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_ALGOS_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_ALGOS"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id RAW(16);',
'BEGIN',
'  IF :NEW.ID IS NULL THEN',
'    :NEW.ID := SYS_GUID();',
'  END IF;',
'',
'  -- Fetch user_id from UR_USERS based on APEX session user',
'  SELECT USER_ID INTO v_user_id ',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_ALGOS_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_ALGO_ATTRIBUTES_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_ALGO_ATTRIBUTES"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id RAW(16);',
'BEGIN',
'  IF :NEW.ID IS NULL THEN',
'    :NEW.ID := SYS_GUID();',
'  END IF;',
'',
'  -- Fetch USER_ID from UR_USERS based on APEX session user',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'',
'    -- Set default DATA_TYPE if null',
'    IF :NEW.DATA_TYPE IS NULL THEN',
'      :NEW.DATA_TYPE := ''NUMBER'';',
'    END IF;',
'',
'    -- Set default TYPE if null',
'    IF :NEW.TYPE IS NULL THEN',
'      :NEW.TYPE := ''M'';',
'    END IF;',
'',
'    -- Automatically generate KEY from NAME using UR_UTILS.Clean_TEXT if KEY is null or empty',
'    IF :NEW.KEY IS NULL OR TRIM(:NEW.KEY) = '''' THEN',
'      :NEW.KEY := UR_UTILS.Clean_TEXT(:NEW.NAME);',
'    END IF;',
'',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'',
'    -- Do NOT modify KEY during update, leave as is',
'',
'    -- Ensure DATA_TYPE defaults if null',
'    IF :NEW.DATA_TYPE IS NULL THEN',
'      :NEW.DATA_TYPE := ''NUMBER'';',
'    END IF;',
'',
'    -- Ensure TYPE defaults if null',
'    IF :NEW.TYPE IS NULL THEN',
'      :NEW.TYPE := ''M'';',
'    END IF;',
'',
'  END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_ALGO_ATTRIBUTES_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_ALGO_VERSIONS_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_ALGO_VERSIONS',
'FOR EACH ROW',
'DECLARE',
'  v_user_id RAW(16);',
'  v_max_version NUMBER;',
'  v_new_version NUMBER;',
'BEGIN',
'  IF :NEW.ID IS NULL THEN',
'    :NEW.ID := SYS_GUID();',
'  END IF;',
'',
'  -- Fetch user_id from UR_USERS based on APEX session user',
'  SELECT USER_ID INTO v_user_id',
'  FROM UR_USERS',
'  WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF INSERTING THEN',
'    -- Set audit columns',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'',
'    -- Auto increment VERSION',
'    BEGIN',
'      SELECT MAX(TO_NUMBER(VERSION)) INTO v_max_version',
'      FROM UR_ALGO_VERSIONS',
'      WHERE ALGO_ID = :NEW.ALGO_ID;',
'',
'      v_new_version := NVL(v_max_version, 0) + 1;',
'    EXCEPTION',
'      WHEN NO_DATA_FOUND THEN',
'        v_new_version := 1;',
'      WHEN VALUE_ERROR THEN',
'        -- version column has non-numeric values - fallback to 1',
'        v_new_version := 1;',
'    END;',
'    :NEW.VERSION := TO_CHAR(v_new_version);',
'',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'',
'  -- Update UR_ALGOS table CURRENT_VERSION_ID to the VERSION record ID that was just inserted/updated',
'  UPDATE UR_ALGOS',
'  SET CURRENT_VERSION_ID = :NEW.ID,',
'      UPDATED_BY = v_user_id,',
'      UPDATED_ON = SYSDATE',
'  WHERE ID = :NEW.ALGO_ID;',
'',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_ALGO_VERSIONS_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_BHAUMIK_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_BHAUMIK_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_BHAUMIK_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_BHAUMIK_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_CHINAR_22SEPT1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_CHINAR_22SEPT1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_CHINAR_22SEPT1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_CHINAR_22SEPT1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_CHINAR_22SEPT_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_CHINAR_22SEPT_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_CHINAR_22SEPT_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_CHINAR_22SEPT_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_CHINAR_28_SEP_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_CHINAR_28_SEP_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_CHINAR_28_SEP_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_CHINAR_28_SEP_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_CHINAR_STAY_DATE_TEMPLATE_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_CHINAR_STAY_DATE_TEMPLATE_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_CHINAR_STAY_DATE_TEMPLATE_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_CHINAR_STAY_DATE_TEMPLATE_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_CHINAR_TEST_111_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_CHINAR_TEST_111_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_CHINAR_TEST_111_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_CHINAR_TEST_111_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_CHINAR_TEST_112_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_CHINAR_TEST_112_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_CHINAR_TEST_112_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_CHINAR_TEST_112_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_CONTACTS_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_CONTACTS',
'FOR EACH ROW',
'DECLARE',
'    v_primary_count NUMBER;',
'    v_user_id RAW(16);',
'BEGIN',
'    -- Assign ID if null',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        BEGIN',
'            SELECT USER_ID INTO v_user_id',
'              FROM UR_USERS',
'             WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'        EXCEPTION',
'            WHEN NO_DATA_FOUND THEN',
'                v_user_id := SYS_GUID();  -- fallback in case no user found',
'        END;',
'',
'        :NEW.CREATED_BY := v_user_id;',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        :NEW.UPDATED_BY := v_user_id;',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        BEGIN',
'            SELECT USER_ID INTO v_user_id',
'              FROM UR_USERS',
'             WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'        EXCEPTION',
'            WHEN NO_DATA_FOUND THEN',
'                v_user_id := SYS_GUID();  -- fallback if user unknown',
'        END;',
'',
'        :NEW.UPDATED_BY := v_user_id;',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'',
'    -- Enforce only one PRIMARY=''Y'' per HOTEL_ID',
'    IF :NEW.PRIMARY = ''Y'' THEN',
'        SELECT COUNT(*)',
'          INTO v_primary_count',
'          FROM UR_CONTACTS',
'         WHERE HOTEL_ID = :NEW.HOTEL_ID',
'           AND PRIMARY = ''Y''',
'           AND ID != :NEW.ID;',
'',
'        IF v_primary_count > 0 THEN',
'            RAISE_APPLICATION_ERROR(-20001, ''Only one PRIMARY contact allowed per HOTEL_ID'');',
'        END IF;',
'    END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_CONTACTS_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_DAILY_BREAKDOWN11_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_DAILY_BREAKDOWN11_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_DAILY_BREAKDOWN11_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_DAILY_BREAKDOWN11_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_DAILY_BREAKDOWN_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_DAILY_BREAKDOWN_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_DAILY_BREAKDOWN_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_DAILY_BREAKDOWN_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_DAILY_BREAKDOWN_VK_2_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_DAILY_BREAKDOWN_VK_2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_DAILY_BREAKDOWN_VK_2_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_DAILY_BREAKDOWN_VK_2_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_DAILY_BREAKDOWN_VK_3_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_DAILY_BREAKDOWN_VK_3_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_DAILY_BREAKDOWN_VK_3_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_DAILY_BREAKDOWN_VK_3_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_DAILY_BREAKDOWN_VK_4_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_DAILY_BREAKDOWN_VK_4_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_DAILY_BREAKDOWN_VK_4_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_DAILY_BREAKDOWN_VK_4_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_DAILY_BREAKDOWN_VK_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_DAILY_BREAKDOWN_VK_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_DAILY_BREAKDOWN_VK_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_DAILY_BREAKDOWN_VK_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_DEMO_30SEP25_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_DEMO_30SEP25_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_DEMO_30SEP25_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_DEMO_30SEP25_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_EVENTS_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_EVENTS',
'FOR EACH ROW',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        -- Assign a new GUID if EVENT_ID is null (typical on insert)',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO :NEW.CREATED_BY ',
'        FROM UR_USERS ',
'        WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        SELECT USER_ID INTO :NEW.UPDATED_BY ',
'        FROM UR_USERS ',
'        WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO :NEW.UPDATED_BY ',
'        FROM UR_USERS ',
'        WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_EVENTS_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_EXPENSE_TEMPLATE_02_T_BI_TRG" ',
'      BEFORE INSERT ON "UR_EXPENSE_TEMPLATE_02_T"',
'      FOR EACH ROW',
'       WHEN (NEW.ID IS NULL) BEGIN',
'        :NEW.ID := SYS_GUID();',
'      END;',
'    ',
'/',
'ALTER TRIGGER "UR_EXPENSE_TEMPLATE_02_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_EXP_REPORT_2122122_T_BI_TRG" ',
'      BEFORE INSERT ON "UR_EXP_REPORT_2122122_T"',
'      FOR EACH ROW',
'       WHEN (NEW.ID IS NULL) BEGIN',
'        :NEW.ID := SYS_GUID();',
'      END;',
'    ',
'/',
'ALTER TRIGGER "UR_EXP_REPORT_2122122_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_EXP_REPORT_212212_T_BI_TRG" ',
'      BEFORE INSERT ON "UR_EXP_REPORT_212212_T"',
'      FOR EACH ROW',
'       WHEN (NEW.ID IS NULL) BEGIN',
'        :NEW.ID := SYS_GUID();',
'      END;',
'    ',
'/',
'ALTER TRIGGER "UR_EXP_REPORT_212212_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_EXP_REPORT_21221_T_BI_TRG" ',
'      BEFORE INSERT ON "UR_EXP_REPORT_21221_T"',
'      FOR EACH ROW',
'       WHEN (NEW.ID IS NULL) BEGIN',
'        :NEW.ID := SYS_GUID();',
'      END;',
'    ',
'/',
'ALTER TRIGGER "UR_EXP_REPORT_21221_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_EXP_REPORT_21_T_BI_TRG" ',
'      BEFORE INSERT ON "UR_EXP_REPORT_21_T"',
'      FOR EACH ROW',
'       WHEN (NEW.ID IS NULL) BEGIN',
'        :NEW.ID := SYS_GUID();',
'      END;',
'    ',
'/',
'ALTER TRIGGER "UR_EXP_REPORT_21_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_EXP_REPORT_3_T_BI_TRG" ',
'      BEFORE INSERT ON "UR_EXP_REPORT_3_T"',
'      FOR EACH ROW',
'       WHEN (NEW.ID IS NULL) BEGIN',
'        :NEW.ID := SYS_GUID();',
'      END;',
'    ',
'/',
'ALTER TRIGGER "UR_EXP_REPORT_3_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_EXP_REPORT_T_BI_TRG" ',
'      BEFORE INSERT ON "UR_EXP_REPORT_T"',
'      FOR EACH ROW',
'       WHEN (NEW.ID IS NULL) BEGIN',
'        :NEW.ID := SYS_GUID();',
'      END;',
'    ',
'/',
'ALTER TRIGGER "UR_EXP_REPORT_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_HOTELS_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_HOTELS',
'FOR EACH ROW',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO :NEW.CREATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'        IF :NEW.CURRENCY_CODE IS NULL THEN',
'            :NEW.CURRENCY_CODE := ''GBP'';',
'        END IF;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_HOTELS_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_HOTEL_GROUPS_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_HOTEL_GROUPS',
'FOR EACH ROW',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO :NEW.CREATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_HOTEL_GROUPS_BI_TRG" ENABLE;',
'',
'   COMMENT ON COLUMN "UR_HOTEL_PRICE_OVERRIDE"."ID" IS ''UUID - Unique attribute identifier (Primary Key).'';',
'   COMMENT ON COLUMN "UR_HOTEL_PRICE_OVERRIDE"."STAY_DATE" IS ''The specific date for which the price is overridden.'';',
'   COMMENT ON COLUMN "UR_HOTEL_PRICE_OVERRIDE"."HOTEL_ID" IS ''Optional Foreign Key to a Hotel table to limit the override to a specific hotel.'';',
'   COMMENT ON COLUMN "UR_HOTEL_PRICE_OVERRIDE"."TYPE" IS ''Pricing Type (e.g., Retail, Group).'';',
'   COMMENT ON COLUMN "UR_HOTEL_PRICE_OVERRIDE"."PRICE" IS ''The overridden price for the stay date.'';',
'   COMMENT ON COLUMN "UR_HOTEL_PRICE_OVERRIDE"."REASON" IS ''Justification for the price override.'';',
'   COMMENT ON COLUMN "UR_HOTEL_PRICE_OVERRIDE"."CREATED_BY" IS ''UUID of the user who created the record.'';',
'   COMMENT ON COLUMN "UR_HOTEL_PRICE_OVERRIDE"."UPDATED_BY" IS ''UUID of the user who last updated the record.'';',
'   COMMENT ON COLUMN "UR_HOTEL_PRICE_OVERRIDE"."CREATED_ON" IS ''Timestamp of when the record was created.'';',
'   COMMENT ON COLUMN "UR_HOTEL_PRICE_OVERRIDE"."UPDATED_ON" IS ''Timestamp of when the record was last updated.'';',
'   COMMENT ON TABLE "UR_HOTEL_PRICE_OVERRIDE"  IS ''Stores daily price overrides for hotels.'';',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_HOTEL_PRICE_OVERRIDE_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_HOTEL_PRICE_OVERRIDE"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id RAW(16);',
'BEGIN',
'  IF :NEW.ID IS NULL THEN',
'    :NEW.ID := SYS_GUID();',
'  END IF;',
'',
'  -- Fetch user_id from UR_USERS based on APEX session user',
'  SELECT USER_ID INTO v_user_id ',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_HOTEL_PRICE_OVERRIDE_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_HOTEL_RESERVATIONS_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_HOTEL_RESERVATIONS',
'FOR EACH ROW',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO :NEW.CREATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_HOTEL_RESERVATIONS_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_HOTEL_ROOM_TYPES_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_HOTEL_ROOM_TYPES',
'FOR EACH ROW',
'DECLARE',
'    v_current_user RAW(16);',
'BEGIN',
'  -- The following line is problematic in a row-level trigger and should generally be avoided.',
'  -- Date columns store date and time internally, the format is for display.',
'  -- execute immediate q''[alter session set nls_date_format=''YYYY-MM-DD HH24:MI:SS'']'';',
'',
'  IF :NEW.ROOM_TYPE_ID IS NULL THEN',
'    -- Assign a new GUID if ROOM_TYPE_ID is null (for new records typically)',
'    :NEW.ROOM_TYPE_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    ',
'    SELECT USER_ID INTO :NEW.CREATED_BY FROM UR_USERS WHERE USER_NAME = (SYS_CONTEXT (''APEX$SESSION'', ''APP_USER''));',
'    :NEW.CREATED_ON := SYSDATE;',
'    -- For new records, UPDATED_BY and UPDATED_ON are also set initially.',
'    SELECT USER_ID INTO :NEW.UPDATED_BY FROM UR_USERS WHERE USER_NAME = (SYS_CONTEXT (''APEX$SESSION'', ''APP_USER''));',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'',
'  IF UPDATING THEN',
'    -- When updating an existing record, update UPDATED_BY and UPDATED_ON.',
'    SELECT USER_ID INTO :NEW.UPDATED_BY FROM UR_USERS WHERE USER_NAME = (SYS_CONTEXT (''APEX$SESSION'', ''APP_USER''));',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_HOTEL_ROOM_TYPES_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_INDIGO_L_SQUARE_I_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_INDIGO_L_SQUARE_I_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_INDIGO_L_SQUARE_I_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_INDIGO_L_SQUARE_I_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_INDIGO_L_SQUARE_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_INDIGO_L_SQUARE_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_INDIGO_L_SQUARE_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_INDIGO_L_SQUARE_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_INTERFACE_LOGS_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_INTERFACE_LOGS',
'FOR EACH ROW',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO :NEW.CREATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_INTERFACE_LOGS_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_INDIGO_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_INDIGO_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_INDIGO_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_INDIGO_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_MCL_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_MCL_T"',
'FOR EACH ROW',
'DECLARE',
'  v_'))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_MCL_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_MCL_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_10_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_10_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_10_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_10_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_11_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_11_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_11_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_11_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_12_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_12_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_12_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_12_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_13OCT_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_13OCT_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_13OCT_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_13OCT_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_13_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_13_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_13_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_13_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_14_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_14_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_14_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_14_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_15_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_15_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_15_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_15_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_2_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_2_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_2_T_BI_TRG" ENABLE;',
'',
'   COMMENT ON TABLE "UR_LOS1_YORK_2_T_ERR$"  IS ''DML Error Logging table for "UR_LOS1_YORK_2_T"'';',
'',
'   COMMENT ON TABLE "UR_LOS1_YORK_2_T_ERR$1"  IS ''DML Error Logging table for "UR_LOS1_YORK_2_T"'';',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_7_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_7_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_7_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_7_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_8_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_8_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_8_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_8_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_9_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_9_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_9_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_9_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS1_YORK_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS1_YORK_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS1_YORK_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS1_YORK_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_LOS3_YORK_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_LOS3_YORK_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_LOS3_YORK_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_LOS3_YORK_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_MCL_LOS1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_MCL_LOS1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_MCL_LOS1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_MCL_LOS1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_PICKUP_INDIGO_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_PICKUP_INDIGO_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_PICKUP_INDIGO_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_PICKUP_INDIGO_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_REPORTS_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_REPORTS',
'FOR EACH ROW',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO :NEW.CREATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_REPORTS_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_REPORT_DASHBOARDS_BI" ',
'BEFORE INSERT OR UPDATE ON UR_REPORT_DASHBOARDS',
'FOR EACH ROW',
'DECLARE',
'  v_hotel_name VARCHAR2(100);',
'  v_key_candidate VARCHAR2(110);',
'  v_user_id RAW(16);',
'  v_json_error EXCEPTION;',
'  PRAGMA EXCEPTION_INIT(v_json_error, -22827); -- ORA-22827 JSON parse error code',
'  ',
'BEGIN',
'  -- Set ID if NULL',
'  IF :NEW.ID IS NULL THEN',
'    :NEW.ID := SYS_GUID();',
'  END IF;',
'',
'  -- Default CREATED_BY, UPDATED_BY, CREATED_ON, UPDATED_ON depending on insert/update',
'  IF INSERTING THEN',
'',
'    -- Fetch CURRENT USER ID from UR_USERS via APEX user',
'    BEGIN',
'      SELECT USER_ID INTO v_user_id',
'      FROM UR_USERS',
'      WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'    EXCEPTION',
'      WHEN NO_DATA_FOUND THEN',
'        v_user_id := NULL;',
'    END;',
'',
'    IF v_user_id IS NOT NULL THEN',
'      :NEW.CREATED_BY := v_user_id;',
'      :NEW.UPDATED_BY := v_user_id;',
'    ELSE',
'      RAISE_APPLICATION_ERROR(-20001, ''Unable to find USER_ID for current APEX user'');',
'    END IF;',
'',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_ON := SYSDATE;',
'',
'    -- ACTIVE default',
'    IF :NEW.ACTIVE IS NULL THEN',
'      :NEW.ACTIVE := ''Y'';',
'    END IF;',
'',
'    -- If HOTEL_ID is provided and Name/Key are NULL or empty, derive from Hotel''s name',
'    IF :NEW.HOTEL_ID IS NOT NULL THEN',
'      SELECT HOTEL_NAME INTO v_hotel_name FROM UR_HOTELS WHERE ID = :NEW.HOTEL_ID;',
'',
'      -- Populate NAME if empty',
'      IF :NEW.NAME IS NULL OR TRIM(:NEW.NAME) = '''' THEN',
'        :NEW.NAME := v_hotel_name;',
'      END IF;',
'',
'      -- Populate KEY if empty',
'      IF :NEW."KEY" IS NULL OR TRIM(:NEW."KEY") = '''' THEN',
'        -- Derive KEY from hotel name (uppercase, replace spaces with underscore, remove special chars except _)',
'        v_key_candidate := REGEXP_REPLACE(UPPER(v_hotel_name), ''[^A-Z0-9_]'', '''');',
'        v_key_candidate := REPLACE(v_key_candidate, '' '', ''_'');  -- Redundant after regex but keep for clarity',
'',
'        -- Append ''_DASHBOARD'' suffix if not already present',
'        IF NOT v_key_candidate LIKE ''%_DASHBOARD'' THEN',
'          v_key_candidate := v_key_candidate || ''_DASHBOARD'';',
'        END IF;',
'',
'        :NEW."KEY" := v_key_candidate;',
'      END IF;',
'    END IF;',
'',
'  ELSIF UPDATING THEN',
'',
'    -- Refresh UPDATED_BY and UPDATED_ON regardless',
'    BEGIN',
'      SELECT USER_ID INTO v_user_id',
'      FROM UR_USERS',
'      WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'    EXCEPTION',
'      WHEN NO_DATA_FOUND THEN',
'        v_user_id := NULL;',
'    END;',
'',
'    IF v_user_id IS NOT NULL THEN',
'      :NEW.UPDATED_BY := v_user_id;',
'    ELSE',
'      RAISE_APPLICATION_ERROR(-20002, ''Unable to find USER_ID for current APEX user'');',
'    END IF;',
'',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'',
'  -- Validate DEFINITION is valid JSON - raise error if not',
'  BEGIN',
'    -- Attempt to parse JSON in DEFINITION by wrapping in JSON_EXISTS which fails if invalid',
'    IF NOT JSON_EXISTS(:NEW.DEFINITION, ''$'') THEN',
'      RAISE_APPLICATION_ERROR(-20003, ''Definition column contains invalid JSON data.'');',
'    END IF;',
'  EXCEPTION',
'    WHEN OTHERS THEN',
'      RAISE_APPLICATION_ERROR(-20004, ''Definition column contains invalid JSON data.'');',
'  END;',
'',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_REPORT_DASHBOARDS_BI" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_STR_3_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_STR_3_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_STR_3_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_STR_3_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_STR_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_STR_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_STR_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_STR_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_TEMPLATES_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON UR_TEMPLATES',
'FOR EACH ROW',
'BEGIN',
'    IF :NEW.ID IS NULL THEN',
'        :NEW.ID := SYS_GUID();',
'    END IF;',
'',
'    IF INSERTING THEN',
'        SELECT USER_ID INTO :NEW.CREATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.CREATED_ON := SYSDATE;',
'',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'        SELECT USER_ID INTO :NEW.UPDATED_BY',
'          FROM UR_USERS',
'         WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'        :NEW.UPDATED_ON := SYSDATE;',
'    END IF;',
'END;',
'/',
'ALTER TRIGGER "TRG_UR_TEMPLATES_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEMP_1_OCT_N1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEMP_1_OCT_N1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEMP_1_OCT_N1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEMP_1_OCT_N1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEMP_1_OCT_N2_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEMP_1_OCT_N2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEMP_1_OCT_N2_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEMP_1_OCT_N2_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEMP_1_OCT_N_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEMP_1_OCT_N_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEMP_1_OCT_N_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEMP_1_OCT_N_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEMP_1_OCT_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEMP_1_OCT_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEMP_1_OCT_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEMP_1_OCT_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEMP_3_OCT_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEMP_3_OCT_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEMP_3_OCT_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEMP_3_OCT_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEMP_DEMO_11_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEMP_DEMO_11_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEMP_DEMO_11_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEMP_DEMO_11_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEMP_NN_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEMP_NN_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEMP_NN_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEMP_NN_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST1_22_CHINAR_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST1_22_CHINAR_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST1_22_CHINAR_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST1_22_CHINAR_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_13_10_CP_2_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_13_10_CP_2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_13_10_CP_2_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_13_10_CP_2_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_13_10_CP_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_13_10_CP_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_13_10_CP_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_13_10_CP_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_CHINAR_1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_CHINAR_1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_CHINAR_1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_CHINAR_1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_CHINAR_29_SEP_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_CHINAR_29_SEP_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_CHINAR_29_SEP_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_CHINAR_29_SEP_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_CHINAR_2_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_CHINAR_2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_CHINAR_2_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_CHINAR_2_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_CHINAR_NEWEST_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_CHINAR_NEWEST_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_CHINAR_NEWEST_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_CHINAR_NEWEST_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_CHINAR_NO_USC_NEW_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_CHINAR_NO_USC_NEW_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_CHINAR_NO_USC_NEW_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_CHINAR_NO_USC_NEW_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_CHINAR_NO_USC_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_CHINAR_NO_USC_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_CHINAR_NO_U'))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'SC_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_CHINAR_NO_USC_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_CHINAR_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_CHINAR_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_CHINAR_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_CHINAR_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_STACY_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_STACY_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_STACY_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_STACY_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TEST_TEMPLATE_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TEST_TEMPLATE_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TEST_TEMPLATE_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TEST_TEMPLATE_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_TT_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_TT_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_TT_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_TT_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_UR_BHAUMIK_30_SEP1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_UR_BHAUMIK_30_SEP1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_UR_BHAUMIK_30_SEP1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_UR_BHAUMIK_30_SEP1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_UR_BHAUMIK_30_SEP_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_UR_BHAUMIK_30_SEP_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_UR_BHAUMIK_30_SEP_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_UR_BHAUMIK_30_SEP_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_UR_CHINAR_QUAL_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_UR_CHINAR_QUAL_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_UR_CHINAR_QUAL_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_UR_CHINAR_QUAL_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_UR_USERS_BI_TRG" ',
'FOR INSERT OR UPDATE ON ur_users',
'COMPOUND TRIGGER',
'',
'  BEFORE EACH ROW IS',
'    l_current_user_id UR_USERS.USER_ID%TYPE;',
'  BEGIN',
'    IF INSERTING THEN',
'      -- generate PK if not provided',
'      IF :NEW.user_id IS NULL THEN',
'        :NEW.user_id := SYS_GUID();',
'      END IF;',
'',
'      -- set created_by / updated_by from session package (if available)',
'      l_current_user_id := app_user_ctx.get_current_user_id;',
'      IF l_current_user_id IS NOT NULL THEN',
'        :NEW.created_by := l_current_user_id;',
'        :NEW.updated_by := l_current_user_id;',
'      END IF;',
'',
'      -- timestamps (respect any pre-filled created_on)',
'      IF :NEW.created_on IS NULL THEN',
'        :NEW.created_on := SYSDATE;',
'      END IF;',
'      :NEW.updated_on := SYSDATE;',
'',
'    ELSIF UPDATING THEN',
'      l_current_user_id := app_user_ctx.get_current_user_id;',
'      IF l_current_user_id IS NOT NULL THEN',
'        :NEW.updated_by := l_current_user_id;',
'      END IF;',
'      :NEW.updated_on := SYSDATE;',
'    END IF;',
'  END BEFORE EACH ROW;',
'',
'END trg_ur_users_bi_trg;',
'/',
'ALTER TRIGGER "TRG_UR_USERS_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_250915_1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_250915_1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_250915_1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_250915_1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_250915_2_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_250915_2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_250915_2_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_250915_2_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_250915_3_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_250915_3_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_250915_3_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_250915_3_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_250915_4_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_250915_4_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_250915_4_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_250915_4_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_250915_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_250915_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_250915_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_250915_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_ATT_QUAL1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_ATT_QUAL1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_ATT_QUAL1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_ATT_QUAL1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_LEAVE_SETUP_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_LEAVE_SETUP_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LEAVE_SETUP_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_LEAVE_SETUP_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_LOS1_YORK_2_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_2_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_LOS1_YORK_2_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_LOS1_YORK_3_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_3_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_3_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_LOS1_YORK_3_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_LOS1_YORK_4_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_4_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_4_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_LOS1_YORK_4_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_LOS1_YORK_5_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_5_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_5_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_LOS1_YORK_5_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_LOS1_YORK_6_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_6_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_6_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_LOS1_YORK_6_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_LOS1_YORK_7_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_7_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_7_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_LOS1_YORK_7_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_LOS1_YORK_8_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_8_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_8_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_LOS1_YORK_8_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_LOS1_YORK_9_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_9_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_9_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_LOS1_YORK_9_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_LOS1_YORK_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_LOS1_YORK_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_LOS1_YORK_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_LOS1_YORK_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_NEW_CHINAR_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_NEW_CHINAR_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_NEW_CHINAR_T_BI_TRG;',
'/',
'ALTER TRIGGER "UR_VK_NEW_CHINAR_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_SAMPLE_HOTEL_DATA_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_SAMPLE_HOTEL_DATA_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_SAMPLE_HOTEL_DATA_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_SAMPLE_HOTEL_DATA_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_SEG1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_SEG1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_SEG1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_SEG1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_SEGMENT_QUALIFIER1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_SEGMENT_QUALIFIER1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_SEGMENT_QUALIFIER1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_SEGMENT_QUALIFIER1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_SEGMENT_QUALIFIER2_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_SEGMENT_QUALIFIER2_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_SEGMENT_QUALIFIER2_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_SEGMENT_QUALIFIER2_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_SEGMENT_QUALIFIER_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_SEGMENT_QUALIFIER_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_SEGMENT_QUALIFIER_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_SEGMENT_QUALIFIER_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_VK_TMS_TASK_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_VK_TMS_TASK_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_VK_TMS_TASK_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_VK_TMS_TASK_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_YORK_LOS1_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_YORK_LOS1_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_YORK_LOS1_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_YORK_LOS1_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_YORK_LOS1_VK_29SEP25_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_YORK_LOS1_VK_29SEP25_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_YORK_LOS1_VK_29SEP25_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_YORK_LOS1_VK_29SEP25_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_YORK_TEMP12_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_YORK_TEMP12_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_YORK_TEMP12_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_YORK_TEMP12_T_BI_TRG" ENABLE;',
'',
'  CREATE OR REPLACE EDITIONABLE TRIGGER "UR_YORK_TEMP14_T_BI_TRG" ',
'BEFORE INSERT OR UPDATE ON "UR_YORK_TEMP14_T"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END UR_YORK_TEMP14_T_BI_TRG;',
'',
'/',
'ALTER TRIGGER "UR_YORK_TEMP14_T_BI_TRG" ENABLE;',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'create or replace PACKAGE BODY ALGO_EVALUATOR_PKG AS',
'',
'  -- [Functions GENERIC_MATH_EVAL, get_attribute_id_from_template, get_value_for_date, FLEXIBLE_TO_DATE, and build_dynamic_query remain unchanged from the previous version]',
'',
'  FUNCTION GENERIC_MATH_EVAL(p_function_name IN VARCHAR2, p_values IN VARCHAR2) RETURN NUMBER IS',
'    l_sum   NUMBER := 0; l_count NUMBER := 0; l_min   NUMBER; l_max   NUMBER; l_val   NUMBER;',
'  BEGIN',
'  FOR r IN (',
'      SELECT num',
'      FROM (',
'          SELECT',
'              TO_NUMBER(TRIM(REGEXP_SUBSTR(p_values, ''[^,]+'', 1, LEVEL)) DEFAULT NULL ON CONVERSION ERROR) AS num',
'          FROM',
'              DUAL',
'          CONNECT BY',
'              LEVEL <= REGEXP_COUNT(p_values, '','') + 1',
'      )',
'      WHERE num IS NOT NULL',
'  ) LOOP',
'      l_val := r.num;',
'      l_sum := l_sum + l_val;',
'      l_count := l_count + 1;',
'      IF l_min IS NULL OR l_val < l_min THEN l_min := l_val; END IF;',
'      IF l_max IS NULL OR l_val > l_max THEN l_max := l_val; END IF;',
'  END LOOP;',
'',
'    CASE UPPER(p_function_name)',
'      WHEN ''SUM''     THEN RETURN l_sum;',
'      WHEN ''AVERAGE'' THEN RETURN CASE WHEN l_count > 0 THEN l_sum / l_count ELSE 0 END;',
'      WHEN ''COUNT''   THEN RETURN l_count;',
'      WHEN ''MIN''     THEN RETURN l_min;',
'      WHEN ''MAX''     THEN RETURN l_max;',
'      ELSE RETURN NULL;',
'    END CASE;',
'  END GENERIC_MATH_EVAL;',
'',
'  FUNCTION get_attribute_id_from_template(p_template_id VARCHAR2) RETURN VARCHAR2 IS',
'    l_attr_id VARCHAR2(255);',
'  BEGIN',
'    SELECT id INTO l_attr_id FROM ur_algo_attributes WHERE template_id = p_template_id AND name = ''OWN PROPERTY RANK'' AND ROWNUM = 1;',
'    RETURN l_attr_id;',
'  EXCEPTION WHEN NO_DATA_FOUND THEN RETURN NULL;',
'  END get_attribute_id_from_template;',
'',
'  FUNCTION get_value_for_date(p_data_table IN t_result_tab, p_target_date IN DATE) RETURN NUMBER IS',
'  BEGIN',
'    IF p_data_table IS NULL THEN RETURN NULL; END IF;',
'    FOR i IN 1 .. p_data_table.COUNT LOOP',
'      IF p_data_table(i).stay_date = p_target_date THEN RETURN p_data_table(i).evaluated_price; END IF;',
'    END LOOP;',
'    RETURN NULL;',
'  END get_value_for_date;',
'',
'  FUNCTION FLEXIBLE_TO_DATE(p_date_string IN VARCHAR2) RETURN DATE IS',
'  BEGIN',
'    IF p_date_string IS NULL THEN RETURN NULL; END IF;',
'    BEGIN RETURN TO_DATE(SUBSTR(p_date_string, 1, 10), ''MM/DD/YYYY''); EXCEPTION WHEN OTHERS THEN',
'      BEGIN RETURN TO_DATE(SUBSTR(p_date_string, 1, 10), ''YYYY-MM-DD''); EXCEPTION WHEN OTHERS THEN',
'        BEGIN RETURN TO_DATE(SUBSTR(p_date_string, 1, 10), ''DD/MM/YYYY''); EXCEPTION WHEN OTHERS THEN',
'          BEGIN RETURN TO_DATE(SUBSTR(p_date_string, 1, 10), ''DD-MM-YYYY''); EXCEPTION WHEN OTHERS THEN',
'            BEGIN RETURN TO_DATE(SUBSTR(p_date_string, 1, 11), ''DD-MON-YYYY''); EXCEPTION WHEN OTHERS THEN RETURN NULL; END;',
'          END;',
'        END;',
'      END;',
'    END;',
'  END FLEXIBLE_TO_DATE;',
'',
'  FUNCTION build_dynamic_query(p_rules_json IN CLOB) RETURN CLOB IS',
'     l_sql_select      CLOB := ''SELECT base.STAY_DATE, ''; l_sql_from        CLOB; l_sql_where       CLOB := '' WHERE 1=1 '';',
'     l_price_case_stmt CLOB := ''CASE ''; l_rule_case_stmt  CLOB := ''CASE ''; TYPE t_alias_map IS TABLE OF VARCHAR2(10) INDEX BY VARCHAR2(255);',
'     l_aliases         t_alias_map; l_alias_counter   PLS_INTEGER := 1; l_base_alias      VARCHAR2(10); l_current_id      VARCHAR2(255);',
'     l_regions_count   PLS_INTEGER; TYPE t_attr_tab IS TABLE OF VARCHAR2(255); l_attr_collection t_attr_tab := t_attr_tab();',
'     TYPE t_set_map IS TABLE OF BOOLEAN INDEX BY VARCHAR2(255); l_unique_attrs t_set_map; l_occ_attr_raw VARCHAR2(255);',
'     l_pr_template  VARCHAR2(255); l_expr_raw      VARCHAR2(32767); l_pos           PLS_INTEGER; l_attr_in_expr VARCHAR2(255);',
'    BEGIN',
'      FOR cond_rec IN (SELECT cond_json FROM JSON_TABLE(p_rules_json, ''$.regions[*].conditions[*]'' COLUMNS (cond_json CLOB FORMAT JSON PATH ''$'')) conds) LOOP',
'        l_occ_attr_raw := JSON_VALUE(cond_rec.cond_json, ''$.occupancyThreshold.attribute'');',
'        l_pr_template := JSON_VALUE(co'))
);
end;
/
begin
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'nd_rec.cond_json, ''$.propertyRanking.type'');',
'        l_expr_raw := JSON_VALUE(cond_rec.cond_json, ''$.expression'');',
'        IF l_occ_attr_raw IS NOT NULL THEN l_unique_attrs(REGEXP_REPLACE(l_occ_attr_raw, ''^#|#$'', '''')) := TRUE; END IF;',
'        IF l_pr_template IS NOT NULL THEN DECLARE l_pr_attr VARCHAR2(255); BEGIN l_pr_attr := get_attribute_id_from_template(l_pr_template); IF l_pr_attr IS NOT NULL THEN l_unique_attrs(l_pr_attr) := TRUE; END IF; END; END IF;',
'        l_pos := 1;',
'        LOOP l_attr_in_expr := REGEXP_SUBSTR(l_expr_raw, ''#[A-F0-9]+#'', l_pos); EXIT WHEN l_attr_in_expr IS NULL; l_unique_attrs(REGEXP_REPLACE(l_attr_in_expr, ''^#|#$'', '''')) := TRUE; l_pos := INSTR(l_expr_raw, l_attr_in_expr, l_pos) + LENGTH(l_attr_i'
||'n_expr); END LOOP;',
'      END LOOP;',
'      l_attr_collection.DELETE;',
'      DECLARE l_key VARCHAR2(255); BEGIN l_key := l_unique_attrs.FIRST; WHILE l_key IS NOT NULL LOOP l_attr_collection.EXTEND; l_attr_collection(l_attr_collection.COUNT) := l_key; l_key := l_unique_attrs.NEXT(l_key); END LOOP; END;',
'      IF l_attr_collection.COUNT = 0 THEN RETURN q''[SELECT NULL, NULL, ''ERROR: No attributes found in JSON'' FROM DUAL]''; END IF;',
'      FOR i IN 1 .. l_attr_collection.COUNT LOOP l_aliases(l_attr_collection(i)) := ''a'' || l_alias_counter; l_alias_counter := l_alias_counter + 1; END LOOP;',
'      l_base_alias := l_aliases(l_attr_collection(1)); l_sql_from := '' FROM TABLE(ur_utils.GET_ATTRIBUTE_VALUE(p_attribute_id => '''''' || l_attr_collection(1) || '''''')) '' || l_base_alias;',
'      FOR i IN 2 .. l_attr_collection.COUNT LOOP l_sql_from := l_sql_from || '' LEFT JOIN TABLE(ur_utils.GET_ATTRIBUTE_VALUE(p_attribute_id => '''''' || l_attr_collection(i) || '''''')) '' || l_aliases(l_attr_collection(i)) || '' ON '' || l_base_alias || ''.STA'
||'Y_DATE = '' || l_aliases(l_attr_collection(i)) || ''.STAY_DATE ''; END LOOP;',
'      FOR f IN (SELECT stay_from, stay_to, lead_from, lead_to, days_of_week, min_rate FROM JSON_TABLE(p_rules_json, ''$.regions[0].filters'' COLUMNS (stay_from DATE PATH ''$.stayWindow.from'', stay_to DATE PATH ''$.stayWindow.to'', lead_from DATE PATH ''$.l'
||'eadTime.from'', lead_to DATE PATH ''$.leadTime.to'', days_of_week VARCHAR2(100) FORMAT JSON PATH ''$.daysOfWeek'', min_rate NUMBER PATH ''$.minimumRate''))) LOOP',
'        l_sql_where := l_sql_where || '' AND '' || l_base_alias || ''.STAY_DATE BETWEEN TO_DATE('''''' || TO_CHAR(f.stay_from, ''YYYY-MM-DD'') || '''''', ''''YYYY-MM-DD'''') AND TO_DATE('''''' || TO_CHAR(f.stay_to, ''YYYY-MM-DD'') || '''''', ''''YYYY-MM-DD'''')'';',
'        l_sql_where := l_sql_where || '' AND TRUNC(SYSDATE) BETWEEN TO_DATE('''''' || TO_CHAR(f.lead_from, ''YYYY-MM-DD'') || '''''', ''''YYYY-MM-DD'''') AND TO_DATE('''''' || TO_CHAR(f.lead_to, ''YYYY-MM-DD'') || '''''', ''''YYYY-MM-DD'''')'';',
'        IF f.days_of_week IS NOT NULL AND f.days_of_week <> ''[]'' THEN l_sql_where := l_sql_where || '' AND TO_CHAR(''||l_base_alias||''.STAY_DATE, ''''D'''') IN ('' || REPLACE(REPLACE(f.days_of_week, ''['', ''''), '']'', '''') || '') ''; END IF;',
'        l_sql_where := l_sql_where || '' AND '' || l_base_alias || ''.ATTRIBUTE_VALUE >= '' || f.min_rate;',
'      END LOOP;',
'      l_sql_where := l_sql_where || '' AND ('' || l_base_alias || ''.STAY_DATE = :b_stay_date_filter OR :b_stay_date_null_check IS NULL) '';',
'      l_regions_count := TO_NUMBER(JSON_VALUE(p_rules_json, ''$.regions.size()''));',
'      FOR i IN 0 .. l_regions_count - 1 LOOP',
'        DECLARE',
'          l_when_clause VARCHAR2(32000) := ''WHEN (''; l_expr VARCHAR2(4000) := JSON_VALUE(p_rules_json, ''$.regions['' || i || ''].conditions[0].expression'');',
'          l_region_name VARCHAR2(255) := JSON_VALUE(p_rules_json, ''$.regions['' || i || ''].name''); l_cond_name VARCHAR2(255) := JSON_VALUE(p_rules_json, ''$.regions['' || i || ''].conditions[0].name'');',
'          l_full_rule_name VARCHAR2(512) := REPLACE(l_region_name || '' / '' || l_cond_name, '''''''', '''''''''''');',
'        BEGIN',
'          FOR j IN 0 .. TO_NUMBER(JSON_VALUE(p_rules_json, ''$.regions['' || i || ''].conditions.size()'')) - 1 LOOP',
'            DECLARE',
'              l_cond_path VARCHAR2(200) := ''$.regions['' || i || ''].conditions['' || j || '']''; l_occ_attr_raw VARCHAR2(255) := JSON_VALUE(p_rules_json, l_cond_path || ''.occupancyThreshold.attribute'');',
'              l_occ_attr VARCHAR2(255) := REGEXP_REPLACE(NVL(l_occ_attr_raw, ''''), ''^#|#$'', ''''); l_pr_template_id VARCHAR2(255) := JSON_VALUE(p_rules_json, l_cond_path || ''.propertyRanking.type'');',
'              l_pr_attr VARCHAR2(255) := get_attribute_id_from_template(l_pr_template_id); l_occ_op VARCHAR2(10) := JSON_VALUE(p_rules_json, l_cond_path || ''.occupancyThreshold.operator'');',
'              l_occ_val NUMBER := TO_NUMBER(JSON_VALUE(p_rules_json, l_cond_path || ''.occupancyThreshold.value'')); l_pr_op VARCHAR2(10) := JSON_VALUE(p_rules_json, l_cond_path || ''.propertyRanking.operator'');',
'              l_pr_val NUMBER := TO_NUMBER(JSON_VALUE(p_rules_json, l_cond_path || ''.propertyRanking.value''));',
'            BEGIN',
'              IF l_occ_attr IS NOT NULL AND l_aliases.EXISTS(l_occ_attr) THEN l_when_clause := l_when_clause || l_aliases(l_occ_attr) || ''.ATTRIBUTE_VALUE '' || l_occ_op || '' '' || l_occ_val || '' AND ''; END IF;',
'              IF l_pr_attr IS NOT NULL AND l_aliases.EXISTS(l_pr_attr) THEN l_when_clause := l_when_clause || l_aliases(l_pr_attr) || ''.ATTRIBUTE_VALUE '' || l_pr_op || '' '' || l_pr_val || '' AND ''; END IF;',
'            END;',
'          END LOOP;',
'          l_when_clause := RTRIM(l_when_clause, '' AND '') || '')'';',
'          l_current_id := l_aliases.FIRST;',
'          WHILE l_current_id IS NOT NULL LOOP l_expr := REPLACE(l_expr, ''#'' || l_current_id || ''#'', l_aliases(l_current_id) || ''.ATTRIBUTE_VALUE''); l_current_id := l_aliases.NEXT(l_current_id); END LOOP;',
'          l_price_case_stmt := l_price_case_stmt || l_when_clause || '' THEN '' || l_expr || '' '';',
'          l_rule_case_stmt  := l_rule_case_stmt || l_when_clause || '' THEN '''''' || l_full_rule_name || '''''' '';',
'        END;',
'      END LOOP;',
'      l_price_case_stmt := l_price_case_stmt || '' ELSE NULL END''; l_rule_case_stmt  := l_rule_case_stmt || '' ELSE ''''No Rule Applied'''' END'';',
'      l_sql_select := l_sql_select || l_price_case_stmt || '' AS EVALUATED_PRICE, '' || l_rule_case_stmt || '' AS APPLIED_RULE'';',
'      RETURN l_sql_select || l_sql_from || l_sql_where;',
'    END build_dynamic_query;',
'',
'  FUNCTION EVALUATE(',
'    p_algo_id    IN ur_algos.id%TYPE,',
'    p_version_id IN ur_algo_versions.id%TYPE DEFAULT NULL,',
'    p_stay_date  IN DATE DEFAULT NULL',
'  ) RETURN t_result_tab_obj PIPELINED IS',
'    l_rules_json        CLOB;',
'    TYPE t_alias_map IS TABLE OF VARCHAR2(255) INDEX BY VARCHAR2(255);',
'    l_aliases t_alias_map;',
'    l_current_id        VARCHAR2(255);',
'    TYPE t_staged_data_map IS TABLE OF t_result_tab INDEX BY VARCHAR2(255);',
'    l_staged_data t_staged_data_map;',
'    TYPE t_date_set IS TABLE OF BOOLEAN INDEX BY VARCHAR2(255);',
'    l_date_set t_date_set;',
'    l_all_dates SYS.ODCIDATELIST := SYS.ODCIDATELIST();',
'    l_distinct_dates    SYS.ODCIDATELIST := SYS.ODCIDATELIST();',
'    l_hotel_id ur_algos.hotel_id%TYPE;',
'    TYPE t_event_score_map IS TABLE OF NUMBER INDEX BY VARCHAR2(10);',
'    l_event_scores t_event_score_map;',
'    TYPE t_lead_date_map IS TABLE OF DATE INDEX BY VARCHAR2(255);',
'    l_lead_dates t_lead_date_map; -- << CORRECTED THIS LINE',
'    l_lead_attr_ids t_date_set;',
'',
'    -- ++ NEW VARIABLES',
'    l_algo_name         ur_algos.name%TYPE;',
'    l_effective_algo_id ur_algos.id%TYPE;',
'    l_version_id_to_use ur_algo_versions.id%TYPE;',
'    -- / NEW VARIABLES',
'  BEGIN',
'    -- ++ MODIFIED LOGIC: Determine which version and algo to use',
'    BEGIN',
'        IF p_version_id IS NOT NULL THEN',
'            -- A specific version is provided, use it directly.',
'            l_version_id_to_use := p_version_id;',
'            SELECT av.expression, av.algo_id, a.name, a.hotel_id',
'            INTO l_rules_json, l_effective_algo_id, l_algo_name, l_hotel_id',
'            FROM ur_algo_versions av',
'            JOIN ur_algos a ON av.algo_id = a.id',
'            WHERE av.id = l_version_id_to_use;',
'        ELSE',
'            -- No version ID provided, use the algo_id to find the current version.',
'            l_effective_algo_id := p_algo_id;',
'            SELECT a.current_version_id, a.name, a.hotel_id',
'            INTO l_version_id_to_use, l_algo_name, l_hotel_id',
'            FROM ur_algos a',
'            WHERE a.id = l_effective_algo_id;',
'',
'            SELECT expression INTO l_rules_json',
'            FROM ur_algo_versions',
'            WHERE id = l_version_id_to_use;',
'        END IF;',
'    EXCEPTION',
'        WHEN NO_DATA_FOUND THEN',
'            PIPE ROW(t_result_rec_obj(l_algo_name, NULL, NULL, NULL, ''ERROR: Algorithm or Version not found.''));',
'            RETURN;',
'    END;',
'    -- / MODIFIED LOGIC',
'',
'    FOR rec IN (SELECT JSON_VALUE(cond_json, ''$.occupancyThreshold.attribute'') as occ_attr, JSON_VALUE(cond_json, ''$.propertyRanking.type'') as pr_template, JSON_VALUE(cond_json, ''$.expression'') as expr, JSON_VALUE(lead_time_json, ''$.attribute'') as le'
||'ad_attr FROM JSON_TABLE(l_rules_json, ''$.regions[*]'' COLUMNS (lead_time_json CLOB FORMAT JSON PATH ''$.filters.leadTime'', NESTED PATH ''$.conditions[*]'' COLUMNS (cond_json CLOB FORMAT JSON PATH ''$'')))) LOOP',
'        DECLARE',
'            l_occ_attr VARCHAR2(255) := REGEXP_REPLACE(NVL(rec.occ_attr, ''''), ''^#|#$'', ''''); l_pr_attr_id VARCHAR2(255);',
'            l_lead_attr VARCHAR2(255) := REGEXP_REPLACE(NVL(rec.lead_attr, ''''), ''^#|#$'', ''''); l_pos PLS_INTEGER := 1;',
'            l_attr_in_expr VARCHAR2(255); l_clean_attr VARCHAR2(255);',
'        BEGIN',
'            IF l_occ_attr IS NOT NULL AND NOT l_aliases.EXISTS(l_occ_attr) THEN l_aliases(l_occ_attr) := l_occ_attr; END IF;',
'            IF l_lead_attr IS NOT NULL AND NOT l_aliases.EXISTS(l_lead_attr) THEN l_aliases(l_lead_attr) := l_lead_attr; l_lead_attr_ids(l_lead_attr) := TRUE; END IF;',
'            IF rec.pr_template IS NOT NULL THEN l_pr_attr_id := get_attribute_id_from_template(REPLACE(rec.pr_template, ''#'', '''')); IF l_pr_attr_id IS NOT NULL AND NOT l_aliases.EXISTS(l_pr_attr_id) THEN l_aliases(l_pr_attr_id) := l_pr_attr_id; END IF'
||'; END IF;',
'            LOOP l_attr_in_expr := REGEXP_SUBSTR(rec.expr, ''#[A-F0-9]+#'', l_pos); EXIT WHEN l_attr_in_expr IS NULL; l_clean_attr := REGEXP_REPLACE(l_attr_in_expr, ''^#|#$'', ''''); IF NOT l_aliases.EXISTS(l_clean_attr) THEN l_aliases(l_clean_attr) := l_c'
||'lean_attr; END IF; l_pos := INSTR(rec.expr, l_attr_in_expr, l_pos) + LENGTH(l_attr_in_expr); END LOOP;',
'        END;',
'    END LOOP;',
'',
'    IF l_aliases.COUNT = 0 THEN PIPE ROW(t_result_rec_obj(l_algo_name, NULL, NULL, NULL, ''ERROR: No attributes found in JSON'')); RETURN; END IF;',
'',
'    DECLARE',
'      TYPE t_event_rec IS RECORD ( event_date_str VARCHAR2(10), max_score NUMBER ); TYPE t_event_tab IS TABLE OF t_event_rec; l_event_list t_event_tab;',
'    BEGIN',
'      SELECT TO_CHAR(event_date, ''YYYY-MM-DD''), MAX(score) BULK COLLECT INTO l_event_list FROM (SELECT e.event_start_date + level - 1 AS event_date, (e.impact_level * e.impact_type) AS score FROM ur_events e WHERE e.hotel_id = l_hotel_id CONNECT BY l'
||'evel <= e.event_end_date - e.event_start_date + 1 AND PRIOR e.id = e.id AND PRIOR sys_guid() IS NOT NULL) GROUP BY event_date;',
'      FOR i IN 1 .. l_event_list.COUNT LOOP l_event_scores(l_event_list(i).event_date_str) := l_event_list(i).max_score; END LOOP;',
'    END;',
'',
'    l_current_id := l_aliases.FIRST;',
'    WHILE l_current_id IS NOT NULL LOOP',
'      IF l_lead_attr_ids.EXISTS(l_current_id) THEN',
'        FOR rec IN (SELECT stay_date, attribute_value FROM TABLE(ur_utils.GET_ATTRIBUTE_VALUE(p_attribute_id => l_current_id, p_hotel_id => l_hotel_id)) WHERE attribute_value IS NOT NULL) LOOP',
'          DECLARE l_converted_date DATE; BEGIN l_converted_date := FLEXIBLE_TO_DATE(rec.attribute_value); IF l_converted_date IS NOT NULL THEN l_lead_dates(TO_CHAR(rec.stay_date, ''YYYY-MM-DD'') || l_current_id) := l_converted_date; END IF; END;',
'        END LOOP;',
'      ELSE',
'        SELECT stay_date, TO_NUMBER(attribute_value), NULL BULK COLLECT INTO l_staged_data(l_current_id) FROM TABLE(ur_utils.GET_ATTRIBUTE_VALUE(p_attribute_id => l_current_id, p_hotel_id => l_hotel_id)) WHERE attribute_value IS NOT NULL;',
'      END IF;',
'      FOR rec IN (SELECT stay_date FROM TABLE(ur_utils.GET_ATTRIBUTE_VALUE(p_attribute_id => l_current_id, p_hotel_id => l_hotel_id))) LOOP l_date_set(TO_CHAR(rec.stay_date, ''YYYY-MM-DD'')) := TRUE; END LOOP;',
'      l_current_id := l_aliases.NEXT(l_current_id);',
'    END LOOP;',
'',
'    DECLARE v_date_key VARCHAR2(255) := l_date_set.FIRST; BEGIN WHILE v_date_key IS NOT NULL LOOP l_distinct_dates.EXTEND; l_distinct_dates(l_distinct_dates.LAST) := TO_DATE(v_date_key, ''YYYY-MM-DD''); v_date_key := l_date_set.NEXT(v_date_key); END LO'
||'OP; END;',
'',
'    <<date_loop>>',
'    FOR d IN (SELECT COLUMN_VALUE AS stay_date FROM TABLE(l_distinct_dates) ORDER BY COLUMN_VALUE) LOOP',
'      DECLARE',
'        v_stay_date DATE := d.stay_date;',
'        v_any_rule_matched_for_date BOOLEAN := FALSE;',
'        l_failure_details_json CLOB := NULL;',
'      BEGIN',
'        IF p_stay_date IS NOT NULL AND v_stay_date != p_stay_date THEN',
'          GOTO next_date;',
'        END IF;',
'',
'        <<regions_loop>>',
'        FOR region_rec IN (',
'          SELECT region_name, stay_from, stay_to, conditions, days_of_week, minimum_rate, sequence, lead_attr_raw, lead_type, lead_from_val, lead_to_val, lead_value',
'          FROM JSON_TABLE(l_rules_json, ''$.regions[*]'' COLUMNS (',
'            region_name  VARCHAR2(255) PATH ''$.name'', stay_from DATE PATH ''$.filters.stayWindow.from'', stay_to DATE PATH ''$.filters.stayWindow.to'',',
'            conditions   CLOB FORMAT JSON PATH ''$.conditions'', days_of_week VARCHAR2(100) FORMAT JSON PATH ''$.filters.daysOfWeek'',',
'            minimum_rate NUMBER PATH ''$.filters.minimumRate'', sequence NUMBER PATH ''$.sequence'',',
'            lead_attr_raw  VARCHAR2(255) PATH ''$.filters.leadTime.attribute'', lead_type VARCHAR2(50) PATH ''$.filters.leadTime.type'',',
'            lead_from_val  DATE PATH ''$.filters.leadTime.from'', lead_to_val DATE PATH ''$.filters.leadTime.to'',',
'            lead_value     NUMBER PATH ''$.filters.leadTime.value''',
'          )) ORDER BY sequence',
'        ) LOOP',
'          DECLARE',
'            l_filters_passed BOOLEAN := TRUE;',
'            l_filter_failure_json CLOB := NULL;',
'            l_lead_time_json CLOB := NULL;',
'          BEGIN',
'            IF NOT (v_stay_date BETWEEN region_rec.stay_from AND region_rec.stay_to) THEN',
'              l_filters_passed := FALSE;',
'              l_filter_failure_json := ''{"filter_name":"stay_window", "actual":"''||TO_CHAR(v_stay_date, ''YYYY-MM-DD'')||''", "required":"''||TO_CHAR(region_rec.stay_from, ''YYYY-MM-DD'')||'' to ''||TO_CHAR(region_rec.stay_to, ''YYYY-MM-DD'')||''", "passed":fal'
||'se}'';',
'            ELSIF region_rec.days_of_week IS NOT NULL AND region_rec.days_of_week <> ''[]'' AND INSTR(region_rec.days_of_week, TO_CHAR(v_stay_date, ''D'')) = 0 THEN',
'              l_filters_passed := FALSE;',
'              l_filter_failure_json := ''{"filter_name":"day_of_week", "actual":"''||TO_CHAR(v_stay_date, ''D'')||''", "required":''||REPLACE(region_rec.days_of_week,''"'',''\"'')||'', "passed":false}'';',
'            ELSIF region_rec.lead_type IS NOT NULL THEN',
'              DECLARE',
'                lt_passes BOOLEAN := TRUE; lt_attr_id VARCHAR2(255); actual_lt_date DATE; lt_key VARCHAR2(265);',
'              BEGIN',
'                lt_attr_id := REGEXP_REPLACE(NVL(region_rec.lead_attr_raw, ''''), ''^#|#$'', ''''); lt_key := TO_CHAR(v_stay_date, ''YYYY-MM-DD'') || lt_attr_id;',
'                IF l_lead_dates.EXISTS(lt_key) THEN actual_lt_date := l_lead_dates(lt_key); ELSE actual_lt_date := NULL; END IF;',
'                IF actual_lt_date IS NULL THEN lt_passes := FALSE; END IF;',
'                CASE region_rec.lead_type',
'                    WHEN ''date_range'' THEN',
'                        IF lt_passes AND NOT (actual_lt_date BETWEEN region_rec.lead_from_val AND region_rec.lead_to_val) THEN lt_passes := FALSE; END IF;',
'                        l_lead_time_json := ''{"filter_name":"lead_time", "type":"date_range", "attribute":"''||lt_attr_id||''", "actual":"''||TO_CHAR(actual_lt_date, ''YYYY-MM-DD'')||''", "from":"''||TO_CHAR(region_rec.lead_from_val, ''YYYY-MM-DD'')||''", "to"'
||':"''||TO_CHAR(region_rec.lead_to_val, ''YYYY-MM-DD'')||''"}'';',
'                    WHEN ''days'' THEN',
'                        IF lt_passes AND (TRUNC(v_stay_date) - TRUNC(actual_lt_date)) < region_rec.lead_value THEN lt_passes := FALSE; END IF;',
'                        l_lead_time_json := ''{"filter_name":"lead_time", "type":"days", "attribute":"''||lt_attr_id||''", "actual_lead_days":''||(TRUNC(v_stay_date) - TRUNC(actual_lt_date))||'', "required_lead_days":''||region_rec.lead_value||''}'';',
'                    ELSE l_lead_time_json := ''{"filter_name":"lead_time", "type":"unknown"}'';',
'                END CASE;',
'                IF NOT lt_passes THEN',
'                    l_filters_passed := FALSE;',
'                    l_filter_failure_json := RTRIM(l_lead_time_json, ''}'') || '', "passed": false}'';',
'                END IF;',
'              END;',
'            END IF;',
'            IF l_filters_passed THEN',
'              FOR cond_rec IN (',
'                SELECT cond_name, expr, occ_attr, occ_op, occ_val, pr_type, pr_op, pr_val, es_op, es_val, sequence',
'                FROM JSON_TABLE(region_rec.conditions, ''$[*]'' COLUMNS (',
'                  cond_name VARCHAR2(255) PATH ''$.name'', expr VARCHAR2(4000) PATH ''$.expression'', sequence NUMBER PATH ''$.sequence'',',
'                  occ_attr VARCHAR2(255) PATH ''$.occupancyThreshold.attribute'', occ_op VARCHAR2(10) PATH ''$.occupancyThreshold.operator'', occ_val NUMBER PATH ''$.occupancyThreshold.value'',',
'                  pr_type VARCHAR2(255) PATH ''$.propertyRanking.type'', pr_op VARCHAR2(10) PATH ''$.propertyRanking.operator'', pr_val NUMBER PATH ''$.propertyRanking.value'',',
'                  es_op VARCHAR2(10) PATH ''$.eventScore.operator'', es_val NUMBER PATH ''$.eventScore.value''',
'                )) ORDER BY sequence',
'              ) LOOP',
'                DECLARE',
'                  l_expr CLOB := cond_rec.expr; l_eval_result NUMBER; l_applied_rule_json CLOB; v_condition_met BOOLEAN := TRUE;',
'                  l_actual_occ_val NUMBER := NULL; l_occ_attr_id VARCHAR2(255); l_pr_template_id VARCHAR2(255); l_pr_attr_id VARCHAR2(255);',
'                  l_actual_pr_val NUMBER := NULL; l_actual_event_score NUMBER := NULL; l_date_key VARCHAR2(10); l_attr_json CLOB;',
'                  l_raw_expr VARCHAR2(4000); l_eval_copy VARCHAR2(4000); l_expr_outcome NUMBER; l_attr_val VARCHAR2(4000);',
'                  l_attr_counter INTEGER := 0; l_failed_cond_json CLOB; l_check_result NUMBER; l_occ_failed BOOLEAN := NULL;',
'                  l_pr_failed BOOLEAN := NULL; l_ev_failed BOOLEAN := NULL; l_attr_in_expr VARCHAR2(255); l_pos PLS_INTEGER;',
'                BEGIN',
'                  l_occ_failed := NULL;',
'                  IF cond_rec.occ_attr IS NOT NULL THEN l_occ_attr_id := REPLACE(cond_rec.occ_attr, ''#'', ''''); IF l_staged_data.EXISTS(l_occ_attr_id) THEN l_actual_occ_val := get_value_for_date(l_staged_data(l_occ_attr_id), v_stay_date); EXECUTE IMMED'
||'IATE ''BEGIN :result := CASE WHEN :val1 '' || cond_rec.occ_op || '' :val2 THEN 1 ELSE 0 END; END;'' USING OUT l_check_result, IN l_actual_occ_val, IN cond_rec.occ_val; IF l_check_result = 0 OR l_actual_occ_val IS NULL THEN l_occ_failed := TRUE; v_conditi'
||'on_met := FALSE; ELSE l_occ_failed := FALSE; END IF; ELSE l_occ_failed := TRUE; v_condition_met := FALSE; END IF; END IF;',
'                  l_pr_failed := NULL;',
'                  IF v_condition_met AND cond_rec.pr_type IS NOT NULL THEN l_pr_template_id := REPLACE(cond_rec.pr_type, ''#'', ''''); l_pr_attr_id := get_attribute_id_from_template(l_pr_template_id); IF l_pr_attr_id IS NOT NULL AND l_staged_data.EXISTS('
||'l_pr_attr_id) THEN l_actual_pr_val := get_value_for_date(l_staged_data(l_pr_attr_id), v_stay_date); EXECUTE IMMEDIATE ''BEGIN :result := CASE WHEN :val1 '' || cond_rec.pr_op || '' :val2 THEN 1 ELSE 0 END; END;'' USING OUT l_check_result, IN l_actual_pr_v'
||'al, IN cond_rec.pr_val; IF l_check_result = 0 OR l_actual_pr_val IS NULL THEN l_pr_failed := TRUE; v_condition_met := FALSE; ELSE l_pr_failed := FALSE; END IF; ELSE l_pr_failed := TRUE; v_condition_met := FALSE; END IF; END IF;',
'                  l_ev_failed := NULL;',
'                  IF v_condition_met AND cond_rec.es_val IS NOT NULL THEN l_date_key := TO_CHAR(v_stay_date, ''YYYY-MM-DD''); IF l_event_scores.EXISTS(l_date_key) THEN l_actual_event_score := l_event_scores(l_date_key); ELSE l_actual_event_score := 0; '
||'END IF; EXECUTE IMMEDIATE ''BEGIN :result := CASE WHEN :val1 '' || cond_rec.es_op || '' :val2 THEN 1 ELSE 0 END; END;'' USING OUT l_check_result, IN l_actual_event_score, IN cond_rec.es_val; IF l_check_result = 0 THEN l_ev_failed := TRUE; v_condition_met'
||' := FALSE; ELSE l_ev_failed := FALSE; END IF; END IF;',
'                  IF v_condition_met THEN',
'                    l_raw_expr := cond_rec.expr; l_eval_copy := cond_rec.expr; l_attr_json := ''{''; l_attr_counter := 0; l_pos := 1;',
'                    LOOP l_attr_in_expr := REGEXP_SUBSTR(cond_rec.expr, ''#[A-F0-9]+#'', 1, l_pos); EXIT WHEN l_attr_in_expr IS NULL; l_current_id := REGEXP_REPLACE(l_attr_in_expr, ''^#|#$'', ''''); l_attr_val := TO_CHAR(get_value_for_date(l_staged_data(l_'
||'current_id), v_stay_date)); l_eval_copy := REPLACE(l_eval_copy, ''#'' || l_current_id || ''#'', l_attr_val); IF l_attr_counter > 0 THEN l_attr_json := l_attr_json || '',''; END IF; l_attr_json := l_attr_json || ''"'' || l_current_id || ''":'' || NVL(l_attr_val'
||', ''null''); l_pos := l_pos + 1; l_attr_counter := l_attr_counter + 1; END LOOP;',
'                    l_attr_json := l_attr_json || ''}''; l_eval_copy := REGEXP_REPLACE(l_eval_copy, ''(AVERAGE|SUM|COUNT|MAX|MIN)\s*\((.*?)\)'', ''ALGO_EVALUATOR_PKG.GENERIC_MATH_EVAL(''''\1'''', ''''\2'''')'', 1, 0, ''i''); EXECUTE IMMEDIATE ''SELECT '' || l_eval_cop'
||'y || '' FROM DUAL'' INTO l_expr_outcome; l_eval_result := l_expr_outcome;',
'                    l_applied_rule_json := ''{'' || ''"region":"'' || REPLACE(region_rec.region_name,''"'',''\"'') || ''", "condition":"'' || REPLACE(cond_rec.cond_name,''"'',''\"'') || ''", "stay_date":"'' || TO_CHAR(v_stay_date,''YYYY-MM-DD'') || ''", "filters":{'' ||'
||' ''"stay_window":"'' || TO_CHAR(region_rec.stay_from,''YYYY-MM-DD'') || '' to '' || TO_CHAR(region_rec.stay_to,''YYYY-MM-DD'') || ''"'' || '', "lead_time":'' || l_lead_time_json || CASE WHEN region_rec.days_of_week IS NOT NULL THEN '', "days_of_week":'' || REPLACE'
||'(region_rec.days_of_week,''"'',''\"'') ELSE '''' END || CASE WHEN region_rec.minimum_rate IS NOT NULL THEN '', "minimum_rate":'' || TO_CHAR(region_rec.minimum_rate) ELSE '''' END || ''}'' || '', "occupancy":'' || CASE WHEN cond_rec.occ_attr IS NOT NULL THEN ''{"att'
||'r":"'' || REPLACE(cond_rec.occ_attr,''#'','''') || ''", "actual":'' || NVL(TO_CHAR(l_actual_occ_val),''null'') || '', "operator":"'' || cond_rec.occ_op || ''", "threshold":'' || TO_CHAR(cond_rec.occ_val) || '', "failed":'' || CASE WHEN l_occ_failed THEN ''true'' ELSE'
||' ''false'' END || ''}'' ELSE ''null'' END || '', "property_ranking":'' || CASE WHEN cond_rec.pr_type IS NOT NULL THEN ''{"attr":"'' || NVL(l_pr_attr_id,'''') || ''", "actual":'' || NVL(TO_CHAR(l_actual_pr_val),''null'') || '', "operator":"'' || cond_rec.pr_op || ''", "'
||'threshold":'' || TO_CHAR(cond_rec.pr_val) || '', "failed":'' || CASE WHEN l_pr_failed THEN ''true'' ELSE ''false'' END || ''}'' ELSE ''null'' END || '', "event_score":'' || CASE WHEN cond_rec.es_val IS NOT NULL THEN ''{"actual":'' || NVL(TO_CHAR(l_actual_event_scor'
||'e),''null'') || '', "operator":"'' || cond_rec.es_op || ''", "threshold":'' || TO_CHAR(cond_rec.es_val) || '', "failed":'' || CASE WHEN l_ev_failed THEN ''true'' ELSE ''false'' END || ''}'' ELSE ''null'' END || '', "expression":"'' || REPLACE(cond_rec.expr,''"'',''\"'') |'
||'| ''", "expression_values":'' || l_attr_json || '', "evaluated_outcome":'' || NVL(TO_CHAR(l_expr_outcome),''null'');',
'                    IF region_rec.minimum_rate IS NOT NULL AND l_eval_result < region_rec.minimum_rate THEN l_applied_rule_json := l_applied_rule_json || '', "note":"min_rate_applied"''; l_eval_result := region_rec.minimum_rate; END IF;',
'                    l_applied_rule_json := l_applied_rule_json || '', "result":'' || TO_CHAR(l_eval_result) || ''}'';',
'                    PIPE ROW(t_result_rec_obj(l_algo_name, v_stay_date, TO_CHAR(v_stay_date, ''Dy''), l_eval_result, l_applied_rule_json));',
'                    v_any_rule_matched_for_date := TRUE;',
'                    GOTO end_date_processing;',
'                  ELSE',
'                    l_raw_expr := cond_rec.expr; l_eval_copy := cond_rec.expr; l_attr_json := ''{''; l_attr_counter := 0; l_pos := 1;',
'                    LOOP l_attr_in_expr := REGEXP_SUBSTR(cond_rec.expr, ''#[A-F0-9]+#'', 1, l_pos); EXIT WHEN l_attr_in_expr IS NULL; l_current_id := REGEXP_REPLACE(l_attr_in_expr, ''^#|#$'', ''''); l_attr_val := TO_CHAR(get_value_for_date(l_staged_data(l_'
||'current_id), v_stay_date)); l_eval_copy := REPLACE(l_eval_copy, ''#'' || l_current_id || ''#'', l_attr_val); IF l_attr_counter > 0 THEN l_attr_json := l_attr_json || '',''; END IF; l_attr_json := l_attr_json || ''"'' || l_current_id || ''":'' || NVL(l_attr_val'
||', ''null''); l_pos := l_pos + 1; l_attr_counter := l_attr_counter + 1; END LOOP;',
'                    l_attr_json := l_attr_json || ''}'';',
'                    BEGIN l_eval_copy := REGEXP_REPLACE(l_eval_copy, ''(AVERAGE|SUM|COUNT|MAX|MIN)\s*\((.*?)\)'', ''ALGO_EVALUATOR_PKG.GENERIC_MATH_EVAL(''''\1'''', ''''\2'''')'', 1, 0, ''i''); EXECUTE IMMEDIATE ''SELECT '' || l_eval_copy || '' FROM DUAL'' INTO l_expr'
||'_outcome; EXCEPTION WHEN OTHERS THEN l_expr_outcome := NULL; END;',
'                    l_failed_cond_json := ''{'' || ''"region":"'' || REPLACE(region_rec.region_name,''"'',''\"'') || ''", "condition":"'' || REPLACE(cond_rec.cond_name,''"'',''\"'') || ''", "stay_date":"'' || TO_CHAR(v_stay_date,''YYYY-MM-DD'') || ''", "filters":{'' || '
||'''"stay_window":"'' || TO_CHAR(region_rec.stay_from,''YYYY-MM-DD'') || '' to '' || TO_CHAR(region_rec.stay_to,''YYYY-MM-DD'') || ''"'' || '', "lead_time":'' || l_lead_time_json || CASE WHEN region_rec.days_of_week IS NOT NULL THEN '', "days_of_week":'' || REPLACE('
||'region_rec.days_of_week,''"'',''\"'') ELSE '''' END || CASE WHEN region_rec.minimum_rate IS NOT NULL THEN '', "minimum_rate":'' || TO_CHAR(region_rec.minimum_rate) ELSE '''' END || ''}'' || '', "occupancy":'' || CASE WHEN cond_rec.occ_attr IS NOT NULL THEN ''{"attr'
||'":"'' || REPLACE(cond_rec.occ_attr,''#'','''') || ''", "actual":'' || NVL(TO_CHAR(l_actual_occ_val),''null'') || '', "operator":"'' || cond_rec.occ_op || ''", "threshold":'' || TO_CHAR(cond_rec.occ_val) || '', "failed":'' || CASE WHEN l_occ_failed THEN ''true'' ELSE '
||'''false'' END || ''}'' ELSE ''null'' END || '', "property_ranking":'' || CASE WHEN cond_rec.pr_type IS NOT NULL THEN ''{"attr":"'' || NVL(l_pr_attr_id,'''') || ''", "actual":'' || NVL(TO_CHAR(l_actual_pr_val),''null'') || '', "operator":"'' || cond_rec.pr_op || ''", "t'
||'hreshold":'' || TO_CHAR(cond_rec.pr_val) || '', "failed":'' || CASE WHEN l_pr_failed THEN ''true'' ELSE ''false'' END || ''}'' ELSE ''null'' END || '', "event_score":'' || CASE WHEN cond_rec.es_val IS NOT NULL THEN ''{"actual":'' || NVL(TO_CHAR(l_actual_event_score'
||'),''null'') || '', "operator":"'' || cond_rec.es_op || ''", "threshold":'' || TO_CHAR(cond_rec.es_val) || '', "failed":'' || CASE WHEN l_ev_failed THEN ''true'' ELSE ''false'' END || ''}'' ELSE ''null'' END || '', "expression":"'' || REPLACE(cond_rec.expr,''"'',''\"'') ||'
||' ''", "expression_values":'' || l_attr_json || '', "evaluated_outcome":'' || NVL(TO_CHAR(l_expr_outcome),''null'') || '', "result":null'' || '', "note":"condition_not_met"'' || ''}'';',
'                    IF l_failure_details_json IS NULL THEN l_failure_details_json := ''['' || l_failed_cond_json; ELSE l_failure_details_json := l_failure_details_json || '','' || l_failed_cond_json; END IF;',
'                  END IF;',
'                END;',
'              END LOOP;',
'            ELSE',
'              DECLARE',
'                l_full_filter_fail_json CLOB;',
'              BEGIN',
'                l_full_filter_fail_json := ''{''',
'                  || ''"region":"'' || REPLACE(region_rec.region_name,''"'',''\"'')',
'                  || ''", "condition":null''',
'                  || '', "stay_date":"'' || TO_CHAR(v_stay_date,''YYYY-MM-DD'')',
'                  || ''", "note":"filter_not_met"''',
'                  || '', "failed_filter":'' || l_filter_failure_json',
'                  || ''}'';',
'                IF l_failure_details_json IS NULL THEN l_failure_details_json := ''['' || l_full_filter_fail_json; ELSE l_failure_details_json := l_failure_details_json || '','' || l_full_filter_fail_json; END IF;',
'              END;',
'            END IF;',
'          END;',
'        END LOOP;',
'',
'        <<end_date_processing>>',
'        IF NOT v_any_rule_matched_for_date THEN',
'          IF l_failure_details_json IS NOT NULL THEN',
'            l_failure_details_json := l_failure_details_json || '']'';',
'            PIPE ROW(t_result_rec_obj(l_algo_name, v_stay_date, TO_CHAR(v_stay_date, ''Dy''), NULL, l_failure_details_json));',
'          ELSE',
'            PIPE ROW(t_result_rec_obj(l_algo_name, v_stay_date, TO_CHAR(v_stay_date, ''Dy''), NULL, ''[{"note":"No Applicable Rules or Filters Found","stay_date":"'' || TO_CHAR(v_stay_date,''YYYY-MM-DD'') || ''"}]''));',
'          END IF;',
'        END IF;',
'',
'      <<next_date>>',
'      NULL;',
'      END;',
'    END LOOP;',
'',
'    RETURN;',
'  EXCEPTION',
'    WHEN OTHERS THEN',
'      PIPE ROW(t_result_rec_obj(l_algo_name, NULL, NULL, NULL, ''FATAL ERROR: '' || SQLERRM || '': '' || DBMS_UTILITY.FORMAT_ERROR_BACKTRACE));',
'      RETURN;',
'  END EVALUATE;',
'',
'END ALGO_EVALUATOR_PKG;',
'/',
'create or replace PACKAGE BODY app_user_ctx IS',
'  g_user_id UR_USERS.USER_ID%TYPE;',
'  PROCEDURE set_current_user_id(p_user_id IN UR_USERS.USER_ID%TYPE) IS',
'  BEGIN',
'    g_user_id := p_user_id;',
'  END;',
'  PROCEDURE clear_current_user_id IS',
'  BEGIN',
'    g_user_id := NULL;',
'  END;',
'  FUNCTION get_current_user_id RETURN UR_USERS.USER_ID%TYPE IS',
'  BEGIN',
'    RETURN g_user_id;',
'  END;',
'END app_user_ctx;',
'/',
'create or replace PACKAGE BODY Graph_SQL AS',
'',
'  -- Type to hold column info',
'  TYPE t_colrec IS RECORD (',
'    col_name    VARCHAR2(30),',
'    data_type   VARCHAR2(30),',
'    nullable    VARCHAR2(1),   -- ''Y'' or ''N''',
'    data_length NUMBER,',
'    data_precision NUMBER,',
'    data_scale  NUMBER,',
'    is_pk       BOOLEAN,',
'    default_val VARCHAR2(4000)',
'  );',
'  TYPE t_colrec_tab IS TABLE OF t_colrec INDEX BY PLS_INTEGER;',
'',
'  -- Debug utility',
'  PROCEDURE dbg(p_msg VARCHAR2, p_debug_flag VARCHAR2) IS',
'  BEGIN',
'    IF p_debug_flag = ''Y'' THEN',
'      BEGIN',
'        APEX_DEBUG.MESSAGE(p_msg);',
''))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'        ',
'      EXCEPTION WHEN OTHERS THEN',
'        DBMS_OUTPUT.put_line(p_msg);',
'      END;',
'    END IF;',
'  END;',
'',
'  -- Get table metadata',
'  FUNCTION get_table_columns(p_table VARCHAR2) RETURN t_colrec_tab IS',
'    cols t_colrec_tab;',
'    idx  PLS_INTEGER := 0;',
'    TYPE t_varchar2_tab IS TABLE OF VARCHAR2(30);',
'    pk_cols t_varchar2_tab;',
'  BEGIN',
'    -- Fetch PKs',
'    SELECT cols.column_name',
'    BULK COLLECT INTO pk_cols',
'    FROM user_constraints cons',
'    JOIN user_cons_columns cols',
'      ON cons.constraint_name = cols.constraint_name',
'    WHERE cons.constraint_type = ''P''',
'      AND cons.table_name = UPPER(p_table);',
'',
'    -- Fetch all columns',
'    FOR r IN (',
'      SELECT column_name, data_type, nullable,',
'             data_length, data_precision, data_scale, data_default',
'      FROM user_tab_columns',
'      WHERE table_name = UPPER(p_table)',
'      ORDER BY column_id',
'    ) LOOP',
'      idx := idx + 1;',
'      cols(idx).col_name := r.column_name;',
'      cols(idx).data_type := r.data_type;',
'      cols(idx).nullable := r.nullable;',
'      cols(idx).data_length := r.data_length;',
'      cols(idx).data_precision := r.data_precision;',
'      cols(idx).data_scale := r.data_scale;',
'      cols(idx).is_pk := (r.column_name MEMBER OF pk_cols);',
'      cols(idx).default_val := r.data_default;',
'    END LOOP;',
'',
'    RETURN cols;',
'  END;',
'',
'  -- Sample value helper',
'  FUNCTION sample_value(p_col t_colrec) RETURN VARCHAR2 IS',
'  BEGIN',
'    IF p_col.is_pk THEN',
'      IF UPPER(p_col.data_type) = ''RAW'' THEN',
'        RETURN LOWER(RAWTOHEX(SYS_GUID()));',
'      ELSE',
'        RETURN ''PK_VALUE'';',
'      END IF;',
'    END IF;',
'',
'    CASE UPPER(p_col.data_type)',
'      WHEN ''NUMBER'' THEN RETURN ''123'';',
'      WHEN ''DATE'' THEN RETURN TO_CHAR(SYSDATE, ''YYYY-MM-DD'');',
'      WHEN ''TIMESTAMP(6)'' THEN RETURN TO_CHAR(SYSTIMESTAMP, ''YYYY-MM-DD"T"HH24:MI:SS'');',
'      WHEN ''RAW'' THEN RETURN LOWER(RAWTOHEX(SYS_GUID()));',
'      ELSE RETURN ''SampleText'';',
'    END CASE;',
'  END;',
'',
'  -- Main procedure',
'  PROCEDURE proc_crud_json(',
'    p_mode      IN VARCHAR2,',
'    p_table     IN VARCHAR2,',
'    p_payload   IN CLOB,',
'    p_debug     IN VARCHAR2 DEFAULT ''N'',',
'    p_status    OUT VARCHAR2,',
'    p_message   OUT CLOB,',
'    p_icon out varchar2,',
'    p_title out varchar2',
'  ) IS',
'    l_cols t_colrec_tab;',
'  BEGIN',
'    dbg(''Start proc_crud_json, mode=''||p_mode, p_debug);',
'',
'    ------------------------------------------------------------------',
'    -- F = FETCH METADATA',
'    ------------------------------------------------------------------',
'    IF UPPER(p_mode) = ''F'' THEN',
'      l_cols := get_table_columns(p_table);',
'      IF l_cols.COUNT = 0 THEN',
'        p_status := ''E'';',
'        p_message := ''Table "''||p_table||''" does not exist or has no columns'';',
'        RETURN;',
'      END IF;',
'    ',
'      -- Build JSON metadata',
'      DECLARE',
'        l_json_response JSON_OBJECT_T := JSON_OBJECT_T();',
'        l_fields       JSON_ARRAY_T := JSON_ARRAY_T();',
'        l_mandatories  JSON_ARRAY_T := JSON_ARRAY_T();',
'        l_sample_c     JSON_OBJECT_T := JSON_OBJECT_T();',
'        l_sample_u     JSON_OBJECT_T := JSON_OBJECT_T();',
'        l_sample_d     JSON_OBJECT_T := JSON_OBJECT_T();',
'      BEGIN',
'        FOR i IN 1 .. l_cols.COUNT LOOP',
'          DECLARE',
'            l_field_obj JSON_OBJECT_T := JSON_OBJECT_T();',
'          BEGIN',
'          ',
'            l_field_obj.put(''column_name'', l_cols(i).col_name);',
'            l_field_obj.put(''data_type'', l_cols(i).data_type);',
'            l_field_obj.put(''nullable'', l_cols(i).nullable);',
'            l_field_obj.put(''is_primary_key'', CASE WHEN l_cols(i).is_pk THEN ''Y'' ELSE ''N'' END);',
'            l_field_obj.put(''default_value'', l_cols(i).default_val);',
'            l_field_obj.put(''sample_value'', sample_value(l_cols(i)));',
'            l_fields.append(l_field_obj);',
'',
'            IF l_cols(i).nullable = ''N'' OR l_cols(i).is_pk THEN',
'              l_mandatories.append(l_cols(i).col_name);',
'              l_sample_c.put(l_cols(i).col_name, sample_value(l_cols(i)));',
'            END IF;',
'',
'            IF l_cols(i).is_pk THEN',
'              l_sample_u.put(l_cols(i).col_name, sample_value(l_cols(i)));',
'              l_sample_d.put(l_cols(i).col_name, sample_value(l_cols(i)));',
'            ELSE',
'              IF l_cols(i).nullable = ''Y'' THEN',
'                l_sample_u.put(l_cols(i).col_name, sample_value(l_cols(i)));',
'              END IF;',
'            END IF;',
'          END;',
'        END LOOP;',
'',
'        l_json_response.put(''fields'', l_fields);',
'        l_json_response.put(''mandatory_columns'', l_mandatories);',
'        l_json_response.put(''sample_create_payload'', l_sample_c);',
'        l_json_response.put(''sample_update_payload'', l_sample_u);',
'        l_json_response.put(''sample_delete_payload'', l_sample_d);',
'',
'        p_status := ''S'';',
'        p_message := l_json_response.to_string;',
'      END;',
'',
'',
'------------------------------------------------------------------',
'-- C = CREATE / INSERT (dynamic, JSON-driven)',
'------------------------------------------------------------------',
'ELSIF UPPER(p_mode) = ''C'' THEN',
'  dbg(''Entering CREATE mode for table ''||p_table, p_debug);',
'',
'  DECLARE',
'    l_sql         VARCHAR2(32767);',
'    l_insert_cols VARCHAR2(32767) := '''';',
'    l_insert_vals VARCHAR2(32767) := '''';',
'    l_val         VARCHAR2(4000);',
'    l_clob         clob;',
'    c             INTEGER;',
'    rc            INTEGER;',
'    l_any_found   BOOLEAN := FALSE;',
'    l_new_id      RAW(16);  -- Generate SYS_GUID manually',
'  BEGIN',
'    -- Generate new ID',
'    l_new_id := SYS_GUID();',
'',
'    -- Load column metadata for the target table',
'    l_cols := get_table_columns(p_table);',
'    IF l_cols.COUNT = 0 THEN',
'      p_status  := ''E'';',
'      p_message := ''Table "''||p_table||''" does not exist or has no columns'';',
'      RETURN;',
'    END IF;',
'    -- Build column and bind lists',
'    FOR i IN 1 .. l_cols.COUNT LOOP',
'    ',
'      IF UPPER(l_cols(i).col_name) = ''ID'' THEN',
'         l_val := (l_new_id);  -- assign SYS_GUID for ID',
'      ELSE',
'            l_val :=  json_query( p_payload , ''$."''||l_cols(i).col_name||''"'' returning clob)  ;   -- Need to add col type if clob type  ---------------------------------------------',
'       -- l_val := json_value(p_payload, ''$."''||l_cols(i).col_name||''"'');',
'      END IF;',
'      IF l_val IS NOT NULL THEN',
'        l_any_found := TRUE;',
'        l_insert_cols := l_insert_cols || l_cols(i).col_name || '','';',
'        l_insert_vals := l_insert_vals || '':'' || l_cols(i).col_name || '','';',
'      END IF;',
'    END LOOP;',
'    IF NOT l_any_found THEN',
'      p_status  := ''E'';',
'      p_message := ''No matching columns found in payload for insert'';',
'      RETURN;',
'    END IF;',
'    l_insert_cols := RTRIM(l_insert_cols, '','');',
'    l_insert_vals := RTRIM(l_insert_vals, '','');',
'    -- Compose SQL',
'    l_sql := ''INSERT INTO '' || p_table || '' ('' || l_insert_cols || '') '' ||',
'             ''VALUES ('' || l_insert_vals || '')'';',
'    dbg(''Generated INSERT SQL: ''||l_sql, p_debug);',
'    -- Parse and bind',
'    c := DBMS_SQL.open_cursor;',
'    DBMS_SQL.parse(c, l_sql, DBMS_SQL.native);',
'    -- Bind values',
'    FOR i IN 1 .. l_cols.COUNT LOOP',
'      IF UPPER(l_cols(i).col_name) = ''ID'' THEN',
'        DBMS_SQL.bind_variable(c, '':''||l_cols(i).col_name, l_new_id);',
'      ELSE',
'       -- l_val := json_query( p_payload , ''$."''||l_cols(i).col_name||''"'' returning clob) ;',
'        if upper(l_cols(i).data_type) = ''CLOB'' then',
'         l_clob := json_query( p_payload , ''$."''||l_cols(i).col_name||''"'' returning clob) ;',
'        else',
'            l_val := json_value(p_payload, ''$."''||l_cols(i).col_name||''"'');',
'        end if;',
'',
'       -- l_val := json_value(p_payload, ''$."''||l_cols(i).col_name||''"'');',
'        IF l_val IS NOT NULL OR l_clob IS NOT NULL THEN        ',
'         -- DBMS_SQL.bind_variable(c, '':''||l_cols(i).col_name, l_val); ',
'         if upper(l_cols(i).data_type) = ''CLOB'' then',
'            dbms_sql.bind_variable(c, '':''||l_cols(i).col_name, l_clob);  -- l_val must be CLOB',
'        else',
'            dbms_sql.bind_variable(c, '':''||l_cols(i).col_name, to_char(l_val));',
'        end if;',
'        END IF;',
'      END IF;',
'      ',
'    END LOOP;',
'    rc := DBMS_SQL.execute(c);',
'    DBMS_SQL.close_cursor(c);',
'    p_status  := ''S'';',
'    p_message := ''Inserted ''||rc||'' row(s). New ID ='' || RAWTOHEX(l_new_id) || '''';',
'  EXCEPTION',
'    WHEN OTHERS THEN',
'      IF DBMS_SQL.is_open(c) THEN',
'        DBMS_SQL.close_cursor(c);',
'      END IF;',
'      p_status  := ''E'';',
'      p_message := ''Insert failed: ''||SQLERRM;',
'      dbg(''Insert failed: ''||SQLERRM, p_debug);',
'  END;',
'',
'',
'',
'    ------------------------------------------------------------------',
'    -- U = UPDATE',
'    ------------------------------------------------------------------',
'ELSIF UPPER(p_mode) = ''U'' THEN',
'   dbg(''--- UPDATE MODE START ---'', p_debug);',
'',
'   DECLARE',
'     l_sql       VARCHAR2(32767);',
'     l_set_list  VARCHAR2(32767);',
'     l_pk_col    VARCHAR2(128);',
'     c           INTEGER;',
'     l_rows      INTEGER;',
'     l_val       VARCHAR2(4000);',
'     l_first     BOOLEAN := TRUE;',
'   BEGIN',
'     -- 1. Get primary key column',
'     SELECT ucc.column_name',
'       INTO l_pk_col',
'       FROM user_constraints uc',
'       JOIN user_cons_columns ucc ',
'         ON uc.constraint_name = ucc.constraint_name',
'      WHERE uc.table_name = UPPER(p_table)',
'        AND uc.constraint_type = ''P''',
'        AND ROWNUM = 1;',
'',
'     dbg(''Primary Key Column='' || l_pk_col, p_debug);',
'',
'     -- 2. Build SET clause dynamically in PL/SQL',
'     l_set_list := '''';',
'     FOR rec IN (',
'       SELECT column_name',
'       FROM user_tab_columns',
'       WHERE table_name = UPPER(p_table)',
'         AND column_name <> l_pk_col',
'       ORDER BY column_id',
'     )',
'     LOOP',
'       l_val := json_value(p_payload, ''$."''||rec.column_name||''"'' returning varchar2(4000));',
'       IF l_val IS NOT NULL THEN',
'         IF l_first THEN',
'           l_set_list := ''"''||rec.column_name||''" = :''||rec.column_name;',
'           l_first := FALSE;',
'         ELSE',
'           l_set_list := l_set_list || '', "''||rec.column_name||''" = :''||rec.column_name;',
'         END IF;',
'       END IF;',
'     END LOOP;',
'',
'     IF l_set_list IS NULL THEN',
'       p_status  := ''E'';',
'       p_message := ''No updatable columns found in JSON payload.'';',
'       RETURN;',
'     END IF;',
'',
'     -- 3. Final UPDATE statement',
'     l_sql := ''UPDATE '' || p_table || '' SET '' || l_set_list ||',
'              '' WHERE "'' || l_pk_col || ''" = :''||l_pk_col;',
'',
'     dbg(''Final Update SQL = '' || l_sql, p_debug);',
'',
'     -- 4. Parse and bind',
'     c := dbms_sql.open_cursor;',
'     dbms_sql.parse(c, l_sql, dbms_sql.native);',
'',
'     -- Bind non-PK values',
'     FOR rec IN (',
'       SELECT column_name',
'       FROM user_tab_columns',
'       WHERE table_name = UPPER(p_table)',
'         AND column_name <> l_pk_col',
'     )',
'     LOOP',
'       l_val := json_value(p_payload, ''$."''||rec.column_name||''"'' returning varchar2(4000));',
'       IF l_val IS NOT NULL THEN',
'         dbms_sql.bind_variable(c, '':''||rec.column_name, l_val);',
'         dbg(''Binding ''||rec.column_name||''=''||l_val, p_debug);',
'       END IF;',
'     END LOOP;',
'',
'     -- Bind PK',
'     l_val := json_value(p_payload, ''$."''||l_pk_col||''"'' returning varchar2(4000));',
'     IF l_val IS NOT NULL THEN',
'       dbms_sql.bind_variable(c, '':''||l_pk_col, l_val);',
'       dbg(''Binding PK ''||l_pk_col||''=''||l_val, p_debug);',
'     END IF;',
'',
'     -- 5. Execute',
'     l_rows := dbms_sql.execute(c);',
'     dbms_sql.close_cursor(c);',
'',
'     p_status  := ''S'';',
'     p_message := ''Updated ''||l_rows||'' hotel successfully.'';',
'    p_icon  := ''success'';',
'    p_title := ''Success!'';',
'',
'   ',
'',
'',
'     dbg(''--- UPDATE MODE END ---'', p_debug);',
'   EXCEPTION',
'     WHEN OTHERS THEN',
'       IF dbms_sql.is_open(c) THEN',
'         dbms_sql.close_cursor(c);',
'       END IF;',
'       p_status  := ''E'';',
'       p_message := ''Update failed: ''||SQLERRM;',
'        p_icon  := ''error'';',
'    p_title := ''Update Failed'';',
'       dbg(''Update failed: ''||SQLERRM, p_debug);',
'   END;',
'',
'',
'',
'',
'------------------------------------------------------------------',
'-- D = DELETE',
'------------------------------------------------------------------',
'ELSIF p_mode = ''D'' THEN',
'    -- Delete record(s) based on primary key(s)',
'    DECLARE',
'        l_pk_col VARCHAR2(200);',
'        l_pk_val VARCHAR2(4000);',
'        l_sql    VARCHAR2(4000);',
'    BEGIN',
'        -- Fetch the primary key column dynamically',
'        SELECT cols.column_name',
'        INTO   l_pk_col',
'        FROM   all_constraints cons',
'        JOIN   all_cons_columns cols',
'        ON     cons.constraint_name = cols.constraint_name',
'        AND    cons.owner = cols.owner',
'        WHERE  cons.constraint_type = ''P''',
'        AND    cons.table_name = UPPER(p_table)',
'        AND    ROWNUM = 1;',
'',
'        -- Extract PK value from JSON',
'        l_pk_val := json_value(p_payload, ''$."'' || l_pk_col || ''"'');',
'',
'        IF l_pk_val IS NULL THEN',
'            p_status  := ''E'';',
'            p_message := ''Primary key ''||l_pk_col||'' not found in payload'';',
'            RETURN;',
'        END IF;',
'',
'        -- Build DELETE SQL',
'        l_sql := ''DELETE FROM '' || p_table || '' WHERE '' || l_pk_col || '' = :pk'';',
'',
'        IF p_debug = ''Y'' THEN',
'            dbms_output.put_line(''DELETE SQL: '' || l_sql);',
'            dbms_output.put_line(''PK VALUE : '' || l_pk_val);',
'        END IF;',
'',
'        -- Execute delete',
'        EXECUTE IMMEDIATE l_sql USING l_pk_val;',
'',
'        p_status  := ''S'';',
'        p_message := ''Delete successful.'';',
'',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            p_status  := ''E'';',
'            p_message := ''Delete failed: '' || SQLERRM;',
'    END;',
'',
'    ------------------------------------------------------------------',
'    -- Other modes not implemented yet',
'    ------------------------------------------------------------------',
'    ELSE',
'      p_status := ''E'';',
'      p_message := ''Mode ''||p_mode||'' not implemented'';',
'    END IF;',
'',
'  END proc_crud_json;',
'',
'END Graph_SQL;',
'/',
'create or replace PACKAGE BODY pkg_generic_crud AS',
'',
'  -- Type to hold column info',
'  TYPE t_colrec IS RECORD (',
'    col_name    VARCHAR2(30),',
'    data_type   VARCHAR2(30),',
'    nullable    VARCHAR2(1),   -- ''Y'' or ''N''',
'    data_length NUMBER,',
'    data_precision NUMBER,',
'    data_scale  NUMBER,',
'    is_pk       BOOLEAN,',
'    default_val VARCHAR2(4000)',
'  );',
'  TYPE t_colrec_tab IS TABLE OF t_colrec INDEX BY PLS_INTEGER;',
'',
'  -- Debug utility',
'  PROCEDURE dbg(p_msg VARCHAR2, p_debug_flag VARCHAR2) IS',
'  BEGIN',
'    IF p_debug_flag = ''Y'' THEN',
'      BEGIN',
'        APEX_DEBUG.MESSAGE(p_msg);',
'      EXCEPTION WHEN OTHERS THEN',
'        DBMS_OUTPUT.put_line(p_msg);',
'      END;',
'    END IF;',
'  END;',
'',
'  -- Get table metadata',
'  FUNCTION get_table_columns(p_table VARCHAR2) RETURN t_colrec_tab IS',
'    cols t_colrec_tab;',
'    idx  PLS_INTEGER := 0;',
'    TYPE t_varchar2_tab IS TABLE OF VARCHAR2(30);',
'    pk_cols t_varchar2_tab;',
'  BEGIN',
'    -- Fetch PKs',
'    SELECT cols.column_name',
'    BULK COLLECT INTO pk_cols',
'    FROM user_constraints cons',
'    JOIN user_cons_columns cols',
'      ON cons.constraint_name = cols.constraint_name',
'    WHERE cons.constraint_type = ''P''',
'      AND cons.table_name = UPPER(p_table);',
'',
'    -- Fetch all columns',
'    FOR r IN (',
'      SELECT column_name, data_type, nullable,',
'             data_length, data_precision, data_scale, data_default',
'      FROM user_tab_columns',
'      WHERE table_name = UPPER(p_table)',
'      ORDER BY column_id',
'    ) LOOP',
'      idx := idx + 1;',
'      cols(idx).col_name := r.column_name;',
'      cols(idx).data_type := r.data_type;',
'      cols(idx).nullable := r.nullable;',
'      cols(idx).data_length := r.data_length;',
'      cols(idx).data_precision := r.data_precision;',
'      cols(idx).data_scale := r.data_scale;',
'      cols(idx).is_pk := (r.column_name MEMBER OF pk_cols);',
'      cols(idx).default_val := r.data_default;',
'    END LOOP;',
'',
'    RETURN cols;',
'  END;',
'',
'  -- Sample value helper',
'  FUNCTION sample_value(p_col t_colrec) RETURN VARCHAR2 IS',
'  BEGIN',
'    IF p_col.is_pk THEN',
'      IF UPPER(p_col.data_type) = ''RAW'' THEN',
'        RETURN LOWER(RAWTOHEX(SYS_GUID()));',
'      ELSE',
'        RETURN ''PK_VALUE'';',
'      END IF;',
'    END IF;',
'',
'    CASE UPPER(p_col.data_type)',
'      WHEN ''NUMBER'' THEN RETURN ''123'';',
'      WHEN ''DATE'' THEN RETURN TO_CHAR(SYSDATE, ''YYYY-MM-DD'');',
'      WHEN ''TIMESTAMP(6)'' THEN RETURN TO_CHAR(SYSTIMESTAMP, ''YYYY-MM-DD"T"HH24:MI:SS'');',
'      WHEN ''RAW'' THEN RETURN LOWER(RAWTOHEX(SYS_GUID()));',
'      ELSE RETURN ''SampleText'';',
'    END CASE;',
'  END;',
'',
'  -- Main procedure',
'  PROCEDURE proc_crud_json(',
'    p_mode      IN VARCHAR2,',
'    p_table     IN VARCHAR2,',
'    p_payload   IN CLOB,',
'    p_debug     IN VARCHAR2 DEFAULT ''N'',',
'    p_status    OUT VARCHAR2,',
'    p_message   OUT CLOB,',
'    p_icon out varchar2,',
'    p_title out varchar2',
'  ) IS',
'    l_cols t_colrec_tab;',
'  BEGIN',
'    dbg(''Start proc_crud_json, mode=''||p_mode, p_debug);',
'',
'    ------------------------------------------------------------------',
'    -- F = FETCH METADATA',
'    ------------------------------------------------------------------',
'    IF UPPER(p_mode) = ''F'' THEN',
'      l_cols := get_table_columns(p_table);',
'      IF l_cols.COUNT = 0 THEN',
'        p_status := ''E'';',
'        p_message := ''Table "''||p_table||''" does not exist or has no columns'';',
'        RETURN;',
'      END IF;',
'',
'      -- Build JSON metadata',
'      DECLARE',
'        l_json_response JSON_OBJECT_T := JSON_OBJECT_T();',
'        l_fields       JSON_ARRAY_T := JSON_ARRAY_T();',
'        l_mandatories  JSON_ARRAY_T := JSON_ARRAY_T();',
'        l_sample_c     JSON_OBJECT_T := JSON_OBJECT_T();',
'        l_sample_u     JSON_OBJECT_T := JSON_OBJECT_T();',
'        l_sample_d     JSON_OBJECT_T := JSON_OBJECT_T();',
'      BEGIN',
'        FOR i IN 1 .. l_cols.COUNT LOOP',
'          DECLARE',
'            l_field_obj JSON_OBJECT_T := JSON_OBJECT_T();',
'          BEGIN',
'            l_field_obj.put(''column_name'', l_cols(i).col_name);',
'            l_field_obj.put(''data_type'', l_cols(i).data_type);',
'            l_field_obj.put(''nullable'', l_cols(i).nullable);',
'            l_field_obj.put(''is_primary_key'', CASE WHEN l_cols(i).is_pk THEN ''Y'' ELSE ''N'' END);',
'            l_field_obj.put(''default_value'', l_cols(i).default_val);',
'            l_field_obj.put(''sample_value'', sample_value(l_cols(i)));',
'            l_fields.append(l_field_obj);',
'',
'            IF l_cols(i).nullable = ''N'' OR l_cols(i).is_pk THEN',
'              l_mandatories.append(l_cols(i).col_name);',
'              l_sample_c.put(l_cols(i).col_name, sample_value(l_cols(i)));',
'            END IF;',
'',
'            IF l_cols(i).is_pk THEN',
'              l_sample_u.put(l_cols(i).col_name, sample_value(l_cols(i)));',
'              l_sample_d.put(l_cols(i).col_name, sample_value(l_cols(i)));',
'            ELSE',
'              IF l_cols(i).nullable = ''Y'' THEN',
'                l_sample_u.put(l_cols(i).col_name, sample_value(l_cols(i)));',
'              END IF;',
'            END IF;',
'          END;',
'        END LOOP;',
'',
'        l_json_response.put(''fields'', l_fields);',
'        l_json_response.put(''mandatory_columns'', l_mandatories);',
'        l_json_response.put(''sample_create_payload'', l_sample_c);',
'        l_json_response.put(''sample_update_payload'', l_sample_u);',
'        l_json_response.put(''sample_delete_payload'', l_sample_d);',
'',
'        p_status := ''S'';',
'        p_message := l_json_response.to_string;',
'      END;',
'',
'',
'------------------------------------------------------------------',
'-- C = CREATE / INSERT (dynamic, JSON-driven)',
'------------------------------------------------------------------',
'ELSIF UPPER(p_mode) = ''C'' THEN',
'  dbg(''Entering CREATE mode for table ''||p_table, p_debug);',
'',
'  DECLARE',
'    l_sql         VARCHAR2(32767);',
'    l_insert_cols VARCHAR2(32767) := '''';',
'    l_insert_vals VARCHAR2(32767) := '''';',
'    l_val         VARCHAR2(4000);',
'    c             INTEGER;',
'    rc            INTEGER;',
'    l_any_found   BOOLEAN := FALSE;',
'  BEGIN',
'    -- Load column metadata for the target table',
'    l_cols := get_table_columns(p_table);',
'    IF l_cols.COUNT = 0 THEN',
'      p_status  := ''E'';',
'      p_message := ''Table "''||p_table||''" does not exist or has no columns'';',
'      RETURN;',
'    END IF;',
'',
'    -- Build column and bind placeholder lists from JSON',
'    FOR i IN 1 .. l_cols.COUNT LOOP',
'      -- Pull value from JSON; non-existent key or JSON null -> NULL',
'      l_val := json_value(p_payload, ''$."''||l_cols(i).col_name||''"'');',
'',
'      IF p_debug = ''Y'' THEN',
'        dbg(''JSON check for column ''||l_cols(i).col_name||'' -> ''||',
'            CASE WHEN l_val IS NULL THEN ''NULL/absent'' ELSE l_val END, p_debug);',
'      END IF;',
'',
'      -- Only include columns that have a non-NULL value in payload',
'      IF l_val IS NOT NULL THEN',
'        l_any_found := TRUE;',
'        -- Note: do not quote column names here; they are from data dictionary and uppercase-safe',
'        l_insert_cols := l_insert_cols || l_cols(i).col_name || '','';',
'        l_insert_vals := l_insert_vals || '':'' || l_cols(i).col_name || '','';',
'      END IF;',
'    END LOOP;',
'',
'    IF NOT l_any_found THEN',
'      p_status  := ''E'';',
'      p_message := ''No matching columns found in payload for insert'';',
'      RETURN;',
'    END IF;',
'',
'    -- Trim trailing commas',
'    l_insert_cols := RTRIM(l_insert_cols, '','');',
'    l_insert_vals := RTRIM(l_insert_vals, '','');',
'',
'    -- Compose SQL',
'    l_sql := ''INSERT INTO '' || p_table || '' ('' || l_insert_cols || '') VALUES ('' || l_insert_vals || '')'';',
'    dbg(''Generated INSERT SQL: ''||l_sql, p_debug);',
'',
'    -- Parse and bind',
'    c := DBMS_SQL.open_cursor;',
'    DBMS_SQL.parse(c, l_sql, DBMS_SQL.native);',
'',
'    -- Bind only the columns we actually included (non-NULL in payload)',
'    FOR i IN 1 .. l_cols.COUNT LOOP',
'      l_val := json_value(p_payload, ''$."''||l_cols(i).col_name||''"'');',
'      IF l_val IS NOT NULL THEN',
'        DBMS_SQL.bind_variable(c, '':''||l_cols(i).col_name, l_val);',
'        dbg(''Binding ''||l_cols(i).col_name||''=''||l_val, p_debug);',
'      END IF;',
'    END LOOP;',
'',
'    rc := DBMS_SQL.execute(c);',
'    DBMS_SQL.close_cursor(c);',
'',
'    p_status  := ''S'';',
'    p_message := ''Inserted ''||rc||'' row(s)'';',
'',
'  EXCEPTION',
'    WHEN OTHERS THEN',
'      IF DBMS_SQL.is_open(c) THEN',
'        DBMS_SQL.close_cursor(c);',
'      END IF;',
'      p_status  := ''E'';',
'      p_message := ''Insert failed: ''||SQLERRM;',
'      dbg(''Insert failed: ''||SQLERRM, p_debug);',
'  END;',
'',
'',
'    ------------------------------------------------------------------',
'    -- U = UPDATE',
'    ------------------------------------------------------------------',
'ELSIF UPPER(p_mode) = ''U'' THEN',
'   dbg(''--- UPDATE MODE START ---'', p_debug);',
'',
'   DECLARE',
'     l_sql       VARCHAR2(32767);',
'     l_set_list  VARCHAR2(32767);',
'     l_pk_col    VARCHAR2(128);',
'     c           INTEGER;',
'     l_rows      INTEGER;',
'     l_val       VARCHAR2(4000);',
'     l_first     BOOLEAN := TRUE;',
'   BEGIN',
'     -- 1. Get primary key column',
'     SELECT ucc.column_name',
'       INTO l_pk_col',
'       FROM user_constraints uc',
'       JOIN user_cons_columns ucc ',
'         ON uc.constraint_name = ucc.constraint_name',
'      WHERE uc.table_name = UPPER(p_table)',
'        AND uc.constraint_type = ''P''',
'        AND ROWNUM = 1;',
'',
'     dbg(''Primary Key Column='' || l_pk_col, p_debug);',
'',
'     -- 2. Build SET clause dynamically in PL/SQL',
'     l_set_list := '''';',
'     FOR rec IN (',
'       SELECT column_name',
'       FROM user_tab_columns',
'       WHERE table_name = UPPER(p_table)',
'         AND column_name <> l_pk_col',
'       ORDER BY column_id',
'     )',
'     LOOP',
'       l_val := json_value(p_payload, ''$."''||rec.column_name||''"'' returning varchar2(4000));',
'       IF l_val IS NOT NULL THEN',
'         IF l_first THEN',
'           l_set_list := ''"''||rec.column_name||''" = :''||rec.column_name;',
'           l_first := FALSE;',
'         ELSE',
'           l_set_list := l_set_list || '', "''||rec.column_name||''" = :''||rec.column_name;',
'         END IF;',
'       END IF;',
'     END LOOP;',
'',
'     IF l_set_list IS NULL THEN',
'       p_status  := ''E'';',
'       p_message := ''No updatable columns found in JSON payload.'';',
'       RETURN;',
'     END IF;',
'',
'     -- 3. Final UPDATE statement',
'     l_sql := ''UPDATE '' || p_table || '' SET '' || l_set_list ||',
'              '' WHERE "'' || l_pk_col || ''" = :''||l_pk_col;',
'',
'     dbg(''Final Update SQL = '' || l_sql, p_debug);',
'',
'     -- 4. Parse and bind',
'     c := dbms_sql.open_cursor;',
'     dbms_sql.parse(c, l_sql, dbms_sql.native);',
'',
'     -- Bind non-PK values',
'     FOR rec IN (',
'       SELECT column_name',
'       FROM user_tab_columns',
'       WHERE table_name = UPPER(p_table)',
'         AND column_name <> l_pk_col',
'     )',
'     LOOP',
'       l_val := json_value(p_payload, ''$."''||rec.column_name||''"'' returning varchar2(4000));',
'       IF l_val IS NOT NULL THEN',
'         dbms_sql.bind_variable(c, '':''||rec.column_name, l_val);',
'         dbg(''Binding ''||rec.column_name||''=''||l_val, p_debug);',
'       END IF;',
'     END LOOP;',
'',
'     -- Bind PK',
'     l_val := json_value(p_payload, ''$."''||l_pk_col||''"'' returning varchar2(4000));',
'     IF l_val IS NOT NULL THEN',
'       dbms_sql.bind_variable(c, '':''||l_pk_col, l_val);',
'       dbg(''Binding PK ''||l_pk_col||''=''||l_val, p_debug);',
'     END IF;',
'',
'     -- 5. Execute',
'     l_rows := dbms_sql.execute(c);',
'     dbms_sql.close_cursor(c);',
'',
'     p_status  := ''S'';',
'     p_message := ''Updated ''||l_rows||'' hotel successfully.'';',
'    p_icon  := ''success'';',
'    p_title := ''Success!'';',
'',
'   ',
'',
'',
'     dbg(''--- UPDATE MODE END ---'', p_debug);',
'   EXCEPTION',
'     WHEN OTHERS THEN',
'       IF dbms_sql.is_open(c) THEN',
'         dbms_sql.close_cursor(c);',
'       END IF;',
'       p_status  := ''E'';',
'       p_message := ''Update failed: ''||SQLERRM;',
'        p_icon  := ''error'';',
'    p_title := ''Update Failed'';',
'       dbg(''Update failed: ''||SQLERRM, p_debug);',
'   END;',
'',
'',
'',
'',
'------------------------------------------------------------------',
'-- D = DELETE',
'------------------------------------------------------------------',
'ELSIF p_mode = ''D'' THEN',
'    -- Delete record(s) based on primary key(s)',
'    DECLARE',
'        l_pk_col VARCHAR2(200);',
'        l_pk_val VARCHAR2(4000);',
'        l_sql    VARCHAR2(4000);',
'    BEGIN',
'        -- Fetch the primary key column dynamically',
'        SELECT cols.column_name',
'        INTO   l_pk_col',
'        FROM   all_constraints cons',
'        JOIN   all_cons_columns cols',
'        ON     cons.constraint_name = cols.constraint_name',
'        AND    cons.owner = cols.owner',
'        WHERE  cons.constraint_type = ''P''',
'        AND    cons.table_name = UPPER(p_table)',
'        AND    ROWNUM = 1;',
'',
'        -- Extract PK value from JSON',
'        l_pk_val := json_value(p_payload, ''$."'' || l_pk_col || ''"'');',
'',
'        IF l_pk_val IS NULL THEN',
'            p_status  := ''E'';',
'            p_message := ''Primary key ''||l_pk_col||'' not found in payload'';',
'            RETURN;',
'        END IF;',
'',
'        -- Build DELETE SQL',
'        l_sql := ''DELETE FROM '' || p_table || '' WHERE '' || l_pk_col || '' = :pk'';',
'',
'        IF p_debug = ''Y'' THEN',
'            dbms_output.put_line(''DELETE SQL: '' || l_sql);',
'            dbms_output.put_line(''PK VALUE : '' || l_pk_val);',
'        END IF;',
'',
'        -- Execute delete',
'        EXECUTE IMMEDIATE l_sql USING l_pk_val;',
'',
'        p_status  := ''S'';',
'        p_message := ''Delete successful.'';',
'',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            p_status  := ''E'';',
'            p_message := ''Delete failed: '' || SQLERRM;',
'    END;',
'',
'    ------------------------------------------------------------------',
'    -- Other modes not implemented yet',
'    ------------------------------------------------------------------',
'    ELSE',
'      p_status := ''E'';',
'      p_message := ''Mode ''||p_mode||'' not implemented'';',
'    END IF;',
'',
'  END proc_crud_json;',
'',
'END pkg_generic_crud;',
'/',
'create or replace PACKAGE BODY ur_users_pkg IS',
'  -----------------------------------------------------------------------',
'  -- Internal helper: generate base username (first letter + last, cleaned)',
'  -----------------------------------------------------------------------',
'  FUNCTION gen_base_username(p_first IN VARCHAR2, p_last IN VARCHAR2) RETURN VARCHAR2 IS',
'    l_first VARCHAR2(200);',
'    l_last  VARCHAR2(200);',
'    l_raw   VARCHAR2(400);',
'  BEGIN',
'    -- copy to locals (can''t assign to IN params)',
'    l_first := NVL(TRIM(p_first), ''x'');',
'    l_last  := NVL(TRIM(p_last), ''user'');',
'',
'    l_raw := LOWER(SUBSTR(l_first,1,1) || l_last);',
'    RETURN REGEXP_REPLACE(l_raw, ''[^a-z0-9]'', '''');',
'  END gen_base_username;',
'',
'  -----------------------------------------------------------------------',
'  -- Ensure uniqueness: check UR_USERS table and APEX accounts, append digits',
'  -----------------------------------------------------------------------',
'  FUNCTION ensure_unique_username(p_base IN VARCHAR2) RETURN VARCHAR2 IS',
'    l_try        VARCHAR2(255) := p_base;',
'    l_counter    PLS_INTEGER := 1;',
'    l_exists     NUMBER;',
'    l_apex_userid NUMBER;',
'  BEGIN',
'    LOOP',
'      SELECT COUNT(*) INTO l_exists FROM UR_USERS WHERE LOWER(USER_NAME) = LOWER(l_try);',
'',
'      IF l_exists = 0 THEN',
'        -- Check APEX repository safely',
'        BEGIN',
'          l_apex_userid := APEX_UTIL.GET_USER_ID(l_try);',
'        EXCEPTION',
'          WHEN OTHERS THEN',
'            l_apex_userid := NULL;',
'        END;',
'        IF l_apex_userid IS NOT NULL THEN',
'          l_exists := 1;',
'        END IF;',
'      END IF;',
'',
'      IF l_exists = 0 THEN',
'        RETURN l_try;',
'      END IF;',
'',
'      l_counter := l_counter + 1;',
'      l_try := p_base || TO_CHAR(l_counter);',
'      l_exists := 0;',
'    END LOOP;',
'  END ensure_unique_username;',
'',
'  -----------------------------------------------------------------------',
'  -- create apex user (requires workspace admin privileges)',
'  -----------------------------------------------------------------------',
'  PROCEDURE do_create_apex_user(',
'    p_user_name IN VARCHAR2,',
'    p_first_name IN VARCHAR2,',
'    p_last_name  IN VARCHAR2,',
'    p_email      IN VARCHAR2,',
'    p_allow_app_building_yn IN VARCHAR2 DEFAULT ''N''',
'  ) IS',
'    l_temp_pwd VARCHAR2(100);',
'  BEGIN',
'    l_temp_pwd := dbms_random.string(''A'', 12); -- simple temp pwd',
'    APEX_UTIL.CREATE_USER(',
'      p_user_name                    => p_user_name,',
'      p_first_name                   => p_first_name,',
'      p_last_name                    => p_last_name,',
'      p_email_address                => p_email,',
'      p_web_password                 => l_temp_pwd,',
'      p_web_password_format          => ''CLEAR_TEXT'',',
'      p_change_password_on_first_use => ''Y'',',
'      p_allow_app_building_yn        => p_allow_app_building_yn',
'    );',
'    -- we intentionally do NOT email the temp password',
'  END do_create_apex_user;',
'',
'  -----------------------------------------------------------------------',
'  -- assign application-level roles (APEX_ACL)',
'  -- p_roles: comma-separated role static IDs (e.g. ''ADMIN,USER'')',
'  -----------------------------------------'))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'------------------------------',
'  PROCEDURE assign_app_roles(',
'    p_app_id IN NUMBER,',
'    p_user_name IN VARCHAR2,',
'    p_roles IN VARCHAR2',
'  ) IS',
'    l_app_id NUMBER := NVL(p_app_id, apex_application.g_flow_id);',
'    l_role_list DBMS_UTILITY.LNAME_ARRAY;',
'    l_cnt INTEGER := 0;',
'    l_role VARCHAR2(4000);',
'    l_pos PLS_INTEGER := 1;',
'    l_token VARCHAR2(4000);',
'  BEGIN',
'    IF p_roles IS NULL THEN',
'      RETURN;',
'    END IF;',
'',
'    -- split comma separated roles (simple loop)',
'    WHILE l_pos <= LENGTH(p_roles) LOOP',
'      l_token := TRIM(REGEXP_SUBSTR(p_roles, ''[^,]+'', 1, l_pos));',
'      EXIT WHEN l_token IS NULL;',
'      BEGIN',
'        APEX_ACL.ADD_USER_ROLE(',
'          p_application_id => l_app_id,',
'          p_user_name      => p_user_name,',
'          p_role_static_id => l_token',
'        );',
'      EXCEPTION WHEN OTHERS THEN',
'        NULL; -- record-level logging could be added',
'      END;',
'      l_pos := l_pos + 1;',
'    END LOOP;',
'  END assign_app_roles;',
'',
'  -----------------------------------------------------------------------',
'  -- send welcome email (no password)',
'  -----------------------------------------------------------------------',
'  PROCEDURE do_send_welcome_email(',
'    p_to       IN VARCHAR2,',
'    p_username IN VARCHAR2,',
'    p_first    IN VARCHAR2,',
'    p_last     IN VARCHAR2',
'  ) IS',
'    l_subject VARCHAR2(4000);',
'    l_body    CLOB;',
'    l_login_url VARCHAR2(2000) := ''https://gce17f00a19c10b-prod.adb.uk-london-1.oraclecloudapps.com/ords/r/dev/ur/login?session=101555937796515'';',
'  BEGIN',
'    l_subject := ''Welcome to Our Application'';',
'    l_body := ''Hello '' || NVL(p_first || '' '' || p_last, p_username) || CHR(10) || CHR(10) ||',
'              ''Your account has been created.'' || CHR(10) ||',
'              ''Username: '' || p_username || CHR(10) || CHR(10) ||',
'              ''To set your password, please use the application login page and click "Forgot Password" or use the reset flow.'' || CHR(10) ||',
'              ''Login here: '' || l_login_url || CHR(10) || CHR(10) ||',
'              ''If you did not expect this email, contact support.'';',
'    APEX_MAIL.SEND(',
'      p_to   => p_to,',
'      p_from => ''no-reply@yourdomain.com'',',
'      p_subj => l_subject,',
'      p_body => l_body',
'    );',
'    -- try immediate push (harmless if queue job also handles)',
'    BEGIN',
'      APEX_MAIL.PUSH_QUEUE;',
'    EXCEPTION WHEN OTHERS THEN NULL;',
'    END;',
'  EXCEPTION WHEN OTHERS THEN NULL;',
'  END do_send_welcome_email;',
'',
'  -----------------------------------------------------------------------',
'  -- Public: create user full',
'  -----------------------------------------------------------------------',
'  FUNCTION create_user_full(',
'    p_first_name      IN VARCHAR2,',
'    p_last_name       IN VARCHAR2,',
'    p_email           IN VARCHAR2,',
'    p_contact_number  IN NUMBER DEFAULT NULL,',
'    p_user_type       IN VARCHAR2 DEFAULT ''ENDUSER'',',
'    p_status          IN VARCHAR2 DEFAULT ''ACTIVE'',',
'    p_start_date      IN DATE DEFAULT NULL,',
'    p_end_date        IN DATE DEFAULT NULL,',
'    p_login_method    IN VARCHAR2 DEFAULT ''APEX'',',
'    p_app_id          IN NUMBER DEFAULT NULL,',
'    p_preferred_roles IN VARCHAR2 DEFAULT NULL',
'  ) RETURN t_result IS',
'    l_result t_result;',
'    l_username VARCHAR2(255);',
'    l_base VARCHAR2(255);',
'    l_user_id RAW(16);',
'  BEGIN',
'    l_result.status := ''ERROR'';',
'    l_result.message := NULL;',
'    l_result.username := NULL;',
'',
'    -- generate username & uniqueness',
'    l_base := gen_base_username(p_first_name, p_last_name);',
'    l_username := ensure_unique_username(l_base);',
'',
'    -- insert into UR_USERS table (replaces your automatic DML)',
'    INSERT INTO UR_USERS (',
'      USER_ID, FIRST_NAME, LAST_NAME, EMAIL, CONTACT_NUMBER, USER_TYPE, STATUS,',
'      START_DATE, END_DATE, LOGIN_METHOD, USER_NAME',
'    )',
'    VALUES (',
'      SYS_GUID(), p_first_name, p_last_name, p_email, p_contact_number, p_user_type, p_status,',
'      p_start_date, p_end_date, p_login_method, l_username',
'    )',
'    RETURNING USER_ID INTO l_user_id;',
'',
'    COMMIT;',
'',
'    -- Try to create APEX account; if we lack privileges, enqueue for admin',
'    BEGIN',
'      do_create_apex_user(l_username, p_first_name, p_last_name, p_email);',
'      -- assign app roles if any',
'      IF p_preferred_roles IS NOT NULL THEN',
'        assign_app_roles(p_app_id, l_username, p_preferred_roles);',
'      END IF;',
'      -- send welcome email',
'      do_send_welcome_email(p_email, l_username, p_first_name, p_last_name);',
'      l_result.status := ''OK'';',
'      l_result.message := ''User row created and APEX account created; email queued.'';',
'      l_result.username := l_username;',
'      RETURN l_result;',
'    EXCEPTION',
'      WHEN OTHERS THEN',
'        -- most common reason: not a workspace admin. Enqueue for admin processing.',
'        enqueue_user_for_admin(',
'          p_first_name => p_first_name,',
'          p_last_name  => p_last_name,',
'          p_email      => p_email,',
'          p_contact_number => p_contact_number,',
'          p_user_type => p_user_type,',
'          p_start_date => p_start_date,',
'          p_end_date => p_end_date,',
'          p_login_method => p_login_method,',
'          p_base_username => l_base,',
'          p_suggested_username => l_username,',
'          p_preferred_roles => p_preferred_roles',
'        );',
'        l_result.status := ''PENDING'';',
'        l_result.message := ''User row created in UR_USERS; APEX user creation queued for admin. Reason: '' || SQLERRM;',
'        l_result.username := l_username;',
'        RETURN l_result;',
'    END;',
'  EXCEPTION',
'    WHEN OTHERS THEN',
'      ROLLBACK;',
'      l_result.status := ''ERROR'';',
'      l_result.message := ''Creation failed: '' || SQLERRM;',
'      RETURN l_result;',
'  END create_user_full;',
'',
'  -----------------------------------------------------------------------',
'  -- Enqueue for admin',
'  -----------------------------------------------------------------------',
'  PROCEDURE enqueue_user_for_admin(',
'    p_first_name IN VARCHAR2,',
'    p_last_name  IN VARCHAR2,',
'    p_email      IN VARCHAR2,',
'    p_contact_number IN NUMBER DEFAULT NULL,',
'    p_user_type IN VARCHAR2 DEFAULT ''ENDUSER'',',
'    p_start_date IN DATE DEFAULT NULL,',
'    p_end_date   IN DATE DEFAULT NULL,',
'    p_login_method IN VARCHAR2 DEFAULT ''APEX'',',
'    p_base_username IN VARCHAR2 DEFAULT NULL,',
'    p_suggested_username IN VARCHAR2 DEFAULT NULL,',
'    p_preferred_roles IN VARCHAR2 DEFAULT NULL',
'  ) IS',
'  BEGIN',
'    INSERT INTO UR_USERS_PENDING (',
'      FIRST_NAME, LAST_NAME, EMAIL, CONTACT_NUMBER, USER_TYPE,',
'      START_DATE, END_DATE, LOGIN_METHOD, BASE_USERNAME, SUGGESTED_USERNAME,',
'      PREFERRED_ROLES, CREATED_ON, PROCESSED_FLAG',
'    ) VALUES (',
'      p_first_name, p_last_name, p_email, p_contact_number, p_user_type,',
'      p_start_date, p_end_date, p_login_method, p_base_username, p_suggested_username,',
'      p_preferred_roles, SYSDATE, ''N''',
'    );',
'    COMMIT;',
'  EXCEPTION',
'    WHEN OTHERS THEN',
'      NULL; -- consider logging',
'  END enqueue_user_for_admin;',
'',
'  -----------------------------------------------------------------------',
'  -- Admin: process pending rows. Run as admin or scheduled job owned by privileged schema',
'  -----------------------------------------------------------------------',
'  PROCEDURE process_pending_users(p_processor IN VARCHAR2 DEFAULT NULL) IS',
'    CURSOR c_pending IS',
'      SELECT PEND_ID, FIRST_NAME, LAST_NAME, EMAIL, SUGGESTED_USERNAME, PREFERRED_ROLES',
'      FROM UR_USERS_PENDING',
'      WHERE PROCESSED_FLAG = ''N''',
'      FOR UPDATE SKIP LOCKED;',
'    l_rec c_pending%ROWTYPE;',
'    l_apex_err VARCHAR2(4000);',
'  BEGIN',
'    FOR l_rec IN c_pending LOOP',
'      BEGIN',
'        -- create apex user (must run as workspace admin)',
'        do_create_apex_user(l_rec.SUGGESTED_USERNAME, l_rec.FIRST_NAME, l_rec.LAST_NAME, l_rec.EMAIL);',
'        -- assign roles if any (use current app context or modify to pass app_id)',
'        IF l_rec.PREFERRED_ROLES IS NOT NULL THEN',
'          assign_app_roles(NULL, l_rec.SUGGESTED_USERNAME, l_rec.PREFERRED_ROLES);',
'        END IF;',
'        -- send email',
'        do_send_welcome_email(l_rec.EMAIL, l_rec.SUGGESTED_USERNAME, l_rec.FIRST_NAME, l_rec.LAST_NAME);',
'',
'        -- mark processed',
'        UPDATE UR_USERS_PENDING',
'        SET PROCESSED_FLAG = ''Y'',',
'            PROCESSOR = p_processor,',
'            PROCESSED_ON = SYSDATE,',
'            NOTES = ''Processed OK''',
'        WHERE PEND_ID = l_rec.PEND_ID;',
'        COMMIT;',
'      EXCEPTION',
'        WHEN OTHERS THEN',
'          l_apex_err := SQLERRM;',
'          UPDATE UR_USERS_PENDING',
'          SET PROCESSED_FLAG = ''E'',',
'              PROCESSOR = p_processor,',
'              PROCESSED_ON = SYSDATE,',
'              NOTES = ''Error: '' || l_apex_err',
'          WHERE PEND_ID = l_rec.PEND_ID;',
'          COMMIT;',
'      END;',
'    END LOOP;',
'  END process_pending_users;',
'',
'END ur_users_pkg;',
'/',
'create or replace PACKAGE BODY ur_user_mgmt IS',
'',
'PROCEDURE create_user (',
'    p_first      IN VARCHAR2,',
'    p_last       IN VARCHAR2,',
'    p_email      IN VARCHAR2,',
'    p_contact    IN NUMBER,',
'    p_user_type  IN VARCHAR2,',
'    p_status     IN VARCHAR2,',
'    p_start_date IN DATE DEFAULT SYSDATE,',
'    p_end_date   IN DATE DEFAULT NULL,',
'    p_login_method IN VARCHAR2 DEFAULT ''APEX''',
') IS',
'    v_username   VARCHAR2(255);',
'    v_guid       RAW(16) := SYS_GUID();',
'    v_app_id     NUMBER := NVL(TO_NUMBER(SYS_CONTEXT(''APEX$SESSION'',''APP_ID'')), 101); -- fallback app id',
'    v_body       CLOB;',
'BEGIN',
'    -- 1. Build username (first letter of first name + full last name, lowercase)',
'    v_username := LOWER(SUBSTR(p_first,1,1) || p_last);',
'',
'    -- 2. Insert into UR_USERS',
'    INSERT INTO ur_users (',
'        user_id, first_name, last_name, email,',
'        contact_number, user_type, status,',
'        start_date, end_date, login_method, user_name',
'    )',
'    VALUES (',
'        v_guid, p_first, p_last, p_email,',
'        p_contact, p_user_type, p_status,',
'        p_start_date, p_end_date, p_login_method, v_username',
'    );',
'',
'    -- 3. Create APEX user (no password, force reset on first login)',
'    APEX_UTIL.CREATE_USER (',
'        p_user_name      => v_username,',
'        p_email_address  => p_email,',
'        p_developer_privs => ''ADMIN:DATA_LOADER:EDIT:HELP:MONITOR:SQL'',',
'        p_change_password_on_first_use => ''Y'',',
'        p_web_password   => NULL',
'    );',
'',
'    -- 4. Prepare email body',
'    v_body := ''Dear '' || p_first || '' '' || p_last || '','' || CHR(10) ||',
'              ''Your user account has been created.'' || CHR(10) ||',
'              ''Username: '' || v_username || CHR(10) ||',
'              ''Login: https://gce17f00a19c10b-prod.adb.uk-london-1.oraclecloudapps.com/ords/r/dev/ur/login'' || CHR(10) ||',
'              ''Please reset your password on first login.'';',
'',
'    -- 5. Send email',
'    APEX_MAIL.SEND(',
'        p_to      => p_email,',
'        p_from    => ''no-reply@yourdomain.com'',',
'        p_subj    => ''Your User Account Has Been Created'',',
'        p_body    => v_body',
'    );',
'',
'    COMMIT;',
'END create_user;',
'',
'END ur_user_mgmt;',
'/',
'create or replace PACKAGE BODY ur_utils IS',
'',
'    PROCEDURE POPULATE_ERROR_COLLECTION_FROM_LOG (',
'        p_interface_log_id IN  UR_INTERFACE_LOGS.ID%TYPE,',
'        p_collection_name  IN  VARCHAR2,',
'        p_status           OUT VARCHAR2,',
'        p_message          OUT VARCHAR2',
'    )',
'    IS',
'        l_error_json CLOB;',
'        l_json_array_count NUMBER;',
'    BEGIN',
'        -- Initialize OUT parameters to a default error state.',
'        p_status  := ''E'';',
'        p_message := ''An unexpected error occurred during processing.'';',
'',
'        -- Step 1: Validate inputs',
'        IF p_interface_log_id IS NULL THEN',
'            p_status  := ''E'';',
'            p_message := ''Error: The Interface Log ID cannot be null.'';',
'            RETURN;',
'        END IF;',
'',
'        IF p_collection_name IS NULL OR TRIM(p_collection_name) IS NULL THEN',
'            p_status  := ''E'';',
'            p_message := ''Error: The Collection Name cannot be null or empty.'';',
'            RETURN;',
'        END IF;',
'',
'        -- Step 2: Fetch the ERROR_JSON from the logs table',
'        BEGIN',
'            SELECT error_json',
'            INTO   l_error_json',
'            FROM   ur_interface_logs',
'            WHERE  id = p_interface_log_id;',
'        EXCEPTION',
'            WHEN NO_DATA_FOUND THEN',
'                p_status  := ''E'';',
'                p_message := ''Error: No record found for Interface Log ID: '' || RAWTOHEX(p_interface_log_id) || ''.'';',
'                RETURN;',
'        END;',
'',
'        -- Step 3: Check if the fetched JSON is null or empty',
'        IF l_error_json IS NULL OR DBMS_LOB.GETLENGTH(l_error_json) = 0 THEN',
'            p_status  := ''W'';',
'            p_message := ''Warning: The error log for the specified ID is empty. No data to populate.'';',
'            -- It''s a good practice to still ensure the collection is empty in this case.',
'            APEX_COLLECTION.CREATE_OR_TRUNCATE_COLLECTION(p_collection_name => p_collection_name);',
'            RETURN;',
'        END IF;',
'',
'        -- Step 4: Parse the JSON and check for validity',
'        BEGIN',
'            APEX_JSON.PARSE(l_error_json);',
'        EXCEPTION',
'            WHEN OTHERS THEN',
'                -- APEX_JSON raises an unhandled exception (ORA-20987) for parse errors.',
'                p_status  := ''E'';',
'                p_message := ''Error: Failed to parse the ERROR_JSON content. The JSON string may be malformed.'';',
'                RETURN;',
'        END;',
'',
'        -- Step 5: Initialize the APEX Collection',
'        -- This creates the collection if it doesn''t exist or clears it if it does.',
'        APEX_COLLECTION.CREATE_OR_TRUNCATE_COLLECTION(',
'            p_collection_name => p_collection_name',
'        );',
'',
'        -- Step 6: Loop through the JSON array and populate the collection',
'        l_json_array_count := APEX_JSON.GET_COUNT(p_path => ''.'');',
'',
'        IF l_json_array_count > 0 THEN',
'            FOR i IN 1..l_json_array_count LOOP',
'                -- Add members to the collection.',
'                -- c001 for row number, c002 for the error message.',
'                APEX_COLLECTION.ADD_MEMBER(',
'                    p_collection_name => p_collection_name,',
'                    p_c001            => APEX_JSON.GET_VARCHAR2(p_path => ''[%d].row'', p0 => i),',
'                    p_c002            => APEX_JSON.GET_VARCHAR2(p_path => ''[%d].error'', p0 => i)',
'                );',
'            END LOOP;',
'            ',
'            p_status  := ''S'';',
'            p_message := ''Success: Collection '''''' || p_collection_name || '''''' has been populated with '' || l_json_array_count || '' error(s).'';',
'',
'        ELSE',
'            -- This handles cases where the JSON is valid but is an empty array, e.g., ''[]''.',
'            p_status  := ''W'';',
'            p_message := ''Warning: The error log contains an empty array. The collection is empty.'';',
'        END IF;',
'',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            -- A final catch-all for any other unexpected Oracle errors.',
'            p_status  := ''E'';',
'            p_message := ''An unexpected system error occurred: '' || SQLERRM;',
'    END POPULATE_ERROR_COLLECTION_FROM_LOG;',
'',
'',
'    PROCEDURE VALIDATE_TEMPLATE_DEFINITION(',
'        p_json_clob  IN            CLOB,',
'        p_alert_clob IN OUT NOCOPY CLOB,',
'        p_status     OUT           VARCHAR2',
'    ) IS',
'        l_error_found BOOLEAN := FALSE;',
'    BEGIN',
'        -- Loop through each JSON object in the array where a ''qualifier'' exists.',
'        FOR r IN (',
'            SELECT',
'                nm,',
'                dt,',
'                qlf',
'            FROM',
'                JSON_TABLE(p_json_clob, ''$[*]''',
'                    COLUMNS (',
'                        nm  VARCHAR2(255) PATH ''$.name'',',
'                        dt  VARCHAR2(50)  PATH ''$.data_type'',',
'                        qlf VARCHAR2(255) PATH ''$.qualifier''',
'                    )',
'                )',
'            WHERE',
'                qlf IS NOT NULL',
'        ) LOOP',
'            -- RULE 1: Qualifiers with ''DATE'' in the name must have a ''DATE'' data_type.',
'            IF INSTR(UPPER(r.qlf), ''DATE'') > 0 THEN',
'                IF r.dt <> ''DATE'' THEN',
'                    l_error_found := TRUE;',
'                    ur_utils.add_alert(',
'                        p_alert_clob,',
'                        ''Field "'' || r.nm || ''": Qualifier "'' || r.qlf || ''" must be DATE.'',',
'                        ''error'',',
'                        NULL,',
'                        NULL,',
'                        p_alert_clob',
'                    );',
'                END IF;',
'            -- RULE 2: All other qualifiers must have a ''NUMBER'' data_type.',
'            ELSE',
'                IF r.dt <> ''NUMBER'' THEN',
'                    l_error_found := TRUE;',
'                    ur_utils.add_alert(',
'                        p_alert_clob,',
'                        ''Field "'' || r.nm || ''": Qualifier "'' || r.qlf || ''" must be NUMBER.'',',
'                        ''error'',',
'                        NULL,',
'                        NULL,',
'                        p_alert_clob',
'                    );',
'                END IF;',
'            END IF;',
'        END LOOP;',
'',
'        -- Set the final status (''S''uccess or ''E''rror) and add a success message if needed.',
'        IF l_error_found THEN',
'            p_status := ''E'';',
'        ELSE',
'            p_status := ''S'';',
'            ur_utils.add_alert(p_alert_clob, ''Template definition validated successfully.'', ''success'', NULL, NULL, p_alert_clob);',
'        END IF;',
'',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            p_status := ''E'';',
'            ur_utils.add_alert(p_alert_clob, ''Unexpected validation error: '' || SQLERRM, ''error'', NULL, NULL, p_alert_clob);',
'    END VALIDATE_TEMPLATE_DEFINITION;',
'',
'    --------------------------------------------------------------------------------',
'',
'    FUNCTION GET_ATTRIBUTE_VALUE(',
'        p_attribute_id   IN RAW      DEFAULT NULL,',
'        p_attribute_key  IN VARCHAR2 DEFAULT NULL,',
'        p_hotel_id       IN RAW      DEFAULT NULL,',
'        p_stay_date      IN DATE     DEFAULT NULL,',
'        p_round_digits   IN NUMBER   DEFAULT 2',
'    ) RETURN UR_attribute_value_table PIPELINED AS',
'        l_response_clob CLOB;',
'        l_status        VARCHAR2(1);',
'    BEGIN',
'        -- This internal call remains the same. The JSON it produces should have',
'        -- the attribute_value as a number, date string, or text string.',
'        GET_ATTRIBUTE_VALUE(',
'            p_attribute_id  => p_attribute_id,',
'            p_attribute_key => p_attribute_key,',
'            p_hotel_id      => p_hotel_id,',
'            p_stay_date     => p_stay_date,',
'            p_round_digits  => p_round_digits,',
'            p_debug_flag    => FALSE,',
'            p_response_clob => l_response_clob',
'        );',
'',
'        l_status := JSON_VALUE(l_response_clob, ''$.STATUS'');',
'',
'        IF l_status = ''S'' THEN',
'            FOR rec IN (',
'                SELECT',
'                    TO_DATE(jt.stay_date, ''DD-MON-YYYY'') AS stay_date,',
'                    jt.attribute_value',
'                FROM',
'                    JSON_TABLE(',
'                        l_response_clob,',
'                        ''$.RESPONSE_PAYLOAD[*]''',
'                        COLUMNS (',
'                            stay_date       VARCHAR2(20)   PATH ''$.stay_date'',',
'                            -- MODIFIED: Read the value as VARCHAR2 to handle all types.',
'                            attribute_value VARCHAR2(4000) PATH ''$.attribute_value''',
'                        )',
'                    ) jt',
'            ) LOOP',
'                -- This now works for any data type since attribute_value is a string.',
'                PIPE ROW(UR_attribute_value_row(rec.stay_date, rec.attribute_value));',
'            END LOOP;',
'        END IF;',
'',
'        RETURN;',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            -- Gracefully exit on error',
'            RETURN;',
'    END GET_ATTRIBUTE_VALUE;',
'',
'    --------------------------------------------------------------------------------',
'',
'    -- =================================================================',
'    --  MAIN PROCEDURE IMPLEMENTATION (Returns JSON CLOB)',
'    -- =================================================================',
'    PROCEDURE build_json_response(',
'        p_status                 IN VARCHAR2,',
'        p_message                IN CLOB,',
'        p_attribute_id           IN RAW,',
'        p_attribute_name         IN VARCHAR2,',
'        p_attribute_key          IN VARCHAR2,',
'        p_attribute_datatype     IN VARCHAR2,',
'        p_attribute_qualifier    IN VARCHAR2,',
'        p_attribute_static_val   IN VARCHAR2,',
'        p_hotel_id               IN RAW,',
'        p_stay_date              IN DATE,',
'        p_debug_flag             IN BOOLEAN,',
'        p_record_count           IN NUMBER,',
'        p_payload_array          IN JSON_ARRAY_T,',
'        p_response_clob          OUT CLOB',
'    ) IS',
'        l_json_obj JSON_OBJECT_T;',
'    BEGIN',
'        l_json_obj := JSON_OBJECT_T();',
'        l_json_obj.put(''attribute_id'', RAWTOHEX(p_attribute_id));',
'        l_json_obj.put(''attribute_name'', p_attribute_name);',
'        l_json_obj.put(''attribute_key'', p_attribute_key);',
'        l_json_obj.put(''attribute_datatype'', p_attribute_datatype);',
'        l_json_obj.put(''attribute_qualifier'', p_attribute_qualifier);',
'        l_json_obj.put(''attribute_static_value'', p_attribute_static_val);',
'        l_json_obj.put(''hotel_id'', RAWTOHEX(p_hotel_id));',
'        l_json_obj.put(''stay_date'', TO_CHAR(p_stay_date, ''YYYY-MM-DD''));',
'        l_json_obj.put(''DEBUG_FLAG'', CASE WHEN p_debug_flag THEN ''TRUE'' ELSE ''FALSE'' END);',
'        l_json_obj.put(''RESPONSE_TIME'', TO_CHAR(SYSTIMESTAMP, ''YYYY-MM-DD"T"HH24:MI:SS.FF"Z"''));',
'        l_json_obj.put(''STATUS'', p_status);',
'        l_json_obj.put(''RECORD_COUNT'', p_record_count);',
'        l_json_obj.put(''MESSAGE'', p_message);',
'        l_json_obj.put(''RESPONSE_PAYLOAD'', p_payload_array);',
'',
'        p_response_clob := l_json_obj.to_clob;',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            p_response_clob := ''{"STATUS":"E", "MESSAGE":"Failed to generate final JSON response: '' || SQLERRM || ''"}'';',
'    END build_json_response;',
'',
'    --------------------------------------------------------------------------------',
'',
'    PROCEDURE GET_ATTRIBUTE_VALUE(',
'        p_attribute_id  IN  RAW      DEFAULT NULL,',
'        p_attribute_key IN  VARCHAR2 DEFAULT NULL,',
'        p_hotel_id      IN  RAW      DEFAULT NULL,',
'        p_stay_date     IN  DATE     DEFAULT NULL,',
'        p_round_digits  IN  NUMBER   DEFAULT 2,',
'        p_debug_flag    IN  BOOLEAN  DEFAULT FALSE,',
'        p_response_clob OUT CLOB',
'    ) IS',
'        l_attribute_rec     UR_ALGO_ATTRIBUTES%ROWTYPE;',
'        l_template_rec      UR_TEMPLATES%ROWTYPE;',
'        l_sql_stmt          VARCHAR2(8000);',
'        l_cursor            SYS_REFCURSOR;',
'        l_stay_date_val     DATE;',
'        l_attribute_val_out VARCHAR2(4000);',
'        l_records_fetched   NUMBER := 0;',
'        l_json_payload_arr  JSON_ARRAY_T := JSON_ARRAY_T();',
'        l_json_row_obj      JSON_OBJECT_T;',
'        l_status            VARCHAR2(1) := ''S'';',
'        l_message           CLOB;',
'        l_debug_log         CLOB;',
'',
'        PROCEDURE append_debug(p_log_entry IN VARCHAR2) IS',
'        BEGIN',
'            IF p_debug_flag THEN',
'                l_debug_log := l_debug_log || TO_CHAR(SYSTIMESTAMP, ''HH24:MI:SS.FF'') || '' - '' || p_log_entry || CHR(10);',
'            END IF;',
'        END append_debug;',
'',
'    BEGIN',
'        append_debug(''Procedure started.'');',
'',
'        IF (p_attribute_id IS NULL AND p_attribute_key IS NULL) OR (p_attribute_id IS NOT NULL AND p_attribute_key IS NOT NULL) THEN',
'            l_message := ''Validation Error: Provide either p_attribute_id or p_attribute_key, but not both.'';',
'            build_json_response(''E'', l_message, NULL, NULL, p_attribute_key, NULL, NULL, NULL, p_hotel_id, p_stay_date, p_debug_flag, 0, JSON_ARRAY_T(''[]''), p_response_clob);',
'            RETURN;',
'        END IF;',
'',
'        BEGIN',
'            IF p_attribute_id IS NOT NULL THEN',
'                SELECT * INTO l_attribute_rec FROM UR_ALGO_ATTRIBUTES WHERE ID = p_attribute_id;',
'            ELSE',
'                SELECT * INTO l_attribute_rec FROM UR_ALGO_ATTRIBUTES WHERE KEY = p_attribute_key;',
'            END IF;',
'            append_debug(''Found attribute with ID: '' || RAWTOHEX(l_attribute_rec.ID) || '', TYPE: '' || l_attribute_rec.TYPE || '', VALUE: '' || l_attribute_rec.VALUE);',
'        EXCEPTION',
'            WHEN NO_DATA_FOUND THEN',
'                l_message := ''Attribute not found for the specified ID or KEY.'';',
'                build_json_response(''E'', l_message, p_attribute_id, NULL, p_attribute_key, NULL, NULL, NULL, p_hotel_id, p_stay_date, p_debug_flag, 0, JSON_ARRAY_T(''[]''), p_response_clob);',
'                RETURN;',
'        END;',
'',
'        IF l_attribute_rec.TYPE = ''M'' THEN',
'            append_debug(''Attribute type is Manual. Using static value.'');',
'            l_json_row_obj := JSON_OBJECT_T();',
'            l_json_row_obj.put(''stay_date'', TO_CHAR(p_stay_date, ''DD-MON-YYYY''));',
'            CASE UPPER(l_attribute_rec.DATA_TYPE)',
'                WHEN ''NUMBER'' THEN',
'                    l_json_row_obj.put(''attribute_value'', ROUND(TO_NUMBER(l_attribute_rec.VALUE), p_round_digits));',
'                ELSE',
'                    l_json_row_obj.put(''attribute_value'', l_attribute_rec.VALUE);',
'            END CASE;',
'            l_json_payload_arr.append(l_json_row_obj);',
'            l_records_fetched := 1;',
'            l_message         := ''Manual value returned.'';',
'',
'ELSIF l_attribute_rec.TYPE = ''S'' THEN',
'    append_debug(''Attribute type is Sourced. Parsing value formula.'');',
'    DECLARE',
'        TYPE t_table_map IS TABLE OF VARCHAR2(10) INDEX BY VARCHAR2(150);',
'        l_tables             t_table_map;',
'        l_formula            VARCHAR2(4000) := l_attribute_rec.VALUE;',
'        l_expression         VARCHAR2(4000) := l_formula;',
'        l_from_clause        VARCHAR2(4000);',
'        l_where_clause       VARCHAR2(1000) := '' WHERE 1=1'';',
'        l_stay_date_column   VARCHAR2(150); -- This variable is the target of our change',
'        l_base_table_alias   VARCHAR2(10)   := ''t1'';',
'        l_table_counter      NUMBER         := 1;',
'        l_pos                NUMBER         := 1;',
'        l_source_ref         VARCHAR2(200);',
'    BEGIN',
'        -- ### MODIFIED LOGIC: Determine the STAY_DATE column name ###',
'        IF l_attribute_rec.TEMPLATE_ID IS NOT NULL THEN',
'            -- **[1] Original Logic: Use Template ID if it exists**',
'            append_debug(''Template ID found. Looking up STAY_DATE column from template definition.'');',
'            IF l_attribute_rec.ATTRIBUTE_QUALIFIER IN (''OWN_PROPERTY'', ''COMP_PROPERTY'') THEN',
'                l_stay_date_column := ''STAY_DATE'';',
'            ELSE',
'                BEGIN',
'                    SELECT * INTO l_template_rec FROM UR_TEMPLATES WHERE ID = l_attribute_rec.TEMPLATE_ID;',
'                    SELECT jt.name',
'                    INTO   l_stay_date_column',
'                    FROM   JSON_TABLE(l_template_rec.DEFINITION, ''$[*]'' COLUMNS (name VARCHAR2(100) PATH ''$.name'', qualifier VARCHAR2(100) PATH ''$.qualifier'')) jt',
'                    WHERE  jt.qualifier = ''STAY_DATE'';',
'                EXCEPTION',
'                    WHEN NO_DATA_FOUND THEN',
'                        RAISE_APPLICATION_ERROR(-20004, ''Critical error: The associated template definition requires a column with the ''''STAY_DATE'''' qualifier.'');',
'                END;',
'            END IF;',
'        ELSE',
'            -- **[2] New Logic: Introspect the formula if no Template ID**',
'            append_debug(''Template ID is NULL. Starting non-templated attribute logic.'');',
'',
'            IF p_hotel_id IS NULL THEN',
'                append_debug(''Validation failed: p_hotel_id is NULL for a non-templated Sourced attribute.'');',
'                l_message := ''Validation Error: A Hotel ID must be provided to retrieve values for this attribute configuration.'';',
'                build_json_response(''E'', l_message, l_attribute_rec.ID, l_attribute_rec.NAME, l_attribute_rec.KEY, l_attribute_rec.DATA_TYPE, l_attribute_rec.ATTRIBUTE_QUALIFIER, l_attribute_rec.VALUE, p_hotel_id, p_stay_date, p_debug_flag, 0, JSON_A'
||'RRAY_T(''[]''), p_response_clob);',
'                RETURN;',
'            END IF;',
'',
'            append_debug(''Template ID is NULL. Introspecting formula to find base table and verify STAY_DATE column.'');',
'            ',
'            DECLARE',
'                l_base_table_name VARCHAR2(128);',
'                l_column_exists   NUMBER;',
'            BEGIN',
'                -- Extract the first table name from the formula (e.g., from #TABLE.COLUMN#)',
'                l_base_table_name := REGEXP_SUBSTR(l_formula, ''#([^#.]+)\.'', 1, 1, NULL, 1);',
'',
'                IF l_base_table_name IS NULL THEN',
'                    RAISE_APPLICATION_ERROR(-20006, ''Invalid formula format. Cannot determine base table from value: '' || l_formula);',
'                END IF;',
'                ',
'                append_debug(''Inferred base table is: '' || l_base_table_name);',
'',
'                -- Check if a ''STAY_DATE'' column exists in that table',
'                SELECT COUNT(*)',
'                INTO   l_column_exists',
'                FROM   ALL_TAB_COLUMNS',
'                WHERE  TABLE_NAME = UPPER(l_base_table_name)',
'                  AND  COLUMN_NAME = ''STAY_DATE'';',
'',
'                IF l_column_exists > 0 THEN',
'                    l_stay_date_column := ''STAY_DATE'';',
'                ELSE',
'                    RAISE_APPLICATION_ERROR(-20007, ''Configuration error: The base table '''''' || l_base_table_name || '''''' for this attribute does not have a required ''''STAY_DATE'''' column.'');',
'                END IF;',
'            END;',
'        END IF;',
'',
'        append_debug(''Determined Stay Date column is: '' || l_stay_date_column);',
'',
'        -- 1. Parse all source references and build FROM clause (This logic remains the same)',
'        LOOP',
'            l_source_ref := REGEXP_SUBSTR(l_formula, ''#([^#]+)#'', l_pos, 1, NULL, 1);',
'            EXIT WHEN l_source_ref IS NULL;',
'',
'                    DECLARE',
'                        l_table_name VARCHAR2(150) := REGEXP_SUBSTR(l_source_ref, ''^[^.]+'');',
'                        l_col_name   VARCHAR2(150) := REGEXP_SUBSTR(l_source_ref, ''[^.]+$'');',
'                        l_alias      VARCHAR2(10);',
'                    BEGIN',
'                        IF NOT l_tables.EXISTS(l_table_name) THEN',
'                            l_alias              := ''t'' || l_table_counter;',
'                            l_tables(l_table_name) := l_alias;',
'',
'                            IF l_table_counter = 1 THEN',
'                                l_from_clause := DBMS_ASSERT.ENQUOTE_NAME(l_table_name) || '' '' || l_alias;',
'                            ELSE',
'                                l_fro'))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'm_clause := l_from_clause || '' LEFT JOIN '' || DBMS_ASSERT.ENQUOTE_NAME(l_table_name) || '' '' || l_alias ||',
'                                                 '' ON '' || l_base_table_alias || ''.'' || DBMS_ASSERT.ENQUOTE_NAME(l_stay_date_column) || '' = '' || l_alias || ''.'' || DBMS_ASSERT.ENQUOTE_NAME(l_stay_date_column);',
'                            END IF;',
'                            l_table_counter := l_table_counter + 1;',
'                        ELSE',
'                            l_alias := l_tables(l_table_name);',
'                        END IF;',
'',
'                        l_expression := REPLACE(l_expression, ''#'' || l_source_ref || ''#'', l_alias || ''.'' || DBMS_ASSERT.ENQUOTE_NAME(l_col_name));',
'                    END;',
'                    l_pos := REGEXP_INSTR(l_formula, ''#'', l_pos, 2) + 1;',
'                END LOOP;',
'',
'                IF l_from_clause IS NULL THEN',
'                    RAISE_APPLICATION_ERROR(-20001, ''Invalid Sourced Attribute: Formula is missing a source reference like #TABLE.COLUMN#.'');',
'                END IF;',
'',
'                -- 2. Validate expression (now includes brackets)',
'                DECLARE',
'                    l_validation_check VARCHAR2(4000);',
'                BEGIN',
'                    l_validation_check := REGEXP_REPLACE(l_expression, ''[''''a-zA-Z0-9_."''''\(\)0-9\.\+\*\/ \t\r\n-]'', '''');',
'                    IF l_validation_check IS NOT NULL THEN',
'                        RAISE_APPLICATION_ERROR(-20003, ''Invalid Sourced Attribute: Formula contains illegal characters.'');',
'                    END IF;',
'                END;',
'',
'                -- 4. Build final SQL (Conditionally apply ROUND based on data type)',
'                IF p_stay_date IS NOT NULL THEN l_where_clause := l_where_clause || '' AND TRUNC('' || l_base_table_alias || ''.'' || DBMS_ASSERT.ENQUOTE_NAME(l_stay_date_column) || '') = TRUNC(:stay_date)''; END IF;',
'                IF p_hotel_id IS NOT NULL THEN l_where_clause := l_where_clause || '' AND '' || l_base_table_alias || ''.'' || DBMS_ASSERT.ENQUOTE_NAME(''HOTEL_ID'') || '' = :hotel_id''; END IF;',
'',
'                IF l_attribute_rec.DATA_TYPE = ''NUMBER'' THEN',
'                    append_debug(''Data type is NUMBER, applying ROUND().'');',
'                    l_sql_stmt := ''SELECT '' || l_base_table_alias || ''.'' || DBMS_ASSERT.ENQUOTE_NAME(l_stay_date_column) ||',
'                                  '', ROUND(('' || l_expression || ''), :round_digits)'' ||',
'                                  '' FROM '' || l_from_clause || l_where_clause;',
'                ELSE',
'                    append_debug(''Data type is '' || l_attribute_rec.DATA_TYPE || '', not applying ROUND().'');',
'                    l_sql_stmt := ''SELECT '' || l_base_table_alias || ''.'' || DBMS_ASSERT.ENQUOTE_NAME(l_stay_date_column) ||',
'                                  '', '' || l_expression ||',
'                                  '' FROM '' || l_from_clause || l_where_clause;',
'                END IF;',
'',
'                append_debug(''Dynamic SQL: '' || l_sql_stmt);',
'',
'                -- Open the cursor with the correct bind variables based on the data type',
'                IF l_attribute_rec.DATA_TYPE = ''NUMBER'' THEN',
'                    -- This block handles NUMBER types, which always need :round_digits',
'                    CASE',
'                        WHEN p_stay_date IS NOT NULL AND p_hotel_id IS NOT NULL THEN',
'                            OPEN l_cursor FOR l_sql_stmt USING p_round_digits, p_stay_date, p_hotel_id;',
'                        WHEN p_stay_date IS NOT NULL AND p_hotel_id IS NULL THEN',
'                            OPEN l_cursor FOR l_sql_stmt USING p_round_digits, p_stay_date;',
'                        WHEN p_stay_date IS NULL AND p_hotel_id IS NOT NULL THEN',
'                            OPEN l_cursor FOR l_sql_stmt USING p_round_digits, p_hotel_id;',
'                        ELSE',
'                            OPEN l_cursor FOR l_sql_stmt USING p_round_digits;',
'                    END CASE;',
'                ELSE',
'                    -- This block handles non-NUMBER types (DATE, VARCHAR2, etc.), which do NOT have :round_digits',
'                    CASE',
'                        WHEN p_stay_date IS NOT NULL AND p_hotel_id IS NOT NULL THEN',
'                            OPEN l_cursor FOR l_sql_stmt USING p_stay_date, p_hotel_id;',
'                        WHEN p_stay_date IS NOT NULL AND p_hotel_id IS NULL THEN',
'                            OPEN l_cursor FOR l_sql_stmt USING p_stay_date;',
'                        WHEN p_stay_date IS NULL AND p_hotel_id IS NOT NULL THEN',
'                            OPEN l_cursor FOR l_sql_stmt USING p_hotel_id;',
'                        ELSE',
'                            -- No bind variables are needed if all parameters are null for non-numeric types',
'                            OPEN l_cursor FOR l_sql_stmt;',
'                    END CASE;',
'                END IF;',
'',
'',
'',
'                LOOP',
'                    FETCH l_cursor INTO l_stay_date_val, l_attribute_val_out;',
'                    EXIT WHEN l_cursor%NOTFOUND;',
'                    ',
'                    l_records_fetched := l_records_fetched + 1;',
'                    l_json_row_obj := JSON_OBJECT_T();',
'                    l_json_row_obj.put(''stay_date'', TO_CHAR(l_stay_date_val, ''DD-MON-YYYY''));',
'',
'                    -- Conditionally handle the attribute value based on its data type',
'                    CASE UPPER(l_attribute_rec.DATA_TYPE)',
'                        WHEN ''NUMBER'' THEN',
'                            l_json_row_obj.put(''attribute_value'', TO_NUMBER(l_attribute_val_out));',
'                        ELSE -- For DATE, VARCHAR2, etc., treat as a string',
'                            l_json_row_obj.put(''attribute_value'', l_attribute_val_out);',
'                    END CASE;',
'                    ',
'                    l_json_payload_arr.append(l_json_row_obj);',
'                END LOOP;',
'                CLOSE l_cursor;',
'            END;',
'        ELSE',
'            RAISE_APPLICATION_ERROR(-20005, ''Attribute validation error: Unknown TYPE '''''' || l_attribute_rec.TYPE || ''''''. Must be ''''M'''' (Manual) or ''''S'''' (Sourced).'');',
'        END IF;',
'',
'        IF l_message IS NULL THEN',
'            l_message := l_records_fetched || '' records fetched successfully.'';',
'            IF l_records_fetched = 0 AND l_attribute_rec.TYPE != ''M'' THEN',
'                l_status  := ''W'';',
'                l_message := ''No records found for the given criteria.'';',
'            END IF;',
'        END IF;',
'',
'        IF p_debug_flag THEN',
'            l_message := l_message || CHR(10) || ''--- DEBUG LOG ---'' || CHR(10) || l_debug_log;',
'        END IF;',
'',
'        build_json_response(l_status, l_message, l_attribute_rec.ID, l_attribute_rec.NAME, l_attribute_rec.KEY, l_attribute_rec.DATA_TYPE, l_attribute_rec.ATTRIBUTE_QUALIFIER, l_attribute_rec.VALUE, p_hotel_id, p_stay_date, p_debug_flag, l_records_fe'
||'tched, l_json_payload_arr, p_response_clob);',
'',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            IF l_cursor%ISOPEN THEN',
'                CLOSE l_cursor;',
'            END IF;',
'            l_status  := ''E'';',
'            l_message := ''An unexpected error occurred: '' || SQLERRM;',
'            append_debug(l_message);',
'            IF p_debug_flag THEN',
'                l_message := l_message || CHR(10) || ''--- DEBUG LOG ---'' || CHR(10) || l_debug_log;',
'            END IF;',
'            build_json_response(',
'                ''E'',',
'                l_message,',
'                l_attribute_rec.ID,',
'                NVL(l_attribute_rec.NAME, ''UNKNOWN''),',
'                NVL(l_attribute_rec.KEY, p_attribute_key),',
'                NVL(l_attribute_rec.DATA_TYPE, ''UNKNOWN''),',
'                NVL(l_attribute_rec.ATTRIBUTE_QUALIFIER, ''UNKNOWN''),',
'                NVL(l_attribute_rec.VALUE, ''UNKNOWN''),',
'                p_hotel_id,',
'                p_stay_date,',
'                p_debug_flag,',
'                0,',
'                JSON_ARRAY_T(''[]''),',
'                p_response_clob',
'            );',
'    END GET_ATTRIBUTE_VALUE;',
'',
'    --------------------------------------------------------------------------------',
'',
'    FUNCTION Clean_TEXT(p_text IN VARCHAR2) RETURN VARCHAR2 IS',
'        v_clean VARCHAR2(4000);',
'    BEGIN',
'        v_clean := UPPER(',
'            SUBSTR(',
'                REGEXP_REPLACE(',
'                    REGEXP_REPLACE(',
'                        REGEXP_REPLACE(',
'                            TRIM(p_text),',
'                            ''^[^A-Za-z0-9]+|[^A-Za-z0-9]+$'',',
'                            ''''',
'                        ),',
'                        ''[^A-Za-z0-9]+'',',
'                        ''_''',
'                    ),',
'                    ''_+'',',
'                    ''_''',
'                ),',
'                1,',
'                110',
'            )',
'        );',
'        RETURN v_clean;',
'    END Clean_TEXT;',
'',
'    --------------------------------------------------------------------------------',
'',
'    FUNCTION normalize_json(p_json CLOB) RETURN CLOB IS',
'    BEGIN',
'        RETURN REPLACE(REPLACE(p_json, ''"data-type"'', ''"data_type"''), ''"DATA-TYPE"'', ''"data_type"'');',
'    END normalize_json;',
'',
'    --------------------------------------------------------------------------------',
'',
'    PROCEDURE get_collection_json(',
'        p_collection_name IN  VARCHAR2,',
'        p_json_clob       OUT CLOB,',
'        p_status          OUT VARCHAR2,',
'        p_message         OUT VARCHAR2',
'    ) IS',
'        l_count NUMBER;',
'    BEGIN',
'        SELECT',
'            COUNT(*)',
'        INTO l_count',
'        FROM',
'            apex_collections',
'        WHERE',
'            collection_name = p_collection_name;',
'',
'        IF l_count = 0 THEN',
'            p_status    := ''E'';',
'            p_message   := ''Failure: Collection "'' || p_collection_name || ''" does not exist or is empty'';',
'            p_json_clob := NULL;',
'            RETURN;',
'        END IF;',
'',
'        -- Initialize and build JSON output',
'        apex_json.initialize_clob_output;',
'        apex_json.open_array;',
'',
'        FOR rec IN (',
'            SELECT',
'                c001,',
'                c002,',
'                c003',
'            FROM',
'                apex_collections',
'            WHERE',
'                collection_name = p_collection_name',
'            ORDER BY',
'                seq_id',
'        ) LOOP',
'            apex_json.open_object;',
'            apex_json.write(''name'', rec.c001);',
'            apex_json.write(''data_type'', rec.c002);',
'            apex_json.write(''qualifier'', rec.c003);',
'            apex_json.close_object;',
'        END LOOP;',
'',
'        apex_json.close_array;',
'',
'        p_json_clob := apex_json.get_clob_output;',
'',
'        apex_json.free_output;',
'',
'        p_status  := ''S'';',
'        p_message := ''JSON generated for collection "'' || p_collection_name || ''"'';',
'',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            p_status    := ''E'';',
'            p_message   := ''Failure: '' || SQLERRM;',
'            p_json_clob := NULL;',
'    END get_collection_json;',
'',
'    --------------------------------------------------------------------------------',
'',
'    PROCEDURE define_db_object(',
'        p_template_key IN  VARCHAR2,',
'        p_status       OUT BOOLEAN,',
'        p_message      OUT VARCHAR2,',
'        p_mode         IN  VARCHAR2 DEFAULT ''N'' -- ''N'' = new create, ''U'' = update/replace existing',
'    ) IS',
'        v_db_object_name VARCHAR2(30);',
'        v_sql            CLOB;',
'        v_col_defs       CLOB := '''';',
'        v_unique_defs    CLOB := '''';',
'        v_definition     CLOB;',
'        v_exists         NUMBER;',
'        v_trigger_name   VARCHAR2(130);',
'        l_col_name       VARCHAR2(100);',
'    BEGIN',
unistr('        -- \D83D\DD12 Lock and fetch details'),
'        SELECT',
'            db_object_name,',
'            definition',
'        INTO',
'            v_db_object_name,',
'            v_definition',
'        FROM',
'            ur_templates',
'        WHERE',
'            key = p_template_key',
'        FOR UPDATE;',
'',
'        IF v_definition IS NULL THEN',
'            p_status  := FALSE;',
'            p_message := ''Failure: Definition JSON is NULL for template_key '' || p_template_key;',
'            RETURN;',
'        END IF;',
'',
'        -- Generate table name if not already defined',
'        IF v_db_object_name IS NULL THEN',
'            v_db_object_name := ''UR_TMPLT_'' || UPPER(p_template_key) || ''_T'';',
'        END IF;',
'',
unistr('        -- \D83D\DD0D Check if table exists'),
'        SELECT',
'            COUNT(*)',
'        INTO v_exists',
'        FROM',
'            all_tables',
'        WHERE',
'            table_name = UPPER(v_db_object_name);',
'',
unistr('        -- \D83E\DDE9 Handle based on mode'),
'        IF v_exists > 0 THEN',
'            IF p_mode = ''N'' THEN',
'                p_status  := FALSE;',
'                p_message := ''Failure: Table '' || v_db_object_name || '' already exists.'';',
'                RETURN;',
'            ELSIF p_mode = ''U'' THEN',
'                -- Drop existing trigger if exists',
'                BEGIN',
'                    v_trigger_name := v_db_object_name || ''_BI_TRG'';',
'                    EXECUTE IMMEDIATE ''DROP TRIGGER "'' || v_trigger_name || ''"'';',
'                EXCEPTION',
'                    WHEN OTHERS THEN',
'                        NULL; -- ignore if not exists',
'                END;',
'',
'                -- Drop existing table',
'                BEGIN',
'                    EXECUTE IMMEDIATE ''DROP TABLE "'' || v_db_object_name || ''" CASCADE CONSTRAINTS'';',
'                EXCEPTION',
'                    WHEN OTHERS THEN',
'                        p_status  := FALSE;',
'                        p_message := ''Failure dropping existing table: '' || SQLERRM;',
'                        RETURN;',
'                END;',
'            END IF;',
'        END IF;',
'',
'        -- Start with ID RAW(16) as primary key column',
'        v_col_defs := ''"REC_ID" RAW(16)'';',
'',
'        -- Parse JSON definition',
'        FOR rec IN (',
'            SELECT',
'                jt.name,',
'                jt.data_type,',
'                jt.qualifier',
'            FROM',
'                JSON_TABLE(',
'                    normalize_json(v_definition),',
'                    ''$[*]'' COLUMNS (',
'                        name      VARCHAR2(100) PATH ''$.name'',',
'                        data_type VARCHAR2(30)  PATH ''$.data_type'',',
'                        qualifier VARCHAR2(30)  PATH ''$.qualifier''',
'                    )',
'                ) jt',
'        ) LOOP',
'            -- Sanitize and normalize column name',
'            l_col_name := UPPER(TRIM(BOTH ''_'' FROM rec.name));',
'            l_col_name := REGEXP_REPLACE(l_col_name, ''_{2,}'', ''_'');',
'            v_col_defs := v_col_defs || '', '';',
'',
'            -- Map data types',
'            IF UPPER(rec.data_type) = ''TEXT'' THEN',
'                v_col_defs := v_col_defs || ''"'' || l_col_name || ''" VARCHAR2(4000)'';',
'            ELSIF UPPER(rec.data_type) = ''NUMBER'' THEN',
'                v_col_defs := v_col_defs || ''"'' || l_col_name || ''" NUMBER'';',
'            ELSIF UPPER(rec.data_type) = ''DATE'' THEN',
'                v_col_defs := v_col_defs || ''"'' || l_col_name || ''" DATE'';',
'            ELSE',
'                v_col_defs := v_col_defs || ''"'' || l_col_name || ''" VARCHAR2(4000)'';',
'            END IF;',
'',
'            -- Add unique constraint for special qualifiers',
'            IF UPPER(rec.qualifier) = ''STAY_DATE'' THEN',
'                v_unique_defs :=',
'                    v_unique_defs ||',
'                    '', CONSTRAINT "'' || v_db_object_name || ''_'' || l_col_name || ''_UQ" UNIQUE ("'' ||',
'                    l_col_name || ''")'';',
'            END IF;',
'        END LOOP;',
'',
'        -- Add WHO / AUDIT columns',
'        v_col_defs :=',
'            v_col_defs ||',
'            '', CREATED_BY RAW(16), UPDATED_BY RAW(16), CREATED_ON DATE, UPDATED_ON DATE, HOTEL_ID RAW(16), INTERFACE_LOG_ID RAW(16)'';',
'',
'        -- Build CREATE TABLE DDL',
'        v_sql :=',
'            ''CREATE TABLE "'' || v_db_object_name || ''" ('' ||',
'            v_col_defs ||',
'            '', CONSTRAINT "'' || v_db_object_name || ''_PK" PRIMARY KEY ("REC_ID")'' ||',
'            v_unique_defs || '')'';',
'',
'        EXECUTE IMMEDIATE v_sql;',
'',
'        -- Create or replace trigger',
'        v_trigger_name := v_db_object_name || ''_BI_TRG'';',
'        v_sql          := ''',
'CREATE OR REPLACE EDITIONABLE TRIGGER "'' || v_trigger_name || ''"',
'BEFORE INSERT OR UPDATE ON "'' || v_db_object_name || ''"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'   WHERE USER_NAME = SYS_CONTEXT(''''APEX$SESSION'''', ''''APP_USER'''');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END '' || v_trigger_name || '';',
''';',
'        EXECUTE IMMEDIATE v_sql;',
'',
'        -- Update UR_TEMPLATES',
'        UPDATE ur_templates',
'        SET',
'            db_object_name         = v_db_object_name,',
'            db_object_created_on   = SYSDATE',
'        WHERE',
'            key = p_template_key;',
'',
'        COMMIT;',
'',
'        p_status := TRUE;',
'        IF p_mode = ''U'' THEN',
'            p_message := ''Success: Table "'' || v_db_object_name || ''" redefined (replaced) successfully.'';',
'        ELSE',
'            p_message := ''Success: Table "'' || v_db_object_name || ''" created with ID primary key and trigger.'';',
'        END IF;',
'',
'    EXCEPTION',
'        WHEN NO_DATA_FOUND THEN',
'            p_status  := FALSE;',
'            p_message := ''Failure: Template key not found'';',
'        WHEN OTHERS THEN',
'            p_status  := FALSE;',
'            p_message := ''Failure: '' || SQLERRM;',
'    END define_db_object;',
'',
'    --------------------------------------------------------------------------------',
'',
'    PROCEDURE create_ranking_view(',
'        p_template_key IN  VARCHAR2,',
'        p_status       OUT BOOLEAN,',
'        p_message      OUT VARCHAR2',
'    ) IS',
'        -- Metadata Variables',
'        v_definition       CLOB;',
'        v_data_table_name  VARCHAR2(128);',
'        v_view_name        VARCHAR2(128);',
'        v_sdate_col        VARCHAR2(128);',
'        v_own_property_col VARCHAR2(128);',
'        v_property_list    CLOB;',
'',
'        -- Dynamic SQL Variables',
'        v_sql              CLOB;',
'        v_pivot_clause     CLOB; -- For inside the subquery',
'        v_final_columns    CLOB; -- For the final SELECT list',
'        v_property_count   NUMBER := 0;',
'        v_exists           NUMBER;',
'',
'    BEGIN',
'        -- Step 1: Lock row and get metadata',
'        SELECT',
'            definition,',
'            db_object_name',
'        INTO',
'            v_definition,',
'            v_data_table_name',
'        FROM',
'            ur_templates',
'        WHERE',
'            key = p_template_key',
'        FOR UPDATE;',
'',
'        -- Step 2: Validation checks',
'        IF v_definition IS NULL THEN',
'            p_status  := FALSE;',
'            p_message := ''Failure: Definition JSON is NULL.'';',
'            ROLLBACK;',
'            RETURN;',
'        END IF;',
'        IF v_data_table_name IS NULL THEN',
'            p_status  := FALSE;',
'            p_message := ''Failure: DB object not yet defined.'';',
'            ROLLBACK;',
'            RETURN;',
'        END IF;',
'        SELECT COUNT(*) INTO v_exists FROM user_tables WHERE table_name = UPPER(v_data_table_name);',
'        IF v_exists = 0 THEN',
'            p_status  := FALSE;',
'            p_message := ''Failure: Source table '' || v_data_table_name || '' does not exist.'';',
'            ROLLBACK;',
'            RETURN;',
'        END IF;',
'',
'        -- Step 3: Parse JSON to get column names and count all properties',
'        SELECT jt.name',
'        INTO   v_sdate_col',
'        FROM   JSON_TABLE(v_definition, ''$[*]'' COLUMNS (name VARCHAR2(128) PATH ''$.name'', qualifier VARCHAR2(128) PATH ''$.qualifier'')) jt',
'        WHERE  jt.qualifier = ''STAY_DATE'';',
'',
'        SELECT jt.name',
'        INTO   v_own_property_col',
'        FROM   JSON_TABLE(v_definition, ''$[*]'' COLUMNS (name VARCHAR2(128) PATH ''$.name'', qualifier VARCHAR2(128) PATH ''$.qualifier'')) jt',
'        WHERE  jt.qualifier = ''OWN_PROPERTY'';',
'',
'        SELECT',
'            LISTAGG(''"'' || jt.name || ''"'', '', '') WITHIN GROUP(',
'            ORDER BY',
'                jt.name',
'            ),',
'            COUNT(jt.name)',
'        INTO',
'            v_property_list,',
'            v_property_count',
'        FROM',
'            JSON_TABLE(v_definition, ''$[*]'' COLUMNS (name VARCHAR2(128) PATH ''$.name'', qualifier VARCHAR2(128) PATH ''$.qualifier'')) jt',
'        WHERE',
'            jt.qualifier IN (''OWN_PROPERTY'', ''COMP_PROPERTY'');',
'',
'        -- Step 4: Build the dynamic PIVOT and final column list clauses',
'        FOR i IN 1..v_property_count LOOP',
'            v_pivot_clause := v_pivot_clause ||',
'                              ''MAX(CASE WHEN overall_rank = '' || i || '' THEN hotel_name END) AS "RANK_'' || i || ''_NAME",'' || CHR(10) ||',
'                              ''MAX(CASE WHEN overall_rank = '' || i || '' THEN price END) AS "RANK_'' || i || ''_RATE",'' || CHR(10);',
'',
'            v_final_columns := v_final_columns ||',
'                               ''p."RANK_'' || i || ''_NAME",'' || CHR(10) ||',
'                               ''p."RANK_'' || i || ''_RATE",'' || CHR(10);',
'        END LOOP;',
'        v_pivot_clause  := RTRIM(v_pivot_clause, '','' || CHR(10));',
'        v_final_columns := RTRIM(v_final_columns, '','' || CHR(10));',
'',
'',
'        -- Step 5: Build the final CREATE VIEW statement',
'        v_view_name := ''UR_TMPLT_'' || p_template_key || ''_RANK_V'';',
'',
'        v_sql := ''CREATE OR REPLACE VIEW "'' || v_view_name || ''" AS '' || CHR(10) ||',
'                 ''WITH all_properties_ranked AS ('' || CHR(10) ||',
'                 ''    SELECT '' || CHR(10) ||',
'                 ''      "HOTEL_ID",'' || CHR(10) || ',
'                 ''        "'' || v_sdate_col || ''",'' || CHR(10) ||',
'                 ''        hotel_name,'' || CHR(10) ||',
'                 ''        CASE WHEN REGEXP_LIKE(price, ''''^[0-9,.]+$'''') THEN TO_NUMBER(REPLACE(price, '''','''', '''''''')) ELSE NULL END AS price,'' || CHR(10) ||',
'                 ''        ROW_NUMBER() OVER(PARTITION BY "'' || v_sdate_col || ''" ORDER BY CASE WHEN REGEXP_LIKE(price, ''''^[0-9,.]+$'''') THEN TO_NUMBER(REPLACE(price, '''','''', '''''''')) ELSE NULL END ASC NULLS LAST) as overall_rank'' || CHR(10) ||',
'                 ''    FROM "'' || v_data_table_name || ''"'' || CHR(10) ||',
'                 ''    UNPIVOT (price FOR hotel_name IN ('' || v_property_list || ''))'' || CHR(10) ||',
'                 '')'' || CHR(10) ||',
'                 ''SELECT '' || CHR(10) ||',
'                 ''    p."'' || v_sdate_col || ''" AS "STAY_DATE",'' || CHR(10) ||',
'                 ''    own.price AS "OWN_PROPERTY_RATE",'' || CHR(10) ||',
'                 ''    own.overall_rank AS "OWN_PROPERTY_RANK",'' || CHR(10) ||',
'                 ''    '' || v_final_columns || CHR(10) ||',
'                 ''FROM ('' || CHR(10) ||',
'                 ''    SELECT "'' || v_sdate_col || ''", '' || v_pivot_clause || '' FROM all_properties_ranked GROUP BY "'' || v_sdate_col || ''"'' || CHR(10) ||',
'                 '') p'' || CHR(10) ||',
'                 ''JOIN ('' || CHR(10) ||',
'                 ''    SELECT "'' || v_sdate_col || ''", price, overall_rank FROM all_properties_ranked WHERE hotel_name = '''''' || v_own_property_col || '''''''' || CHR(10) ||',
'                 '') own ON p."'' || v_sdate_col || ''" = own."'' || v_sdate_col || ''"'';',
'',
'        -- Step 6: Execute the dynamic SQL',
'        EXECUTE IMMEDIATE v_sql;',
'',
'        -- Update UR_TEMPLATES with the new db_view_object_name and timestamp',
'        UPDATE ur_templates',
'        SET',
'            db_view_object_name         = v_view_name,',
'            db_view_object_created_on   = SYSDATE',
'        WHERE',
'            key = p_template_key;',
'',
'        COMMIT;',
'        p_status  := TRUE;',
'        p_message := ''Success! Ranking view "'' || v_view_name || ''" created or replaced.'';',
'',
'    EXCEPTION',
'        WHEN NO_DATA_FOUND THEN',
'            p_status  := FALSE;',
'            p_message := ''Failure: Could not find a required qualifier (STAY_DATE, OWN_PROPERTY) in template key '''''' || p_template_key || ''''''.'';',
'            ROLLBACK;',
'        WHEN OTHERS THEN',
'            p_status := FALSE;',
'            p_message := ''Failure: '' || SQLERRM;',
'            DBMS_OUTPUT.PUT_LINE(''--- FAILED SQL ---'');',
'            DBMS_OUTPUT.PUT_LINE(v_sql);',
'            DBMS_OUTPUT.PUT_LINE(''------------------'');',
'            ROLLBACK;',
'    END create_ranking_view;',
'',
'    --------------------------------------------------------------------------------',
'',
'    PROCEDURE LOAD_DATA_MAPPING_COLLECTION(',
'        p_file_id         IN  VARCHAR2,',
'        p_template_id     IN  VARCHAR2,',
'        p_collection_name IN  VARCHAR2,',
'        p_status          OUT VARCHAR2,',
'        p_message         OUT VARCHAR2',
'    ) IS',
'        -- Local variables',
'        v_seq_id NUMBER;',
'    BEGIN',
'        -- Initialize outputs',
'        p_status  := ''S'';',
'        p_message := ''Processing completed successfully.'';',
'',
'        ------------------------------------------------------------------------',
'        -- Step 1: Create or truncate the APEX collection',
'        ------------------------------------------------------------------------',
'        BEGIN',
'            IF APEX_COLLECTION.COLLECTION_EXISTS(p_collection_name) THEN',
'                APEX_COLLECTION.DELETE_COLLECTION(p_collection_name);',
'            END IF;',
'',
'            APEX_COLLECTION.CREATE_COLLECTION(p_collection_name);',
'',
'        EXCEPTION',
'            WHEN OTHERS THEN',
'                p_status  := ''E'';',
'                p_message := ''Failed to create or truncate collection "'' || p_collection_name || ''": '' || SQLERRM;',
'                RETURN;',
'        END;',
'',
'        ------------------------------------------------------------------------',
'        -- Step 2: Insert data from TEMP_BLOB JSON into collection (c001)',
'        ------------------------------------------------------------------------',
'        BEGIN',
'            FOR rec IN (',
'                SELECT',
'                    jt.name || '' ('' || jt.data_type || '')'' AS column_desc,',
'                    jt.col_position',
'                FROM',
'                    TEMP_BLOB t,',
'                    JSON_TABLE(',
'                        normalize_json(t.columns),',
'                        ''$[*]'' COLUMNS (',
'                            name       VARCHAR2(100) PATH ''$.name'',',
'                            data_type  VARCHAR2(100) PATH ''$.data_type'',',
'                            col_position VARCHAR2(100) PATH ''$.pos''',
'                        )',
'                    ) jt',
'                WHERE',
'                    t.id = p_file_id',
'            ) LOOP',
'                APEX_COLLECTION.ADD_MEMBER(',
'                    p_collection_name => p_collection_name,',
'                    p_c001            => rec.column_desc,',
'                    p_c004            => rec.col_position',
'                );',
'            END LOOP;',
'',
'        EXCEPTION',
'            WHEN OTHERS THEN',
'                p_status  := ''E'';',
'                p_message := ''Failed to insert data from TEMP_BLOB (File ID: '' || p_file_id || ''): '' || SQLERRM;',
'                RETURN;',
'        END;',
'',
'        ------------------------------------------------------------------------',
'        -- Step 3: Update existing collection members with matching data from UR_TEMPLATES (c002, c003)',
'        ------------------------------------------------------------------------',
'        BEGIN',
'            FOR rec IN (',
'                SELECT',
'                    jt.name || '' ('' || jt.data_type || '')'' AS column_desc',
'                FROM',
'                    UR_TEMPLATES t,',
'                    JSON_TABLE(',
'                        normalize_json(t.definition),',
'                        ''$[*]'' COLUMNS (',
'                            name      VARCHAR2(100) PATH ''$.name'',',
'                            data_type VARCHAR2(100) PATH ''$.data_type''',
'                        )',
'                    )',
'                     jt',
'                WHERE',
'                    t.id = p_template_id',
'                ORDER BY',
'                    t.id DESC',
'            ) LOOP',
'                BEGIN',
'                    -- Find the seq_id for matching collection member',
'                    SELECT',
'                        seq_id',
'                    INTO v_seq_id',
'                    FROM',
'                        apex_collections',
'                    WHERE',
'                        collection_name = p_collection_name AND c001 = rec.column_desc;',
'',
'                    -- Update c002 and c003 attributes',
'                    APEX_COLLECTION.UPDATE_MEMBER_ATTRIBUTE(',
'                        p_collection_name => p_collection_name,',
'                        p_seq             => v_seq_id,',
'                        p_attr_number     => 2,',
'                        p_attr_value      => rec.column_desc',
'                    );',
'',
'                    APEX_COLLECTION.UPDATE_MEMBER_ATTRIBUTE(',
'                        p_collection_name => p_collection_name,',
'                        p_seq             => v_seq_id,',
'                        p_attr_number     => 3,',
'                        p_attr_value      => ''Maps To''',
'                    );',
'',
'                    APEX_COLLECTION.UPDATE_MEMBER_ATTRIBUTE(',
'                        p_collection_name => p_collection_name,',
'                        p_seq             => v_seq_id,',
'                        p_attr_number     => 4,',
'                        p_attr_value      => NULL',
'                    );',
'',
'                EXCEPTION',
'                    WHEN NO_DATA_FOUND THEN',
unistr('                        -- No matching collection member found \2014 ignore gracefully'),
'                        NULL;',
'                    WHEN OTHERS THEN',
'                        p_status  := ''E'';',
'                        p_message := ''Failed to update member attribute in collection "'' || p_collection_name || ''" for "''',
'                                     || rec.column_desc || ''": '' || SQLERRM;',
'                        RETURN;',
'                END;',
'            END LOOP;',
'',
'        EXCEPTION',
'            WHEN OTHERS THEN',
'                p_status  := ''E'';',
'                p_message := ''Failed to update collection members from UR_TEMPLATES (ID: '' || p_template_id || ''): '' || SQLERRM;',
'                RETURN;',
'        END;',
'',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            p_status  := ''E'';',
'            p_message := ''Unexpected error occurred: '' || SQLERRM;',
'    END LOAD_DATA_MAPPING_COLLECTION;',
'',
'    --------------------------------------------------------------------------------',
'',
'    PROCEDURE Load_Data(',
'        p_file_id         IN  NUMBER,',
'        p_template_key    IN  VARCHAR2,',
'        p_hotel_id        IN  RAW,',
'        p_collection_name IN  VARCHAR2,',
'        p_status          OUT BOOLEAN,',
'        p_message         OUT VARCHAR2',
'    ) IS',
'        ---------------------------------------------------------'))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'-------------',
'        -- Variables',
'        -------------------------------------------------------------------',
'        l_blob          BLOB;',
'        l_file_name     VARCHAR2(255);',
'        l_table_name    VARCHAR2(255);',
'        l_template_id   RAW(16);',
'        l_total_rows    NUMBER := 0;',
'        l_success_cnt   NUMBER := 0;',
'        l_fail_cnt      NUMBER := 0;',
'        l_log_id        RAW(16);',
'        l_error_json    CLOB := ''['';',
'        l_apex_user     VARCHAR2(255) := NVL(v(''APP_USER''), ''APEX_USER'');',
'        l_sql           CLOB;',
'',
'        -- Dynamic headers',
'        TYPE t_headers IS TABLE OF VARCHAR2(4000) INDEX BY PLS_INTEGER;',
'        v_headers       t_headers;',
'        v_col_count     PLS_INTEGER := 0;',
'',
'        -- JSON / dynamic variables',
'        v_profile_clob  CLOB;',
'        v_sql_json      CLOB;',
'        c               SYS_REFCURSOR;',
'        v_row_json      CLOB;',
'        v_line_number   NUMBER;',
'',
'        -- Row processing',
'        l_cols          VARCHAR2(32767);',
'        l_vals          VARCHAR2(32767);',
'        l_set           VARCHAR2(32767);',
'        l_stay_col_name VARCHAR2(200);',
'        l_stay_val      VARCHAR2(4000);',
'',
'    BEGIN',
'        INSERT INTO debug_log(message) VALUES (''START Load_Data - file_id='' || p_file_id);',
'',
'        -------------------------------------------------------------------',
'        -- 0. Check for duplicate upload',
'        -------------------------------------------------------------------',
'        SELECT',
'            COUNT(*)',
'        INTO l_total_rows',
'        FROM',
'            ur_interface_logs',
'        WHERE',
'            file_id = p_file_id AND load_status = ''SUCCESS'';',
'',
'        IF l_total_rows > 0 THEN',
'            p_status  := FALSE;',
'            p_message := ''Failure: File is already uploaded successfully.'';',
'            INSERT INTO debug_log(message) VALUES (p_message);',
'            RETURN;',
'        END IF;',
'',
'        -------------------------------------------------------------------',
'        -- 1. Get blob and file name',
'        -------------------------------------------------------------------',
'        SELECT',
'            blob_content,',
'            filename',
'        INTO',
'            l_blob,',
'            l_file_name',
'        FROM',
'            temp_blob',
'        WHERE',
'            id = p_file_id;',
'',
'        INSERT INTO debug_log(message) VALUES (''Got blob and filename: '' || NVL(l_file_name, ''<null>''));',
'',
'        -------------------------------------------------------------------',
'        -- 2. Get target table name + template id',
'        -------------------------------------------------------------------',
'        SELECT',
'            db_object_name,',
'            id',
'        INTO',
'            l_table_name,',
'            l_template_id',
'        FROM',
'            ur_templates',
'        WHERE',
'            upper(id) = upper(p_template_key);',
'',
'        INSERT INTO debug_log(message) VALUES (''Target table: '' || l_table_name || '', template_id: '' || RAWTOHEX(l_template_id));',
'',
'        -------------------------------------------------------------------',
'        -- 3. Get STAY_DATE column name from template definition (if any)',
'        -------------------------------------------------------------------',
'        BEGIN',
'            SELECT',
'                jt.name',
'            INTO l_stay_col_name',
'            FROM',
'                ur_templates t,',
'                JSON_TABLE(',
'                    t.definition,',
'                    ''$[*]''',
'                    COLUMNS (',
'                        name      VARCHAR2(200) PATH ''$.name'',',
'                        qualifier VARCHAR2(200) PATH ''$.qualifier''',
'                    )',
'                ) jt',
'            WHERE',
'                t.id = l_template_id AND UPPER(jt.qualifier) = ''STAY_DATE''',
'            FETCH FIRST 1 ROWS ONLY;',
'            INSERT INTO debug_log(message) VALUES (''Found STAY_DATE column in template: '' || l_stay_col_name);',
'        EXCEPTION',
'            WHEN NO_DATA_FOUND THEN',
'                l_stay_col_name := NULL;',
'                INSERT INTO debug_log(message) VALUES (''No STAY_DATE configured in template'');',
'        END;',
'',
'        -------------------------------------------------------------------',
'        -- 4. Discover file profile',
'        -------------------------------------------------------------------',
'        v_profile_clob := apex_data_parser.discover(',
'            p_content   => l_blob,',
'            p_file_name => l_file_name',
'        );',
'',
'        INSERT INTO debug_log(message) VALUES (''apex_data_parser.discover done'');',
'',
'        -------------------------------------------------------------------',
'        -- 5. Insert initial log row',
'        -------------------------------------------------------------------',
'        l_log_id := sys_guid();',
'        INSERT INTO ur_interface_logs (',
'            id, hotel_id, template_id, interface_type,',
'            load_start_time, load_status, created_by, updated_by,',
'            created_on, updated_on, file_id',
'        ) VALUES (',
'            l_log_id,',
'            p_hotel_id,',
'            l_template_id,',
'            ''UPLOAD'',',
'            systimestamp,',
'            ''IN_PROGRESS'',',
'            hextoraw(rawtohex(utl_raw.cast_to_raw(l_apex_user))),',
'            hextoraw(rawtohex(utl_raw.cast_to_raw(l_apex_user))),',
'            sysdate, sysdate,',
'            p_file_id',
'        );',
'',
'        INSERT INTO debug_log(message) VALUES (''Inserted ur_interface_logs id='' || RAWTOHEX(l_log_id));',
'',
'        -------------------------------------------------------------------',
'        -- 6. Get dynamic headers from file',
'        -------------------------------------------------------------------',
'        FOR r IN (',
'            SELECT',
'                column_position,',
'                column_name',
'            FROM',
'                TABLE(apex_data_parser.get_columns(v_profile_clob))',
'            ORDER BY',
'                column_position',
'        ) LOOP',
'            v_headers(r.column_position) := r.column_name;',
'            v_col_count                  := r.column_position;',
'        END LOOP;',
'',
'        INSERT INTO debug_log(message) VALUES (''Detected '' || v_col_count || '' columns from file.'');',
'        IF v_col_count = 0 THEN',
'            RAISE_APPLICATION_ERROR(-20001, ''No columns detected in uploaded file.'');',
'        END IF;',
'',
'        -------------------------------------------------------------------',
'        -- 7. Build JSON SQL',
'        -------------------------------------------------------------------',
'        v_sql_json := ''SELECT p.line_number, JSON_OBJECT('';',
'        FOR i IN 1..v_col_count LOOP',
'            IF i > 1 THEN',
'                v_sql_json := v_sql_json || '', '';',
'            END IF;',
'            v_sql_json := v_sql_json || '''''''' || REPLACE(v_headers(i), '''''''', '''''''''''') || '''''' VALUE NVL(p.col'' || LPAD(i, 3, ''0'') || '', '''''''')'';',
'        END LOOP;',
'        v_sql_json := v_sql_json || '') AS row_json FROM TABLE(apex_data_parser.parse(p_content => :1, p_file_name => :2, p_skip_rows => 1)) p'';',
'',
'        INSERT INTO debug_log(message) VALUES (''Built SQL for JSON parse (len='' || LENGTH(v_sql_json) || '')'');',
'',
'        -------------------------------------------------------------------',
'        -- 8. Process each row',
'        -------------------------------------------------------------------',
'        OPEN c FOR v_sql_json USING l_blob, l_file_name;',
'        LOOP',
'            FETCH c INTO v_line_number, v_row_json;',
'            EXIT WHEN c%NOTFOUND;',
'',
'            l_total_rows := l_total_rows + 1;',
'            INSERT INTO debug_log(message) VALUES (''--- Processing row #'' || l_total_rows || '' line='' || NVL(TO_CHAR(v_line_number), ''N/A''));',
'',
'            -- Reset dynamic variables',
'            l_cols     := NULL;',
'            l_vals     := NULL;',
'            l_set      := NULL;',
'            l_stay_val := NULL;',
'',
'            BEGIN',
'                DECLARE',
'                    l_elem          JSON_ELEMENT_T := JSON_ELEMENT_T.parse(v_row_json);',
'                    l_obj           JSON_OBJECT_T;',
'                    l_keys          JSON_KEY_LIST;',
'                    l_col           VARCHAR2(4000);',
'                    l_val           VARCHAR2(4000);',
'                    l_val_formatted VARCHAR2(4000);',
'                BEGIN',
'                    IF NOT l_elem.is_object THEN',
'                        RAISE_APPLICATION_ERROR(-20002, ''Row not a JSON object'');',
'                    END IF;',
'',
'                    l_obj  := TREAT(l_elem AS JSON_OBJECT_T);',
'                    l_keys := l_obj.get_keys;',
'',
'                    FOR j IN 1..l_keys.count LOOP',
'                        l_col := sanitize_column_name(l_keys(j));',
'                        l_val := l_obj.get_string(l_keys(j));',
'',
'                        -- Capture STAY_DATE value',
'                        IF l_stay_col_name IS NOT NULL AND l_col = UPPER(l_stay_col_name) THEN',
'                            l_stay_val := l_val;',
'                        END IF;',
'',
'                        -- Format value',
'                        l_val_formatted := NULL;',
'                        IF l_val IS NOT NULL AND REGEXP_LIKE(l_val, ''^-?\d+(\.\d+)?$'') THEN',
'                            l_val_formatted := TO_CHAR(TO_NUMBER(l_val));',
'                        END IF;',
'',
'                        IF l_val_formatted IS NULL THEN',
'                            l_val_formatted := '''''''' || REPLACE(NVL(l_val, ''''), '''''''', '''''''''''') || '''''''';',
'                        END IF;',
'',
'                        -- Append to dynamic SQL parts',
'                        IF l_set IS NOT NULL THEN',
'                            l_set  := l_set || '', '';',
'                            l_cols := l_cols || '', '';',
'                            l_vals := l_vals || '', '';',
'                        END IF;',
'',
'                        l_set  := NVL(l_set, '''') || l_col || '' = '' || l_val_formatted;',
'                        l_cols := NVL(l_cols, '''') || l_col;',
'                        l_vals := NVL(l_vals, '''') || l_val_formatted;',
'                    END LOOP;',
'',
'                    -- Always append HOTEL_ID to the set/insert',
'                    IF NVL(l_cols, '''') <> '''' THEN',
'                        l_cols := l_cols || '', HOTEL_ID'';',
'                        l_vals := l_vals || '', HEXTORAW('''''' || RAWTOHEX(p_hotel_id) || '''''')'';',
'                        l_set  := l_set || '', HOTEL_ID = '''''' || p_hotel_id || '''''''';',
'                    END IF;',
'',
'                    ----------------------------------------------------------------',
'                    -- UPSERT logic (update first, then insert)',
'                    ----------------------------------------------------------------',
'                    l_sql := ''UPDATE '' || l_table_name ||',
'                             '' SET '' || l_set ||',
'                             '' WHERE HOTEL_ID = HEXTORAW('''''' || RAWTOHEX(p_hotel_id) || '''''')'';',
'',
'                    -- Optional: include STAY_DATE if available',
'                    IF l_stay_val IS NOT NULL THEN',
'                        l_sql := l_sql || '' AND '' || l_stay_col_name || '' = '''''' || REPLACE(l_stay_val, '''''''', '''''''''''') || '''''''';',
'                    END IF;',
'',
'                    -- Debug',
'                    INSERT INTO debug_log(message) VALUES (''UPDATE SQL: '' || SUBSTR(l_sql, 1, 2000));',
'',
'                    EXECUTE IMMEDIATE l_sql;',
'',
'                    IF SQL%ROWCOUNT = 0 THEN',
unistr('                        -- No row updated \2192 INSERT'),
'                        l_cols := l_cols || '', HOTEL_ID'';',
'                        l_vals := l_vals || '', HEXTORAW('''''' || RAWTOHEX(p_hotel_id) || '''''')'';',
'',
'                        l_sql := ''INSERT INTO '' || l_table_name || '' ('' || l_cols || '') VALUES ('' || l_vals || '')'';',
'                        INSERT INTO debug_log(message) VALUES (''INSERT SQL: '' || SUBSTR(l_sql, 1, 2000));',
'                        EXECUTE IMMEDIATE l_sql;',
'                    END IF;',
'',
'                    l_success_cnt := l_success_cnt + 1;',
'',
'                END;',
'            EXCEPTION',
'                WHEN OTHERS THEN',
'                    l_fail_cnt   := l_fail_cnt + 1;',
'                    l_error_json := l_error_json || ''{"row":'' || l_total_rows || '',"error":"'' || REPLACE(SQLERRM, ''"'', '''''''') || ''"},'';',
'            END;',
'        END LOOP;',
'        CLOSE c;',
'',
'        -- finalize error JSON',
'        IF l_error_json IS NOT NULL AND l_error_json <> ''['' THEN',
'            IF SUBSTR(l_error_json, -1) = '','' THEN',
'                l_error_json := SUBSTR(l_error_json, 1, LENGTH(l_error_json) - 1);',
'            END IF;',
'            l_error_json := l_error_json || '']'';',
'        ELSE',
'            l_error_json := NULL;',
'        END IF;',
'',
'        COMMIT;',
'',
'        -- Update log',
'        UPDATE ur_interface_logs',
'        SET',
'            load_end_time   = systimestamp,',
'            load_status     = ''SUCCESS'',',
'            updated_on      = sysdate,',
'            error_json      = l_error_json',
'        WHERE',
'            id = l_log_id;',
'',
'        p_status  := TRUE;',
unistr('        p_message := ''Success: Upload completed \2192 Total='' || l_total_rows || '', Success='' || l_success_cnt || '', Failed='' || l_fail_cnt;'),
'',
'        INSERT INTO debug_log(message) VALUES (''Completed Load_Data - '' || p_message);',
'',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            BEGIN',
'                UPDATE ur_interface_logs',
'                SET',
'                    load_end_time   = systimestamp,',
'                    load_status     = ''FAILED'',',
'                    updated_on      = sysdate',
'                WHERE',
'                    id = l_log_id;',
'            EXCEPTION',
'                WHEN OTHERS THEN',
'                    NULL;',
'            END;',
'',
'            ROLLBACK;',
'            p_status  := FALSE;',
'            p_message := ''Failure: '' || SQLERRM;',
'    END Load_Data;',
'',
'    --------------------------------------------------------------------------------',
'',
'    PROCEDURE fetch_templates(',
'        p_file_id     IN  NUMBER,',
'        p_hotel_id    IN  VARCHAR2,',
'        p_min_score   IN  NUMBER DEFAULT 90,',
'        p_debug_flag  IN  VARCHAR2 DEFAULT ''N'',',
'        p_output_json OUT CLOB,',
'        p_status      OUT VARCHAR2,',
'        p_message     OUT VARCHAR2',
'    ) IS',
'        -- Local types',
'        TYPE t_name_type_rec IS RECORD(',
'            name      VARCHAR2(100),',
'            data_type VARCHAR2(30)',
'        );',
'        TYPE t_name_type_tab IS TABLE OF t_name_type_rec;',
'',
'        TYPE t_template_rec IS RECORD(',
'            id         VARCHAR2(50),',
'            name       VARCHAR2(200),',
'            definition t_name_type_tab',
'        );',
'        TYPE t_template_tab IS TABLE OF t_template_rec INDEX BY PLS_INTEGER;',
'',
'        -- Variables',
'        v_source_clob         CLOB;',
'        v_source_normalized   CLOB;',
'',
'        v_target_id           VARCHAR2(50);',
'        v_target_name         VARCHAR2(200);',
'        v_target_def_clob     CLOB;',
'        v_target_normalized   CLOB;',
'',
'        v_source_defs         t_name_type_tab := t_name_type_tab();',
'        v_target_defs         t_name_type_tab := t_name_type_tab();',
'',
'        v_templates           t_template_tab;',
'        v_count_templates     PLS_INTEGER := 0;',
'',
'        v_json_output         CLOB := ''['';',
'        v_min_score_use       NUMBER;',
'        v_separator           VARCHAR2(1) := '''';',
'',
'        v_match_count         NUMBER;',
'        v_score               NUMBER;',
'',
'        CURSOR c_targets IS',
'            SELECT',
'                ID,',
'                NAME,',
'                DEFINITION',
'            FROM',
'                UR_TEMPLATES',
'            WHERE',
'                hotel_id = p_hotel_id;',
'',
'        -- Debug procedure',
'        PROCEDURE debug(p_msg VARCHAR2) IS',
'        BEGIN',
'            IF UPPER(p_debug_flag) = ''Y'' THEN',
'                DBMS_OUTPUT.PUT_LINE(''[DEBUG] '' || p_msg);',
'            END IF;',
'        END;',
'',
'        -- Normalize data-type keys in JSON string (case sensitive replacement)',
'        FUNCTION normalize_json(p_json CLOB) RETURN CLOB IS',
'        BEGIN',
'            RETURN REPLACE(REPLACE(p_json, ''"data-type"'', ''"data_type"''), ''"DATA-TYPE"'', ''"data_type"'');',
'        END;',
'',
'        -- Parse definition JSON into PL/SQL collection',
'        FUNCTION parse_definition(p_clob CLOB) RETURN t_name_type_tab IS',
'            l_defs t_name_type_tab := t_name_type_tab();',
'            idx    PLS_INTEGER := 0;',
'        BEGIN',
'            FOR rec IN (',
'                SELECT',
'                    lower(trim(name)) AS name,',
'                    lower(trim(data_type)) AS data_type',
'                FROM',
'                    JSON_TABLE(',
'                        p_clob,',
'                        ''$[*]'' COLUMNS (',
'                            name      VARCHAR2(100) PATH ''$.name'',',
'                            data_type VARCHAR2(30)  PATH ''$.data_type''',
'                        )',
'                    )',
'            ) LOOP',
'                idx := idx + 1;',
'                l_defs.EXTEND;',
'                l_defs(idx).name      := rec.name;',
'                l_defs(idx).data_type := rec.data_type;',
'            END LOOP;',
'            RETURN l_defs;',
'        EXCEPTION',
'            WHEN OTHERS THEN',
'                RETURN NULL;',
'        END;',
'',
'        -- Count matches (name + data_type case-insensitive)',
'        FUNCTION count_matches(',
'            p_source t_name_type_tab,',
'            p_target t_name_type_tab',
'        ) RETURN NUMBER IS',
'            v_count NUMBER := 0;',
'        BEGIN',
'            FOR i IN 1..p_source.COUNT LOOP',
'                FOR j IN 1..p_target.COUNT LOOP',
'                    IF p_source(i).name = p_target(j).name AND p_source(i).data_type = p_target(j).data_type THEN',
'                        v_count := v_count + 1;',
'                        EXIT;',
'                    END IF;',
'                END LOOP;',
'            END LOOP;',
'            RETURN v_count;',
'        END;',
'',
'    BEGIN',
'        -- Validate inputs and assign to local variable',
'        v_min_score_use := NVL(p_min_score, 90);',
'        IF v_min_score_use < 0 OR v_min_score_use > 100 THEN',
'            v_min_score_use := 90;',
'        END IF;',
'',
'        IF p_file_id IS NULL THEN',
'            p_status      := ''E'';',
'            p_message     := ''File ID must be provided'';',
'            p_output_json := NULL;',
'            RETURN;',
'        END IF;',
'',
'        IF p_hotel_id IS NULL THEN',
'            p_status      := ''E'';',
'            p_message     := ''Hotel ID must be provided'';',
'            p_output_json := NULL;',
'            RETURN;',
'        END IF;',
'',
'        debug(''Starting processing...'');',
'        debug(''File ID: '' || p_file_id);',
'        debug(''Hotel ID: '' || p_hotel_id);',
'        debug(''Minimum Score: '' || v_min_score_use);',
'',
'        -- Fetch and normalize source CLOB',
'        BEGIN',
'            SELECT columns INTO v_source_clob FROM temp_blob WHERE id = p_file_id;',
'            IF v_source_clob IS NULL THEN',
'                p_status      := ''E'';',
'                p_message     := ''Source definition not found for file_id '' || p_file_id;',
'                p_output_json := NULL;',
'                RETURN;',
'            END IF;',
'        EXCEPTION',
'            WHEN NO_DATA_FOUND THEN',
'                p_status      := ''E'';',
'                p_message     := ''Source file not found for id '' || p_file_id;',
'                p_output_json := NULL;',
'                RETURN;',
'            WHEN OTHERS THEN',
'                p_status      := ''E'';',
'                p_message     := ''Error fetching source definition: '' || SQLERRM;',
'                p_output_json := NULL;',
'                RETURN;',
'        END;',
'',
'        v_source_normalized := normalize_json(v_source_clob);',
'',
'        -- Parse source defs',
'        v_source_defs := parse_definition(v_source_normalized);',
'        IF v_source_defs IS NULL OR v_source_defs.COUNT = 0 THEN',
'            p_status      := ''E'';',
'            p_message     := ''Cannot parse source definition JSON or empty definition'';',
'            p_output_json := NULL;',
'            RETURN;',
'        END IF;',
'        debug(''Parsed Source definitions: '' || v_source_defs.COUNT || '' fields'');',
'',
'        -- Initialize JSON output',
'        v_json_output     := ''['';',
'        v_count_templates := 0;',
'',
'        -- Loop over target templates from cursor',
'        FOR r_target IN c_targets LOOP',
'            v_target_id       := r_target.ID;',
'            v_target_name     := r_target.NAME;',
'            v_target_def_clob := r_target.DEFINITION;',
'',
'            IF v_target_def_clob IS NULL THEN',
'                debug(''Skipping template '' || v_target_id || '' due to NULL definition'');',
'                CONTINUE;',
'            END IF;',
'',
'            v_target_normalized := normalize_json(v_target_def_clob);',
'',
'            v_target_defs := parse_definition(v_target_normalized);',
'            IF v_target_defs IS NULL OR v_target_defs.COUNT = 0 THEN',
'                debug(''Skipping template '' || v_target_id || '' due to parsing error or empty definition'');',
'                CONTINUE;',
'            END IF;',
'',
'            v_match_count := count_matches(v_source_defs, v_target_defs);',
'',
'            v_score := ROUND((2 * v_match_count) / (v_source_defs.COUNT + v_target_defs.COUNT) * 100);',
'',
'            debug(',
'                ''Template '' || v_target_id || '' ('' || v_target_name || ''): Matches='' ||',
'                v_match_count || '', Score='' || v_score',
'            );',
'',
'            IF v_score >= v_min_score_use THEN',
'                IF v_count_templates > 0 THEN',
'                    v_json_output := v_json_output || '','';',
'                END IF;',
'                v_json_output     := v_json_output || ''{"Template_id":"'' || v_target_id ||',
'                                     ''","Template_Name":"'' || REPLACE(v_target_name, ''"'', ''\"'') ||',
'                                     ''","Score":'' || v_score || ''}'';',
'                v_count_templates := v_count_templates + 1;',
'            END IF;',
'        END LOOP;',
'',
'        v_json_output := v_json_output || '']'';',
'',
'        IF v_count_templates = 0 THEN',
'            p_output_json := ''[{}]'';',
'            p_message     := ''No templates matched the minimum score threshold'';',
'            debug(''No matching templates found.'');',
'        ELSE',
'            p_output_json := v_json_output;',
'            p_message     := ''Templates matched: '' || v_count_templates;',
'            debug(''Matching templates count: '' || v_count_templates);',
'        END IF;',
'',
'        p_status := ''S'';',
'',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            p_status      := ''E'';',
'            p_message     := ''Unexpected error: '' || SQLERRM;',
'            p_output_json := NULL;',
'    END fetch_templates;',
'',
'    --------------------------------------------------------------------------------',
'',
'    PROCEDURE DELETE_TEMPLATES(',
'        p_id           IN  VARCHAR2 DEFAULT NULL,',
'        p_hotel_id     IN  VARCHAR2 DEFAULT NULL,',
'        p_key          IN  VARCHAR2 DEFAULT NULL,',
'        p_name         IN  VARCHAR2 DEFAULT NULL,',
'        p_type         IN  VARCHAR2 DEFAULT NULL,',
'        p_active       IN  CHAR     DEFAULT NULL,',
'        p_db_obj_empty IN  CHAR     DEFAULT NULL,',
'        p_delete_all   IN  CHAR     DEFAULT ''N'',',
'        p_debug        IN  CHAR     DEFAULT ''N'',',
'        p_json_output  OUT CLOB',
'    ) AS',
'        v_sql          VARCHAR2(1000);',
'        v_rows_count   NUMBER;',
'        v_status       CHAR(1);',
'        v_message      VARCHAR2(4000);',
'        v_json_list    CLOB := ''['';',
'        v_first        BOOLEAN := TRUE;',
'',
'        CURSOR c_templates IS',
'            SELECT',
'                id,',
'                hotel_id,',
'                key,',
'                name,',
'                type,',
'                active,',
'                db_object_name',
'            FROM',
'                ur_templates',
'            WHERE',
'                (p_delete_all = ''Y'' OR (p_id IS NULL OR id = p_id)) AND (p_delete_all = ''Y'' OR (p_hotel_id IS NULL OR hotel_id = p_hotel_id)) AND (p_delete_all = ''Y'' OR (p_key IS NULL OR key = p_key)) AND (p_delete_all = ''Y'' OR (p_name IS NULL OR nam'
||'e = p_name)) AND (p_delete_all = ''Y'' OR (p_type IS NULL OR type = p_type)) AND (p_delete_all = ''Y'' OR (p_active IS NULL OR active = p_active));',
'',
'        -- Helper to escape JSON strings (basic)',
'        FUNCTION json_escape(str IN VARCHAR2) RETURN VARCHAR2 IS',
'        BEGIN',
'            RETURN REPLACE(REPLACE(REPLACE(REPLACE(str, ''\'', ''\\''), ''"'', ''\"''), CHR(10), ''\n''), CHR(13), '''');',
'        EXCEPTION',
'            WHEN OTHERS THEN',
'                RETURN '''';',
'        END;',
'',
'        PROCEDURE dbg(p_msg VARCHAR2) IS',
'        BEGIN',
'            IF p_debug = ''Y'' THEN',
'                apex_debug.message(p_msg);',
'            END IF;',
'        END;',
'',
'        PROCEDURE append_result(',
'            p_id          IN VARCHAR2,',
'            p_hotel_id    IN VARCHAR2,',
'            p_key         IN VARCHAR2,',
'            p_name        IN VARCHAR2,',
'            p_type        IN VARCHAR2,',
'            p_active      IN CHAR,',
'            p_db_obj_name IN VARCHAR2,',
'            p_status      IN CHAR,',
'            p_message     IN VARCHAR2',
'        ) IS',
'        BEGIN',
'            IF v_first THEN',
'                v_first := FALSE;',
'            ELSE',
'                v_json_list := v_json_list || '','';',
'            END IF;',
'',
'            v_json_list := v_json_list || ''{'' ||',
'                           ''"id":"'' || json_escape(p_id) || ''",'' ||',
'                           ''"hotel_id":"'' || json_escape(p_hotel_id) || ''",'' ||',
'                           ''"key":"'' || json_escape(p_key) || ''",'' ||',
'                           ''"name":"'' || json_escape(p_name) || ''",'' ||',
'                           ''"type":"'' || json_escape(p_type) || ''",'' ||',
'                           ''"active":"'' || json_escape(p_active) || ''",'' ||',
'                           ''"db_object_name":"'' || json_escape(p_db_obj_name) || ''",'' ||',
'                           ''"status":"'' || json_escape(p_status) || ''",'' ||',
'                           ''"message":"'' || json_escape(p_message) || ''"'' ||',
'                           ''}'';',
'        END;',
'',
'    BEGIN',
'        dbg(''Started DELETE_TEMPLATES_AND_DB_OBJECTS_JSON procedure.'');',
'',
'        FOR rec IN c_templates LOOP',
'            dbg(''Processing template ID='' || rec.id || '', DB_OBJECT_NAME='' || rec.db_object_name);',
'',
'            IF rec.db_object_name IS NULL THEN',
'                v_status  := ''E'';',
'                v_message := ''No DB_OBJECT_NAME specified for template, skipping.'';',
'                dbg(v_message);',
'                append_result(rec.id, rec.hotel_id, rec.key, rec.name, rec.type, rec.active, NULL, v_status, v_message);',
'                CONTINUE;',
'            END IF;',
'',
'            -- Check if table should be empty before deleting',
'            IF p_db_obj_empty = ''Y'' THEN',
'                v_sql := ''SELECT COUNT(*) FROM '' || rec.db_object_name;',
'                BEGIN',
'                    EXECUTE IMMEDIATE v_sql INTO v_rows_count;',
'                EXCEPTION',
'                    WHEN OTHERS THEN',
'                        v_rows_count := -1; -- can''t count, treat as error or non-empty',
'                END;',
'',
'                IF v_rows_count > 0 THEN',
'                    v_status  := ''E'';',
'                    v_message := ''DB Object table ['' || rec.db_object_name || ''] is not empty (ROWS='' || v_rows_count || ''), skipping deletion.'';',
'                    dbg(v_message);',
'                    append_result(rec.id, rec.hotel_id, rec.key, rec.name, rec.type, rec.active, rec.db_object_name, v_status, v_message);',
'                    CONTINUE;',
'                END IF;',
'                dbg(''DB Object table ['' || rec.db_object_name || ''] is empty, proceeding.'');',
'            END IF;',
'',
'            -- Try to drop the table and delete template',
'            BEGIN',
'                v_sql := ''DROP TABLE '' || rec.db_object_name || '' CASCADE CONSTRAINTS'';',
'                dbg(''Executing: '' || v_sql);',
'                EXECUTE IMMEDIATE v_sql;',
'',
'                dbg(''Dropped table '' || rec.db_object_name);',
'',
'                DELETE FROM ur_templates WHERE id = rec.id;',
'',
'                dbg(''Deleted template id='' || rec.id);',
'',
'                v_status  := ''S'';',
'                v_message := ''Successfully dropped table and deleted template.'';',
'                append_result(rec.id, rec.hotel_id, rec.key, rec.name, rec.type, rec.active, rec.db_object_name, v_status, v_message);',
'',
'            EXCEPTION',
'                WHEN OTHERS THEN',
'                    v_status  := ''E'';',
'                    v_message := ''Error dropping table or deleting template: '' || SQLERRM;',
'                    dbg(v_message);',
'                    append_result(rec.id, rec.hotel_id, rec.key, rec.name, rec.type, rec.active, rec.db_object_name, v_status, v_message);',
'            END;',
'        END LOOP;',
'',
'        v_json_list   := v_json_list || '']'';',
'        p_json_output := v_json_list;',
'',
'        dbg(''Completed DELETE_TEMPLATES_AND_DB_OBJECTS_JSON procedure.'');',
'    END DELETE_TEMPLATES;',
'',
'    --------------------------------------------------------------------------------',
'',
'   PROCEDURE manage_algo_attributes(',
'        p_template_key   IN  VARCHAR2,',
'        p_mode           IN  CHAR,',
'        p_attribute_key  IN  VARCHAR2 DEFAULT NULL,',
'        p_status         OUT BOOLEAN,',
'        p_message        OUT VARCHAR2',
'    ) IS',
'      -- Original Variables',
'      v_db_object_name UR_TEMPLATES.DB_OBJECT_NAME%TYPE;',
'      v_definition     UR_TEMPLATES.DEFINITION%TYPE;',
'      v_hotel_id       UR_TEMPLATES.HOTEL_ID%TYPE;',
'      v_user_id        RAW(16);',
'      v_insert_count   NUMBER := 0;',
'      v_delete_count   NUMBER := 0;',
'      v_template_id    RAW(16);',
'      v_attr_qualifier VARCHAR2(4000) := NULL;',
'',
'      -- New Variables for RST logic',
'      v_template_type        UR_TEMPLATES.TYPE%TYPE;',
'      v_db_view_object_name  UR_TEMPLATES.DB_VIEW_OBJECT_NAME%TYPE;',
'      v_own_property_count   NUMBER := 0;',
'      v_comp_property_count  NUMBER := 0;',
'      v_object_exists        NUMBER := 0;',
'      v_column_exists        NUMBER := 0;',
'',
'      -- Local helper procedure updated to accept qualifier name',
'        PROCEDURE create_rst_attribute (',
'          p_attr_name       IN VARCHAR2,',
'          p_attr_key        IN VARCHAR2,',
'          p_attr_val        IN VARCHAR2,',
'          p_qualifier_name  IN VARCHAR2,',
'          p_data_type       IN VARCHAR2 DEFAULT ''NUMBER''',
'      ) IS',
'          v_exists NUMBER;',
'      BEGIN',
'          SELECT COUNT(*) INTO v_exists FROM ur_algo_attributes WHERE key = p_attr_key;',
'          IF v_exists = 0 THEN',
'              INSERT INTO ur_algo_attributes (',
'                  id, algo_id, hotel_id, name, key, data_type, description, type, value, template_id, attribute_qualifier,',
'                  created_by, updated_by, created_on, updated_on',
'              ) VALUES (',
'                  SYS_GUID(), NULL, v_hotel_id, p_attr_name, p_attr_key, p_data_type,',
'                  NULL,',
'                 '))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
' ''S'', ',
'                  ''#'' || p_attr_val || ''#'', -- Value wrapped in #',
'                  v_template_id,',
'                  p_qualifier_name,',
'                  v_user_id, v_user_id, SYSDATE, SYSDATE',
'              );',
'              v_insert_count := v_insert_count + 1;',
'          END IF;',
'      END create_rst_attribute;',
'',
'    BEGIN',
'      -- Initialization',
'      p_status := FALSE;',
'      p_message := NULL;',
'',
'      -- Obtain needed data from UR_TEMPLATES',
'      BEGIN',
'        SELECT db_object_name, definition, hotel_id, id, type, db_view_object_name',
'        INTO v_db_object_name, v_definition, v_hotel_id, v_template_id, v_template_type, v_db_view_object_name',
'        FROM ur_templates',
'        WHERE key = p_template_key;',
'      EXCEPTION',
'        WHEN NO_DATA_FOUND THEN',
'          p_message := ''Failure: Template key not found: '' || p_template_key;',
'          RETURN;',
'      END;',
'',
'      IF v_db_object_name IS NULL THEN',
'        p_message := ''Failure: DB_OBJECT_NAME not defined for template_key '' || p_template_key;',
'        RETURN;',
'      END IF;',
'',
'      -- Get USER_ID once for audit columns',
'      BEGIN',
'        SELECT USER_ID INTO v_user_id',
'        FROM UR_USERS',
'        WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'      EXCEPTION',
'        WHEN NO_DATA_FOUND THEN',
'          v_user_id := NULL;',
'      END;',
'',
'      IF p_mode = ''C'' THEN',
'        IF v_definition IS NULL THEN',
'          p_message := ''Failure: Definition JSON is NULL for template_key '' || p_template_key;',
'          RETURN;',
'        END IF;',
'',
'        -- ====================================================================================',
'        -- START: LOGIC FOR RST TEMPLATES',
'        -- ====================================================================================',
'        IF v_template_type = ''RST'' THEN',
'          -- Count OWN_PROPERTY and COMP_PROPERTY qualifiers',
'          SELECT',
'            COUNT(CASE WHEN UPPER(jt.qualifier) = ''OWN_PROPERTY'' THEN 1 END),',
'            COUNT(CASE WHEN UPPER(jt.qualifier) = ''COMP_PROPERTY'' THEN 1 END)',
'          INTO v_own_property_count, v_comp_property_count',
'          FROM JSON_TABLE(v_definition, ''$[*]'' COLUMNS (qualifier VARCHAR2(30) PATH ''$.qualifier'')) jt;',
'',
'          -- Check if the special qualifiers exist to trigger the RST logic',
'          IF v_own_property_count > 0 AND v_comp_property_count > 0 THEN',
'            -- 1. Validate DB_VIEW_OBJECT_NAME',
'            IF v_db_view_object_name IS NULL THEN',
'              p_message := ''Failure: DB_VIEW_OBJECT_NAME is not defined for RST template '' || p_template_key;',
'              RETURN;',
'            END IF;',
'',
'            -- 2. Validate the view/object exists',
'            BEGIN',
'              SELECT 1 INTO v_object_exists FROM user_objects',
'              WHERE object_name = UPPER(v_db_view_object_name) AND object_type IN (''VIEW'', ''TABLE'', ''SYNONYM'');',
'            EXCEPTION',
'              WHEN NO_DATA_FOUND THEN',
'                v_object_exists := 0;',
'            END;',
'',
'            IF v_object_exists = 0 THEN',
'              p_message := ''Failure: The specified DB_VIEW_OBJECT_NAME '''''' || v_db_view_object_name || '''''' does not exist.'';',
'              RETURN;',
'            END IF;',
'',
'            -- 3. Validate and create attributes for OWN_PROPERTY',
'            FOR r_col IN (',
'                SELECT ''OWN_PROPERTY_RANK'' AS col_name FROM DUAL',
'                UNION ALL',
'                SELECT ''OWN_PROPERTY_RATE'' AS col_name FROM DUAL',
'            ) LOOP',
'                SELECT COUNT(*) INTO v_column_exists FROM user_tab_columns',
'                WHERE table_name = UPPER(v_db_view_object_name) AND column_name = r_col.col_name;',
'',
'                IF v_column_exists = 0 THEN',
'                    p_message := ''Failure: Required column '' || r_col.col_name || '' not found in view '' || v_db_view_object_name;',
'                    RETURN;',
'                END IF;',
'            END LOOP;',
'            ',
'            create_rst_attribute(''OWN PROPERTY RANK'', v_db_view_object_name || ''.OWN_PROPERTY_RANK'', v_db_view_object_name || ''.OWN_PROPERTY_RANK'', ''OWN_PROPERTY'');',
'            create_rst_attribute(''OWN PROPERTY RATE'', v_db_view_object_name || ''.OWN_PROPERTY_RATE'', v_db_view_object_name || ''.OWN_PROPERTY_RATE'', ''OWN_PROPERTY'');',
'            ',
'            -- 4. Create attributes for COMP_PROPERTY',
'            FOR i IN 1 .. (v_comp_property_count + 1) LOOP',
'              DECLARE',
'                l_col_name   VARCHAR2(100) := ''RANK_'' || i || ''_RATE'';',
'                l_attr_name  VARCHAR2(100) := ''COMP SET R'' || i || '' RATE'';',
'                l_attr_key   VARCHAR2(200) := v_db_view_object_name || ''.'' || l_col_name;',
'              BEGIN',
'                -- Validate that the required rank column exists',
'                SELECT COUNT(*) INTO v_column_exists FROM user_tab_columns',
'                WHERE table_name = UPPER(v_db_view_object_name) AND column_name = l_col_name;',
'',
'                IF v_column_exists = 0 THEN',
'                  p_message := ''Failure: Required column '' || l_col_name || '' not found in view '' || v_db_view_object_name || ''.'';',
'                  ROLLBACK;',
'                  RETURN;',
'                END IF;',
'                ',
'                -- Create the attribute using the helper',
'                create_rst_attribute(l_attr_name, l_attr_key, l_attr_key, ''COMP_PROPERTY'');',
'              END;',
'            END LOOP;',
'          END IF;',
'',
'          -- Process any OTHER qualifiers in an RST template using the original logic',
'          FOR rec IN (',
'            SELECT jt.name, jt.data_type, jt.qualifier',
'            FROM JSON_TABLE(',
'              v_definition, ''$[*]'' COLUMNS (',
'                name      VARCHAR2(100) PATH ''$.name'',',
'                data_type VARCHAR2(30)  PATH ''$.data_type'',',
'                qualifier VARCHAR2(30)  PATH ''$.qualifier''',
'              )',
'            ) jt',
'            WHERE jt.qualifier IS NOT NULL',
'              AND UPPER(jt.qualifier) NOT IN (''UNIQUE'', ''OWN_PROPERTY'', ''COMP_PROPERTY'')',
'          )',
'          LOOP',
'            DECLARE',
'              l_col_name VARCHAR2(150) := UPPER(REGEXP_REPLACE(TRIM(rec.name), ''_+$'', ''''));',
'              v_key      VARCHAR2(150) := v_db_object_name || ''.'' || l_col_name;',
'              v_exists   NUMBER;',
'            BEGIN',
'              SELECT COUNT(*) INTO v_exists FROM ur_algo_attributes WHERE key = v_key;',
'              IF v_exists = 0 THEN',
'                INSERT INTO ur_algo_attributes (',
'                  id, algo_id, hotel_id, name, key, data_type, description, type, value, template_id, attribute_qualifier,',
'                  created_by, updated_by, created_on, updated_on',
'                ) VALUES (',
'                  SYS_GUID(), NULL, v_hotel_id, l_col_name, v_key, NVL(UPPER(rec.data_type), ''NUMBER''),',
'                  NULL, ''S'', ',
'                  ''#'' || v_key || ''#'', -- Value wrapped in #',
'                  v_template_id, rec.qualifier,',
'                  v_user_id, v_user_id, SYSDATE, SYSDATE',
'                );',
'                v_insert_count := v_insert_count + 1;',
'              END IF;',
'            END;',
'          END LOOP;',
'',
'        ELSE',
'          -- ====================================================================================',
'          -- START: ORIGINAL LOGIC FOR NON-RST TEMPLATES',
'          -- ====================================================================================',
'          FOR rec IN (',
'            SELECT jt.name, jt.data_type, jt.qualifier',
'            FROM JSON_TABLE(',
'              v_definition, ''$[*]'' COLUMNS (',
'                name      VARCHAR2(100) PATH ''$.name'',',
'                data_type VARCHAR2(30)  PATH ''$.data_type'',',
'                qualifier VARCHAR2(30)  PATH ''$.qualifier''',
'              )',
'            ) jt',
'            WHERE jt.qualifier IS NOT NULL',
'              AND UPPER(jt.qualifier) <> ''UNIQUE''',
'          )',
'          LOOP',
'            DECLARE',
'              l_col_name VARCHAR2(150) := UPPER(REGEXP_REPLACE(TRIM(rec.name), ''_+$'', ''''));',
'              v_key      VARCHAR2(150) := v_db_object_name || ''.'' || l_col_name;',
'              v_exists   NUMBER;',
'            BEGIN',
'              SELECT COUNT(*) INTO v_exists FROM ur_algo_attributes WHERE key = v_key;',
'              IF v_exists = 0 THEN',
'                INSERT INTO ur_algo_attributes (',
'                  id, algo_id, hotel_id, name, key, data_type, description, type, value, template_id, attribute_qualifier,',
'                  created_by, updated_by, created_on, updated_on',
'                ) VALUES (',
'                  SYS_GUID(), NULL, v_hotel_id, l_col_name, v_key, NVL(UPPER(rec.data_type), ''NUMBER''),',
'                  NULL, ''S'', ',
'                  ''#'' || v_key || ''#'', -- Value wrapped in #',
'                  v_template_id, rec.qualifier,',
'                  v_user_id, v_user_id, SYSDATE, SYSDATE',
'                );',
'                v_insert_count := v_insert_count + 1;',
'              END IF;',
'            END;',
'          END LOOP;',
'        END IF;',
'',
'        COMMIT;',
'        p_status := TRUE;',
'        p_message := ''Success: '' || v_insert_count || '' attribute''',
'                   || CASE WHEN v_insert_count = 1 THEN '''' ELSE ''s'' END',
'                   || '' inserted for template_key '' || p_template_key;',
'',
'      ELSIF p_mode = ''D'' THEN',
'        -- Delete logic remains unchanged',
'        IF p_attribute_key IS NOT NULL THEN',
'          IF p_attribute_key LIKE v_db_object_name || ''.%'' OR p_attribute_key LIKE v_db_view_object_name || ''.%'' THEN',
'            DELETE FROM ur_algo_attributes WHERE key = p_attribute_key;',
'            v_delete_count := SQL%ROWCOUNT;',
'            COMMIT;',
'            p_status := TRUE;',
'            IF v_delete_count > 0 THEN',
'              p_message := ''Success: '' || v_delete_count || '' attribute deleted with key '' || p_attribute_key;',
'            ELSE',
'              p_message := ''Info: No attribute found to delete with key '' || p_attribute_key;',
'            END IF;',
'          ELSE',
'            p_status := FALSE;',
'            p_message := ''Failure: Attribute key does not belong to template '' || p_template_key;',
'          END IF;',
'        ELSE',
'          DELETE FROM ur_algo_attributes WHERE template_id = v_template_id; -- Safer delete by template_id',
'          v_delete_count := SQL%ROWCOUNT;',
'          COMMIT;',
'          p_status := TRUE;',
'          p_message := ''Success: '' || v_delete_count || '' attribute''',
'                       || CASE WHEN v_delete_count = 1 THEN '''' ELSE ''s'' END',
'                       || '' deleted for template_key '' || p_template_key;',
'        END IF;',
'',
'      ELSIF p_mode = ''U'' THEN',
'        p_status := FALSE;',
'        p_message := ''Update mode not yet implemented'';',
'',
'      ELSE',
'        p_status := FALSE;',
'        p_message := ''Invalid mode: '' || p_mode || ''. Valid modes are C, U, D.'';',
'      END IF;',
'',
'    EXCEPTION',
'      WHEN OTHERS THEN',
'        ROLLBACK;',
'        p_status := FALSE;',
'        p_message := ''Failure: '' || SQLERRM;',
'    END manage_algo_attributes;',
'',
'    --------------------------------------------------------------------------------',
'',
'    PROCEDURE add_alert(',
'        p_existing_json IN  CLOB,',
'        p_message       IN  VARCHAR2,',
'        p_icon          IN  VARCHAR2 DEFAULT NULL,',
'        p_title         IN  VARCHAR2 DEFAULT NULL,',
'        p_timeout       IN  NUMBER   DEFAULT NULL,',
'        p_updated_json  OUT CLOB',
'    ) IS',
'        l_json_array json_array_t;',
'        l_new_object json_object_t;',
'    BEGIN',
'        -- Create the new JSON object',
'        l_new_object := new json_object_t();',
'        l_new_object.put(''message'', p_message);',
'        l_new_object.put(''icon'', nvl(p_icon, ''success''));',
'        l_new_object.put(''title'', nvl(p_title, ''''));',
'',
'        IF p_timeout IS NOT NULL THEN',
'            l_new_object.put(''timeOut'', to_char(p_timeout));',
'        END IF;',
'',
'        -- Append the new object to the existing array or create a new array',
'        IF p_existing_json IS NULL OR trim(p_existing_json) = '''' THEN',
'            -- Create a new array with the new object',
'            l_json_array := new json_array_t();',
'        ELSE',
'            -- Parse the existing JSON string into a JSON array',
'            l_json_array := json_array_t(p_existing_json);',
'        END IF;',
'',
'        -- Append the new object',
'        l_json_array.append(l_new_object);',
'',
'        -- Convert the JSON array back to a CLOB',
'        p_updated_json := l_json_array.to_clob;',
'    END add_alert;',
'',
'    --------------------------------------------------------------------------------',
'',
'    PROCEDURE validate_expression(',
'        p_expression IN  VARCHAR2,',
'        p_mode       IN  CHAR,',
'        p_hotel_id   IN  VARCHAR2,',
'        p_status     OUT VARCHAR2, -- ''S'' or ''E''',
'        p_message    OUT VARCHAR2',
'    ) IS',
'        TYPE t_str_list IS TABLE OF VARCHAR2(100) INDEX BY PLS_INTEGER;',
'        v_attributes         t_str_list;',
'        v_functions          t_str_list;',
'        v_operators          t_str_list;',
'        v_attr_count         NUMBER := 0;',
'        v_func_count         NUMBER := 0;',
'        v_oper_count         NUMBER := 0;',
'',
'        TYPE t_token_rec IS RECORD(',
'            token     VARCHAR2(4000),',
'            start_pos PLS_INTEGER,',
'            end_pos   PLS_INTEGER',
'        );',
'        TYPE t_token_tab IS TABLE OF t_token_rec INDEX BY PLS_INTEGER;',
'        v_tokens             t_token_tab;',
'        v_token_count        PLS_INTEGER := 0;',
'',
'        TYPE t_token_tab_nt IS TABLE OF VARCHAR2(100) INDEX BY PLS_INTEGER;',
'        v_unmatched_tokens   t_token_tab;',
'        v_unmatched_count    PLS_INTEGER := 0;',
'',
'        -- To mark tokens consumed by multi-word operators',
'        TYPE t_bool_tab IS TABLE OF BOOLEAN INDEX BY PLS_INTEGER;',
'        v_token_consumed     t_bool_tab;',
'',
'        v_mode               CHAR := UPPER(p_mode);',
'',
'        -- Trim and uppercase token helper',
'        FUNCTION normalize_token(p_token VARCHAR2) RETURN VARCHAR2 IS',
'        BEGIN',
'            RETURN UPPER(TRIM(p_token));',
'        END;',
'',
'        -- Strip function parameters, e.g. "ROUND (n,d)" -> "ROUND"',
'        FUNCTION normalize_func_name(p_func VARCHAR2) RETURN VARCHAR2 IS',
'        BEGIN',
'            RETURN REGEXP_REPLACE(UPPER(TRIM(p_func)), ''\s*\(.*\)$'');',
'        END;',
'',
'        -- Checks if token is numeric',
'        FUNCTION is_number(p_token VARCHAR2) RETURN BOOLEAN IS',
'        BEGIN',
'            RETURN REGEXP_LIKE(p_token, ''^[+-]?(\d+(\.\d*)?|\.\d+)([Ee][+-]?\d+)?$'');',
'        END;',
'',
'        -- Check presence in list',
'        FUNCTION is_in_list(',
'            p_token VARCHAR2,',
'            p_list  t_str_list,',
'            cnt     NUMBER',
'        ) RETURN BOOLEAN IS',
'        BEGIN',
'            FOR i IN 1..cnt LOOP',
'                IF p_list(i) = p_token THEN',
'                    RETURN TRUE;',
'                END IF;',
'            END LOOP;',
'            RETURN FALSE;',
'        END;',
'',
'        -- Check if token valid: attribute, operator, function, number, parentheses',
'        FUNCTION is_token_valid(p_token VARCHAR2) RETURN BOOLEAN IS',
'            l_token VARCHAR2(100) := p_token;',
'        BEGIN',
'            -- Parentheses always valid tokens',
'            IF l_token IN (''('', '')'') THEN',
'                RETURN TRUE;',
'            END IF;',
'',
'            -- Strip trailing ''('' from function calls',
'            IF SUBSTR(l_token, -1) = ''('' THEN',
'                l_token := SUBSTR(l_token, 1, LENGTH(l_token) - 1);',
'            END IF;',
'',
'            -- Check if number',
'            IF is_number(l_token) THEN',
'                RETURN TRUE;',
'            END IF;',
'',
'            l_token := normalize_token(l_token);',
'',
'            IF is_in_list(l_token, v_attributes, v_attr_count) THEN',
'                RETURN TRUE;',
'            ELSIF is_in_list(l_token, v_functions, v_func_count) THEN',
'                RETURN TRUE;',
'            ELSIF is_in_list(l_token, v_operators, v_oper_count) THEN',
'                RETURN TRUE;',
'            END IF;',
'',
'            RETURN FALSE;',
'        END;',
'',
'        PROCEDURE load_functions(',
'            p_list  OUT t_str_list,',
'            p_count OUT NUMBER',
'        ) IS',
'        BEGIN',
'            p_list.DELETE;',
'            p_count := 0;',
'            FOR r IN (',
'                SELECT',
'                    return_value',
'                FROM',
'                    apex_application_lov_entries',
'                WHERE',
'                    list_of_values_name = ''UR EXPRESSION FUNCTIONS''',
'                ORDER BY',
'                    return_value',
'            ) LOOP',
'                p_count        := p_count + 1;',
'                p_list(p_count) := normalize_func_name(r.return_value);',
'            END LOOP;',
'            IF p_count = 0 THEN',
'                RAISE_APPLICATION_ERROR(-20010, ''Functions LOV missing or empty'');',
'            END IF;',
'        END;',
'',
'        PROCEDURE load_operators(',
'            p_list  OUT t_str_list,',
'            p_count OUT NUMBER',
'        ) IS',
'        BEGIN',
'            p_list.DELETE;',
'            p_count := 0;',
'            FOR r IN (',
'                SELECT',
'                    return_value',
'                FROM',
'                    apex_application_lov_entries',
'                WHERE',
'                    list_of_values_name = ''UR EXPRESSION OPERATORS''',
'                ORDER BY',
'                    return_value',
'            ) LOOP',
'                p_count        := p_count + 1;',
'                p_list(p_count) := UPPER(TRIM(r.return_value));',
'            END LOOP;',
'            IF p_count = 0 THEN',
'                RAISE_APPLICATION_ERROR(-20011, ''Operators LOV missing or empty'');',
'            END IF;',
'        END;',
'',
'        PROCEDURE load_attributes(',
'            p_hotel_id IN  VARCHAR2,',
'            p_list     OUT t_str_list,',
'            p_count    OUT NUMBER',
'        ) IS',
'        BEGIN',
'            p_list.DELETE;',
'            p_count := 0;',
'            FOR r IN (',
'                SELECT',
'                    key',
'                FROM',
'                    ur_algo_attributes',
'                WHERE',
'                    hotel_id = p_hotel_id',
'            ) LOOP',
'                p_count        := p_count + 1;',
'                p_list(p_count) := UPPER(TRIM(r.key));',
'            END LOOP;',
'            IF p_count = 0 THEN',
'                RAISE_APPLICATION_ERROR(-20012, ''Attributes missing for hotel_id '' || p_hotel_id);',
'            END IF;',
'        END;',
'',
'        -- Tokenizer splitting expression into tokens, tracking start/end pos',
'        PROCEDURE tokenize_expression(',
'            p_expr  IN  VARCHAR2,',
'            p_tokens OUT t_token_tab,',
'            p_count OUT NUMBER',
'        ) IS',
'            l_pos         PLS_INTEGER := 1;',
'            l_len         PLS_INTEGER := LENGTH(p_expr);',
'            l_token       VARCHAR2(4000);',
'            l_token_start PLS_INTEGER;',
'            l_token_end   PLS_INTEGER;',
'        BEGIN',
'            p_tokens.DELETE;',
'            p_count := 0;',
'            WHILE l_pos <= l_len LOOP',
'                l_token := REGEXP_SUBSTR(',
'                    p_expr,',
'                    ''([A-Za-z0-9_\.]+|\d+(\.\d+)?|\(|\)|\S)'',',
'                    l_pos,',
'                    1,',
'                    ''i''',
'                );',
'                EXIT WHEN l_token IS NULL;',
'                l_token_start := INSTR(p_expr, l_token, l_pos);',
'                l_token_end   := l_token_start + LENGTH(l_token) - 1;',
'                p_count       := p_count + 1;',
'                p_tokens(p_count) := t_token_rec(token => l_token, start_pos => l_token_start, end_pos => l_token_end);',
'                l_pos         := l_token_end + 1;',
'                WHILE l_pos <= l_len AND SUBSTR(p_expr, l_pos, 1) = '' '' LOOP',
'                    l_pos := l_pos + 1;',
'                END LOOP;',
'            END LOOP;',
'        END;',
'',
'        FUNCTION build_json_errors(',
'            p_unmatched t_token_tab,',
'            p_count     PLS_INTEGER',
'        ) RETURN VARCHAR2 IS',
'            v_json VARCHAR2(4000) := ''['';',
'        BEGIN',
'            IF p_count = 0 THEN',
'                RETURN ''[]'';',
'            END IF;',
'            FOR i IN 1..p_count LOOP',
'                v_json := v_json || ''{"token":"'' || p_unmatched(i).token ||',
'                          ''","start":'' || p_unmatched(i).start_pos ||',
'                          '',"end":'' || p_unmatched(i).end_pos || ''}'';',
'                IF i < p_count THEN',
'                    v_json := v_json || '','';',
'                END IF;',
'            END LOOP;',
'            v_json := v_json || '']'';',
'            RETURN v_json;',
'        END;',
'',
'        -- Return number of consecutive tokens matched as an operator starting at start_idx',
'        FUNCTION get_longest_operator_match(start_idx IN PLS_INTEGER) RETURN PLS_INTEGER IS',
'            combined      VARCHAR2(4000);',
'            max_words     CONSTANT PLS_INTEGER := 4; -- max operator words count',
'            words_count   PLS_INTEGER;',
'            l_len         PLS_INTEGER := LEAST(max_words, v_token_count - start_idx + 1);',
'            i             PLS_INTEGER;',
'        BEGIN',
'            FOR words_count IN REVERSE 1..l_len LOOP',
'                combined := '''';',
'                FOR i IN start_idx..start_idx + words_count - 1 LOOP',
'                    IF combined IS NULL OR combined = '''' THEN',
'                        combined := UPPER(TRIM(v_tokens(i).token));',
'                    ELSE',
'                        combined := combined || '' '' || UPPER(TRIM(v_tokens(i).token));',
'                    END IF;',
'                END LOOP;',
'                IF is_in_list(combined, v_operators, v_oper_count) THEN',
'                    RETURN words_count;',
'                END IF;',
'            END LOOP;',
'            RETURN 0;',
'        END;',
'',
'    BEGIN',
'        p_status  := ''E'';',
'        p_message := NULL;',
'',
'        IF v_mode NOT IN (''V'', ''C'') THEN',
'            p_status  := ''E'';',
'            p_message := ''Invalid mode "'' || p_mode || ''". Valid are V or C.'';',
'            RETURN;',
'        END IF;',
'',
'        IF p_hotel_id IS NULL THEN',
'            p_status  := ''E'';',
'            p_message := ''hotel_id is mandatory'';',
'            RETURN;',
'        END IF;',
'',
'        IF p_expression IS NULL OR LENGTH(TRIM(p_expression)) = 0 THEN',
'            p_status  := ''E'';',
'            p_message := ''Expression is empty'';',
'            RETURN;',
'        END IF;',
'',
'        load_functions(v_functions, v_func_count);',
'        load_operators(v_operators, v_oper_count);',
'        load_attributes(p_hotel_id, v_attributes, v_attr_count);',
'',
'        tokenize_expression(p_expression, v_tokens, v_token_count);',
'',
'        -- Initialize consumed array',
'        v_token_consumed.DELETE;',
'',
'        DECLARE',
'            i             PLS_INTEGER := 1;',
'            words_matched PLS_INTEGER := 0;',
'        BEGIN',
'            WHILE i <= v_token_count LOOP',
'                words_matched := get_longest_operator_match(i);',
'                IF words_matched > 0 THEN',
'                    FOR j IN i..i + words_matched - 1 LOOP',
'                        v_token_consumed(j) := TRUE;',
'                    END LOOP;',
'                    i := i + words_matched;',
'                ELSE',
'                    -- Single token valid check',
'                    v_token_consumed(i) := is_token_valid(normalize_token(v_tokens(i).token));',
'                    i                   := i + 1;',
'                END IF;',
'            END LOOP;',
'        END;',
'',
'        IF v_mode = ''V'' THEN',
'            v_unmatched_tokens.DELETE;',
'            v_unmatched_count := 0;',
'            FOR i IN 1..v_token_count LOOP',
'                IF v_token_consumed.EXISTS(i) AND v_token_consumed(i) = FALSE THEN',
'                    v_unmatched_count                       := v_unmatched_count + 1;',
'                    v_unmatched_tokens(v_unmatched_count) := v_tokens(i);',
'                END IF;',
'            END LOOP;',
'',
'            IF v_unmatched_count > 0 THEN',
'                p_status  := ''E'';',
'                p_message := ''Invalid tokens: '' || build_json_errors(v_unmatched_tokens, v_unmatched_count);',
'            ELSE',
'                p_status  := ''S'';',
'                p_message := ''Expression validated successfully.'';',
'            END IF;',
'',
'        ELSIF v_mode = ''C'' THEN',
'            p_status  := ''S'';',
'            p_message := '''';',
'            FOR i IN 1..v_token_count LOOP',
'                IF v_token_consumed.EXISTS(i) AND v_token_consumed(i) = TRUE THEN',
'                    p_message := p_message || v_tokens(i).token || '' '';',
'                END IF;',
'            END LOOP;',
'            p_message := RTRIM(p_message);',
'        END IF;',
'',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            p_status  := ''E'';',
'            p_message := ''Failure: '' || SQLERRM;',
'    END validate_expression;',
'',
'END ur_utils;',
'/',
'create or replace PACKAGE BODY ur_utils_test IS',
'',
'    FUNCTION Clean_TEXT(p_text IN VARCHAR2) RETURN VARCHAR2 IS',
'      v_clean VARCHAR2(4000);',
'    BEGIN',
'      v_clean := UPPER(',
'                   SUBSTR(',
'                     REGEXP_REPLACE(',
'                       REGEXP_REPLACE(',
'                         REGEXP_REPLACE(',
'                           TRIM(p_text),',
'                           ''^[^A-Za-z0-9]+|[^A-Za-z0-9]+$'', ''''',
'                         ),',
'                         ''[^A-Za-z0-9]+'', ''_''',
'                       ),',
'                       ''_+'', ''_''',
'                     ),',
'                     1, 110',
'                   )',
'                 );',
'      RETURN v_clean;',
'    END Clean_TEXT;',
'',
'FUNCTION normalize_json (p_json CLOB) RETURN CLOB IS',
'BEGIN',
'  RETURN REPLACE(REPLACE(p_json, ''"data-type"'', ''"data_type"''), ''"DATA-TYPE"'', ''"data_type"'');',
'END normalize_json;',
'',
'  PROCEDURE get_collection_json(',
'    p_collection_name IN VARCHAR2,',
'    p_json_clob OUT CLOB,',
'    p_status OUT BOOLEAN,',
'    p_message OUT VARCHAR2',
'  ) IS',
'    l_count NUMBER;',
'  BEGIN',
'    SELECT COUNT(*)',
'      INTO l_count',
'      FROM apex_collections',
'     WHERE collection_name = p_collection_name;',
'',
'    IF l_count = 0 THEN',
'      p_status := FALSE;',
'      p_message := ''Failure: Collection "'' || p_collection_name || ''" does not exist or is empty'';',
'      p_json_clob := NULL;',
'      RETURN;',
'    END IF;',
'',
'    -- Initialize and build JSON output',
'    apex_json.initialize_clob_output;',
'    apex_json.open_array;',
'',
'    FOR rec IN (',
'      SELECT c001, c002, c003',
'        FROM apex_collections',
'       WHERE collection_name = p_collection_name',
'       ORDER BY seq_id',
'    )',
'    LOOP',
'      apex_json.open_object;',
'      apex_json.write(''name'', rec.c001);',
'      apex_json.write(''data_type'', rec.c002);',
'      apex_json.write(''qualifier'', rec.c003);',
'      apex_json.close_object;',
'    END LOOP;',
'',
'    apex_json.close_array;',
'',
'    p_json_clob := apex_json.get_clob_output;',
'',
'    apex_json.free_output;',
'',
'    p_status := TRUE;',
'    p_message := ''Success: JSON generated for collection "'' || p_collection_name || ''"'';',
'',
'  EXCEPTION',
'    WHEN OTHERS THEN',
'      p_status := FALSE;',
'      p_message := ''Failure: '' || SQLERRM;',
'      p_json_clob := NULL;',
'  END get_collection_json;',
'',
'',
'',
' PROCEDURE define_db_object(',
'    p_template_key IN VARCHAR2,',
'    p_status OUT BOOLEAN,',
'    p_message OUT VARCHAR2',
') IS',
'    v_db_object_name VARCHAR2(30);',
'    v_sql            CLOB;',
'    v_col_defs       CLOB := '''';',
'    v_unique_defs    CLOB := '''';',
'    v_definition     CLOB;',
'    v_exists         NUMBER;',
'    v_trigger_name   VARCHAR2(130);',
'    l_col_name       VARCHAR2(100);',
'BEGIN',
'    -- Lock row in UR_TEMPLATES and get DB_OBJECT_NAME and definition',
'    SELECT db_object_name, definition',
'    INTO v_db_object_name, v_definition',
'    FROM ur_templates',
'    WHERE key = p_template_key',
'    FOR UPDATE;',
'',
'    IF v_db_object_name IS NOT NULL THEN',
'      p_status := FALSE;',
'      p_message := ''Failure: Table already defined as '' || v_db_object_name;',
'      RETURN;',
'    END IF;',
'',
'    IF v_definition IS NULL THEN',
'      p_status := FALSE;',
'      p_message := ''Failure: Definition JSON is NULL for template_key '' || p_template_key;',
'      RETURN;',
'    END IF;',
'',
'    -- Generate table name (adjust prefix as needed)',
'    v_db_object_name := ''UR_'' || UPPER(p_template_key) || ''_T'';',
'',
'    -- Check if table exists',
'    SELECT COUNT(*)',
'    INTO v_exists',
'    FROM all_tables',
'    WHERE table_name = UPPER(v_db_object_name);',
'',
'    IF v_exists > 0 THEN',
'      p_status := FALSE;',
'      p_message := ''Failure: Table '' || v_db_object_name || '' already exists in schema'';',
'      RETURN;',
'    END IF;',
'',
'    -- Start with ID RAW(16) as primary key column',
'    v_col_defs := ''"REC_ID" RAW(16)'';',
'',
'    -- Parse JSON and build column definitions',
'    FOR rec IN (',
'      SELECT jt.name, jt.data_type, jt.qualifier',
'      FROM JSON_TABLE(',
'  normalize_json(v_definition),',
'  ''$[*]'' COLUMNS (',
'    name       VARCHAR2(100) PATH ''$.name'',',
'    data_type  VARCHAR2(30)  PATH ''$.data_type'',',
'    qualifier  VARCHAR2(30)  PATH ''$.qualifier''',
'  )',
') jt',
'',
'    )',
'    LOOP',
'      -- sanitize column name: trim underscores and collapse multiple',
'      l_col_name := UPPER(TRIM(BOTH ''_'' FROM rec.name));',
'      l_col_name := REGEXP_REPLACE(l_col_name, ''_{2,}'', ''_'');',
'',
'      v_col_defs := v_col_defs || '', '';',
'',
'      -- Map data type including DATE',
'      IF UPPER(rec.data_type) = ''TEXT'' THEN',
'        v_col_defs := v_col_defs || ''"'' || l_col_name || ''" VARCHAR2(4000)'';',
'      ELSIF UPPER(rec.data_type) = ''NUMBER'' THEN',
'        v_col_defs := v_col_defs || ''"'' || l_col_name || ''" NUMBER'';',
'      ELSIF UPPER(rec.data_type) = ''DATE'' THEN',
'        v_col_defs := v_col_defs || ''"'' || l_col_name || ''" DATE'';',
'      ELSE',
'        -- Default to VARCHAR2 for unknown type',
'        v_col_defs := v_col_defs || ''"'' || l_col_name || ''" VARCHAR2(4000)'';',
'      END IF;',
'',
'      -- Collect STAY_DATE constraint definitions',
'      IF UPPER(rec.qualifier) = ''STAY_DATE'' THEN',
'        v_unique_defs := v_unique_defs ',
'          || '', CONSTRAINT "'' || v_db_object_name || ''_'' || l_col_name || ''_UQ" UNIQUE ("'' || l_col_name || ''")'';',
'      END IF;',
'    END LOOP;',
'',
'    -- Add WHO columns + HOTEL_ID RAW(16)',
'    v_col_defs := v_col_defs',
'      || '', CREATED_BY RAW(16), UPDATED_BY RAW(16), CREATED_ON DATE, UPDATED_ON DATE, HOTEL_ID RAW(16), INTERFACE_LOG_ID RAW(16)'';',
'',
'    -- Build final CREATE TABLE DDL',
'    v_sql := ''CREATE TABLE "'' || v_db_object_name || ''" ('' ',
'        || v_col_defs ',
'        || '', CONSTRAINT "'' || v_db_object_name || ''_PK" PRIMARY KEY ("REC_ID")''',
'        || v_unique_defs',
'        || '')'';',
'',
'    EXECUTE IMMEDIATE v_sql;',
'',
'    -- Create trigger to auto-generate ID (if NULL) using SYS_GUID()',
'    v_trigger_name := v_db_object_name || ''_BI_TRG'';',
'',
'    v_sql := ''',
'CREATE OR REPLACE EDITIONABLE TRIGGER "'' || v_trigger_name || ''"',
'BEFORE INSERT OR UPDATE ON "'' || v_db_object_name || ''"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE US'))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'ER_NAME = SYS_CONTEXT(''''APEX$SESSION'''', ''''APP_USER'''');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END '' || v_trigger_name || '';',
''';',
'',
'    EXECUTE IMMEDIATE v_sql;',
'',
'    -- Update UR_TEMPLATES with the new db_object_name and timestamp',
'    UPDATE ur_templates',
'    SET db_object_name = v_db_object_name,',
'        db_object_created_on = SYSDATE',
'    WHERE key = p_template_key;',
'',
'    COMMIT;',
'',
'    p_status := TRUE;',
'    p_message := ''Success: Table "'' || v_db_object_name || ''" created with ID primary key and trigger'';',
'EXCEPTION',
'    WHEN NO_DATA_FOUND THEN',
'      p_status := FALSE;',
'      p_message := ''Failure: Template key not found'';',
'    WHEN OTHERS THEN',
'      p_status := FALSE;',
'      p_message := ''Failure: '' || SQLERRM;',
'END define_db_object;',
'',
'',
'PROCEDURE LOAD_DATA_MAPPING_COLLECTION (',
'    p_file_id         IN  VARCHAR2,',
'    p_template_id    IN  VARCHAR2,',
'    p_collection_name IN  VARCHAR2,',
'    p_status          OUT VARCHAR2,',
'    p_message         OUT VARCHAR2',
') IS',
'',
'    -- Local variables',
'    v_seq_id NUMBER;',
'',
'BEGIN',
'    -- Initialize outputs',
'    p_status := ''S'';',
'    p_message := ''Processing completed successfully.'';',
'',
'    ------------------------------------------------------------------------',
'    -- Step 1: Create or truncate the APEX collection',
'    ------------------------------------------------------------------------',
'    BEGIN',
'        IF APEX_COLLECTION.COLLECTION_EXISTS(p_collection_name) THEN',
'            APEX_COLLECTION.DELETE_COLLECTION(p_collection_name);',
'        END IF;',
'',
'        APEX_COLLECTION.CREATE_COLLECTION(p_collection_name);',
'',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            p_status := ''E'';',
'            p_message := ''Failed to create or truncate collection "'' || p_collection_name || ''": '' || SQLERRM;',
'            RETURN;',
'    END;',
'',
'    ------------------------------------------------------------------------',
'    -- Step 2: Insert data from TEMP_BLOB JSON into collection (c001)',
'    ------------------------------------------------------------------------',
'    BEGIN',
'        FOR rec IN (',
'            SELECT jt.name || '' ('' || jt.data_type || '')'' AS column_desc, jt.col_position',
'            FROM TEMP_BLOB t,',
'                 JSON_TABLE(',
'    normalize_json(t.columns),',
'    ''$[*]'' COLUMNS (',
'       name      VARCHAR2(100) PATH ''$.name'',',
'       data_type VARCHAR2(100) PATH ''$.data_type'',',
'       col_position VARCHAR2(100) PATH ''$.pos''',
'    )',
'',
'                 ) jt',
'            WHERE t.id = p_file_id',
'        ) LOOP',
'            APEX_COLLECTION.ADD_MEMBER(',
'                p_collection_name => p_collection_name,',
'                p_c001            => rec.column_desc,',
'                p_c004            => rec.col_position',
'            );',
'        END LOOP;',
'',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            p_status := ''E'';',
'            p_message := ''Failed to insert data from TEMP_BLOB (File ID: '' || p_file_id || ''): '' || SQLERRM;',
'            RETURN;',
'    END;',
'',
'    ------------------------------------------------------------------------',
'    -- Step 3: Update existing collection members with matching data from UR_TEMPLATES (c002, c003)',
'    ------------------------------------------------------------------------',
'    BEGIN',
'        FOR rec IN (',
'            SELECT jt.name || '' ('' || jt.data_type || '')'' AS column_desc',
'            FROM UR_TEMPLATES t,',
'                 JSON_TABLE(',
'    normalize_json(t.definition),',
'    ''$[*]'' COLUMNS (',
'       name      VARCHAR2(100) PATH ''$.name'',',
'       data_type VARCHAR2(100) PATH ''$.data_type''',
'    )',
')',
' jt',
'            WHERE t.id = p_template_id',
'            ORDER BY t.id DESC',
'        ) LOOP',
'            BEGIN',
'                -- Find the seq_id for matching collection member',
'                SELECT seq_id ',
'                INTO v_seq_id',
'                FROM apex_collections',
'                WHERE collection_name = p_collection_name',
'                  AND c001 = rec.column_desc;',
'',
'                -- Update c002 and c003 attributes',
'                APEX_COLLECTION.UPDATE_MEMBER_ATTRIBUTE(',
'                    p_collection_name => p_collection_name,',
'                    p_seq             => v_seq_id,',
'                    p_attr_number     => 2,',
'                    p_attr_value      => rec.column_desc',
'                );',
'',
'                APEX_COLLECTION.UPDATE_MEMBER_ATTRIBUTE(',
'                    p_collection_name => p_collection_name,',
'                    p_seq             => v_seq_id,',
'                    p_attr_number     => 3,',
'                    p_attr_value      => ''Maps To''',
'                );',
'                ',
'                  ',
'',
'',
'            EXCEPTION',
'                WHEN NO_DATA_FOUND THEN',
unistr('                    -- No matching collection member found \2014 ignore gracefully'),
'                    NULL;',
'                WHEN OTHERS THEN',
'                    p_status := ''E'';',
'                    p_message := ''Failed to update member attribute in collection "'' || p_collection_name || ''" for "'' ',
'                                 || rec.column_desc || ''": '' || SQLERRM;',
'                    RETURN;',
'            END;',
'        END LOOP;',
'',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            p_status := ''E'';',
'            p_message := ''Failed to update collection members from UR_TEMPLATES (ID: '' || p_template_id || ''): '' || SQLERRM;',
'            RETURN;',
'    END;',
'',
'EXCEPTION',
'    WHEN OTHERS THEN',
'        p_status := ''E'';',
'        p_message := ''Unexpected error occurred: '' || SQLERRM;',
'END LOAD_DATA_MAPPING_COLLECTION;',
'',
'PROCEDURE Load_Data (',
'    p_file_id         IN  NUMBER,',
'    p_template_key    IN  VARCHAR2,',
'    p_hotel_id        IN  RAW,',
'    p_collection_name IN  VARCHAR2,',
'    p_status          OUT boolean,',
'    p_message         OUT VARCHAR2',
') IS',
'    l_blob        BLOB;',
'    l_file_name   VARCHAR2(255);',
'    l_table_name  VARCHAR2(255);',
'    l_template_id RAW(16);',
'    l_total_rows  NUMBER := 0;',
'    l_success_cnt NUMBER := 0;',
'    l_fail_cnt    NUMBER := 0;',
'    l_log_id      RAW(16);',
'    l_error_json  CLOB := ''['';',
'    l_first_err   BOOLEAN := TRUE;',
'    l_collection_name VARCHAR2(255);',
'    l_debug boolean := FALSE;',
'',
'    -- mapping record type',
'    TYPE t_map_rec IS RECORD (',
'        src_col     VARCHAR2(128),  ',
'        tgt_col     VARCHAR2(128),  ',
'        parser_col  VARCHAR2(20),   ',
'        data_type   VARCHAR2(50)',
'    );',
'    TYPE t_map IS TABLE OF t_map_rec INDEX BY VARCHAR2(128);',
'',
'    l_mapping   t_map;',
'    l_apex_user VARCHAR2(255) := NVL(v(''APP_USER''),''APEX_USER'');',
'',
'    l_cols   VARCHAR2(32767);',
'    l_vals_calculation   VARCHAR2(32767);',
'    l_sql    CLOB;',
'    k        VARCHAR2(128);',
'    v_expr   VARCHAR2(4000);',
'    l_map_count NUMBER;',
'    l_table_name_1 varchar2(480) := ''UR_VK_NEW_CHINAR_T_INTERFACE'';',
'    l_update_1 CLOB;',
'    l_sql_temp clob;',
'    l_sql_select clob;',
'',
'    -- ADDED: variable for duplicate check',
'    l_existing_cnt NUMBER;',
'    v_cursor   INTEGER;',
'    v_cols     VARCHAR2(1000) := ''hotel_id, booking_id, number_of_rooms'';',
'    v_desc_tab DBMS_SQL.DESC_TAB;',
'    v_col_cnt  INTEGER;',
'    v_value    VARCHAR2(4000);',
'    v_col_val  VARCHAR2(4000);',
'    v_status   INTEGER;',
'BEGIN',
'  XX_LOCAL_Load_Data (',
'    p_file_id         => p_file_id        ',
'    ,p_template_key    => p_template_key   ',
'    ,p_hotel_id        => p_hotel_id       ',
'    ,p_collection_name => p_collection_name',
'    ,p_status          => p_status         ',
'    ,p_message         => p_message        ',
');',
'',
'EXCEPTION',
'    WHEN OTHERS THEN',
'        DECLARE',
'            l_err_msg VARCHAR2(4000);',
'        BEGIN',
'            l_err_msg := SQLERRM;',
'',
'            p_status  := FALSE;',
'            p_message := ''Failure: ''|| l_err_msg;',
'',
'            UPDATE ur_interface_logs',
'               SET load_end_time = systimestamp,',
'                   load_status   = ''FAILED'',',
'                   error_json    = l_error_json || ''{"error":"'' || REPLACE(l_err_msg,''"'','''''''') || ''"}]'',',
'                   updated_on    = sysdate',
'             WHERE id = l_log_id;',
'',
'            ROLLBACK;',
'        END;',
'',
'',
'END Load_Data;',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'PROCEDURE fetch_templates(',
'    p_file_id      IN NUMBER,',
'    p_hotel_id     IN VARCHAR2,',
'    p_min_score    IN NUMBER DEFAULT 90,',
'    p_debug_flag   IN VARCHAR2 DEFAULT ''N'',',
'    p_output_json  OUT CLOB,',
'    p_status       OUT VARCHAR2,',
'    p_message      OUT VARCHAR2',
') IS',
'    -- Local types',
'    TYPE t_name_type_rec IS RECORD(',
'        name       VARCHAR2(100),',
'        data_type  VARCHAR2(30)',
'    );',
'    TYPE t_name_type_tab IS TABLE OF t_name_type_rec;',
'',
'    TYPE t_template_rec IS RECORD(',
'        id         VARCHAR2(50),',
'        name       VARCHAR2(200),',
'        definition t_name_type_tab',
'    );',
'    TYPE t_template_tab IS TABLE OF t_template_rec INDEX BY PLS_INTEGER;',
'',
'    -- Variables',
'    v_source_clob       CLOB;',
'    v_source_normalized CLOB;',
'    ',
'    v_target_id         VARCHAR2(50);',
'    v_target_name       VARCHAR2(200);',
'    v_target_def_clob   CLOB;',
'    v_target_normalized CLOB;',
'',
'    v_source_defs       t_name_type_tab := t_name_type_tab();',
'    v_target_defs       t_name_type_tab := t_name_type_tab();',
'',
'    v_templates         t_template_tab;',
'    v_count_templates   PLS_INTEGER := 0;',
'',
'    v_json_output       CLOB := ''['';',
'    v_min_score_use     NUMBER;',
'    v_separator         VARCHAR2(1) := '''';',
'',
'    v_match_count       NUMBER;',
'    v_score             NUMBER;',
'',
'    CURSOR c_targets IS',
'      SELECT ID, NAME, DEFINITION FROM UR_TEMPLATES WHERE hotel_id = p_hotel_id;',
'',
'    -- Debug procedure',
'    PROCEDURE debug(p_msg VARCHAR2) IS',
'    BEGIN',
'        IF UPPER(p_debug_flag) = ''Y'' THEN',
'            DBMS_OUTPUT.PUT_LINE(''[DEBUG] '' || p_msg);',
'        END IF;',
'    END;',
'',
'    -- Normalize data-type keys in JSON string (case sensitive replacement)',
'    FUNCTION normalize_json(p_json CLOB) RETURN CLOB IS',
'    BEGIN',
'        RETURN REPLACE(REPLACE(p_json, ''"data-type"'', ''"data_type"''), ''"DATA-TYPE"'', ''"data_type"'');',
'    END;',
'',
'    -- Parse definition JSON into PL/SQL collection',
'    FUNCTION parse_definition(p_clob CLOB) RETURN t_name_type_tab IS',
'        l_defs t_name_type_tab := t_name_type_tab();',
'        idx     PLS_INTEGER := 0;',
'    BEGIN',
'        FOR rec IN (',
'            SELECT lower(trim(name)) AS name, lower(trim(data_type)) AS data_type FROM JSON_TABLE(',
'                p_clob,',
'                ''$[*]'' COLUMNS (',
'                    name VARCHAR2(100) PATH ''$.name'',',
'                    data_type VARCHAR2(30) PATH ''$.data_type''',
'                )',
'            )',
'        ) LOOP',
'            idx := idx + 1;',
'            l_defs.EXTEND;',
'            l_defs(idx).name := rec.name;',
'            l_defs(idx).data_type := rec.data_type;',
'        END LOOP;',
'        RETURN l_defs;',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            RETURN NULL;',
'    END;',
'',
'    -- Count matches (name + data_type case-insensitive)',
'    FUNCTION count_matches(p_source t_name_type_tab, p_target t_name_type_tab) RETURN NUMBER IS',
'        v_count NUMBER := 0;',
'    BEGIN',
'        FOR i IN 1 .. p_source.COUNT LOOP',
'            FOR j IN 1 .. p_target.COUNT LOOP',
'                IF p_source(i).name = p_target(j).name AND p_source(i).data_type = p_target(j).data_type THEN',
'                    v_count := v_count + 1;',
'                    EXIT;',
'                END IF;',
'            END LOOP;',
'        END LOOP;',
'        RETURN v_count;',
'    END;',
'',
'BEGIN',
'    -- Validate inputs and assign to local variable',
'    v_min_score_use := NVL(p_min_score, 90);',
'    IF v_min_score_use < 0 OR v_min_score_use > 100 THEN',
'        v_min_score_use := 90;',
'    END IF;',
'',
'    IF p_file_id IS NULL THEN',
'        p_status := ''E'';',
'        p_message := ''File ID must be provided'';',
'        p_output_json := NULL;',
'        RETURN;',
'    END IF;',
'',
'    IF p_hotel_id IS NULL THEN',
'        p_status := ''E'';',
'        p_message := ''Hotel ID must be provided'';',
'        p_output_json := NULL;',
'        RETURN;',
'    END IF;',
'',
'    debug(''Starting processing...'');',
'    debug(''File ID: '' || p_file_id);',
'    debug(''Hotel ID: '' || p_hotel_id);',
'    debug(''Minimum Score: '' || v_min_score_use);',
'',
'    -- Fetch and normalize source CLOB',
'    BEGIN',
'        SELECT columns INTO v_source_clob FROM temp_blob WHERE id = p_file_id;',
'        IF v_source_clob IS NULL THEN',
'            p_status := ''E'';',
'            p_message := ''Source definition not found for file_id '' || p_file_id;',
'            p_output_json := NULL;',
'            RETURN;',
'        END IF;',
'    EXCEPTION',
'        WHEN NO_DATA_FOUND THEN',
'            p_status := ''E'';',
'            p_message := ''Source file not found for id '' || p_file_id;',
'            p_output_json := NULL;',
'            RETURN;',
'        WHEN OTHERS THEN',
'            p_status := ''E'';',
'            p_message := ''Error fetching source definition: '' || SQLERRM;',
'            p_output_json := NULL;',
'            RETURN;',
'    END;',
'',
'    v_source_normalized := normalize_json(v_source_clob);',
'',
'    -- Parse source defs',
'    v_source_defs := parse_definition(v_source_normalized);',
'    IF v_source_defs IS NULL OR v_source_defs.COUNT = 0 THEN',
'        p_status := ''E'';',
'        p_message := ''Cannot parse source definition JSON or empty definition'';',
'        p_output_json := NULL;',
'        RETURN;',
'    END IF;',
'    debug(''Parsed Source definitions: '' || v_source_defs.COUNT || '' fields'');',
'',
'    -- Initialize JSON output',
'    v_json_output := ''['';',
'    v_count_templates := 0;',
'',
'    -- Loop over target templates from cursor',
'    FOR r_target IN c_targets LOOP',
'        v_target_id := r_target.ID;',
'        v_target_name := r_target.NAME;',
'        v_target_def_clob := r_target.DEFINITION;',
'',
'        IF v_target_def_clob IS NULL THEN',
'            debug(''Skipping template '' || v_target_id || '' due to NULL definition'');',
'            CONTINUE;',
'        END IF;',
'',
'        v_target_normalized := normalize_json(v_target_def_clob);',
'',
'        v_target_defs := parse_definition(v_target_normalized);',
'        IF v_target_defs IS NULL OR v_target_defs.COUNT = 0 THEN',
'            debug(''Skipping template '' || v_target_id || '' due to parsing error or empty definition'');',
'            CONTINUE;',
'        END IF;',
'',
'        v_match_count := count_matches(v_source_defs, v_target_defs);',
'',
'        v_score := ROUND((2 * v_match_count) / (v_source_defs.COUNT + v_target_defs.COUNT) * 100);',
'',
'        debug(''Template '' || v_target_id || '' ('' || v_target_name || ''): Matches='' || ',
'              v_match_count || '', Score='' || v_score);',
'',
'        IF v_score >= v_min_score_use THEN',
'            IF v_count_templates > 0 THEN',
'                v_json_output := v_json_output || '','';',
'            END IF;',
'            v_json_output := v_json_output || ''{"Template_id":"'' || v_target_id || ',
'                            ''","Template_Name":"'' || REPLACE(v_target_name,''"'',''\"'') || ',
'                            ''","Score":'' || v_score || ''}'';',
'            v_count_templates := v_count_templates + 1;',
'        END IF;',
'    END LOOP;',
'',
'    v_json_output := v_json_output || '']'';',
'',
'    IF v_count_templates = 0 THEN',
'        p_output_json := ''[{}]'';',
'        p_message := ''No templates matched the minimum score threshold'';',
'        debug(''No matching templates found.'');',
'    ELSE',
'        p_output_json := v_json_output;',
'        p_message := ''Templates matched: '' || v_count_templates;',
'        debug(''Matching templates count: '' || v_count_templates);',
'    END IF;',
'',
'    p_status := ''S'';',
'',
'EXCEPTION',
'    WHEN OTHERS THEN',
'        p_status := ''E'';',
'        p_message := ''Unexpected error: '' || SQLERRM;',
'        p_output_json := NULL;',
'END fetch_templates;',
'',
'PROCEDURE DELETE_TEMPLATES (',
'    p_id            IN VARCHAR2 DEFAULT NULL,',
'    p_hotel_id      IN VARCHAR2 DEFAULT NULL,',
'    p_key           IN VARCHAR2 DEFAULT NULL,',
'    p_name          IN VARCHAR2 DEFAULT NULL,',
'    p_type          IN VARCHAR2 DEFAULT NULL,',
'    p_active        IN CHAR DEFAULT NULL,',
'    p_db_obj_empty  IN CHAR DEFAULT NULL,',
'    p_delete_all    IN CHAR DEFAULT ''N'',',
'    p_debug         IN CHAR DEFAULT ''N'',',
'    p_json_output   OUT CLOB',
'  )',
'  AS',
'    v_sql            VARCHAR2(1000);',
'    v_rows_count     NUMBER;',
'    v_status         CHAR(1);',
'    v_message        VARCHAR2(4000);',
'    v_json_list      CLOB := ''['';',
'    v_first          BOOLEAN := TRUE;',
'',
'    CURSOR c_templates IS',
'      SELECT id, hotel_id, key, name, type, active, db_object_name',
'      FROM ur_templates',
'      WHERE (p_delete_all = ''Y''',
'            OR (p_id IS NULL OR id = p_id))',
'        AND (p_delete_all = ''Y''',
'             OR (p_hotel_id IS NULL OR hotel_id = p_hotel_id))',
'        AND (p_delete_all = ''Y''',
'             OR (p_key IS NULL OR key = p_key))',
'        AND (p_delete_all = ''Y''',
'             OR (p_name IS NULL OR name = p_name))',
'        AND (p_delete_all = ''Y''',
'             OR (p_type IS NULL OR type = p_type))',
'        AND (p_delete_all = ''Y''',
'             OR (p_active IS NULL OR active = p_active));',
'',
'    -- Helper to escape JSON strings (basic)',
'    FUNCTION json_escape(str IN VARCHAR2) RETURN VARCHAR2 IS',
'    BEGIN',
'      RETURN REPLACE(REPLACE(REPLACE(REPLACE(str, ''\'', ''\\''), ''"'', ''\"''), CHR(10), ''\n''), CHR(13), '''');',
'    EXCEPTION WHEN OTHERS THEN',
'      RETURN '''';',
'    END;',
'',
'    PROCEDURE dbg(p_msg VARCHAR2) IS',
'    BEGIN',
'      IF p_debug = ''Y'' THEN',
'        apex_debug.message(p_msg);',
'      END IF;',
'    END;',
'',
'    PROCEDURE append_result (',
'      p_id            IN VARCHAR2,',
'      p_hotel_id      IN VARCHAR2,',
'      p_key           IN VARCHAR2,',
'      p_name          IN VARCHAR2,',
'      p_type          IN VARCHAR2,',
'      p_active        IN CHAR,',
'      p_db_obj_name   IN VARCHAR2,',
'      p_status        IN CHAR,',
'      p_message       IN VARCHAR2',
'    ) IS',
'    BEGIN',
'      IF v_first THEN',
'        v_first := FALSE;',
'      ELSE',
'        v_json_list := v_json_list || '','';',
'      END IF;',
'',
'      v_json_list := v_json_list || ''{'' ||',
'        ''"id":"''          || json_escape(p_id)          || ''",'' ||',
'        ''"hotel_id":"''    || json_escape(p_hotel_id)    || ''",'' ||',
'        ''"key":"''         || json_escape(p_key)         || ''",'' ||',
'        ''"name":"''        || json_escape(p_name)        || ''",'' ||',
'        ''"type":"''        || json_escape(p_type)        || ''",'' ||',
'        ''"active":"''      || json_escape(p_active)      || ''",'' ||',
'        ''"db_object_name":"'' || json_escape(p_db_obj_name) || ''",'' ||',
'        ''"status":"''      || json_escape(p_status)      || ''",'' ||',
'        ''"message":"''     || json_escape(p_message)     || ''"'' ||',
'      ''}'';',
'    END;',
'',
'  BEGIN',
'    dbg(''Started DELETE_TEMPLATES_AND_DB_OBJECTS_JSON procedure.'');',
'',
'    FOR rec IN c_templates LOOP',
'      dbg(''Processing template ID='' || rec.id || '', DB_OBJECT_NAME='' || rec.db_object_name);',
'',
'      IF rec.db_object_name IS NULL THEN',
'        v_status := ''E'';',
'        v_message := ''No DB_OBJECT_NAME specified for template, skipping.'';',
'        dbg(v_message);',
'        append_result(rec.id, rec.hotel_id, rec.key, rec.name, rec.type, rec.active, NULL, v_status, v_message);',
'        CONTINUE;',
'      END IF;',
'',
'      -- Check if table exists in user schema',
'    --   SELECT COUNT(*)',
'    --     INTO v_rows_count',
'    --     FROM all_tables',
'    --    WHERE table_name = rec.db_object_name',
'    --      AND owner = USER;',
'',
'    --   IF v_rows_count = 0 THEN',
'    --     v_status := ''E'';',
'    --     v_message := ''DB Object ['' || rec.db_object_name || ''] does not exist or is not a table.'';',
'    --     dbg(v_message);',
'    --     append_result(rec.id, rec.hotel_id, rec.key, rec.name, rec.type, rec.active, rec.db_object_name, v_status, v_message);',
'    --     CONTINUE;',
'    --   END IF;',
'',
'      -- Check if table should be empty before deleting',
'      IF p_db_obj_empty = ''Y'' THEN',
'        v_sql := ''SELECT COUNT(*) FROM '' || rec.db_object_name;',
'        BEGIN',
'          EXECUTE IMMEDIATE v_sql INTO v_rows_count;',
'        EXCEPTION',
'          WHEN OTHERS THEN',
'            v_rows_count := -1; -- can''t count, treat as error or non-empty',
'        END;',
'',
'        IF v_rows_count > 0 THEN',
'          v_status := ''E'';',
'          v_message := ''DB Object table ['' || rec.db_object_name || ''] is not empty (ROWS='' || v_rows_count || ''), skipping deletion.'';',
'          dbg(v_message);',
'          append_result(rec.id, rec.hotel_id, rec.key, rec.name, rec.type, rec.active, rec.db_object_name, v_status, v_message);',
'          CONTINUE;',
'        END IF;',
'        dbg(''DB Object table ['' || rec.db_object_name || ''] is empty, proceeding.'');',
'      END IF;',
'',
'      -- Try to drop the table and delete template',
'      BEGIN',
'        v_sql := ''DROP TABLE '' || rec.db_object_name || '' CASCADE CONSTRAINTS'';',
'        dbg(''Executing: '' || v_sql);',
'        EXECUTE IMMEDIATE v_sql;',
'',
'        dbg(''Dropped table '' || rec.db_object_name);',
'',
'        DELETE FROM ur_templates WHERE id = rec.id;',
'',
'        dbg(''Deleted template id='' || rec.id);',
'',
'        v_status := ''S'';',
'        v_message := ''Successfully dropped table and deleted template.'';',
'        append_result(rec.id, rec.hotel_id, rec.key, rec.name, rec.type, rec.active, rec.db_object_name, v_status, v_message);',
'',
'      EXCEPTION',
'        WHEN OTHERS THEN',
'          v_status := ''E'';',
'          v_message := ''Error dropping table or deleting template: '' || SQLERRM;',
'          dbg(v_message);',
'          append_result(rec.id, rec.hotel_id, rec.key, rec.name, rec.type, rec.active, rec.db_object_name, v_status, v_message);',
'      END;',
'    END LOOP;',
'',
'    v_json_list := v_json_list || '']'';',
'',
'    p_json_output := v_json_list;',
'',
'    dbg(''Completed DELETE_TEMPLATES_AND_DB_OBJECTS_JSON procedure.'');',
'  END DELETE_TEMPLATES;',
'',
'PROCEDURE manage_algo_attributes(',
'    p_template_key   IN  VARCHAR2,',
'    p_mode           IN  CHAR,',
'    p_attribute_key  IN  VARCHAR2 DEFAULT NULL,',
'    p_status         OUT BOOLEAN,',
'    p_message        OUT VARCHAR2',
') IS',
'  v_db_object_name UR_TEMPLATES.DB_OBJECT_NAME%TYPE;',
'  v_definition     UR_TEMPLATES.DEFINITION%TYPE;',
'  v_hotel_id       UR_TEMPLATES.HOTEL_ID%TYPE;',
'  v_user_id        RAW(16);',
'  v_insert_count   NUMBER := 0;',
'  v_delete_count   NUMBER := 0;',
'BEGIN',
'  -- Initialization',
'  p_status := FALSE;',
'  p_message := NULL;',
'',
'  -- Obtain needed data from UR_TEMPLATES',
'  BEGIN',
'    SELECT db_object_name, definition, hotel_id',
'    INTO v_db_object_name, v_definition, v_hotel_id',
'    FROM ur_templates',
'    WHERE key = p_template_key;',
'  EXCEPTION',
'    WHEN NO_DATA_FOUND THEN',
'      p_message := ''Failure: Template key not found: '' || p_template_key;',
'      RETURN;',
'  END;',
'',
'  IF v_db_object_name IS NULL THEN',
'    p_message := ''Failure: DB_OBJECT_NAME not defined for template_key '' || p_template_key;',
'    RETURN;',
'  END IF;',
'',
'  -- Get USER_ID once for audit columns',
'  BEGIN',
'    SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'  EXCEPTION',
'    WHEN NO_DATA_FOUND THEN',
'      v_user_id := NULL;',
'  END;',
'',
'  IF p_mode = ''C'' THEN',
'    IF v_definition IS NULL THEN',
'      p_message := ''Failure: Definition JSON is NULL for template_key '' || p_template_key;',
'      RETURN;',
'    END IF;',
'',
'    -- Insert attributes for all columns with qualifier <> ''UNIQUE''',
'    FOR rec IN (',
'      SELECT jt.name, jt.data_type, jt.qualifier',
'      FROM JSON_TABLE(',
'        v_definition,',
'        ''$[*]'' COLUMNS (',
'          name       VARCHAR2(100) PATH ''$.name'',',
'          data_type  VARCHAR2(30)  PATH ''$.data_type'',',
'          qualifier  VARCHAR2(30)  PATH ''$.qualifier''',
'        )',
'      ) jt',
'      WHERE jt.qualifier IS NOT NULL',
'        AND UPPER(jt.qualifier) <> ''UNIQUE''',
'    )',
'    LOOP',
'      DECLARE',
'        l_col_name VARCHAR2(150);',
'        v_key      VARCHAR2(150);',
'        v_exists   NUMBER;',
'      BEGIN',
'        -- Normalize column name (remove trailing underscores, spaces, upper-case)',
'    --  l_col_name := UPPER(TRIM(BOTH ''_'' FROM TRIM(rec.name)));',
'-- Normalize: trim spaces, collapse multiple underscores, and remove trailing underscores',
'l_col_name := UPPER(',
'                REGEXP_REPLACE(',
'                  TRIM(rec.name),      -- trim spaces',
'                  ''_+$'',               -- remove trailing underscores',
'                  ''''',
'                )',
'              );',
'',
'',
'        v_key := v_db_object_name || ''.'' || l_col_name;',
'',
'        SELECT COUNT(*) INTO v_exists FROM ur_algo_attributes WHERE key = v_key;',
'        IF v_exists = 0 THEN',
'          INSERT INTO ur_algo_attributes (',
'            id, algo_id, hotel_id, name, key, data_type, description, type, value,',
'            created_by, updated_by, created_on, updated_on',
'          ) VALUES (',
'            SYS_GUID(),',
'            NULL, -- algo_id set to NULL as requested',
'            v_hotel_id,',
'            l_col_name,',
'            v_key,',
'            NVL(UPPER(rec.data_type), ''NUMBER''),',
'            NULL,',
'            ''S'',',
'            v_key,',
'            v_user_id,',
'            v_user_id,',
'            SYSDATE,',
'            SYSDATE',
'          );',
'',
'          v_insert_count := v_insert_count + 1;',
'        END IF;',
'      END;',
'    END LOOP;',
'',
'    COMMIT;',
'',
'    p_status := TRUE;',
'    p_message := ''Success: '' || v_insert_count || '' attribute''',
'                 || CASE WHEN v_insert_count = 1 THEN '''' ELSE ''s'' END',
'                 || '' inserted for template_key '' || p_template_key;',
'',
'  ELSIF p_mode = ''D'' THEN',
'    IF p_attribute_key IS NOT NULL THEN',
'      IF p_attribute_key LIKE v_db_object_name || ''.%'' THEN',
'        DELETE FROM ur_algo_attributes WHERE key = p_attribute_key;',
'        v_delete_count := SQL%ROWCOUNT;',
'        COMMIT;',
'',
'        p_status := TRUE;',
'        IF v_delete_count > 0 THEN',
'          p_message := ''Success: '' || v_delete_count || '' attribute deleted with key '' || p_attribute_key;',
'        ELSE',
'          p_message := ''Info: No attribute found to delete with key '' || p_attribute_key;',
'        END IF;',
'      ELSE',
'        p_status := FALSE;',
'        p_message := ''Failure: Attribute key does not belong to template '' || p_template_key;',
'      END IF;',
'    ELSE',
'      DELETE FROM ur_algo_attributes WHERE key LIKE v_db_object_name || ''.%'';',
'      v_delete_count := SQL%ROWCOUNT;',
'      COMMIT;',
'',
'      p_status := TRUE;',
'      p_message := ''Success: '' || v_delete_count || '' attribute''',
'                   || CASE WHEN v_delete_count = 1 THEN '''' ELSE ''s'' END',
'                   || '' deleted for template_key '' || p_template_key;',
'    END IF;',
'',
'  ELSIF p_mode = ''U'' THEN',
'    p_status := FALSE;',
'    p_message := ''Update mode not yet implemented'';',
'',
'  ELSE',
'    p_status := FALSE;',
'    p_message := ''Invalid mode: '' || p_mode || ''. Valid modes are C, U, D.'';',
'  END IF;',
'',
'EXCEPTION',
'  WHEN OTHERS THEN',
'    p_status := FALSE;',
'    p_message := ''Failure: '' || SQLERRM;',
'END manage_algo_attributes;',
'',
'',
'procedure add_alert(',
'    p_existing_json in clob,',
'    p_message in varchar2,',
'    p_icon in varchar2 default null,',
'    p_title in varchar2 default null,',
'    p_timeout in number default null,',
'    p_updated_json out clob',
') is',
'    l_json_array json_array_t;',
'    l_new_object json_object_t;',
'begin',
'    -- Create the new JSON object',
'    l_new_object := new json_object_t();',
'    l_new_object.put(''message'', p_message);',
'    l_new_object.put(''icon'', nvl(p_icon, ''success''));',
'    l_new_object.put(''title'', nvl(p_title, ''''));',
'',
'    if p_timeout is not null then',
'        l_new_object.put(''timeOut'', to_char(p_timeout));',
'    end if;',
'',
'    -- Append the new object to the existing array or create a new array',
'    if p_existing_json is null or trim(p_existing_json) = '''' then',
'        -- Create a new array with the new object',
'        l_json_array := new json_array_t();',
'    else',
'        -- Parse the existing JSON string into a JSON array',
'        l_json_array := json_array_t(p_existing_json);',
'    end if;',
'',
'    -- Append the new object',
'    l_json_array.append(l_new_object);',
'',
'    -- Convert the JSON array back to a CLOB',
'    p_updated_json := l_json_array.to_clob;',
'end add_alert;',
'',
'PROCEDURE validate_expression (',
'    p_expression IN VARCHAR2,',
'    p_mode IN CHAR,',
'    p_hotel_id IN VARCHAR2,',
'    p_status OUT VARCHAR2, -- ''S'' or ''E''',
'    p_message OUT VARCHAR2',
') IS',
'  TYPE t_str_list IS TABLE OF VARCHAR2(100) INDEX BY PLS_INTEGER;',
'  v_attributes t_str_list;',
'  v_functions t_str_list;',
'  v_operators t_str_list;',
'  v_attr_count NUMBER := 0;',
'  v_func_count NUMBER := 0;',
'  v_oper_count NUMBER := 0;',
'',
'  TYPE t_token_rec IS RECORD (',
'    token VARCHAR2(4000),',
'    start_pos PLS_INTEGER,',
'    end_pos PLS_INTEGER',
'  );',
'  TYPE t_token_tab IS TABLE OF t_token_rec INDEX BY PLS_INTEGER;',
'  v_tokens t_token_tab;',
'  v_token_count PLS_INTEGER := 0;',
'',
'  TYPE t_token_tab_nt IS TABLE OF VARCHAR2(100) INDEX BY PLS_INTEGER;',
'  v_unmatched_tokens t_token_tab;',
'  v_unmatched_count PLS_INTEGER := 0;',
'',
'  -- To mark tokens consumed by multi-word operators',
'  TYPE t_bool_tab IS TABLE OF BOOLEAN INDEX BY PLS_INTEGER;',
'  v_token_consumed t_bool_tab;',
'',
'  v_mode CHAR := UPPER(p_mode);',
'',
'  -- Trim and uppercase token helper',
'  FUNCTION normalize_token(p_token VARCHAR2) RETURN VARCHAR2 IS',
'  BEGIN',
'    RETURN UPPER(TRIM(p_token));',
'  END;',
'',
'  -- Strip function parameters, e.g. "ROUND (n,d)" -> "ROUND"',
'  FUNCTION normalize_func_name(p_func VARCHAR2) RETURN VARCHAR2 IS',
'  BEGIN',
'    RETURN REGEXP_REPLACE(UPPER(TRIM(p_func)), ''\s*\(.*\)$'');',
'  END;',
'',
'  -- Checks if token is numeric',
'  FUNCTION is_number(p_token VARCHAR2) RETURN BOOLEAN IS',
'  BEGIN',
'    RETURN REGEXP_LIKE(p_token, ''^[+-]?(\d+(\.\d*)?|\.\d+)([Ee][+-]?\d+)?$'');',
'  END;',
'',
'  -- Check presence in list',
'  FUNCTION is_in_list(p_token VARCHAR2, p_list t_str_list, cnt NUMBER) RETURN BOOLEAN IS',
'  BEGIN',
'    FOR i IN 1..cnt LOOP',
'      IF p_list(i) = p_token THEN',
'        RETURN TRUE;',
'      END IF;',
'    END LOOP;',
'    RETURN FALSE;',
'  END;',
'',
'  -- Check if token valid: attribute, operator, function, number, parentheses',
'  FUNCTION is_token_valid(p_token VARCHAR2) RETURN BOOLEAN IS',
'    l_token VARCHAR2(100) := p_token;',
'  BEGIN',
'    -- Parentheses always valid tokens',
'    IF l_token IN (''('', '')'') THEN',
'      RETURN TRUE;',
'    END IF;',
'',
'    -- Strip trailing ''('' from function calls',
'    IF SUBSTR(l_token, -1) = ''('' THEN',
'      l_token := SUBSTR(l_token, 1, LENGTH(l_token) - 1);',
'    END IF;',
'',
'    -- Check if number',
'    IF is_number(l_token) THEN',
'      RETURN TRUE;',
'    END IF;',
'',
'    l_token := normalize_token(l_token);',
'',
'    IF is_in_list(l_token, v_attributes, v_attr_count) THEN',
'      RETURN TRUE;',
'    ELSIF is_in_list(l_token, v_functions, v_func_count) THEN',
'      RETURN TRUE;',
'    ELSIF is_in_list(l_token, v_operators, v_oper_count) THEN',
'      RETURN TR'))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'UE;',
'    END IF;',
'',
'    RETURN FALSE;',
'  END;',
'',
'  PROCEDURE load_functions(p_list OUT t_str_list, p_count OUT NUMBER) IS',
'  BEGIN',
'    p_list.DELETE;',
'    p_count := 0;',
'    FOR r IN (',
'      SELECT return_value FROM apex_application_lov_entries',
'      WHERE list_of_values_name = ''UR EXPRESSION FUNCTIONS''',
'      ORDER BY return_value',
'    ) LOOP',
'      p_count := p_count + 1;',
'      p_list(p_count) := normalize_func_name(r.return_value);',
'    END LOOP;',
'    IF p_count = 0 THEN',
'      RAISE_APPLICATION_ERROR(-20010, ''Functions LOV missing or empty'');',
'    END IF;',
'  END;',
'',
'  PROCEDURE load_operators(p_list OUT t_str_list, p_count OUT NUMBER) IS',
'  BEGIN',
'    p_list.DELETE;',
'    p_count := 0;',
'    FOR r IN (',
'      SELECT return_value FROM apex_application_lov_entries',
'      WHERE list_of_values_name = ''UR EXPRESSION OPERATORS''',
'      ORDER BY return_value',
'    ) LOOP',
'      p_count := p_count + 1;',
'      p_list(p_count) := UPPER(TRIM(r.return_value));',
'    END LOOP;',
'    IF p_count = 0 THEN',
'      RAISE_APPLICATION_ERROR(-20011, ''Operators LOV missing or empty'');',
'    END IF;',
'  END;',
'',
'  PROCEDURE load_attributes(p_hotel_id IN VARCHAR2, p_list OUT t_str_list, p_count OUT NUMBER) IS',
'  BEGIN',
'    p_list.DELETE;',
'    p_count := 0;',
'    FOR r IN (',
'      SELECT key FROM ur_algo_attributes WHERE hotel_id = p_hotel_id',
'    ) LOOP',
'      p_count := p_count + 1;',
'      p_list(p_count) := UPPER(TRIM(r.key));',
'    END LOOP;',
'    IF p_count = 0 THEN',
'      RAISE_APPLICATION_ERROR(-20012, ''Attributes missing for hotel_id '' || p_hotel_id);',
'    END IF;',
'  END;',
'',
'  -- Tokenizer splitting expression into tokens, tracking start/end pos',
'  PROCEDURE tokenize_expression(p_expr IN VARCHAR2, p_tokens OUT t_token_tab, p_count OUT NUMBER) IS',
'    l_pos PLS_INTEGER := 1;',
'    l_len PLS_INTEGER := LENGTH(p_expr);',
'    l_token VARCHAR2(4000);',
'    l_token_start PLS_INTEGER;',
'    l_token_end PLS_INTEGER;',
'  BEGIN',
'    p_tokens.DELETE;',
'    p_count := 0;',
'    WHILE l_pos <= l_len LOOP',
'      l_token := REGEXP_SUBSTR(p_expr,',
'        ''([A-Za-z0-9_\.]+|\d+(\.\d+)?|\(|\)|\S)'',',
'        l_pos,',
'        1,',
'        ''i'');',
'      EXIT WHEN l_token IS NULL;',
'      l_token_start := INSTR(p_expr, l_token, l_pos);',
'      l_token_end := l_token_start + LENGTH(l_token) - 1;',
'      p_count := p_count + 1;',
'      p_tokens(p_count) := t_token_rec(token => l_token, start_pos => l_token_start, end_pos => l_token_end);',
'      l_pos := l_token_end + 1;',
'      WHILE l_pos <= l_len AND SUBSTR(p_expr, l_pos, 1) = '' '' LOOP',
'        l_pos := l_pos + 1;',
'      END LOOP;',
'    END LOOP;',
'  END;',
'',
'  FUNCTION build_json_errors(p_unmatched t_token_tab, p_count PLS_INTEGER) RETURN VARCHAR2 IS',
'    v_json VARCHAR2(4000) := ''['';',
'  BEGIN',
'    IF p_count = 0 THEN',
'      RETURN ''[]'';',
'    END IF;',
'    FOR i IN 1..p_count LOOP',
'      v_json := v_json || ''{"token":"'' || p_unmatched(i).token ||',
'                ''","start":'' || p_unmatched(i).start_pos ||',
'                '',"end":'' || p_unmatched(i).end_pos || ''}'';',
'      IF i < p_count THEN',
'        v_json := v_json || '','';',
'      END IF;',
'    END LOOP;',
'    v_json := v_json || '']'';',
'    RETURN v_json;',
'  END;',
'',
'  -- Return number of consecutive tokens matched as an operator starting at start_idx',
'  FUNCTION get_longest_operator_match(start_idx IN PLS_INTEGER) RETURN PLS_INTEGER IS',
'    combined VARCHAR2(4000);',
'    max_words CONSTANT PLS_INTEGER := 4; -- max operator words count',
'    words_count PLS_INTEGER;',
'    l_len PLS_INTEGER := LEAST(max_words, v_token_count - start_idx + 1);',
'    i PLS_INTEGER;',
'  BEGIN',
'    FOR words_count IN REVERSE 1 .. l_len LOOP',
'      combined := '''';',
'      FOR i IN start_idx .. start_idx + words_count - 1 LOOP',
'        IF combined IS NULL OR combined = '''' THEN',
'          combined := UPPER(TRIM(v_tokens(i).token));',
'        ELSE',
'          combined := combined || '' '' || UPPER(TRIM(v_tokens(i).token));',
'        END IF;',
'      END LOOP;',
'      IF is_in_list(combined, v_operators, v_oper_count) THEN',
'        RETURN words_count;',
'      END IF;',
'    END LOOP;',
'    RETURN 0;',
'  END;',
'',
'BEGIN',
'  p_status := ''E'';',
'  p_message := NULL;',
'',
'  IF v_mode NOT IN (''V'', ''C'') THEN',
'    p_status := ''E'';',
'    p_message := ''Invalid mode "'' || p_mode || ''". Valid are V or C.'';',
'    RETURN;',
'  END IF;',
'',
'  IF p_hotel_id IS NULL THEN',
'    p_status := ''E'';',
'    p_message := ''hotel_id is mandatory'';',
'    RETURN;',
'  END IF;',
'',
'  IF p_expression IS NULL OR LENGTH(TRIM(p_expression)) = 0 THEN',
'    p_status := ''E'';',
'    p_message := ''Expression is empty'';',
'    RETURN;',
'  END IF;',
'',
'  load_functions(v_functions, v_func_count);',
'  load_operators(v_operators, v_oper_count);',
'  load_attributes(p_hotel_id, v_attributes, v_attr_count);',
'',
'  tokenize_expression(p_expression, v_tokens, v_token_count);',
'',
'  -- Initialize consumed array',
'  v_token_consumed.DELETE;',
'',
'  DECLARE',
'    i PLS_INTEGER := 1;',
'    words_matched PLS_INTEGER := 0;',
'  BEGIN',
'    WHILE i <= v_token_count LOOP',
'      words_matched := get_longest_operator_match(i);',
'      IF words_matched > 0 THEN',
'        FOR j IN i .. i + words_matched - 1 LOOP',
'          v_token_consumed(j) := TRUE;',
'        END LOOP;',
'        i := i + words_matched;',
'      ELSE',
'        -- Single token valid check',
'        v_token_consumed(i) := is_token_valid(normalize_token(v_tokens(i).token));',
'        i := i + 1;',
'      END IF;',
'    END LOOP;',
'  END;',
'',
'  IF v_mode = ''V'' THEN',
'    v_unmatched_tokens.DELETE;',
'    v_unmatched_count := 0;',
'    FOR i IN 1 .. v_token_count LOOP',
'      IF v_token_consumed.EXISTS(i) AND v_token_consumed(i) = FALSE THEN',
'        v_unmatched_count := v_unmatched_count + 1;',
'        v_unmatched_tokens(v_unmatched_count) := v_tokens(i);',
'      END IF;',
'    END LOOP;',
'',
'    IF v_unmatched_count > 0 THEN',
'      p_status := ''E'';',
'      p_message := ''Invalid tokens: '' || build_json_errors(v_unmatched_tokens, v_unmatched_count);',
'    ELSE',
'      p_status := ''S'';',
'      p_message := ''Expression validated successfully.'';',
'    END IF;',
'',
'  ELSIF v_mode = ''C'' THEN',
'    p_status := ''S'';',
'    p_message := '''';',
'    FOR i IN 1..v_token_count LOOP',
'      IF v_token_consumed.EXISTS(i) AND v_token_consumed(i) = TRUE THEN',
'        p_message := p_message || v_tokens(i).token || '' '';',
'      END IF;',
'    END LOOP;',
'    p_message := RTRIM(p_message);',
'  END IF;',
'',
'EXCEPTION',
'  WHEN OTHERS THEN',
'    p_status := ''E'';',
'    p_message := ''Failure: '' || SQLERRM;',
'END validate_expression;',
'',
'',
'END ur_utils_test;',
'/',
'create or replace PACKAGE BODY UR_UTILS_TEST_1 IS',
'',
'    FUNCTION Clean_TEXT(p_text IN VARCHAR2) RETURN VARCHAR2 IS',
'      v_clean VARCHAR2(4000);',
'    BEGIN',
'      v_clean := UPPER(',
'                   SUBSTR(',
'                     REGEXP_REPLACE(',
'                       REGEXP_REPLACE(',
'                         REGEXP_REPLACE(',
'                           TRIM(p_text),',
'                           ''^[^A-Za-z0-9]+|[^A-Za-z0-9]+$'', ''''',
'                         ),',
'                         ''[^A-Za-z0-9]+'', ''_''',
'                       ),',
'                       ''_+'', ''_''',
'                     ),',
'                     1, 110',
'                   )',
'                 );',
'      RETURN v_clean;',
'    END Clean_TEXT;',
'',
'FUNCTION normalize_json (p_json CLOB) RETURN CLOB IS',
'BEGIN',
'  RETURN REPLACE(REPLACE(p_json, ''"data-type"'', ''"data_type"''), ''"DATA-TYPE"'', ''"data_type"'');',
'END normalize_json;',
'',
'  PROCEDURE get_collection_json(',
'    p_collection_name IN VARCHAR2,',
'    p_json_clob OUT CLOB,',
'    p_status OUT BOOLEAN,',
'    p_message OUT VARCHAR2',
'  ) IS',
'    l_count NUMBER;',
'  BEGIN',
'    SELECT COUNT(*)',
'      INTO l_count',
'      FROM apex_collections',
'     WHERE collection_name = p_collection_name;',
'',
'    IF l_count = 0 THEN',
'      p_status := FALSE;',
'      p_message := ''Failure: Collection "'' || p_collection_name || ''" does not exist or is empty'';',
'      p_json_clob := NULL;',
'      RETURN;',
'    END IF;',
'',
'    -- Initialize and build JSON output',
'    apex_json.initialize_clob_output;',
'    apex_json.open_array;',
'',
'    FOR rec IN (',
'      SELECT c001, c002, c003',
'        FROM apex_collections',
'       WHERE collection_name = p_collection_name',
'       ORDER BY seq_id',
'    )',
'    LOOP',
'      apex_json.open_object;',
'      apex_json.write(''name'', rec.c001);',
'      apex_json.write(''data_type'', rec.c002);',
'      apex_json.write(''qualifier'', rec.c003);',
'      apex_json.close_object;',
'    END LOOP;',
'',
'    apex_json.close_array;',
'',
'    p_json_clob := apex_json.get_clob_output;',
'',
'    apex_json.free_output;',
'',
'    p_status := TRUE;',
'    p_message := ''Success: JSON generated for collection "'' || p_collection_name || ''"'';',
'',
'  EXCEPTION',
'    WHEN OTHERS THEN',
'      p_status := FALSE;',
'      p_message := ''Failure: '' || SQLERRM;',
'      p_json_clob := NULL;',
'  END get_collection_json;',
'',
'',
'',
' PROCEDURE define_db_object(',
'    p_template_key IN VARCHAR2,',
'    p_status OUT BOOLEAN,',
'    p_message OUT VARCHAR2',
') IS',
'    v_db_object_name VARCHAR2(30);',
'    v_sql            CLOB;',
'    v_col_defs       CLOB := '''';',
'    v_unique_defs    CLOB := '''';',
'    v_definition     CLOB;',
'    v_exists         NUMBER;',
'    v_trigger_name   VARCHAR2(130);',
'    l_col_name       VARCHAR2(100);',
'BEGIN',
'    -- Lock row in UR_TEMPLATES and get DB_OBJECT_NAME and definition',
'    SELECT db_object_name, definition',
'    INTO v_db_object_name, v_definition',
'    FROM ur_templates',
'    WHERE key = p_template_key',
'    FOR UPDATE;',
'',
'    IF v_db_object_name IS NOT NULL THEN',
'      p_status := FALSE;',
'      p_message := ''Failure: Table already defined as '' || v_db_object_name;',
'      RETURN;',
'    END IF;',
'',
'    IF v_definition IS NULL THEN',
'      p_status := FALSE;',
'      p_message := ''Failure: Definition JSON is NULL for template_key '' || p_template_key;',
'      RETURN;',
'    END IF;',
'',
'    -- Generate table name (adjust prefix as needed)',
'    v_db_object_name := ''UR_'' || UPPER(p_template_key) || ''_T'';',
'',
'    -- Check if table exists',
'    SELECT COUNT(*)',
'    INTO v_exists',
'    FROM all_tables',
'    WHERE table_name = UPPER(v_db_object_name);',
'',
'    IF v_exists > 0 THEN',
'      p_status := FALSE;',
'      p_message := ''Failure: Table '' || v_db_object_name || '' already exists in schema'';',
'      RETURN;',
'    END IF;',
'',
'    -- Start with ID RAW(16) as primary key column',
'    v_col_defs := ''"REC_ID" RAW(16)'';',
'',
'    -- Parse JSON and build column definitions',
'    FOR rec IN (',
'      SELECT jt.name, jt.data_type, jt.qualifier',
'      FROM JSON_TABLE(',
'  normalize_json(v_definition),',
'  ''$[*]'' COLUMNS (',
'    name       VARCHAR2(100) PATH ''$.name'',',
'    data_type  VARCHAR2(30)  PATH ''$.data_type'',',
'    qualifier  VARCHAR2(30)  PATH ''$.qualifier''',
'  )',
') jt',
'',
'    )',
'    LOOP',
'      -- sanitize column name: trim underscores and collapse multiple',
'      l_col_name := UPPER(TRIM(BOTH ''_'' FROM rec.name));',
'      l_col_name := REGEXP_REPLACE(l_col_name, ''_{2,}'', ''_'');',
'',
'      v_col_defs := v_col_defs || '', '';',
'',
'      -- Map data type including DATE',
'      IF UPPER(rec.data_type) = ''TEXT'' THEN',
'        v_col_defs := v_col_defs || ''"'' || l_col_name || ''" VARCHAR2(4000)'';',
'      ELSIF UPPER(rec.data_type) = ''NUMBER'' THEN',
'        v_col_defs := v_col_defs || ''"'' || l_col_name || ''" NUMBER'';',
'      ELSIF UPPER(rec.data_type) = ''DATE'' THEN',
'        v_col_defs := v_col_defs || ''"'' || l_col_name || ''" DATE'';',
'      ELSE',
'        -- Default to VARCHAR2 for unknown type',
'        v_col_defs := v_col_defs || ''"'' || l_col_name || ''" VARCHAR2(4000)'';',
'      END IF;',
'',
'      -- Collect STAY_DATE constraint definitions',
'      IF UPPER(rec.qualifier) = ''STAY_DATE'' THEN',
'        v_unique_defs := v_unique_defs ',
'          || '', CONSTRAINT "'' || v_db_object_name || ''_'' || l_col_name || ''_UQ" UNIQUE ("'' || l_col_name || ''")'';',
'      END IF;',
'    END LOOP;',
'',
'    -- Add WHO columns + HOTEL_ID RAW(16)',
'    v_col_defs := v_col_defs',
'      || '', CREATED_BY RAW(16), UPDATED_BY RAW(16), CREATED_ON DATE, UPDATED_ON DATE, HOTEL_ID RAW(16), INTERFACE_LOG_ID RAW(16)'';',
'',
'    -- Build final CREATE TABLE DDL',
'    v_sql := ''CREATE TABLE "'' || v_db_object_name || ''" ('' ',
'        || v_col_defs ',
'        || '', CONSTRAINT "'' || v_db_object_name || ''_PK" PRIMARY KEY ("REC_ID")''',
'        || v_unique_defs',
'        || '')'';',
'',
'    EXECUTE IMMEDIATE v_sql;',
'',
'    -- Create trigger to auto-generate ID (if NULL) using SYS_GUID()',
'    v_trigger_name := v_db_object_name || ''_BI_TRG'';',
'',
'    v_sql := ''',
'CREATE OR REPLACE EDITIONABLE TRIGGER "'' || v_trigger_name || ''"',
'BEFORE INSERT OR UPDATE ON "'' || v_db_object_name || ''"',
'FOR EACH ROW',
'DECLARE',
'  v_user_id UR_USERS.USER_ID%TYPE;',
'BEGIN',
'  -- Get the USER_ID once',
'  SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''''APEX$SESSION'''', ''''APP_USER'''');',
'',
'  IF :NEW.REC_ID IS NULL THEN',
'    :NEW.REC_ID := SYS_GUID();',
'  END IF;',
'',
'  IF INSERTING THEN',
'    :NEW.CREATED_BY := v_user_id;',
'    :NEW.CREATED_ON := SYSDATE;',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  ELSIF UPDATING THEN',
'    :NEW.UPDATED_BY := v_user_id;',
'    :NEW.UPDATED_ON := SYSDATE;',
'  END IF;',
'END '' || v_trigger_name || '';',
''';',
'',
'    EXECUTE IMMEDIATE v_sql;',
'',
'    -- Update UR_TEMPLATES with the new db_object_name and timestamp',
'    UPDATE ur_templates',
'    SET db_object_name = v_db_object_name,',
'        db_object_created_on = SYSDATE',
'    WHERE key = p_template_key;',
'',
'    COMMIT;',
'',
'    p_status := TRUE;',
'    p_message := ''Success: Table "'' || v_db_object_name || ''" created with ID primary key and trigger'';',
'EXCEPTION',
'    WHEN NO_DATA_FOUND THEN',
'      p_status := FALSE;',
'      p_message := ''Failure: Template key not found'';',
'    WHEN OTHERS THEN',
'      p_status := FALSE;',
'      p_message := ''Failure: '' || SQLERRM;',
'END define_db_object;',
'',
'',
'PROCEDURE LOAD_DATA_MAPPING_COLLECTION (',
'    p_file_id         IN  VARCHAR2,',
'    p_template_id    IN  VARCHAR2,',
'    p_collection_name IN  VARCHAR2,',
'    p_status          OUT VARCHAR2,',
'    p_message         OUT VARCHAR2',
') IS',
'',
'    -- Local variables',
'    v_seq_id NUMBER;',
'',
'BEGIN',
'    -- Initialize outputs',
'    p_status := ''S'';',
'    p_message := ''Processing completed successfully.'';',
'',
'    ------------------------------------------------------------------------',
'    -- Step 1: Create or truncate the APEX collection',
'    ------------------------------------------------------------------------',
'    BEGIN',
'        IF APEX_COLLECTION.COLLECTION_EXISTS(p_collection_name) THEN',
'            APEX_COLLECTION.DELETE_COLLECTION(p_collection_name);',
'        END IF;',
'',
'        APEX_COLLECTION.CREATE_COLLECTION(p_collection_name);',
'',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            p_status := ''E'';',
'            p_message := ''Failed to create or truncate collection "'' || p_collection_name || ''": '' || SQLERRM;',
'            RETURN;',
'    END;',
'',
'    ------------------------------------------------------------------------',
'    -- Step 2: Insert data from TEMP_BLOB JSON into collection (c001)',
'    ------------------------------------------------------------------------',
'    BEGIN',
'        FOR rec IN (',
'            SELECT jt.name || '' ('' || jt.data_type || '')'' AS column_desc, jt.col_position',
'            FROM TEMP_BLOB t,',
'                 JSON_TABLE(',
'    normalize_json(t.columns),',
'    ''$[*]'' COLUMNS (',
'       name      VARCHAR2(100) PATH ''$.name'',',
'       data_type VARCHAR2(100) PATH ''$.data_type'',',
'       col_position VARCHAR2(100) PATH ''$.pos''',
'    )',
'',
'                 ) jt',
'            WHERE t.id = p_file_id',
'        ) LOOP',
'            APEX_COLLECTION.ADD_MEMBER(',
'                p_collection_name => p_collection_name,',
'                p_c001            => rec.column_desc,',
'                p_c004            => rec.col_position',
'            );',
'        END LOOP;',
'',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            p_status := ''E'';',
'            p_message := ''Failed to insert data from TEMP_BLOB (File ID: '' || p_file_id || ''): '' || SQLERRM;',
'            RETURN;',
'    END;',
'',
'    ------------------------------------------------------------------------',
'    -- Step 3: Update existing collection members with matching data from UR_TEMPLATES (c002, c003)',
'    ------------------------------------------------------------------------',
'    BEGIN',
'        FOR rec IN (',
'            SELECT jt.name || '' ('' || jt.data_type || '')'' AS column_desc',
'            FROM UR_TEMPLATES t,',
'                 JSON_TABLE(',
'    normalize_json(t.definition),',
'    ''$[*]'' COLUMNS (',
'       name      VARCHAR2(100) PATH ''$.name'',',
'       data_type VARCHAR2(100) PATH ''$.data_type''',
'    )',
')',
' jt',
'            WHERE t.id = p_template_id',
'            ORDER BY t.id DESC',
'        ) LOOP',
'            BEGIN',
'                -- Find the seq_id for matching collection member',
'                SELECT seq_id ',
'                INTO v_seq_id',
'                FROM apex_collections',
'                WHERE collection_name = p_collection_name',
'                  AND c001 = rec.column_desc;',
'',
'                -- Update c002 and c003 attributes',
'                APEX_COLLECTION.UPDATE_MEMBER_ATTRIBUTE(',
'                    p_collection_name => p_collection_name,',
'                    p_seq             => v_seq_id,',
'                    p_attr_number     => 2,',
'                    p_attr_value      => rec.column_desc',
'                );',
'',
'                APEX_COLLECTION.UPDATE_MEMBER_ATTRIBUTE(',
'                    p_collection_name => p_collection_name,',
'                    p_seq             => v_seq_id,',
'                    p_attr_number     => 3,',
'                    p_attr_value      => ''Maps To''',
'                );',
'',
'            EXCEPTION',
'                WHEN NO_DATA_FOUND THEN',
unistr('                    -- No matching collection member found \2014 ignore gracefully'),
'                    NULL;',
'                WHEN OTHERS THEN',
'                    p_status := ''E'';',
'                    p_message := ''Failed to update member attribute in collection "'' || p_collection_name || ''" for "'' ',
'                                 || rec.column_desc || ''": '' || SQLERRM;',
'                    RETURN;',
'            END;',
'        END LOOP;',
'',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            p_status := ''E'';',
'            p_message := ''Failed to update collection members from UR_TEMPLATES (ID: '' || p_template_id || ''): '' || SQLERRM;',
'            RETURN;',
'    END;',
'',
'EXCEPTION',
'    WHEN OTHERS THEN',
'        p_status := ''E'';',
'        p_message := ''Unexpected error occurred: '' || SQLERRM;',
'END LOAD_DATA_MAPPING_COLLECTION;',
'',
'PROCEDURE Load_Data (',
'    p_file_id         IN  NUMBER,',
'    p_template_key    IN  VARCHAR2,',
'    p_hotel_id        IN  RAW,',
'    p_collection_name IN  VARCHAR2,',
'    p_status          OUT boolean,',
'    p_message         OUT VARCHAR2',
') IS',
'    l_blob        BLOB;',
'    l_file_name   VARCHAR2(255);',
'    l_table_name  VARCHAR2(255);',
'    l_template_id RAW(16);',
'    l_total_rows  NUMBER := 0;',
'    l_success_cnt NUMBER := 0;',
'    l_fail_cnt    NUMBER := 0;',
'    l_log_id      RAW(16);',
'    l_error_json  CLOB := ''['';',
'    l_first_err   BOOLEAN := TRUE;',
'    l_collection_name VARCHAR2(255);',
'    l_debug boolean := FALSE;',
'',
'    -- mapping record type',
'    TYPE t_map_rec IS RECORD (',
'        src_col     VARCHAR2(128),  ',
'        tgt_col     VARCHAR2(128),  ',
'        parser_col  VARCHAR2(20),   ',
'        data_type   VARCHAR2(50)',
'    );',
'    TYPE t_map IS TABLE OF t_map_rec INDEX BY VARCHAR2(128);',
'',
'    l_mapping   t_map;',
'    l_apex_user VARCHAR2(255) := NVL(v(''APP_USER''),''APEX_USER'');',
'',
'    l_cols   VARCHAR2(32767);',
'    l_vals   VARCHAR2(32767);',
'    l_sql    CLOB;',
'    k        VARCHAR2(128);',
'    v_expr   VARCHAR2(4000);',
'    l_map_count NUMBER;',
'    l_table_name_1 varchar2(480) := ''UR_VK_NEW_CHINAR_T_INTERFACE'';',
'    l_update_1 CLOB;',
'    l_sql_temp clob;',
'    l_sql_select clob;',
'',
'    -- ADDED: variable for duplicate check',
'    l_existing_cnt NUMBER;',
'    v_cursor   INTEGER;',
'    v_cols     VARCHAR2(1000) := ''hotel_id, booking_id, number_of_rooms'';',
'    v_desc_tab DBMS_SQL.DESC_TAB;',
'    v_col_cnt  INTEGER;',
'    v_value    VARCHAR2(4000);',
'    v_col_val  VARCHAR2(4000);',
'    v_status   INTEGER;',
'    l_rows_fetched    NUMBER;',
'    l_cursor_id       INTEGER;',
'    l_col_count       NUMBER;',
'    l_describe_tab    DBMS_SQL.DESC_TAB;',
'    l_column_value    VARCHAR2(4000);',
'BEGIN',
'    -------------------------------------------------------------------',
'    -- 0. DUPLICATE CHECK: stop if file already uploaded successfully',
'    -------------------------------------------------------------------',
'    SELECT COUNT(*)',
'      INTO l_existing_cnt',
'      FROM ur_interface_logs',
'     WHERE file_id   = p_file_id',
'       AND load_status = ''SUCCESS'';',
'',
'    IF l_existing_cnt > 0 THEN',
'        p_status  := FALSE;',
'        p_message := ''Failure: File is already uploaded successfully.'';',
'        RETURN;',
'    END IF;',
'',
'    -- 1. Get blob and file name',
'    SELECT blob_content, filename',
'      INTO l_blob, l_file_name',
'      FROM temp_blob',
'     WHERE id = p_file_id;',
'     ',
'     /*',
'    IF l_file_name < 0 THEN',
'        p_status  := FALSE;',
'        p_message := ''Failure: File ID ''||p_file_id||'' is already uploaded successfully.'';',
'        RETURN;',
'    END IF;*/',
'',
'    -- 2. Get target table name + template id',
'    SELECT db_object_name, id',
'      INTO l_table_name, l_template_id',
'      FROM ur_templates',
'     WHERE upper(id) = upper(p_template_key);',
'',
'    -- 3. Insert log entry',
'    l_log_id := sys_guid();',
'    INSERT INTO ur_interface_logs (',
'        id, hotel_id, template_id, interface_type,',
'        load_start_time, load_status, created_by, updated_by,',
'        created_on, updated_on, file_id',
'    )',
'    VALUES (',
'        l_log_id,',
'        p_hotel_id,',
'        l_template_id,',
'        ''UPLOAD'',',
'        systimestamp,',
'        ''IN_PROGRESS'',',
'        hextoraw(rawtohex(utl_raw.cast_to_raw(l_apex_user))),',
'        hextoraw(rawtohex(utl_raw.cast_to_raw(l_apex_user))),',
'        sysdate, sysdate,',
'        p_file_id',
'    );',
'',
'    -- 4. Load mapping directly from collection',
'    FOR rec IN (',
'        SELECT regexp_substr(c001, ''^[^(]+'')                    src_col,',
'               regexp_substr(c002, ''^[^(]+'')                    tgt_col,',
'               TRIM(c004)                                       parser_col,',
'               UPPER(regexp_replace(c001, ''^[^(]+\(([^)]+)\).*'', ''\1'')) datatype',
'          FROM apex_collections',
'         WHERE collection_name = p_collection_name',
'           AND c003 = ''Maps To''',
'           AND c004 IS NOT NULL',
'    ) LOOP',
'        l_mapping(UPPER(TRIM(rec.src_col))).src_col    := TRIM(rec.src_col);',
'        l_mapping(UPPER(TRIM(rec.src_col))).tgt_col    := TRIM(rec.tgt_col);',
'        l_mapping(UPPER(TRIM(rec.src_col))).parser_col := TRIM(rec.parser_col);',
'        l_mapping(UPPER(TRIM(rec.src_col))).data_type  := TRIM(rec.datatype);',
'INSERT INTO debug_log(message) VALUES(''rec.src_col: '' || rec.src_col);',
'    INSERT INTO debug_log(message) VALUES(''rec.tgt_col : '' || rec.tgt_col);',
'     INSERT INTO debug_log(message) VALUES(''rec.parser_col : '' || rec.parser_col);',
'    commit;',
'    END LOOP;',
'',
'    l_map_count := l_mapping.count;',
'    IF l_map_count = 0 THEN',
'        RAISE_APPLICATION_ERROR(-20001, ''No mapped columns found in collection!'');',
'    END IF;',
'',
'    -- 5. Build dynamic column list and values',
'    k := l_mapping.first;',
'    WHILE k IS NOT NULL LOOP',
'        IF l_mapping.exists(k)',
'           AND l_mapping(k).tgt_col IS NOT NULL',
'           AND l_mapping(k).parser_col IS NOT NULL',
'        THEN',
'            IF l_cols IS NOT NULL THEN',
'                l_cols := l_cols || '','';',
'                l_vals := l_vals || '','';',
'            END IF;',
'            INSERT INTO debug_log(message) VALUES(''In while loop 1 l_cols: '' || l_cols);',
'            INSERT INTO debug_log(message) VALUES(''In while loop 1 l_vals: '' || l_vals);',
'            l_cols := l_cols || l_mapping(k).tgt_col;',
'            INSERT INTO debug_log(message) VALUES(''In while loop 1 l_cols: '' || l_cols);',
'            -- safe conversions',
'            IF l_mapping(k).data_type = ''NUMBER'' THEN',
'                v_expr := ''CASE WHEN REGEXP_LIKE(p.''|| l_mapping(k).parser_col ||'', ''''^-?\d+(\.\d+)?$'''') ''||',
'                          ''THEN TO_NUMBER(p.''|| l_mapping(k).parser_col ||'') ELSE NULL END'';',
'             ',
'            ELSIF l_mapping(k).data_type = ''DATE'' THEN',
'                v_expr := ''CASE ''||',
'                          -- Full datetime with DD-MM-YYYY',
'                          '' WHEN REGEXP_LIKE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''^\d{2}-\d{2}-\d{4}\s+\d{2}:\d{2}:\d{2}$'''') ''||',
'                          ''      THEN TO_DATE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''DD-MM-YYYY HH24:MI:SS'''') ''||',
'',
'                          -- Full datetime with DD/MM/YYYY',
'                          '' WHEN REGEXP_LIKE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''^\d{2}/\d{2}/\d{4}\s+\d{2}:\d{2}:\d{2}$'''') ''||',
'                          ''      THEN TO_DATE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''DD/MM/YYYY HH24:MI:SS'''') ''||',
'',
'                          -- Full datetime with DD-MON-YYYY (your case)',
'                          '' WHEN REGEXP_LIKE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''^\d{2}-[A-Z]{3}-\d{4}\s+\d{2}:\d{2}:\d{2}$'''', ''''i'''') ''||',
'                          ''      THEN TO_DATE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''DD-MON-YYYY HH24:MI:SS'''') ''||',
'',
'                          -- Just date YYYY-MM-DD',
'                          '' WHEN REGEXP_LIKE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''^\d{4}-\d{2}-\d{2}$'''') ''||',
'                          ''      THEN TO_DATE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''YYYY-MM-DD'''') ''||',
'',
'                          -- Just date DD/MM/YYYY',
'                          '' WHEN REGEXP_LIKE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''^\d{2}/\d{2}/\d{4}$'''') ''||',
'                          ''      THEN TO_DATE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''DD/MM/YYYY'''') ''||',
'',
'                          -- Just date DD-MM-YYYY',
'                          '' WHEN REGEXP_LIKE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''^\d{2}-\d{2}-\d{4}$'''') ''||',
'                          ''      THEN TO_DATE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''DD-MM-YYYY'''') ''||',
'',
'                          -- Just date DD-MON-YYYY',
'                          '' WHEN REGEXP_LIKE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''^\d{2}-[A-Z]{3}-\d{4}$'''', ''''i'''') ''||',
'                          ''      THEN TO_DATE(TRIM(p.''|| l_mapping(k).parser_col ||''), ''''DD-MON-YYYY'''') ''||',
'',
'                          -- Fallback',
'                          '' ELSE NULL END'';',
'',
'',
'',
'                        ELSE',
'                            v_expr := ''p.''|| l_mapping(k).parser_col;',
'                            INSERT INTO debug_log(message) VALUES(''v_expr: '' || v_expr);',
'               ',
'                        END IF;',
'',
'            l_vals := l_vals || v_expr;',
'        END IF;',
'        k := l_mapping.next(k);',
'    END LOOP;',
'',
'',
'    -- 6. Build INSERT statement (HOTEL_ID injected as constant)',
'    /*l_sql :=',
'        ''INSERT INTO ''|| l_table_name ||'' (HOTEL_ID,''|| l_cols ||'',INTERFACE_LOG_ID) ''||',
'        ''SELECT :hotel_id,''|| l_vals ||'',:log_id ''||',
'        ''  FROM TABLE(apex_data_parser.parse(p_content => :b1, p_file_name => :b2)) p ''||',
'        '' WHERE p.line_number > 1'';',
'',
'            EXECUTE IMMEDIATE l_sql USING p_hotel_id, l_log_id, l_blob, l_file_name;',
'',
'*/',
'       -- l_blob := UTL_RAW.CAST_TO_RAW(''header1,header2'' || CHR(10) || ''data1,data2'');',
'    ',
'    -- 1. Construct the SQL query with bind variable placeholders',
'    -- Note: l_vals is concatenated because the list of columns is dynamic.',
'    -- All other *values* are passed via bind variables.',
'    l_sql := ''SELECT :p_hotel_id, '' || l_vals || '', :l_log_id '' ||',
'             '' FROM TABLE(apex_data_parser.parse(p_content => :p_content, p_file_name => :p_file_name)) p '' ||',
'             '' where 1=1'';',
'',
'    INSERT INTO debug_log(message) VALUES(''l_vals 0.11112 :>>>>>>>>>>>>>>>>>> ''||l_vals ); ',
'    ',
'    -- Open & parse',
'    l_cursor_id := DBMS_SQL.OPEN_CURSOR;',
'    DBMS_SQL.PARSE(l_cursor_id, l_sql, DBMS_SQL.NATIVE);',
'    ',
'    INSERT INTO debug_log(message) VALUES(''l_vals 0.1111222222 :>>>>>>>>>>>>>>>>>> ''||l_vals ); ',
'    ',
'    -- Bind variables',
'    DBMS_SQL.BIND_VARIABLE(l_cursor_id, '':p_hotel_id'', p_hotel_id);',
'    DBMS_SQL.BIND_VARIABLE(l_cursor_id, '':l_log_id'', l_log_id);',
'    DBMS_SQL.BIND_VARIABLE(l_cursor_id, '':p_content'', l_blob);',
'    DBMS_SQL.BIND_VARIABLE(l_cursor_id, '':p_file_name'', l_file_name);',
'',
'    INSERT INTO debug_log(message) VALUES(''l_vals 0.2 :>>>>>>>>>>>>>>>>>> ''||l_vals ); ',
'    INSERT INTO debug_log(message) VALUES(''p_hotel_id 0.20 :>>>>>>>>>>>>>>>>>> ''||p_hotel_id ); ',
'    INSERT INTO debug_log(message) VALUES(''l_blob 0.21 :>>>>>>>>>>>>>>>>>> ''||l_blob); ',
'    INSERT INTO debug_log(message) VALUES(''l_log_id 0.21 :>>>>>>>>>>>>>>>>>> ''||l_log_id ); ',
'    INSERT INTO debug_log(message) VALUES(''l_file_name 0.22 :>>>>>>>>>>>>>>>>>> ''||l_file_name );',
'',
'    -- Describe columns to get the actual column count',
'    DBMS_SQL.DESCRIBE_COLUMNS(l_cursor_id, l_col_count, l_describe_tab);',
'    ',
'    INSERT INTO debug_log(message) VALUES(''l_col_count:>>''||l_col_count);',
'',
'    -- Define columns',
'    FOR i IN 1 .. l_col_count LOOP',
'        DBMS_SQL.DEFINE_COLUMN(l_cursor_id, i, l_column_value, 4000);',
'    END LOOP;',
'',
'    -- Execute the cursor',
'    l_rows_fetched := DBMS_SQL.EXECUTE_AND_FETCH(l_cursor_id); ',
'    INSERT INTO debug_log(message) VALUES(''l_rows_fetched:>>>''||l_rows_fetched);',
'',
'    -- Fetch rows',
'    WHILE DBMS_SQL.FETCH_ROWS(l_cursor_id) > 0 LOOP',
'        FOR i IN 1 .. l_col_count LOOP',
'            DBMS_SQL.COLUMN_VALUE(l_cursor_id, i, l_column_value);',
'            INSERT INTO debug_log(message) VALUES(''Column '' || i || '': '' || l_column_value);',
'        END LOOP;',
'    END LOOP;',
'',
'    DBMS_SQL.CLOSE_CURSOR(l_cursor_id);',
'',
'',
'    INSERT INTO debug_log(message) VALUES(''Cursor closed successfully'');',
'',
'',
'INSERT INTO debug_log(message) VALUES(''l_sql: '' || l_sql);    ',
'   commit;',
'    EXECUTE IMMEDIATE l_sql USING p_hotel_id, l_log_id, l_blob, l_file_name;',
'',
'    l_success_cnt := SQL%ROWCOUNT;',
'    l_total_rows  := l_success_cnt;',
'',
'    -- 7. Update log entry',
'    UPDATE ur_interface_logs',
'       SET load_end_time      = systimestamp,',
'           load_status        = CASE WHEN l_fail_cnt = 0 THEN ''SUCCESS'' ELSE ''FAILED'' END,',
'           records_processed  = l_total_rows,',
'           records_successful = l_success_cnt,',
'           records_failed     = l_fail_cnt,',
'           error_json         = CASE WHEN l_fail_cnt > 0 THEN l_error_json || '']'' ELSE NULL END,',
'           updated_by         = hextoraw(rawtohex(utl_raw.cast_to_raw(l_apex_user))),',
'           updated_on         = sysdate',
'     WHERE id = l_log_id;',
'',
'    COMMIT;',
'',
'    -- OUT params',
'    p_status  := TRUE;',
'    p_message := ''Success: Upload completed for File ID  ',
unistr('                  \2192 Total='' || l_total_rows ||'),
'                 '', Success='' || l_success_cnt ||',
'      '))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'           '', Failed='' || l_fail_cnt;',
'',
'EXCEPTION',
'    WHEN OTHERS THEN',
'',
'        /*DECLARE',
'            l_err_msg VARCHAR2(4000);',
'        BEGIN',
'            l_err_msg := SQLERRM;',
'',
'            p_status  := FALSE;',
'            p_message := ''Failure: ''|| l_err_msg;',
'',
'            UPDATE ur_interface_logs',
'               SET load_end_time = systimestamp,',
'                   load_status   = ''FAILED'',',
'                   error_json    = l_error_json || ''{"error":"'' || REPLACE(l_err_msg,''"'','''''''') || ''"}]'',',
'                   updated_on    = sysdate',
'             WHERE id = l_log_id;',
'',
'            ROLLBACK;',
'        END;*/',
'        l_table_name_1 := l_table_name || ''_INTERFACE'';',
'         l_sql := ''CREATE TABLE '' || l_table_name_1 ||',
'             '' AS SELECT * FROM '' || l_table_name || '' WHERE 1=0'';',
'',
'    EXECUTE IMMEDIATE l_sql;',
'',
'         l_sql :=',
'        ''INSERT INTO ''|| l_table_name_1 ||'' (HOTEL_ID,''|| l_cols ||'',INTERFACE_LOG_ID) ''||',
'        ''SELECT :hotel_id,''|| l_vals ||'',:log_id ''||',
'        ''  FROM TABLE(apex_data_parser.parse(p_content => :b1, p_file_name => :b2)) p ''||',
'        '' WHERE p.line_number > 1'';',
'        EXECUTE IMMEDIATE l_sql USING p_hotel_id, l_log_id, l_blob, l_file_name;',
'        commit;',
'     ',
'    -- Build dynamic update set clause',
'    SELECT LISTAGG(''t.''||column_name||'' = s.''||column_name, '', '')',
'             WITHIN GROUP (ORDER BY column_id)',
'      INTO l_update_1',
'      FROM user_tab_columns',
'     WHERE table_name = UPPER(l_table_name)',
'       AND column_name NOT IN (''STAY_DATE'',''HOTEL_ID'');  -- exclude key columns',
'',
'    -- Build merge SQL',
'    l_sql :=',
'        ''MERGE INTO ''||l_table_name||'' t ''||',
'        ''USING ''||l_table_name_1||'' s ''||',
'        ''   ON (t.STAY_DATE = s.STAY_DATE AND t.HOTEL_ID = s.HOTEL_ID) ''||',
'        '' WHEN MATCHED THEN ''||',
'        ''   UPDATE SET ''|| l_update_1;',
'',
'    --dbms_output.put_line(l_sql); -- debug',
'    EXECUTE IMMEDIATE l_sql;',
'    COMMIT;',
'    -- Step 4: clean up interface table',
'        EXECUTE IMMEDIATE ''drop TABLE ''|| l_table_name_1;',
'        commit;',
'',
'         l_success_cnt := SQL%ROWCOUNT; -- rows inserted',
'        l_fail_cnt    := 0;            -- since all go to _INT',
'        l_total_rows  := l_success_cnt;',
'',
'        p_status  := TRUE;',
'        p_message := ''Success: Update completed for File ID ''||p_file_id||',
unistr('                     '' \2192 Total='' || l_total_rows ||'),
'                     '', Success='' || l_success_cnt ||',
'                     '', Failed='' || l_fail_cnt;',
'',
'--END;',
'',
'',
'END Load_Data;',
'',
'',
'PROCEDURE fetch_templates(',
'    p_file_id      IN NUMBER,',
'    p_hotel_id     IN VARCHAR2,',
'    p_min_score    IN NUMBER DEFAULT 90,',
'    p_debug_flag   IN VARCHAR2 DEFAULT ''N'',',
'    p_output_json  OUT CLOB,',
'    p_status       OUT VARCHAR2,',
'    p_message      OUT VARCHAR2',
') IS',
'    -- Local types',
'    TYPE t_name_type_rec IS RECORD(',
'        name       VARCHAR2(100),',
'        data_type  VARCHAR2(30)',
'    );',
'    TYPE t_name_type_tab IS TABLE OF t_name_type_rec;',
'',
'    TYPE t_template_rec IS RECORD(',
'        id         VARCHAR2(50),',
'        name       VARCHAR2(200),',
'        definition t_name_type_tab',
'    );',
'    TYPE t_template_tab IS TABLE OF t_template_rec INDEX BY PLS_INTEGER;',
'',
'    -- Variables',
'    v_source_clob       CLOB;',
'    v_source_normalized CLOB;',
'    ',
'    v_target_id         VARCHAR2(50);',
'    v_target_name       VARCHAR2(200);',
'    v_target_def_clob   CLOB;',
'    v_target_normalized CLOB;',
'',
'    v_source_defs       t_name_type_tab := t_name_type_tab();',
'    v_target_defs       t_name_type_tab := t_name_type_tab();',
'',
'    v_templates         t_template_tab;',
'    v_count_templates   PLS_INTEGER := 0;',
'',
'    v_json_output       CLOB := ''['';',
'    v_min_score_use     NUMBER;',
'    v_separator         VARCHAR2(1) := '''';',
'',
'    v_match_count       NUMBER;',
'    v_score             NUMBER;',
'',
'    CURSOR c_targets IS',
'      SELECT ID, NAME, DEFINITION FROM UR_TEMPLATES WHERE hotel_id = p_hotel_id;',
'',
'    -- Debug procedure',
'    PROCEDURE debug(p_msg VARCHAR2) IS',
'    BEGIN',
'        IF UPPER(p_debug_flag) = ''Y'' THEN',
'            DBMS_OUTPUT.PUT_LINE(''[DEBUG] '' || p_msg);',
'        END IF;',
'    END;',
'',
'    -- Normalize data-type keys in JSON string (case sensitive replacement)',
'    FUNCTION normalize_json(p_json CLOB) RETURN CLOB IS',
'    BEGIN',
'        RETURN REPLACE(REPLACE(p_json, ''"data-type"'', ''"data_type"''), ''"DATA-TYPE"'', ''"data_type"'');',
'    END;',
'',
'    -- Parse definition JSON into PL/SQL collection',
'    FUNCTION parse_definition(p_clob CLOB) RETURN t_name_type_tab IS',
'        l_defs t_name_type_tab := t_name_type_tab();',
'        idx     PLS_INTEGER := 0;',
'    BEGIN',
'        FOR rec IN (',
'            SELECT lower(trim(name)) AS name, lower(trim(data_type)) AS data_type FROM JSON_TABLE(',
'                p_clob,',
'                ''$[*]'' COLUMNS (',
'                    name VARCHAR2(100) PATH ''$.name'',',
'                    data_type VARCHAR2(30) PATH ''$.data_type''',
'                )',
'            )',
'        ) LOOP',
'            idx := idx + 1;',
'            l_defs.EXTEND;',
'            l_defs(idx).name := rec.name;',
'            l_defs(idx).data_type := rec.data_type;',
'        END LOOP;',
'        RETURN l_defs;',
'    EXCEPTION',
'        WHEN OTHERS THEN',
'            RETURN NULL;',
'    END;',
'',
'    -- Count matches (name + data_type case-insensitive)',
'    FUNCTION count_matches(p_source t_name_type_tab, p_target t_name_type_tab) RETURN NUMBER IS',
'        v_count NUMBER := 0;',
'    BEGIN',
'        FOR i IN 1 .. p_source.COUNT LOOP',
'            FOR j IN 1 .. p_target.COUNT LOOP',
'                IF p_source(i).name = p_target(j).name AND p_source(i).data_type = p_target(j).data_type THEN',
'                    v_count := v_count + 1;',
'                    EXIT;',
'                END IF;',
'            END LOOP;',
'        END LOOP;',
'        RETURN v_count;',
'    END;',
'',
'BEGIN',
'    -- Validate inputs and assign to local variable',
'    v_min_score_use := NVL(p_min_score, 90);',
'    IF v_min_score_use < 0 OR v_min_score_use > 100 THEN',
'        v_min_score_use := 90;',
'    END IF;',
'',
'    IF p_file_id IS NULL THEN',
'        p_status := ''E'';',
'        p_message := ''File ID must be provided'';',
'        p_output_json := NULL;',
'        RETURN;',
'    END IF;',
'',
'    IF p_hotel_id IS NULL THEN',
'        p_status := ''E'';',
'        p_message := ''Hotel ID must be provided'';',
'        p_output_json := NULL;',
'        RETURN;',
'    END IF;',
'',
'    debug(''Starting processing...'');',
'    debug(''File ID: '' || p_file_id);',
'    debug(''Hotel ID: '' || p_hotel_id);',
'    debug(''Minimum Score: '' || v_min_score_use);',
'',
'    -- Fetch and normalize source CLOB',
'    BEGIN',
'        SELECT columns INTO v_source_clob FROM temp_blob WHERE id = p_file_id;',
'        IF v_source_clob IS NULL THEN',
'            p_status := ''E'';',
'            p_message := ''Source definition not found for file_id '' || p_file_id;',
'            p_output_json := NULL;',
'            RETURN;',
'        END IF;',
'    EXCEPTION',
'        WHEN NO_DATA_FOUND THEN',
'            p_status := ''E'';',
'            p_message := ''Source file not found for id '' || p_file_id;',
'            p_output_json := NULL;',
'            RETURN;',
'        WHEN OTHERS THEN',
'            p_status := ''E'';',
'            p_message := ''Error fetching source definition: '' || SQLERRM;',
'            p_output_json := NULL;',
'            RETURN;',
'    END;',
'',
'    v_source_normalized := normalize_json(v_source_clob);',
'',
'    -- Parse source defs',
'    v_source_defs := parse_definition(v_source_normalized);',
'    IF v_source_defs IS NULL OR v_source_defs.COUNT = 0 THEN',
'        p_status := ''E'';',
'        p_message := ''Cannot parse source definition JSON or empty definition'';',
'        p_output_json := NULL;',
'        RETURN;',
'    END IF;',
'    debug(''Parsed Source definitions: '' || v_source_defs.COUNT || '' fields'');',
'',
'    -- Initialize JSON output',
'    v_json_output := ''['';',
'    v_count_templates := 0;',
'',
'    -- Loop over target templates from cursor',
'    FOR r_target IN c_targets LOOP',
'        v_target_id := r_target.ID;',
'        v_target_name := r_target.NAME;',
'        v_target_def_clob := r_target.DEFINITION;',
'',
'        IF v_target_def_clob IS NULL THEN',
'            debug(''Skipping template '' || v_target_id || '' due to NULL definition'');',
'            CONTINUE;',
'        END IF;',
'',
'        v_target_normalized := normalize_json(v_target_def_clob);',
'',
'        v_target_defs := parse_definition(v_target_normalized);',
'        IF v_target_defs IS NULL OR v_target_defs.COUNT = 0 THEN',
'            debug(''Skipping template '' || v_target_id || '' due to parsing error or empty definition'');',
'            CONTINUE;',
'        END IF;',
'',
'        v_match_count := count_matches(v_source_defs, v_target_defs);',
'',
'        v_score := ROUND((2 * v_match_count) / (v_source_defs.COUNT + v_target_defs.COUNT) * 100);',
'',
'        debug(''Template '' || v_target_id || '' ('' || v_target_name || ''): Matches='' || ',
'              v_match_count || '', Score='' || v_score);',
'',
'        IF v_score >= v_min_score_use THEN',
'            IF v_count_templates > 0 THEN',
'                v_json_output := v_json_output || '','';',
'            END IF;',
'            v_json_output := v_json_output || ''{"Template_id":"'' || v_target_id || ',
'                            ''","Template_Name":"'' || REPLACE(v_target_name,''"'',''\"'') || ',
'                            ''","Score":'' || v_score || ''}'';',
'            v_count_templates := v_count_templates + 1;',
'        END IF;',
'    END LOOP;',
'',
'    v_json_output := v_json_output || '']'';',
'',
'    IF v_count_templates = 0 THEN',
'        p_output_json := ''[{}]'';',
'        p_message := ''No templates matched the minimum score threshold'';',
'        debug(''No matching templates found.'');',
'    ELSE',
'        p_output_json := v_json_output;',
'        p_message := ''Templates matched: '' || v_count_templates;',
'        debug(''Matching templates count: '' || v_count_templates);',
'    END IF;',
'',
'    p_status := ''S'';',
'',
'EXCEPTION',
'    WHEN OTHERS THEN',
'        p_status := ''E'';',
'        p_message := ''Unexpected error: '' || SQLERRM;',
'        p_output_json := NULL;',
'END fetch_templates;',
'',
'PROCEDURE DELETE_TEMPLATES (',
'    p_id            IN VARCHAR2 DEFAULT NULL,',
'    p_hotel_id      IN VARCHAR2 DEFAULT NULL,',
'    p_key           IN VARCHAR2 DEFAULT NULL,',
'    p_name          IN VARCHAR2 DEFAULT NULL,',
'    p_type          IN VARCHAR2 DEFAULT NULL,',
'    p_active        IN CHAR DEFAULT NULL,',
'    p_db_obj_empty  IN CHAR DEFAULT NULL,',
'    p_delete_all    IN CHAR DEFAULT ''N'',',
'    p_debug         IN CHAR DEFAULT ''N'',',
'    p_json_output   OUT CLOB',
'  )',
'  AS',
'    v_sql            VARCHAR2(1000);',
'    v_rows_count     NUMBER;',
'    v_status         CHAR(1);',
'    v_message        VARCHAR2(4000);',
'    v_json_list      CLOB := ''['';',
'    v_first          BOOLEAN := TRUE;',
'',
'    CURSOR c_templates IS',
'      SELECT id, hotel_id, key, name, type, active, db_object_name',
'      FROM ur_templates',
'      WHERE (p_delete_all = ''Y''',
'            OR (p_id IS NULL OR id = p_id))',
'        AND (p_delete_all = ''Y''',
'             OR (p_hotel_id IS NULL OR hotel_id = p_hotel_id))',
'        AND (p_delete_all = ''Y''',
'             OR (p_key IS NULL OR key = p_key))',
'        AND (p_delete_all = ''Y''',
'             OR (p_name IS NULL OR name = p_name))',
'        AND (p_delete_all = ''Y''',
'             OR (p_type IS NULL OR type = p_type))',
'        AND (p_delete_all = ''Y''',
'             OR (p_active IS NULL OR active = p_active));',
'',
'    -- Helper to escape JSON strings (basic)',
'    FUNCTION json_escape(str IN VARCHAR2) RETURN VARCHAR2 IS',
'    BEGIN',
'      RETURN REPLACE(REPLACE(REPLACE(REPLACE(str, ''\'', ''\\''), ''"'', ''\"''), CHR(10), ''\n''), CHR(13), '''');',
'    EXCEPTION WHEN OTHERS THEN',
'      RETURN '''';',
'    END;',
'',
'    PROCEDURE dbg(p_msg VARCHAR2) IS',
'    BEGIN',
'      IF p_debug = ''Y'' THEN',
'        apex_debug.message(p_msg);',
'      END IF;',
'    END;',
'',
'    PROCEDURE append_result (',
'      p_id            IN VARCHAR2,',
'      p_hotel_id      IN VARCHAR2,',
'      p_key           IN VARCHAR2,',
'      p_name          IN VARCHAR2,',
'      p_type          IN VARCHAR2,',
'      p_active        IN CHAR,',
'      p_db_obj_name   IN VARCHAR2,',
'      p_status        IN CHAR,',
'      p_message       IN VARCHAR2',
'    ) IS',
'    BEGIN',
'      IF v_first THEN',
'        v_first := FALSE;',
'      ELSE',
'        v_json_list := v_json_list || '','';',
'      END IF;',
'',
'      v_json_list := v_json_list || ''{'' ||',
'        ''"id":"''          || json_escape(p_id)          || ''",'' ||',
'        ''"hotel_id":"''    || json_escape(p_hotel_id)    || ''",'' ||',
'        ''"key":"''         || json_escape(p_key)         || ''",'' ||',
'        ''"name":"''        || json_escape(p_name)        || ''",'' ||',
'        ''"type":"''        || json_escape(p_type)        || ''",'' ||',
'        ''"active":"''      || json_escape(p_active)      || ''",'' ||',
'        ''"db_object_name":"'' || json_escape(p_db_obj_name) || ''",'' ||',
'        ''"status":"''      || json_escape(p_status)      || ''",'' ||',
'        ''"message":"''     || json_escape(p_message)     || ''"'' ||',
'      ''}'';',
'    END;',
'',
'  BEGIN',
'    dbg(''Started DELETE_TEMPLATES_AND_DB_OBJECTS_JSON procedure.'');',
'',
'    FOR rec IN c_templates LOOP',
'      dbg(''Processing template ID='' || rec.id || '', DB_OBJECT_NAME='' || rec.db_object_name);',
'',
'      IF rec.db_object_name IS NULL THEN',
'        v_status := ''E'';',
'        v_message := ''No DB_OBJECT_NAME specified for template, skipping.'';',
'        dbg(v_message);',
'        append_result(rec.id, rec.hotel_id, rec.key, rec.name, rec.type, rec.active, NULL, v_status, v_message);',
'        CONTINUE;',
'      END IF;',
'',
'      -- Check if table exists in user schema',
'    --   SELECT COUNT(*)',
'    --     INTO v_rows_count',
'    --     FROM all_tables',
'    --    WHERE table_name = rec.db_object_name',
'    --      AND owner = USER;',
'',
'    --   IF v_rows_count = 0 THEN',
'    --     v_status := ''E'';',
'    --     v_message := ''DB Object ['' || rec.db_object_name || ''] does not exist or is not a table.'';',
'    --     dbg(v_message);',
'    --     append_result(rec.id, rec.hotel_id, rec.key, rec.name, rec.type, rec.active, rec.db_object_name, v_status, v_message);',
'    --     CONTINUE;',
'    --   END IF;',
'',
'      -- Check if table should be empty before deleting',
'      IF p_db_obj_empty = ''Y'' THEN',
'        v_sql := ''SELECT COUNT(*) FROM '' || rec.db_object_name;',
'        BEGIN',
'          EXECUTE IMMEDIATE v_sql INTO v_rows_count;',
'        EXCEPTION',
'          WHEN OTHERS THEN',
'            v_rows_count := -1; -- can''t count, treat as error or non-empty',
'        END;',
'',
'        IF v_rows_count > 0 THEN',
'          v_status := ''E'';',
'          v_message := ''DB Object table ['' || rec.db_object_name || ''] is not empty (ROWS='' || v_rows_count || ''), skipping deletion.'';',
'          dbg(v_message);',
'          append_result(rec.id, rec.hotel_id, rec.key, rec.name, rec.type, rec.active, rec.db_object_name, v_status, v_message);',
'          CONTINUE;',
'        END IF;',
'        dbg(''DB Object table ['' || rec.db_object_name || ''] is empty, proceeding.'');',
'      END IF;',
'',
'      -- Try to drop the table and delete template',
'      BEGIN',
'        v_sql := ''DROP TABLE '' || rec.db_object_name || '' CASCADE CONSTRAINTS'';',
'        dbg(''Executing: '' || v_sql);',
'        EXECUTE IMMEDIATE v_sql;',
'',
'        dbg(''Dropped table '' || rec.db_object_name);',
'',
'        DELETE FROM ur_templates WHERE id = rec.id;',
'',
'        dbg(''Deleted template id='' || rec.id);',
'',
'        v_status := ''S'';',
'        v_message := ''Successfully dropped table and deleted template.'';',
'        append_result(rec.id, rec.hotel_id, rec.key, rec.name, rec.type, rec.active, rec.db_object_name, v_status, v_message);',
'',
'      EXCEPTION',
'        WHEN OTHERS THEN',
'          v_status := ''E'';',
'          v_message := ''Error dropping table or deleting template: '' || SQLERRM;',
'          dbg(v_message);',
'          append_result(rec.id, rec.hotel_id, rec.key, rec.name, rec.type, rec.active, rec.db_object_name, v_status, v_message);',
'      END;',
'    END LOOP;',
'',
'    v_json_list := v_json_list || '']'';',
'',
'    p_json_output := v_json_list;',
'',
'    dbg(''Completed DELETE_TEMPLATES_AND_DB_OBJECTS_JSON procedure.'');',
'  END DELETE_TEMPLATES;',
'',
'PROCEDURE manage_algo_attributes(',
'    p_template_key   IN  VARCHAR2,',
'    p_mode           IN  CHAR,',
'    p_attribute_key  IN  VARCHAR2 DEFAULT NULL,',
'    p_status         OUT BOOLEAN,',
'    p_message        OUT VARCHAR2',
') IS',
'  v_db_object_name UR_TEMPLATES.DB_OBJECT_NAME%TYPE;',
'  v_definition     UR_TEMPLATES.DEFINITION%TYPE;',
'  v_hotel_id       UR_TEMPLATES.HOTEL_ID%TYPE;',
'  v_user_id        RAW(16);',
'  v_insert_count   NUMBER := 0;',
'  v_delete_count   NUMBER := 0;',
'BEGIN',
'  -- Initialization',
'  p_status := FALSE;',
'  p_message := NULL;',
'',
'  -- Obtain needed data from UR_TEMPLATES',
'  BEGIN',
'    SELECT db_object_name, definition, hotel_id',
'    INTO v_db_object_name, v_definition, v_hotel_id',
'    FROM ur_templates',
'    WHERE key = p_template_key;',
'  EXCEPTION',
'    WHEN NO_DATA_FOUND THEN',
'      p_message := ''Failure: Template key not found: '' || p_template_key;',
'      RETURN;',
'  END;',
'',
'  IF v_db_object_name IS NULL THEN',
'    p_message := ''Failure: DB_OBJECT_NAME not defined for template_key '' || p_template_key;',
'    RETURN;',
'  END IF;',
'',
'  -- Get USER_ID once for audit columns',
'  BEGIN',
'    SELECT USER_ID INTO v_user_id',
'    FROM UR_USERS',
'    WHERE USER_NAME = SYS_CONTEXT(''APEX$SESSION'', ''APP_USER'');',
'  EXCEPTION',
'    WHEN NO_DATA_FOUND THEN',
'      v_user_id := NULL;',
'  END;',
'',
'  IF p_mode = ''C'' THEN',
'    IF v_definition IS NULL THEN',
'      p_message := ''Failure: Definition JSON is NULL for template_key '' || p_template_key;',
'      RETURN;',
'    END IF;',
'',
'    -- Insert attributes for all columns with qualifier <> ''UNIQUE''',
'    FOR rec IN (',
'      SELECT jt.name, jt.data_type, jt.qualifier',
'      FROM JSON_TABLE(',
'        v_definition,',
'        ''$[*]'' COLUMNS (',
'          name       VARCHAR2(100) PATH ''$.name'',',
'          data_type  VARCHAR2(30)  PATH ''$.data_type'',',
'          qualifier  VARCHAR2(30)  PATH ''$.qualifier''',
'        )',
'      ) jt',
'      WHERE jt.qualifier IS NOT NULL',
'        AND UPPER(jt.qualifier) <> ''UNIQUE''',
'    )',
'    LOOP',
'      DECLARE',
'        l_col_name VARCHAR2(150);',
'        v_key      VARCHAR2(150);',
'        v_exists   NUMBER;',
'      BEGIN',
'        -- Normalize column name (remove trailing underscores, spaces, upper-case)',
'    --  l_col_name := UPPER(TRIM(BOTH ''_'' FROM TRIM(rec.name)));',
'-- Normalize: trim spaces, collapse multiple underscores, and remove trailing underscores',
'l_col_name := UPPER(',
'                REGEXP_REPLACE(',
'                  TRIM(rec.name),      -- trim spaces',
'                  ''_+$'',               -- remove trailing underscores',
'                  ''''',
'                )',
'              );',
'',
'',
'        v_key := v_db_object_name || ''.'' || l_col_name;',
'',
'        SELECT COUNT(*) INTO v_exists FROM ur_algo_attributes WHERE key = v_key;',
'        IF v_exists = 0 THEN',
'          INSERT INTO ur_algo_attributes (',
'            id, algo_id, hotel_id, name, key, data_type, description, type, value,',
'            created_by, updated_by, created_on, updated_on',
'          ) VALUES (',
'            SYS_GUID(),',
'            NULL, -- algo_id set to NULL as requested',
'            v_hotel_id,',
'            l_col_name,',
'            v_key,',
'            NVL(UPPER(rec.data_type), ''NUMBER''),',
'            NULL,',
'            ''S'',',
'            v_key,',
'            v_user_id,',
'            v_user_id,',
'            SYSDATE,',
'            SYSDATE',
'          );',
'',
'          v_insert_count := v_insert_count + 1;',
'        END IF;',
'      END;',
'    END LOOP;',
'',
'    COMMIT;',
'',
'    p_status := TRUE;',
'    p_message := ''Success: '' || v_insert_count || '' attribute''',
'                 || CASE WHEN v_insert_count = 1 THEN '''' ELSE ''s'' END',
'                 || '' inserted for template_key '' || p_template_key;',
'',
'  ELSIF p_mode = ''D'' THEN',
'    IF p_attribute_key IS NOT NULL THEN',
'      IF p_attribute_key LIKE v_db_object_name || ''.%'' THEN',
'        DELETE FROM ur_algo_attributes WHERE key = p_attribute_key;',
'        v_delete_count := SQL%ROWCOUNT;',
'        COMMIT;',
'',
'        p_status := TRUE;',
'        IF v_delete_count > 0 THEN',
'          p_message := ''Success: '' || v_delete_count || '' attribute deleted with key '' || p_attribute_key;',
'        ELSE',
'          p_message := ''Info: No attribute found to delete with key '' || p_attribute_key;',
'        END IF;',
'      ELSE',
'        p_status := FALSE;',
'        p_message := ''Failure: Attribute key does not belong to template '' || p_template_key;',
'      END IF;',
'    ELSE',
'      DELETE FROM ur_algo_attributes WHERE key LIKE v_db_object_name || ''.%'';',
'      v_delete_count := SQL%ROWCOUNT;',
'      COMMIT;',
'',
'      p_status := TRUE;',
'      p_message := ''Success: '' || v_delete_count || '' attribute''',
'                   || CASE WHEN v_delete_count = 1 THEN '''' ELSE ''s'' END',
'                   || '' deleted for template_key '' || p_template_key;',
'    END IF;',
'',
'  ELSIF p_mode = ''U'' THEN',
'    p_status := FALSE;',
'    p_message := ''Update mode not yet implemented'';',
'',
'  ELSE',
'    p_status := FALSE;',
'    p_message := ''Invalid mode: '' || p_mode || ''. Valid modes are C, U, D.'';',
'  END IF;',
'',
'EXCEPTION',
'  WHEN OTHERS THEN',
'    p_status := FALSE;',
'    p_message := ''Failure: '' || SQLERRM;',
'END manage_algo_attributes;',
'',
'',
'procedure add_alert(',
'    p_existing_json in clob,',
'    p_message in varchar2,',
'    p_icon in varchar2 default null,',
'    p_title in varchar2 default null,',
'    p_timeout in number default null,',
'    p_updated_json out clob',
') is',
'    l_json_array json_array_t;',
'    l_new_object json_object_t;',
'begin',
'    -- Create the new JSON object',
'    l_new_object := new json_object_t();',
'    l_new_object.put(''message'', p_message);',
'    l_new_object.put(''icon'', nvl(p_icon, ''success''));',
'    l_new_object.put(''title'', nvl(p_title, ''''));',
'',
'    if p_timeout is not null then',
'        l_new_object.put(''timeOut'', to_char(p_timeout));',
'    end if;',
'',
'    -- Append the new object to the existing array or create a new array',
'    if p_existing_json is null or trim(p_existing_json) = '''' then',
'        -- Create a new array with the new object',
'        l_json_array := new json_array_t();',
'    else',
'        -- Parse the existing JSON string into a JSON array',
'        l_json_array := json_array_t(p_existing_json);',
'    end if;',
'',
'    -- Append the new object',
'    l_json_array.append(l_new_object);',
'',
'    -- Convert the JSON array back to a CLOB',
'    p_updated_json := l_json_array.to_clob;',
'end add_alert;',
'',
'PROCEDURE validate_expression (',
'    p_expression IN VARCHAR2,',
'    p_mode IN CHAR,',
'    p_hotel_id IN VARCHAR2,',
'    p_status OUT VARCHAR2, -- ''S'' or ''E''',
'    p_message OUT VARCHAR2',
') IS',
'  TYPE t_str_list IS TABLE OF VARCHAR2(100) INDEX BY PLS_INTEGER;',
'  v_attributes t_str_list;',
'  v_functions t_str_list;',
'  v_operators t_str_list;',
'  v_attr_count NUMBER := 0;',
'  v_func_count NUMBER := 0;',
'  v_oper_count NUMBER := 0;',
'',
'  TYPE t_token_rec IS RECORD (',
'    token VARCHAR2(4000),',
'    start_pos PLS_INTEGER,',
'    end_pos PLS_INTEGER',
'  );',
'  TYPE t_token_tab IS TABLE OF t_token_rec INDEX BY PLS_INTEGER;',
'  v_tokens t_token_tab;',
'  v_token_count PLS_INTEGER := 0;',
'',
'  TYPE t_token_tab_nt IS TABLE OF VARCHAR2(100) INDEX BY PLS_INTEGER;',
'  v_unmatched_tokens t_token_tab;',
'  v_unmatched_count PLS_INTEGER := 0;',
'',
'  -- To mark tokens consumed by multi-word operators',
'  TYPE t_bool_tab IS TABLE OF BOOLEAN INDEX BY PLS_INTEGER;',
'  v_token_consumed t_bool_tab;',
'',
'  v_mode CHAR := UPPER(p_mode);',
'',
'  -- Trim and uppercase token helper',
'  FUNCTION normalize_token(p_token VARCHAR2) RETURN VARCHAR2 IS',
'  BEGIN',
'    RETURN UPPER(TRIM(p_token));',
'  END;',
'',
'  -- Strip function parameters, e.g. "ROUND (n,d)" -> "ROUND"',
'  FUNCTION normalize_func_name(p_func VARCHAR2) RETURN VARCHAR2 IS',
'  BEGIN',
'    RETURN REGEXP_REPLACE(UPPER(TRIM(p_func)), ''\s*\(.*\)$'');',
'  END;',
'',
'  -- Checks if token is numeric',
'  FUNCTION is_number(p_token VARCHAR2) RETURN BOOLEAN IS',
'  BEGIN',
'    RETURN REGEXP_LIKE(p_token, ''^[+-]?(\d+(\.\d*)?|\.\d+)([Ee][+-]?\d+)?$'');',
'  END;',
'',
'  -- Check presence in list',
'  FUNCTION is_in_list(p_token VARCHAR2, p_list t_str_list, cnt NUMBER) RETURN BOOLEAN IS',
'  BEGIN',
'    FOR i IN 1..cnt LOOP',
'      IF p_list(i) = p_token THEN',
'        RETURN TRUE;',
'      END IF;',
'    END LOOP;',
'    RETURN FALSE;',
'  END;',
'',
'  -- Check if token valid: attribute, operator, function, number, parentheses',
'  FUNCTION is_token_valid(p_token VARCHAR2) RETURN BOOLEAN IS',
'    l_token VARCHAR2(100) := p_token;',
'  BEGIN',
'    -- Parentheses always valid tokens',
'    IF l_token IN (''('', '')'') THEN',
'      RETURN TRUE;',
'    END IF;',
'',
'    -- Strip trailing ''('' from function calls',
'    IF SUBSTR(l_token, -1) = ''('' THEN',
'      l_token := SUBSTR(l_token, 1, LENGTH(l_token) - 1);',
'    END IF;',
'',
'    -- Check if number',
'    IF is_number(l_token) THEN',
'      RETURN TRUE;',
'    END IF;',
'',
'    l_token := normalize_token(l_token);',
'',
'    IF is_in_list(l_token, v_attributes, v_attr_count) THEN',
'      RETURN TRUE;',
'    ELSIF is_in_list(l_token, v_functions, v_func_count) THEN',
'      RETURN TRUE;',
'    ELSIF is_in_list(l_token, v_operators, v_oper_count) THEN',
'      RETURN TRUE;',
'    END IF;',
'',
'    RETURN FALSE;',
'  END;',
'',
'  PROCEDURE load_functions(p_list OUT t_str_list, p_count OUT NUMBER) IS',
'  BEGIN',
'    p_list.DELETE;',
'    p_count := 0;',
'    FOR r IN (',
'      SELECT return_value FROM apex_application_lov_entries',
'      WHERE list_of_values_name = ''UR EXPRESSION FUNCTIONS''',
'      ORDER BY return_value',
'    ) LOOP',
'      p_count := p_count + 1;',
'      p_list(p_count) := normalize_func_name(r.return_value);',
'    END LOOP;',
'    IF p_count = 0 THEN',
'      RAISE_APPLICATION_ERROR(-20010, ''Functions LOV missing or empty'');',
'    END IF;',
'  END;',
'',
'  PROCEDURE load_operators(p_list OUT t_str_list, p_count OUT NUMBER) IS',
'  BEGIN',
'    p_list.DELETE;',
'    p_count := 0;',
'    FOR r IN (',
'      SELECT return_value FROM apex_application_lov_entries',
'      WHERE list_of_values_name = ''UR EXPRESSION OPERATORS''',
'      ORDER BY return_value',
'    ) LOOP',
'      p_count := p_count + 1;',
'      p_list(p_count) := UPPER(TRIM(r.return_value));',
'    END LOOP;',
'    IF p_count = 0 THEN',
'      RAISE_APPLICATION_ERROR(-20011, ''Operators LOV missing or empty'');',
'    END IF;',
'  END;',
'',
'  PROCEDURE load_attributes(p_hotel_id IN VARCHAR2, p_list OUT t_str_list, p_count OUT NUMBER) IS',
'  BEGIN',
'    p_list.DELETE;',
'    p_count := 0;',
'    FOR r IN (',
'      SELECT key FROM ur_algo_attributes WHERE hotel_id = p_hotel_id',
'    ) LOOP',
'      p_count := p_count + 1;',
'      p_list(p_count) := UPPER(TRIM(r.key));',
'    END LOOP;',
'    IF p_count = 0 THEN',
'      RAISE_APPLICATION_ERROR(-20012, ''Attributes missing for hotel_id '' || p_hotel_id);',
'    END IF;',
'  END;',
'',
'  -- Tokenizer splitting expression into tokens, tracking start/end pos',
'  PROCEDURE tokenize_expression(p_expr IN VARCHAR2, p_tokens OUT t_token_tab, p_count OUT NUMBER) IS',
'    l_pos PLS_INTEGER := 1;',
'    l_len PLS_INTEGER := LENGTH(p_expr);',
'    l_token VARCHAR2(4000);',
'    l_token_start PLS_INTEGER;',
'    l_token_end PLS_INTEGER;',
'  BEGIN',
'    p_tokens.DELETE;',
'    p_count := 0;',
'    WHILE l_pos <= l_len LOOP',
'      l_token := REGEXP_SUBSTR(p_expr,',
'        ''([A-Za-z0-9_\.]+|\d+(\.\d+)?|\(|\)|\S)'',',
'        l_pos,',
'        1,',
'        ''i'');',
'      EXIT WHEN l_token IS NULL;',
'      l_token_start := INSTR(p_expr, l_token, l_pos);',
'      l_token_end := l_token_start + LENGTH(l_token) - 1;',
'      p_count := p_count + 1;',
'      p_tokens(p_count) := t_token_rec(token => l_token, start_pos => l_token_start, end_pos => l_token_end);',
'      l_pos := l_token_end + 1;',
'      WHILE l_pos <= l_len AND SUBSTR(p_expr, l_pos, 1) = '' '' LOOP',
'        l_pos := l_pos + 1;',
'      END LOOP;',
'    END LOOP;',
'  END;',
'',
'  FUNCTION build_json_errors(p_unmatched t_token_tab, p_count PLS_INTEGER) RETURN VARCHAR2 IS',
'    v_json VARCHAR2(4000) := ''['';',
'  BEGIN',
'    IF p_count = 0 THEN',
'      RETURN ''[]'';',
'    END IF;',
'    FOR i IN 1..p_count LOOP',
'      v_json := v_json || ''{"token":"'' || p_unmatched(i).token ||',
'                ''","start":'' || p_unmatched(i).start_pos ||',
'                '',"end":'' || p_unmatched(i).end_pos || ''}'';',
'      IF i < p_count THEN',
'        v_json := v_json || '','';',
'      END IF;',
'    END LOOP;',
'    v_json := v_json || '']'';',
'    RETURN v_json;',
'  END;',
'',
'  -- Return number of consecutive tokens matched as an operator starting at start_idx',
'  FUNCTION get_longest_operator_match(start_idx IN PLS_INTEGER) RETURN PLS_INTEGER IS',
'    combined VARCHAR2(4000);',
'    max_words CONSTANT PLS_INTEGER := 4; -- max operator words count',
'    words_count PLS_INTEGER;',
'    l_len PLS_INTEGER := LEAST(max_words, v_token_count - start_idx + 1);',
'    i PLS_INTEGER;',
'  BEGIN',
'    FOR words_count IN REVERSE 1 .. l_len LOOP',
'      combined := '''';',
'      FOR i IN start_idx .. start_idx + words_count - 1 LOOP',
'        IF combined IS NULL OR combined = '''' THEN',
'          combined := UPPER(TRIM(v_tokens(i).token));',
'        ELSE',
'          combined := combined || '' '' || UPPER(TRIM(v_tokens(i).token));',
'        END IF;',
'      END LOOP;',
'      IF is_in_list(combined, v_operators, v_oper_count) THEN',
'        RETURN words_count;',
'      END IF;',
'    END LOOP;',
'    RETURN 0;',
'  END;',
'',
'BEGIN',
'  p_status := ''E'';',
'  p_message := NULL;',
'',
'  IF v_mode NOT IN (''V'', ''C'') THEN',
'    p_status := ''E'';',
'    p_message := ''Invalid mode "'' || p_mode || ''". Valid are V or C.'';',
'    RETURN;',
'  END IF;',
'',
'  IF p_hotel_id IS NULL THEN',
'    p_status := ''E'';',
'    p_message := ''hotel_id is mandatory'';',
'    RETURN;',
'  END IF;',
'',
'  IF p_expression IS NULL OR LENGTH(TRIM(p_expression)) = 0 THEN',
'    p_status := ''E'';',
'    p_message := ''Expression is empty'';',
'    RETURN;',
'  END IF;',
'',
'  load_functions(v_functions, v_func_count);',
'  load_operators(v_operators, v_oper_count);',
'  load_attributes(p_hotel_id, v_attributes, v_attr_count);',
'',
'  tokenize_expression(p_expression, v_tokens, v_token_count);',
'',
'  -- Initialize consumed array',
'  v_token_consumed.DELETE;',
'',
'  DECLARE',
'    i PLS_INTEGER := 1;',
'    words_matched PLS_INTEGER := 0;',
'  BEGIN',
'    WHILE i <= v_token_count LOOP',
'      words_matched := get_longest_operator_match(i);',
'      IF words_matched > 0 THEN',
'        FOR j IN i .. i + words_matched - 1 LOOP',
'          v_token_consumed(j) := TRUE;',
'        END LOOP;',
'        i := i + words_matched;',
'      ELSE',
'        -- Single token valid check',
'        v_token_consumed(i) := is_token_valid(normalize_token(v_tokens(i).token));',
'        i := i + 1;',
'      END IF;',
'    END LOOP;',
'  END;',
'',
'  IF v_mode = ''V'' THEN',
'    v_unmatched_tokens.DELETE;',
'    v_unmatched_count := 0;',
'    FOR i IN 1 .. v_token_count LOOP',
'      IF v_token_consumed.EXISTS(i) AND v_token_consumed(i) = FALSE THEN',
'        v_unmatched_count := v_unmatched_count + 1;',
'        v_unmatched_tokens(v_unmatched_count) := v_tokens(i);',
'      END IF;',
'    END LOOP;',
'',
'    IF v_unmatched_count > 0 THEN',
'      p_status := ''E'';',
'      p_message := ''Invalid tokens: '' || build_json_errors(v_unmatched_t'))
);
wwv_flow_imp_shared.append_to_install_script(
 p_id=>wwv_flow_imp.id(17568291839509893)
,p_script_clob=>wwv_flow_string.join(wwv_flow_t_varchar2(
'okens, v_unmatched_count);',
'    ELSE',
'      p_status := ''S'';',
'      p_message := ''Expression validated successfully.'';',
'    END IF;',
'',
'  ELSIF v_mode = ''C'' THEN',
'    p_status := ''S'';',
'    p_message := '''';',
'    FOR i IN 1..v_token_count LOOP',
'      IF v_token_consumed.EXISTS(i) AND v_token_consumed(i) = TRUE THEN',
'        p_message := p_message || v_tokens(i).token || '' '';',
'      END IF;',
'    END LOOP;',
'    p_message := RTRIM(p_message);',
'  END IF;',
'',
'EXCEPTION',
'  WHEN OTHERS THEN',
'    p_status := ''E'';',
'    p_message := ''Failure: '' || SQLERRM;',
'END validate_expression;',
'',
'',
'END UR_UTILS_TEST_1;',
'/',
'create or replace PACKAGE BODY XXPEL_A001_FEEDBACK AS',
'',
'  FUNCTION get_profile_value(p_key VARCHAR2) RETURN VARCHAR2 IS',
'    v_return_value VARCHAR2(4000);',
'  BEGIN',
'    SELECT VALUE INTO v_return_value FROM XXPEL_WF_GLOBAL_PROFILES_TBL WHERE KEY = p_key;',
'    RETURN v_return_value;',
'  EXCEPTION',
'    WHEN NO_DATA_FOUND THEN',
'      RETURN NULL;',
'  END get_profile_value;',
'',
'  PROCEDURE SUBMIT_FEEDBACK(',
'    p_feedback       IN VARCHAR2,',
'    p_rating         IN VARCHAR2,',
'    p_new_type       IN VARCHAR2,',
'    p_summary        IN VARCHAR2,',
'    p_description    IN VARCHAR2,',
'    p_page_id        IN NUMBER,',
'    p_app_id         IN NUMBER,',
'    p_app_user       IN VARCHAR2',
'  ) IS',
'    L_FEEDBACK_ID     NUMBER;',
'    L_EMAIL_login     VARCHAR2(2000);',
'    L_EMAIL           VARCHAR2(2000);',
'    L_EMAIL_ENABLE    VARCHAR2(2000);',
'    L_CLOB            CLOB;',
'    L_JIRA_PAYLOAD    CLOB;',
'    L_ISSUE_KEY       VARCHAR2(100);',
'    L_ISSUE_URL       VARCHAR2(4000);',
'    L_JIRA_URL        VARCHAR2(4000);',
'    L_JIRA_USERNAME   VARCHAR2(2000);',
'    L_JIRA_API_TOKEN  VARCHAR2(4000);',
'    L_EMAIL_FROM      VARCHAR2(4000);',
'    L_NEW_TYPE        VARCHAR2(100) := NVL(p_new_type, ''Feedback'');',
'    L_SUMMARY         VARCHAR2(4000) := p_summary;',
'    L_DESCRIPTION     VARCHAR2(4000) := p_description;',
'    ',
'    L_JIRA_BROWSE_URL VARCHAR2(4000);',
'     L_feedback_type VARCHAR2(4000);',
'BEGIN',
' /*   IF p_new_type IS NULL THEN',
'      L_DESCRIPTION := p_feedback;',
'      L_SUMMARY := p_rating;',
'    END IF;*/',
'SELECT DECODE(p_new_type,2,''Bug'',3,''Enhancement Request'',''Feedback'') INTO L_feedback_type',
' from dual;',
'    L_EMAIL := get_profile_value(''FEEDBACK_EMAIL_ADDR'');',
'    L_EMAIL_ENABLE := get_profile_value(''ENABLE_FEEDBACK_EMAIL'');',
'    L_JIRA_URL := get_profile_value(''JIRA_API_URL'');',
'    L_JIRA_USERNAME := get_profile_value(''JIRA_USERNAME'');',
'    L_JIRA_API_TOKEN := get_profile_value(''JIRA_API_TOKEN'');',
'    L_EMAIL_FROM := get_profile_value(''EMAIL_FROM_ADDR'');',
'    L_JIRA_BROWSE_URL := get_profile_value(''JIRA_BROWSE_URL'');',
'',
'    BEGIN',
'    --  SELECT ''sahilmagdum@projecteidos.com'' INTO L_EMAIL_login FROM dual;',
'      SELECT EMAIL',
'      INTO L_EMAIL_login FROM ur_users WHERE upper(USER_NAME) =  upper(v(''app_user''));',
'    EXCEPTION',
'      WHEN NO_DATA_FOUND THEN',
'        L_EMAIL_login := ''unknown@yourdomain.com'';',
'    END;',
'',
'    apex_util.submit_feedback(',
'      p_comment        => p_feedback,',
'      p_application_id => p_app_id,',
'      p_page_id        => p_page_id,',
'      p_rating         => p_rating,',
'      p_ATTRIBUTE_01   => L_feedback_type,',
'      p_ATTRIBUTE_02   => L_SUMMARY,',
'      p_ATTRIBUTE_03   => L_DESCRIPTION,',
'      p_ATTRIBUTE_04   => L_FEEDBACK_ID',
'    );',
'',
'    -- JIRA integration',
'    IF L_feedback_type IN (''Bug'', ''Enhancement Request'') THEN',
'      L_JIRA_PAYLOAD := ''{',
'        "fields": {',
'          "project": {"key": "FOUR"},',
'          "summary": "'' || REPLACE(L_SUMMARY, ''"'', ''\"'') || '' - Feedback Ref: '' || L_FEEDBACK_ID || ''",',
'          "description": {',
'            "type": "doc",',
'            "version": 1,',
'            "content": [{',
'              "type": "paragraph",',
'              "content": [',
'                {"type": "text", "text": "Type: '' || L_feedback_type || ''"}, {"type": "hardBreak"},',
'                {"type": "text", "text": "Feedback Ref: '' || L_FEEDBACK_ID || ''"}, {"type": "hardBreak"},',
'                {"type": "text", "text": "Raised by: '' || L_EMAIL_login || ''"}, {"type": "hardBreak"},',
'                {"type": "text", "text": "Description: '' || REPLACE(L_DESCRIPTION, ''"'', ''\"'') || ''"}',
'              ]',
'            }]',
'          },',
'          "issuetype": {"name": "'' || L_feedback_type || ''"}',
'        }',
'      }'';',
'',
'      apex_web_service.g_request_headers(1).name := ''Content-Type'';',
'      apex_web_service.g_request_headers(1).value := ''application/json'';',
'',
'      L_CLOB := apex_web_service.make_rest_request(',
'        p_url => L_JIRA_URL,',
'        p_http_method => ''POST'',',
'        p_username => L_JIRA_USERNAME,',
'        p_password => L_JIRA_API_TOKEN,',
'        p_body => L_JIRA_PAYLOAD',
'      );',
'',
'      apex_json.parse(L_CLOB);',
'      L_ISSUE_KEY := apex_json.get_varchar2(p_path => ''key'');',
'      L_ISSUE_URL := L_JIRA_URL || L_ISSUE_KEY;',
'    END IF;',
'',
'    -- Email to feedback submitter',
'    apex_mail.send(',
'      p_from => L_EMAIL_FROM,',
'      p_to => L_EMAIL_login,',
'      p_subj => ''Your feedback has been submitted - Ref: '' || L_FEEDBACK_ID,',
'      p_body => ''Your '' || L_feedback_type || '' request has been submitted. Summary: '' || L_SUMMARY,',
'      p_body_html =>',
'        ''Hi,<br><br>Your feedback has been submitted.<br><br>'' ||',
'        ''Summary: '' || L_SUMMARY || ''<br>'' ||',
'        ''Description: '' || L_DESCRIPTION || ',
'        CASE WHEN L_ISSUE_KEY IS NOT NULL THEN ''<br>JIRA Issue: <a href="'' || L_ISSUE_URL || ''" target="_blank">'' || L_ISSUE_KEY || ''</a>'' ELSE '''' END ||',
'        ''<br><br>Regards,<br>Workforce Management Team''',
'    );',
'    apex_mail.push_queue;',
'',
'    -- Email to internal team / managers if email enabled & configured',
'    IF NVL(UPPER(L_EMAIL_ENABLE),''N'') = ''Y'' AND L_EMAIL IS NOT NULL THEN',
'      apex_mail.send(',
'        p_from => L_EMAIL_FROM,',
'        p_to => L_EMAIL,',
'        p_subj => ''A new '' || L_feedback_type || '' has been raised for Workforce - Ref: '' || L_FEEDBACK_ID,',
'        p_body => ''Your '' || L_feedback_type || '' request has been submitted. Summary: '' || L_SUMMARY,',
'        p_body_html =>',
'          ''Hi,<br><br>A new '' || L_feedback_type || '' has been raised.<br><br>'' ||',
'          ''Summary: '' || L_SUMMARY || ''<br>'' ||',
'          ''Description: '' || L_DESCRIPTION || ''<br>'' ||',
'          ''Requestor: '' || L_EMAIL_login || ',
'          CASE WHEN L_ISSUE_KEY IS NOT NULL THEN ''<br>JIRA Issue: <a href="'' || L_ISSUE_URL || ''" target="_blank">'' || L_ISSUE_KEY || ''</a>'' ELSE '''' END ||',
'          ''<br><br>Please review accordingly.<br><br>Regards,<br>Workforce Management Team''',
'      );',
'      apex_mail.push_queue;',
'    END IF;',
'',
'  EXCEPTION',
'    WHEN OTHERS THEN',
'      RAISE;',
'END SUBMIT_FEEDBACK;',
'',
'END XXPEL_A001_FEEDBACK;',
'/',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
'',
''))
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17568361451509903)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'FUNCTION'
,p_object_name=>'FN_SAFE_TO_DATE'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17568500878509905)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'FUNCTION'
,p_object_name=>'GET_MAP_CALCULATION_FUN'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17568798180509906)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'FUNCTION'
,p_object_name=>'GET_PROFILE_JSON'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17568993327509906)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'FUNCTION'
,p_object_name=>'GUESS_DELIMITER'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17569112131509907)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'FUNCTION'
,p_object_name=>'SANITIZE_COLUMN_NAME'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17569352235509908)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'KEY_UNIQUE'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17569532767509909)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'PK_ADDRESSES'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17569765763509909)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'PK_TEMP_BLOB'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17569999250509910)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'PK_UR_ALGOS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17570129207509911)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'PK_UR_ALGO_ATTRIBUTES'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17570367270509912)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'PK_UR_ALGO_VERSIONS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17570590796509913)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'PK_UR_CONTACTS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17570709440509913)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'PK_UR_EVENTS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17570929976509914)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'PK_UR_HOTELS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17571195662509915)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'PK_UR_HOTEL_ACCESSES'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17571347051509916)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'PK_UR_HOTEL_GROUPS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17571577663509916)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'PK_UR_HOTEL_RESERVATIONS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17571743472509917)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'PK_UR_HOTEL_ROOM_TYPES'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17571909236509918)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'PK_UR_INTERFACE_LOGS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17572193575509919)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'PK_UR_PROFILE_OPTIONS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17572328295509919)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'PK_UR_REPORTS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17572549796509920)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'PK_UR_REPORT_DASHBOARDS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17572748947509921)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'PK_UR_TEMPLATES'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17572996514509922)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'PK_UR_USERS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17573152573509922)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UK_UR_ALGO_ATTRIBUTES_KEY'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17573305068509923)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UK_UR_ALGO_VERSIONS_ALGO_VERSION'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17573536623509924)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UQ_UR_HOTEL_GROUPS_NAME'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17573772342509925)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UQ_UR_HOTEL_RES_NUMBER'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17573934413509925)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UQ_UR_PROFILE_OPTIONS_KEY'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17574128808509926)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UQ_UR_REPORTS_KEY'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17574322374509927)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UQ_UR_REPORT_DASHBOARDS_HOTEL_ID'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17574513842509928)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UQ_UR_REPORT_DASHBOARDS_KEY'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17574706296509928)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UQ_UR_REPORT_DASHBOARDS_NAME'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17574918128509929)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UQ_UR_TEMPLATES_KEY'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17575131513509930)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UQ_UR_USERS_EMAIL'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17575351887509931)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_1DAY_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17575556271509931)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_1DAY_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17575788100509932)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_3DAY2_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17575960216509933)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_3DAY2_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17576149479509934)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_3DAY_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17576326873509935)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_3DAY_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17576593768509936)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_7DAY1_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17576740778509936)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_7DAY1_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17576904451509937)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_ADAM_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17577067200509938)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_ALGOS_CON'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17577240827509938)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_BHAUMIK_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17577408685509939)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_BHAUMIK_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17577600206509940)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_CHINAR_22SEPT1_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17577881258509941)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_CHINAR_22SEPT_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17578071013509941)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_CHINAR_22SEPT_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17578288703509942)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_CHINAR_28_SEP_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17578431073509943)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_CHINAR_28_SEP_T_STAY_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17578631369509944)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_CHINAR_STAY_DATE_TEMPLATE_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17578844260509945)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_CHINAR_STAY_DATE_TEMPLATE_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17579014678509945)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_CHINAR_TEST_111_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17579212336509946)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_CHINAR_TEST_112_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17579433720509947)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_CHINAR_TEST_112_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17579690194509948)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_DAILY_BREAKDOWN11_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17579834776509948)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_DAILY_BREAKDOWN_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17580093607509949)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_DAILY_BREAKDOWN_VK_2_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17580266820509950)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_DAILY_BREAKDOWN_VK_2_T_RNS__OTB__UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17580421148509951)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_DAILY_BREAKDOWN_VK_3_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17580683385509951)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_DAILY_BREAKDOWN_VK_3_T_RNS__OTB__UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17580824507509952)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_DAILY_BREAKDOWN_VK_4_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17581076709509953)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_DAILY_BREAKDOWN_VK_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17581207762509954)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_DEMO_30SEP25_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17581460049509954)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_DEMO_30SEP25_T_SDATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17581640904509955)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_EXPENSE_TEMPLATE_02_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17581887944509956)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_EXP_REPORT_2122122_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17582054098509957)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_EXP_REPORT_212212_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17582253626509957)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_EXP_REPORT_21221_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17582437720509958)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_EXP_REPORT_21_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17582677780509959)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_EXP_REPORT_3_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17582824297509960)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_EXP_REPORT_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17583013023509960)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_HPRICOVR_HOTEL_DATE_UK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17583212344509961)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_HPRICOVR_ID_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17583492406509962)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_INDIGO_L_SQUARE_I_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17583665709509963)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_INDIGO_L_SQUARE_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17583882190509964)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_INDIGO_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17584006497509964)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_INDIGO_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17584289121509965)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_MCL_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17584458682509966)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_MCL_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17584654877509967)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_T_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17584863013509967)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17585074584509968)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_10_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17585201261509969)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_10_T_SDATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17585453627509970)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_11_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17585618703509970)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_11_T_SDATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17585849171509971)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_12_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17586002350509972)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_12_T_SDATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17586248177509973)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_13OCT_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17586457241509973)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_13OCT_T_SDATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17586620984509974)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_13_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17586826894509975)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_13_T_SDATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17587085365509976)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_14_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17587287502509977)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_14_T_SDATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17587452422509978)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_15_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17587635528509978)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_15_T_SDATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17587855883509979)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_2_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17588056600509980)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_2_T_SDATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17588266514509981)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_7_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17588444044509981)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_7_T_SDATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17588608489509982)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_8_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17588894026509983)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_8_T_SDATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17589089561509984)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_9_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17589232971509984)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_9_T_SDATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17589488957509985)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_T_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17589629962509986)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS1_YORK_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17589879369509987)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS3_YORK_T_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17590083113509987)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_LOS3_YORK_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17590257878509988)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_MCL_LOS1_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17590480547509989)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_MCL_LOS1_T_SDATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17590639395509990)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_PICKUP_INDIGO_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17590816915509990)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_PICKUP_INDIGO_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17591097682509991)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_STR_3_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17591294186509992)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_STR_3_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17591485890509993)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_STR_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17591684179509993)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEMP_1_OCT_N1_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17591847784509994)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEMP_1_OCT_N1_T_SDATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17592051122509995)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEMP_1_OCT_N2_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17592225559509996)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEMP_1_OCT_N2_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17592484993509996)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEMP_1_OCT_N_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17592689201509997)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEMP_1_OCT_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17592877104509998)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEMP_3_OCT_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17593074542509999)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEMP_3_OCT_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17593239371509999)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEMP_DEMO_11_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17593482276510000)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEMP_DEMO_11_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17593689862510001)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEMP_NN_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17593833483510002)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEMP_NN_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17594046875510002)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEST1_22_CHINAR_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17594231972510003)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEST_13_10_CP_2_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17594409239510004)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEST_13_10_CP_2_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17594616315510005)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEST_13_10_CP_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17594813188510005)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEST_13_10_CP_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17595049871510006)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEST_CHINAR_1_T_BOOKING_ID_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17595213011510007)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEST_CHINAR_1_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17595485378510008)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEST_CHINAR_29_SEP_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17595695256510008)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEST_CHINAR_29_SEP_T_STAY_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17595810937510009)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEST_CHINAR_2_T_BOOKING_ID_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17596029440510010)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEST_CHINAR_2_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17596239842510011)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEST_CHINAR_NEWEST_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17596441782510011)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEST_CHINAR_NO_USC_NEW_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17596601499510012)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEST_CHINAR_NO_USC_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17596898661510013)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEST_CHINAR_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17597004088510014)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEST_STACY_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17597269424510015)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TEST_TEMPLATE_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17597408225510015)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_TT_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17597691505510016)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_UR_BHAUMIK_30_SEP1_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17597814150510017)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_UR_BHAUMIK_30_SEP1_T_STAY_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17598060739510018)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_UR_BHAUMIK_30_SEP_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17598269543510018)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_UR_BHAUMIK_30_SEP_T_STAY_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17598429744510019)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_UR_CHINAR_QUAL_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17598649744510020)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_UR_CHINAR_QUAL_T_STAY_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17598840667510021)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_250915_1_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17599022290510021)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_250915_1_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17599282690510022)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_250915_2_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17599441311510023)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_250915_2_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17599609138510024)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_250915_3_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17599849861510024)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_250915_4_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17600094877510025)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_250915_4_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17600251953510026)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_250915_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17600418896510027)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_250915_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17600685219510027)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_ATT_QUAL1_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17600809512510028)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_ATT_QUAL1_T_RNS__OTB__UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17601026493510029)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_LEAVE_SETUP_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17601242756510030)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_LOS1_YORK_2_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17601444327510030)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_LOS1_YORK_2_T_SDATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17601698228510031)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_LOS1_YORK_3_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17601895864510032)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_LOS1_YORK_3_T_SDATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17602000637510033)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_LOS1_YORK_4_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17602280178510033)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_LOS1_YORK_4_T_SDATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17602441396510034)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_LOS1_YORK_5_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17602623104510035)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_LOS1_YORK_6_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17602831368510036)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_LOS1_YORK_7_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17603003065510036)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_LOS1_YORK_8_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17603201062510037)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_LOS1_YORK_9_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17603311580510038)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_LOS1_YORK_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17603578008510038)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_LOS1_YORK_T_SDATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17603730794510039)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_NEW_CHINAR_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17603914718510040)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_NEW_CHINAR_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17604152360510041)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_SAMPLE_HOTEL_DATA_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17604366640510041)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_SAMPLE_HOTEL_DATA_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17604599469510042)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_SEG1_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17604756610510043)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_SEGMENT_QUALIFIER1_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17604994302510044)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_SEGMENT_QUALIFIER2_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17605193096510045)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_SEGMENT_QUALIFIER_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17605346284510045)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_VK_TMS_TASK_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17605510115510046)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_YORK_LOS1_T_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17605770345510047)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_YORK_LOS1_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17605962507510048)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_YORK_LOS1_VK_29SEP25_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17606115497510048)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_YORK_LOS1_VK_29SEP25_T_S_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17606316345510049)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_YORK_TEMP12_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17606550879510050)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_YORK_TEMP12_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17606785771510051)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_YORK_TEMP14_T_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17606964381510051)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'UR_YORK_TEMP14_T_STAY_DATE_UQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17607103818510052)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'INDEX'
,p_object_name=>'XXPEL_WF_GLOBAL_PROFILES_TBL_PK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17607375921510053)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PACKAGE'
,p_object_name=>'ALGO_EVALUATOR_PKG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17607509752510054)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PACKAGE'
,p_object_name=>'APP_USER_CTX'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17607765279510054)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PACKAGE'
,p_object_name=>'GRAPH_SQL'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17607987444510055)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PACKAGE'
,p_object_name=>'PKG_GENERIC_CRUD'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17608181430510056)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PACKAGE'
,p_object_name=>'UR_USERS_PKG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17608325508510057)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PACKAGE'
,p_object_name=>'UR_USER_MGMT'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17608574856510057)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PACKAGE'
,p_object_name=>'UR_UTILS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17608750206510058)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PACKAGE'
,p_object_name=>'UR_UTILS_TEST'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17608977346510059)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PACKAGE'
,p_object_name=>'UR_UTILS_TEST_1'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17609118672510060)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PACKAGE'
,p_object_name=>'XXPEL_A001_FEEDBACK'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17609340687510060)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PROCEDURE'
,p_object_name=>'CALL_AI_CHAT_COMPLETION'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17609569895510061)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PROCEDURE'
,p_object_name=>'CALL_OPENAI_CHAT_COMPLETION'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17609740021510062)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PROCEDURE'
,p_object_name=>'DELETE_TEMPLATES_AND_DB_OBJECTS_JSON'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17609973606510063)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PROCEDURE'
,p_object_name=>'GENERIC_CRUD_PROC'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17610118743510063)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PROCEDURE'
,p_object_name=>'LOAD_DATA_STANDALONE'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17610379948510064)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PROCEDURE'
,p_object_name=>'LOAD_DATA_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17610589872510065)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PROCEDURE'
,p_object_name=>'MATCH_TEMPLATES'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17610784647510066)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PROCEDURE'
,p_object_name=>'PRC_INSERT_HOTEL_GROUP'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17610949524510066)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PROCEDURE'
,p_object_name=>'P_GENERIC_CRUD'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17611163765510067)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PROCEDURE'
,p_object_name=>'UPDATE_TEMPLATE_DEFINITION'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17611362920510068)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PROCEDURE'
,p_object_name=>'UR_UPLOAD_FILE_PROC'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17611504908510069)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PROCEDURE'
,p_object_name=>'VALIDATE_OR_CLEAN_EXPRESSION'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17611771939510069)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PROCEDURE'
,p_object_name=>'XXPEL_PARSE_ERROR_JSON'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17611980603510070)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'PROCEDURE'
,p_object_name=>'XX_LOCAL_LOAD_DATA'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17612180436510071)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'SEQUENCE'
,p_object_name=>'ISEQ$$_131819'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17612301906510072)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'SEQUENCE'
,p_object_name=>'ISEQ$$_134042'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17612526206510072)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'SEQUENCE'
,p_object_name=>'XXPEL_WF_FEEDBACK_SEQ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17612749101510073)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'DEBUG_LOG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17612989423510074)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'EXPENSES'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17613163650510075)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'HTMLDB_PLAN_TABLE'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17613326285510075)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'TEMP_BLOB'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17613559394510076)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'TEMP_UR_REPORTS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17613737950510077)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'TEMP_UR_REPORT_DASHBOARDS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17613915407510078)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_1DAY_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17614113948510078)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_3DAY2_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17614311797510079)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_3DAY_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17614535245510080)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_7DAY1_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17614745000510081)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_ADAM_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17614952168510081)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_ADDRESSES'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17615164684510082)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_ALGOS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17615390822510083)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_ALGO_ATTRIBUTES'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17615526563510084)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_ALGO_VERSIONS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17615724280510084)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_BHAUMIK_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17615986936510085)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_CHINAR_22SEPT1_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17616148238510086)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_CHINAR_22SEPT_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17616392309510087)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_CHINAR_28_SEP_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17616538022510087)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_CHINAR_STAY_DATE_TEMPLATE_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17616733940510088)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_CHINAR_TEST_111_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17616900050510089)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_CHINAR_TEST_112_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17617142045510090)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_CONTACTS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17617390079510091)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_DAILY_BREAKDOWN11_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17617559301510091)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_DAILY_BREAKDOWN_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17617706848510092)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_DAILY_BREAKDOWN_VK_2_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17617918433510093)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_DAILY_BREAKDOWN_VK_3_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17618122594510094)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_DAILY_BREAKDOWN_VK_4_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17618337528510094)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_DAILY_BREAKDOWN_VK_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17618590076510095)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_DEMO_30SEP25_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17618700130510096)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_EVENTS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17618998714510097)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_EXPENSE_TEMPLATE_02_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17619182873510097)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_EXP_REPORT_2122122_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17619364479510098)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_EXP_REPORT_212212_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17619554489510099)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_EXP_REPORT_21221_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17619773400510100)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_EXP_REPORT_21_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17619934130510100)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_EXP_REPORT_3_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17620172718510101)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_EXP_REPORT_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17620330531510102)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_HOTELS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17620501497510103)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_HOTEL_ACCESSES'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17620724318510103)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_HOTEL_GROUPS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17620986535510104)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_HOTEL_PRICE_OVERRIDE'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17621110872510105)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_HOTEL_RESERVATIONS'
);
end;
/
begin
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17621343312510106)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_HOTEL_ROOM_TYPES'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17621523116510106)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_INDIGO_L_SQUARE_I_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17621726222510107)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_INDIGO_L_SQUARE_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17621989452510108)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_INTERFACE_LOGS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17622154768510109)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_LOS1_INDIGO_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17622345608510109)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_LOS1_MCL_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17622598226510110)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_LOS1_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17622792048510111)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_LOS1_YORK_10_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17622979424510112)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_LOS1_YORK_11_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17623110025510112)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_LOS1_YORK_12_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17623378010510113)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_LOS1_YORK_13OCT_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17623592460510114)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_LOS1_YORK_13_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17623766536510115)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_LOS1_YORK_14_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17623930135510115)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_LOS1_YORK_15_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17624164772510116)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_LOS1_YORK_2_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17624395338510117)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_LOS1_YORK_2_T_ERR$'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17624595089510118)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_LOS1_YORK_2_T_ERR$1'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17624797989510118)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_LOS1_YORK_2_T_INTERFACE'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17624904827510119)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_LOS1_YORK_7_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17625127157510120)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_LOS1_YORK_8_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17625317794510121)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_LOS1_YORK_9_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17625571024510121)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_LOS1_YORK_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17625773281510122)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_LOS1_YORK_T_INTERFACE'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17625992195510123)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_LOS3_YORK_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17626114810510124)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_MCL_LOS1_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17626329324510124)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_PICKUP_INDIGO_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17626523150510125)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_PROFILE_OPTIONS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17626784931510126)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_REPORTS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17626991296510127)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_REPORT_DASHBOARDS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17627100484510127)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_STR_3_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17627338573510128)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_STR_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17627501118510129)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TEMPLATES'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17627780929510130)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TEMP_1_OCT_N1_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17627995393510131)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TEMP_1_OCT_N2_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17628149160510132)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TEMP_1_OCT_N_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17628313114510132)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TEMP_1_OCT_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17628592740510133)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TEMP_3_OCT_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17628783110510134)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TEMP_DEMO_11_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17628931746510135)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TEMP_NN_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17629105758510135)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TEST1_22_CHINAR_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17629323639510136)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TEST_13_10_CP_2_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17629595183510137)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TEST_13_10_CP_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17629724552510138)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TEST_CHINAR_1_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17629994154510138)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TEST_CHINAR_29_SEP_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17630189411510139)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TEST_CHINAR_29_SEP_T_INTERFACE'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17630397806510140)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TEST_CHINAR_2_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17630564884510141)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TEST_CHINAR_NEWEST_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17630770873510141)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TEST_CHINAR_NO_USC_NEW_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17630911416510142)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TEST_CHINAR_NO_USC_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17631135135510143)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TEST_CHINAR_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17631335489510144)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TEST_STACY_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17631501221510144)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TEST_TEMPLATE_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17631708972510145)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_TT_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17631989813510146)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_UR_BHAUMIK_30_SEP1_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17632115574510147)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_UR_BHAUMIK_30_SEP_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17632393976510148)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_UR_CHINAR_QUAL_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17632527012510148)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_UR_CHINAR_QUAL_T_INTERFACE'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17632734481510149)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_USERS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17632927347510150)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_250915_1_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17633176629510151)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_250915_2_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17633332065510151)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_250915_3_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17633597168510152)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_250915_4_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17633794967510153)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_250915_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17633966926510154)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_ATT_QUAL1_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17634103837510154)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_LEAVE_SETUP_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17634348594510155)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_LOS1_YORK_2_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17634599006510156)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_LOS1_YORK_3_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17634708862510157)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_LOS1_YORK_4_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17634994737510157)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_LOS1_YORK_5_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17635129375510158)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_LOS1_YORK_6_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17635323138510159)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_LOS1_YORK_7_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17635598197510160)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_LOS1_YORK_8_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17635752120510160)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_LOS1_YORK_9_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17635966043510161)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_LOS1_YORK_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17636153715510162)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_NEW_CHINAR_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17636341083510163)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_NEW_CHINAR_T_INTERFACE'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17636543163510163)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_SAMPLE_HOTEL_DATA_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17636702531510164)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_SEG1_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17636980057510165)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_SEGMENT_QUALIFIER1_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17637187999510166)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_SEGMENT_QUALIFIER2_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17637378980510166)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_SEGMENT_QUALIFIER_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17637588359510167)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_VK_TMS_TASK_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17637777095510168)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_YORK_LOS1_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17637954805510169)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_YORK_LOS1_VK_29SEP25_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17638133873510169)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_YORK_TEMP12_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17638374099510170)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'UR_YORK_TEMP14_T'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17638598521510171)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'XXPEL_WF_GLOBAL_PROFILES_TBL'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17638714257510172)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TABLE'
,p_object_name=>'XX_FEEDBACK_EMAIL_DETAILS'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17638932325510172)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'TRG_UR_ADDRESSES_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17639183588510173)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'TRG_UR_ALGOS_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17639396870510174)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'TRG_UR_ALGO_ATTRIBUTES_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17639580120510175)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'TRG_UR_ALGO_VERSIONS_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17639710821510175)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'TRG_UR_CONTACTS_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17639922485510176)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'TRG_UR_EVENTS_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17640189006510177)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'TRG_UR_HOTELS_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17640346086510178)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'TRG_UR_HOTEL_GROUPS_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17640533999510178)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'TRG_UR_HOTEL_PRICE_OVERRIDE_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17640738677510179)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'TRG_UR_HOTEL_RESERVATIONS_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17640956460510180)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'TRG_UR_HOTEL_ROOM_TYPES_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17641103228510181)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'TRG_UR_INTERFACE_LOGS_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17641359053510181)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'TRG_UR_REPORTS_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17641594942510182)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'TRG_UR_REPORT_DASHBOARDS_BI'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17641726653510183)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'TRG_UR_TEMPLATES_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17641999543510184)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'TRG_UR_USERS_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17642157358510185)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_1DAY_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17642346593510185)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_3DAY2_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17642539274510186)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_3DAY_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17642714964510187)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_7DAY1_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17642933490510188)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_ADAM_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17643181791510188)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_BHAUMIK_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17643351428510189)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_CHINAR_22SEPT1_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17643569292510190)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_CHINAR_22SEPT_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17643740476510191)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_CHINAR_28_SEP_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17643973015510191)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_CHINAR_STAY_DATE_TEMPLATE_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17644135337510192)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_CHINAR_TEST_111_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17644329981510193)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_CHINAR_TEST_112_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17644513977510194)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_DAILY_BREAKDOWN11_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17644740238510194)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_DAILY_BREAKDOWN_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17644984641510195)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_DAILY_BREAKDOWN_VK_2_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17645162401510196)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_DAILY_BREAKDOWN_VK_3_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17645357784510197)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_DAILY_BREAKDOWN_VK_4_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17645502882510198)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_DAILY_BREAKDOWN_VK_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17645747708510198)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_DEMO_30SEP25_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17645949453510199)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_EXPENSE_TEMPLATE_02_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17646196000510200)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_EXP_REPORT_2122122_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17646359110510201)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_EXP_REPORT_212212_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17646571831510201)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_EXP_REPORT_21221_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17646712724510202)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_EXP_REPORT_21_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17646913584510203)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_EXP_REPORT_3_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17647164885510204)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_EXP_REPORT_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17647315799510204)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_INDIGO_L_SQUARE_I_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17647569045510205)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_INDIGO_L_SQUARE_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17647720881510206)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_LOS1_INDIGO_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17647973474510207)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_LOS1_MCL_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17648158391510207)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_LOS1_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17648311880510208)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_LOS1_YORK_10_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17648509702510209)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_LOS1_YORK_11_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17648792767510210)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_LOS1_YORK_12_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17648984514510210)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_LOS1_YORK_13OCT_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17649138690510211)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_LOS1_YORK_13_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17649346255510212)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_LOS1_YORK_14_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17649519552510213)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_LOS1_YORK_15_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17649701495510213)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_LOS1_YORK_2_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17649910054510214)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_LOS1_YORK_7_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17650190367510215)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_LOS1_YORK_8_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17650321406510216)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_LOS1_YORK_9_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17650529757510216)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_LOS1_YORK_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17650738707510217)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_LOS3_YORK_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17650943410510218)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_MCL_LOS1_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17651184975510219)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_PICKUP_INDIGO_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17651373363510219)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_STR_3_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17651533022510220)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_STR_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17651720437510221)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_TEMP_1_OCT_N1_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17651974227510222)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_TEMP_1_OCT_N2_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17652108322510222)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_TEMP_1_OCT_N_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17652341916510223)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_TEMP_1_OCT_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17652562861510224)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_TEMP_3_OCT_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17652751869510225)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_TEMP_DEMO_11_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17652964242510226)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_TEMP_NN_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17653112513510226)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_TEST1_22_CHINAR_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17653349977510227)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_TEST_13_10_CP_2_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17653561297510228)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_TEST_13_10_CP_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17653731128510229)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_TEST_CHINAR_1_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17653987978510229)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_TEST_CHINAR_29_SEP_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17654120653510230)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_TEST_CHINAR_2_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17654374977510231)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_TEST_CHINAR_NEWEST_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17654526471510232)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_TEST_CHINAR_NO_USC_NEW_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17654721145510232)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_TEST_CHINAR_NO_USC_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17654941058510233)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_TEST_CHINAR_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17655158076510234)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_TEST_STACY_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17655343382510235)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_TEST_TEMPLATE_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17655579200510235)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_TT_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17655744218510236)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_UR_BHAUMIK_30_SEP1_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17655995248510237)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_UR_BHAUMIK_30_SEP_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17656181579510238)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_UR_CHINAR_QUAL_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17656339761510238)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_250915_1_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17656561803510239)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_250915_2_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17656791532510240)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_250915_3_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17656955865510241)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_250915_4_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17657126644510242)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_250915_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17657394091510242)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_ATT_QUAL1_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17657567299510243)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_LEAVE_SETUP_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17657701343510244)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_LOS1_YORK_2_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17657937796510245)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_LOS1_YORK_3_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17658166148510245)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_LOS1_YORK_4_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17658373944510246)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_LOS1_YORK_5_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17658588200510247)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_LOS1_YORK_6_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17658711904510248)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_LOS1_YORK_7_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17658936940510248)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_LOS1_YORK_8_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17659159258510249)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_LOS1_YORK_9_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17659327958510250)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_LOS1_YORK_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17659508072510251)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_NEW_CHINAR_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17659785909510251)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_SAMPLE_HOTEL_DATA_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17659969792510252)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_SEG1_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17660142697510253)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_SEGMENT_QUALIFIER1_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17660313000510254)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_SEGMENT_QUALIFIER2_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17660569813510254)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_SEGMENT_QUALIFIER_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17660721905510255)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_VK_TMS_TASK_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17660979084510256)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_YORK_LOS1_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17661188852510257)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_YORK_LOS1_VK_29SEP25_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17661386385510257)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_YORK_TEMP12_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17661502943510258)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TRIGGER'
,p_object_name=>'UR_YORK_TEMP14_T_BI_TRG'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17661737117510259)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TYPE'
,p_object_name=>'ATTRIBUTE_VALUE_ROW'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17661971959510260)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TYPE'
,p_object_name=>'ATTRIBUTE_VALUE_TABLE'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17662192148510260)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TYPE'
,p_object_name=>'LOG_REC_OBJ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17662355632510261)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TYPE'
,p_object_name=>'LOG_TAB_TYPE'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17662567891510262)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TYPE'
,p_object_name=>'MY_DATE_LIST'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17662763900510263)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TYPE'
,p_object_name=>'T_RESULT_REC_OBJ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17662924976510263)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TYPE'
,p_object_name=>'T_RESULT_TAB_OBJ'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17663129836510264)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TYPE'
,p_object_name=>'UR_ATTRIBUTE_VALUE_ROW'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17663393795510265)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'TYPE'
,p_object_name=>'UR_ATTRIBUTE_VALUE_TABLE'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17663551615510266)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'TEMP_INDIGOHOTELS_INDIGOREPORT_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17663751650510267)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'TEMP_INDIGOHOTELS_R2_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17663981649510267)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'TEMP_INDIGOHOTELS_R6_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17664182552510268)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'TEMP_INDIGOHOTELS_REPORT1_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17664344326510269)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'TEMP_INDIGOHOTELS_REPORT24_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17664550948510270)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'TEMP_INDIGOHOTELS_REPORTTEMP_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17664790945510270)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'TEMP_INDIGOHOTELS_TEST_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17664981225510271)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'TEMP_INDIGO_HOTELS_R2_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17665140073510272)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'TEMP_MARRIOTCENTRALLONDON_DEMO_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17665327967510273)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'TEMP_MARRIOTCENTRALLONDON_R1_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17665583400510273)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'TEMP_MARRIOTCL_FIRSTR_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17665731964510274)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'TEMP_MARRIOTCL_TEST_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17665998737510275)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'TEMP_MARRIOTCL__V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17666146244510276)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'TEMP_YORKHOTEL_YORK06_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17666308983510276)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'TEMP_YORKHOTEL_YORK7_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17666598757510277)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'TEMP_YORKHOTEL_YORKR1_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17666716791510278)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'TEMP_YORKHOTEL_YORKR7_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17666997591510279)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'TEMP_YORKHOTEL_YORK_REPORT_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17667145781510279)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'UR_DEMO_30SEP25_RANKING_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17667307815510280)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'UR_LOS1_INDIGO_RANKING_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17667583991510281)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'UR_LOS1_MCL_RANKING_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17667764457510282)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'UR_LOS1_YORK_12_RANKING_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17667997628510282)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'UR_LOS1_YORK_13OCT_RANKING_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17668155647510283)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'UR_LOS1_YORK_13_RANKING_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17668379255510284)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'UR_LOS1_YORK_15_RANKING_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17668526127510285)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'UR_LOS1_YORK_2_RANKING_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17668745127510285)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'UR_MCL_LOS1_RANKING_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17668941078510286)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'UR_VK_LOS1_YORK_2_RANKING_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17669143334510287)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'UR_VK_LOS1_YORK_3_RANKING_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17669371946510288)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'UR_VK_LOS1_YORK_4_RANKING_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17669506525510288)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'UR_VK_LOS1_YORK_RANKING_V'
);
wwv_flow_imp_shared.create_install_object(
 p_id=>wwv_flow_imp.id(17669757013510289)
,p_script_id=>wwv_flow_imp.id(17568291839509893)
,p_object_owner=>'#OWNER#'
,p_object_type=>'VIEW'
,p_object_name=>'V_RANKING_UR_LOS1_YORK_2_T'
);
wwv_flow_imp.component_end;
end;
/
