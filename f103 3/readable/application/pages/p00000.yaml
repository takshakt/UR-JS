---
# ====== Page: Global Page ===================================
id: 0
identification: 
  name: Global Page

regions: 
- # ====== Region: Hotel Selector ==============================
  id: 25697469516364507
  identification: 
    name: Hotel Selector
    type: Static Content

  layout: 
    sequence: 10
    parent-region: No Parent
    slot: REGION_POSITION_01
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Blank with Attributes
    template-options: 
    - '#DEFAULT#'
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

page-items: 
- # ====== Page Item: P0_ALERT_MESSAGE =========================
  id: 12881528989327102
  identification: 
    name: P0_ALERT_MESSAGE
    type: Hidden

  settings: 
    value-protected: false

  layout: 
    sequence: 30
    region: No Parent
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Always, replacing any existing value in session state

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P0_HOTEL_ID ==============================
  id: 25696812640364501
  identification: 
    name: P0_HOTEL_ID
    type: Select List

  label: 
    label: Hotel Name
    alignment: Left

  settings: 
    page-action-on-selection: None

  multiple-values: 
    type: No

  layout: 
    sequence: 10
    region: Hotel Selector # 25697469516364507
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    label-column-span: Page Template Default

  appearance: 
    template: Optional - Floating
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--stretchInputs
    - t-Form-fieldContainer--large
    - t-Form-fieldContainer--noPadding
    - t-Form-fieldContainer--normalDisplay
    height: 1

  validation: 
    value-required: false

  list-of-values: 
    type: SQL Query
    sql-query: |
      SELECT DISPLAY_VALUE, RETURN_VALUE FROM (
        SELECT NVL(HOTEL_NAME, 'Name') AS DISPLAY_VALUE,
               RAWTOHEX(ID) AS RETURN_VALUE,
               2 AS SORT_ORDER
        FROM UR_HOTELS
        WHERE NVL(ASSOCIATION_END_DATE, SYSDATE) >= SYSDATE
        UNION ALL
        SELECT '-- Show all data --' AS DISPLAY_VALUE,
               'FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF' AS RETURN_VALUE,
               1 AS SORT_ORDER
        FROM DUAL
      )
      ORDER BY SORT_ORDER, DISPLAY_VALUE
    display-extra-values: false
    display-null-value: false

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  default: 
    type: Static
    static-value: FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF

  session-state: 
    storage: Per Session (Persistent)

  quick-picks: 
    show-quick-picks: false

  server-side-condition: 
    type: Expression
    language: PL/SQL
    pl/sql-expression: |
      INSTR(':1026:17:1023:9:19:1075:1001:1002:29:1010:28:1601:33:1006:24:15:167:', ':'||:APP_PAGE_ID||':') > 0
      -- removinge strategy page 1050 from the global hotel

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P0_USERNAME ==============================
  id: 28720602057061102
  identification: 
    name: P0_USERNAME
    type: Hidden

  settings: 
    value-protected: false

  layout: 
    sequence: 40
    region: No Parent
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Always, replacing any existing value in session state

  default: 
    type: Static
    static-value: '&APP_USER.'

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

dynamic-actions: 
- # ====== Dynamic Action: Page load ===========================
  id: 9903648984138615
  identification: 
    name: Page load

  execution: 
    sequence: 20
    event-scope: Static

  when: 
    event: Page Load

- # ====== Dynamic Action: Changed =============================
  id: 12881614238327103
  identification: 
    name: Changed

  execution: 
    sequence: 10
    event-scope: Static
    type: Immediate

  when: 
    event: Change
    selection-type: Item(s)
    item(s): 
    - P0_ALERT_MESSAGE

  actions: 
  - # ====== Action: Execute JavaScript Code =====================
    id: 12881784055327104
    identification: 
      action: Execute JavaScript Code

    settings: 
      code: |
        var messagesJson = $v("P0_ALERT_MESSAGE");  // get the string from hidden page item
        
        if (messagesJson) {
          try {
            // Try parsing the string
            var parsed = JSON.parse(messagesJson);
        
            // Check if parsed result is array or object
            if (Array.isArray(parsed)) {
              // It's an array - pass as is
              showAlertToastr(parsed);
            } else if (parsed && typeof parsed === 'object') {
              // Single object - pass it wrapped in array for consistency 
              showAlertToastr([parsed]);
            } else {
              // Parsed to something else (string/number) — just pass original string
              showAlertToastr(messagesJson);
            }
          } catch (e) {
            // Parsing failed — probably plain text, pass as is
            showAlertToastr(messagesJson);
          }
        }

    execution: 
      sequence: 10
      event: Changed # 12881614238327103
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Connect Hotel ID  ===================
  id: 25696949470364502
  identification: 
    name: 'Connect Hotel ID '

  execution: 
    sequence: 30
    event-scope: Static
    type: Immediate

  when: 
    event: Change
    selection-type: Item(s)
    item(s): 
    - P0_HOTEL_ID

  actions: 
  - # ====== Action: Execute Server-side Code ====================
    id: 25697070030364503
    identification: 
      action: Execute Server-side Code

    settings: 
      language: PE.PROPERTY.SOURCE_SNIPPET_LANG.LOV.PLSQL.D
      pl/sql-code: |
        :G_HOTEL_ID := :P0_HOTEL_ID;
        
      items-to-submit: 
      - P0_HOTEL_ID

    execution: 
      sequence: 10
      event: 'Connect Hotel ID ' # 25696949470364502
      fire-when-event-result-is: True
      fire-on-initialization: false
      stop-execution-on-error: true
      wait-for-result: true

